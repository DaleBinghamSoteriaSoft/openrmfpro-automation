{
    "profile_info": {
      "profile_id": "xccdf_org.ssgproject.content_profile_cis_server_l1",
      "description": "This profile defines a baseline that aligns to the \"Level 1 - Server\"\nconfiguration from the Center for Internet Security® Red Hat Enterprise\nLinux 8 Benchmark™, v3.0.0, released 2023-10-30.\n\nThis profile includes Center for Internet Security®\nRed Hat Enterprise Linux 8 CIS Benchmarks™ content.",
      "title": "CIS Red Hat Enterprise Linux 8 Benchmark for Level 1 - Server"
    },
    "scan_result": {
      "title": "OSCAP Scan Result",
      "identity": "root",
      "profile_id": "xccdf_org.ssgproject.content_profile_cis_server_l1",
      "target": "965ad5ea4cb4",
      "cpe_platforms": [
        "#package_yum",
        "#package_libuser",
        "#package_systemd",
        "#package_shadow-utils",
        "#package_pam",
        "#package_bash",
        "cpe:/o:redhat:enterprise_linux:8.10",
        "cpe:/o:redhat:enterprise_linux:8",
        "#ipv6_enabled"
      ],
      "scanner": "OpenSCAP",
      "scanner_version": "1.4.0",
      "benchmark_url": "#scap_org.open-scap_comp_ssg-rhel8-xccdf.xml",
      "benchmark_id": "xccdf_org.ssgproject.content_benchmark_RHEL-8",
      "benchmark_version": "0.1.74",
      "start_time": "2025-04-12T19:39:26+00:00",
      "end_time": "2025-04-12T19:39:26+00:00",
      "test_system": "cpe:/a:redhat:openscap:1.4.0",
      "score_system": "urn:xccdf:scoring:default",
      "score": 82.944443,
      "score_max": 100,
      "target_addresses": {
        "MAC": [
          "00:00:00:00:00:00"
        ],
        "IPv4": [
          "127.0.0.1"
        ],
        "IPv6": [
          "::1"
        ]
      },
      "guid": "d27f627e-d787-4d10-8115-9854a001e76e",
      "target_name": "redhat/ubi8:8.10",
      "rfcat_version": "1.24.12"
    },
    "rules": {
      "xccdf_org.ssgproject.content_rule_package_aide_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_aide_installed",
        "title": "Install AIDE",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80844-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R76",
              "R79"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "5",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.3"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI01.06",
              "BAI02.01",
              "BAI03.05",
              "BAI06.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS04.07",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001744",
              "CCI-002696",
              "CCI-002699"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.3",
              "SR 3.4",
              "SR 3.8",
              "SR 4.1",
              "SR 6.2",
              "SR 7.6"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1034",
              "1288",
              "1341",
              "1417"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.4",
              "A.12.1.2",
              "A.12.2.1",
              "A.12.4.1",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.14.2.7",
              "A.15.2.1",
              "A.8.2.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-7",
              "PR.DS-1",
              "PR.DS-6",
              "PR.DS-8",
              "PR.IP-1",
              "PR.IP-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000445-GPOS-00199"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-11.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "11.5.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010359"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-251710r880730_rule"
            ]
          }
        ],
        "description": "The <code>aide</code> package can be installed with the following command:\n<pre>\n$ sudo yum install aide</pre>\n         ",
        "rationale": "The AIDE package must be installed if it is to be available for integrity checking.",
        "oval_definition_id": "oval:ssg-package_aide_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_aide_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure aide is installed\n  package:\n    name: aide\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80844-4\n  - CJIS-5.10.1.3\n  - DISA-STIG-RHEL-08-010359\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_aide_installed\n"
          },
          {
            "remediation_id": "package_aide_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_aide\n\nclass install_aide {\n  package { 'aide':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_aide_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"aide\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_aide_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"aide\" ; then\n    yum install -y \"aide\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-251710",
        "stig_id": "RHEL-08-010359"
      },
      "xccdf_org.ssgproject.content_rule_aide_build_database": {
        "rule_id": "xccdf_org.ssgproject.content_rule_aide_build_database",
        "title": "Build and Test AIDE Database",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80675-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R76",
              "R79"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "5",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.3"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI01.06",
              "BAI02.01",
              "BAI03.05",
              "BAI06.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS04.07",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.3",
              "SR 3.4",
              "SR 3.8",
              "SR 4.1",
              "SR 6.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.4",
              "A.12.1.2",
              "A.12.2.1",
              "A.12.4.1",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.14.2.7",
              "A.15.2.1",
              "A.8.2.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-7",
              "PR.DS-1",
              "PR.DS-6",
              "PR.DS-8",
              "PR.IP-1",
              "PR.IP-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000445-GPOS-00199"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-11.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "11.5.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010359"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-251710r880730_rule"
            ]
          }
        ],
        "description": "Run the following command to generate a new database:\n\n<pre>$ sudo /usr/sbin/aide --init</pre>\n\nBy default, the database will be written to the file\n\n<code>/var/lib/aide/aide.db.new.gz</code>.\n\nStoring the database, the configuration file <code>/etc/aide.conf</code>, and the binary\n<code>/usr/sbin/aide</code>\n(or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.\nThe newly-generated database can be installed as follows:\n\n<pre>$ sudo cp /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</pre>\n\nTo initiate a manual check, run the following command:\n<pre>$ sudo /usr/sbin/aide --check</pre>\nIf this check produces any unexpected output, investigate.",
        "rationale": "For AIDE to be effective, an initial database of &quot;known-good&quot; information about files\nmust be captured and it should be able to be verified against the installed files.",
        "oval_definition_id": "oval:ssg-aide_build_database:def:1",
        "remediations": [
          {
            "remediation_id": "aide_build_database",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Build and Test AIDE Database - Ensure AIDE Is Installed\n  ansible.builtin.package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - aide\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80675-2\n  - CJIS-5.10.1.3\n  - DISA-STIG-RHEL-08-010359\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_build_database\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Build and Test AIDE Database - Build and Test AIDE Database\n  ansible.builtin.command: /usr/sbin/aide --init\n  changed_when: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80675-2\n  - CJIS-5.10.1.3\n  - DISA-STIG-RHEL-08-010359\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_build_database\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Build and Test AIDE Database - Check Whether the Stock AIDE Database Exists\n  ansible.builtin.stat:\n    path: /var/lib/aide/aide.db.new.gz\n  register: aide_database_stat\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80675-2\n  - CJIS-5.10.1.3\n  - DISA-STIG-RHEL-08-010359\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_build_database\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Build and Test AIDE Database - Stage AIDE Database\n  ansible.builtin.copy:\n    src: /var/lib/aide/aide.db.new.gz\n    dest: /var/lib/aide/aide.db.gz\n    backup: true\n    remote_src: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - (aide_database_stat.stat.exists is defined and aide_database_stat.stat.exists)\n  tags:\n  - CCE-80675-2\n  - CJIS-5.10.1.3\n  - DISA-STIG-RHEL-08-010359\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_build_database\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "aide_build_database",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"aide\" ; then\n    yum install -y \"aide\"\nfi\n\n/usr/sbin/aide --init\n/bin/cp -p /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-251710",
        "stig_id": "RHEL-08-010359"
      },
      "xccdf_org.ssgproject.content_rule_aide_check_audit_tools": {
        "rule_id": "xccdf_org.ssgproject.content_rule_aide_check_audit_tools",
        "title": "Configure AIDE to Verify the Audit Tools",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85964-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.3.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001496"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AU-9(3)",
              "AU-9(3).1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000278-GPOS-00108"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-030650"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230475r880722_rule"
            ]
          }
        ],
        "description": "The operating system file integrity tool must be configured to protect the integrity of the audit tools.",
        "rationale": "Protecting the integrity of the tools used for auditing purposes is a\ncritical step toward ensuring the integrity of audit information. Audit\ninformation includes all information (e.g., audit records, audit settings,\nand audit reports) needed to successfully audit information system\nactivity.\n\nAudit tools include but are not limited to vendor-provided and open-source\naudit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code\ninto the existing tools to provide the capability to hide or erase system\nactivity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed to\nprovide the capability to identify when the audit tools have been modified,\nmanipulated, or replaced. An example is a checksum hash of the file or\nfiles.",
        "oval_definition_id": "oval:ssg-aide_check_audit_tools:def:1",
        "remediations": [
          {
            "remediation_id": "aide_check_audit_tools",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Configure AIDE to Verify the Audit Tools - Gather List of Packages\n  tags:\n  - CCE-85964-5\n  - DISA-STIG-RHEL-08-030650\n  - NIST-800-53-AU-9(3)\n  - NIST-800-53-AU-9(3).1\n  - aide_check_audit_tools\n  - aide_check_audit_tools\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  ansible.builtin.package_facts:\n    manager: auto\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n\n- name: Ensure aide is installed\n  package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - aide\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85964-5\n  - DISA-STIG-RHEL-08-030650\n  - NIST-800-53-AU-9(3)\n  - NIST-800-53-AU-9(3).1\n  - aide_check_audit_tools\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set audit_tools fact\n  set_fact:\n    audit_tools:\n    - /usr/sbin/auditctl\n    - /usr/sbin/auditd\n    - /usr/sbin/augenrules\n    - /usr/sbin/aureport\n    - /usr/sbin/ausearch\n    - /usr/sbin/autrace\n    - /usr/sbin/rsyslogd\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85964-5\n  - DISA-STIG-RHEL-08-030650\n  - NIST-800-53-AU-9(3)\n  - NIST-800-53-AU-9(3).1\n  - aide_check_audit_tools\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure existing AIDE configuration for audit tools are correct\n  lineinfile:\n    path: /etc/aide.conf\n    regexp: ^{{ item }}\\s\n    line: '{{ item }} p+i+n+u+g+s+b+acl+xattrs+sha512'\n  with_items: '{{ audit_tools }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85964-5\n  - DISA-STIG-RHEL-08-030650\n  - NIST-800-53-AU-9(3)\n  - NIST-800-53-AU-9(3).1\n  - aide_check_audit_tools\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Configure AIDE to properly protect audit tools\n  lineinfile:\n    path: /etc/aide.conf\n    line: '{{ item }} p+i+n+u+g+s+b+acl+xattrs+sha512'\n  with_items: '{{ audit_tools }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85964-5\n  - DISA-STIG-RHEL-08-030650\n  - NIST-800-53-AU-9(3)\n  - NIST-800-53-AU-9(3).1\n  - aide_check_audit_tools\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "aide_check_audit_tools",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"aide\" ; then\n    yum install -y \"aide\"\nfi\n\n\n\n\n\n\n\n\n\n\nif grep -i '^.*/usr/sbin/auditctl.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/auditctl.*#/usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/auditd.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/auditd.*#/usr/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/ausearch.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/ausearch.*#/usr/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/aureport.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/aureport.*#/usr/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/autrace.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/autrace.*#/usr/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/augenrules.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/augenrules.*#/usr/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/rsyslogd.*$' /etc/aide.conf; then\nsed -i \"s#.*/usr/sbin/rsyslogd.*#/usr/sbin/rsyslogd p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide.conf\nelse\necho \"/usr/sbin/rsyslogd p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230475",
        "stig_id": "RHEL-08-030650"
      },
      "xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking": {
        "rule_id": "xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking",
        "title": "Configure Periodic Execution of AIDE",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80676-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R76"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "5",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.3"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI01.06",
              "BAI02.01",
              "BAI03.05",
              "BAI06.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS04.07",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001744",
              "CCI-002699",
              "CCI-002702"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.3",
              "SR 3.4",
              "SR 3.8",
              "SR 4.1",
              "SR 6.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.4",
              "A.12.1.2",
              "A.12.2.1",
              "A.12.4.1",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.14.2.7",
              "A.15.2.1",
              "A.8.2.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "SI-7",
              "SI-7(1)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-7",
              "PR.DS-1",
              "PR.DS-6",
              "PR.DS-8",
              "PR.IP-1",
              "PR.IP-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000363-GPOS-00150",
              "SRG-OS-000446-GPOS-00200",
              "SRG-OS-000447-GPOS-00201"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-11.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "11.5.2"
            ]
          }
        ],
        "description": "At a minimum, AIDE should be configured to run a weekly scan.\nTo implement a daily execution of AIDE at 4:05am using cron, add the following line to <code>/etc/crontab</code>:\n<pre>05 4 * * * root /usr/sbin/aide --check</pre>\nTo implement a weekly execution of AIDE at 4:05am using cron, add the following line to <code>/etc/crontab</code>:\n<pre>05 4 * * 0 root /usr/sbin/aide --check</pre>\nAIDE can be executed periodically through other means; this is merely one example.\nThe usage of cron&#x27;s special time codes, such as  <code>@daily</code> and\n<code>@weekly</code> is acceptable.",
        "rationale": "By default, AIDE does not install itself for periodic execution. Periodically\nrunning AIDE is necessary to reveal unexpected changes in installed files.\n<br>\n          <br>\nUnauthorized changes to the baseline configuration could make the system vulnerable\nto various attacks or allow unauthorized access to the operating system. Changes to\noperating system configurations can have unintended side effects, some of which may\nbe relevant to security.\n<br>\n          <br>\nDetecting such changes and providing an automated response can help avoid unintended,\nnegative consequences that could ultimately affect the security state of the operating\nsystem. The operating system&#x27;s Information Management Officer (IMO)/Information System\nSecurity Officer (ISSO) and System Administrators (SAs) must be notified via email and/or\nmonitoring system trap when there is an unauthorized modification of a configuration item.",
        "oval_definition_id": "oval:ssg-aide_periodic_cron_checking:def:1",
        "remediations": [
          {
            "remediation_id": "aide_periodic_cron_checking",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure AIDE is installed\n  package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - aide\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80676-0\n  - CJIS-5.10.1.3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SI-7\n  - NIST-800-53-SI-7(1)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_periodic_cron_checking\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set cron package name - RedHat\n  set_fact:\n    cron_pkg_name: cronie\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - ansible_os_family == \"RedHat\" or ansible_os_family == \"Suse\"\n  tags:\n  - CCE-80676-0\n  - CJIS-5.10.1.3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SI-7\n  - NIST-800-53-SI-7(1)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_periodic_cron_checking\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set cron package name - Debian\n  set_fact:\n    cron_pkg_name: cron\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - ansible_os_family == \"Debian\"\n  tags:\n  - CCE-80676-0\n  - CJIS-5.10.1.3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SI-7\n  - NIST-800-53-SI-7(1)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_periodic_cron_checking\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Install cron\n  package:\n    name: '{{ cron_pkg_name }}'\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80676-0\n  - CJIS-5.10.1.3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SI-7\n  - NIST-800-53-SI-7(1)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_periodic_cron_checking\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Configure Periodic Execution of AIDE\n  cron:\n    name: run AIDE check\n    minute: 5\n    hour: 4\n    weekday: 0\n    user: root\n    job: /usr/sbin/aide --check\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80676-0\n  - CJIS-5.10.1.3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SI-7\n  - NIST-800-53-SI-7(1)\n  - PCI-DSS-Req-11.5\n  - PCI-DSSv4-11.5.2\n  - aide_periodic_cron_checking\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "aide_periodic_cron_checking",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"aide\" ; then\n    yum install -y \"aide\"\nfi\n\nif ! grep -q \"/usr/sbin/aide --check\" /etc/crontab ; then\n    echo \"05 4 * * * root /usr/sbin/aide --check\" >> /etc/crontab\nelse\n    sed -i '\\!^.* --check.*$!d' /etc/crontab\n    echo \"05 4 * * * root /usr/sbin/aide --check\" >> /etc/crontab\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_configure_crypto_policy": {
        "rule_id": "xccdf_org.ssgproject.content_rule_configure_crypto_policy",
        "title": "Configure System Cryptography Policy",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80935-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.6.1"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1446"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R4.2",
              "CIP-007-3 R5.1",
              "CIP-007-3 R7.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(2)",
              "AC-17(a)",
              "CM-6(a)",
              "MA-4(6)",
              "SC-12(2)",
              "SC-12(3)",
              "SC-13"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000393-GPOS-00173",
              "SRG-OS-000394-GPOS-00174",
              "SRG-OS-000396-GPOS-00176"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FCS_CKM.1",
              "FCS_CKM.2",
              "FCS_COP.1(1)",
              "FCS_COP.1(2)",
              "FCS_COP.1(3)",
              "FCS_COP.1(4)",
              "FCS_TLSC_EXT.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.7"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010020"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230223r928585_rule"
            ]
          }
        ],
        "description": "To configure the system cryptography policy to use ciphers only from the <code>DEFAULT:NO-SHA1</code>\npolicy, run the following command:\n<pre>$ sudo update-crypto-policies --set DEFAULT:NO-SHA1\n         </pre>\nThe rule checks if settings for selected crypto policy are configured as expected. Configuration files in the <code>/etc/crypto-policies/back-ends</code> are either symlinks to correct files provided by Crypto-policies package or they are regular files in case crypto policy customizations are applied.\nCrypto policies may be customized by crypto policy modules, in which case it is delimited from the base policy using a colon.",
        "rationale": "Centralized cryptographic policies simplify applying secure ciphers across an operating system and\nthe applications that run on that operating system. Use of weak or untested encryption algorithms\nundermines the purposes of utilizing encryption to protect data.",
        "warnings": [
          {
            "text": "The system needs to be rebooted for these changes to take effect.",
            "category": "general"
          },
          {
            "text": "System Crypto Modules must be provided by a vendor that undergoes\nFIPS-140 certifications.\nFIPS-140 is applicable to all Federal agencies that use\ncryptographic-based security systems to protect sensitive information\nin computer and telecommunication systems (including voice systems) as\ndefined in Section 5131 of the Information Technology Management Reform\nAct of 1996, Public Law 104-106. This standard shall be used in\ndesigning and implementing cryptographic modules that Federal\ndepartments and agencies operate or are operated for them under\ncontract. See <b><a href=\"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-2.pdf\">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-2.pdf</a></b>\nTo meet this, the system has to have cryptographic software provided by\na vendor that has undergone this certification. This means providing\ndocumentation, test results, design information, and independent third\nparty review by an accredited lab. While open source software is\ncapable of meeting this, it does not meet FIPS-140 unless the vendor\nsubmits to this process.",
            "category": "regulatory"
          }
        ],
        "oval_definition_id": "oval:ssg-configure_crypto_policy:def:1",
        "remediations": [
          {
            "remediation_id": "configure_crypto_policy",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_system_crypto_policy # promote to variable\n  set_fact:\n    var_system_crypto_policy: !!str DEFAULT:NO-SHA1\n  tags:\n    - always\n\n- name: Configure System Cryptography Policy\n  lineinfile:\n    path: /etc/crypto-policies/config\n    regexp: ^(?!#)(\\S+)$\n    line: '{{ var_system_crypto_policy }}'\n    create: true\n  tags:\n  - CCE-80935-0\n  - DISA-STIG-RHEL-08-010020\n  - NIST-800-53-AC-17(2)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-MA-4(6)\n  - NIST-800-53-SC-12(2)\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SC-13\n  - PCI-DSSv4-2.2.7\n  - configure_crypto_policy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that Crypto Policy is Set (runtime)\n  command: /usr/bin/update-crypto-policies --set {{ var_system_crypto_policy }}\n  tags:\n  - CCE-80935-0\n  - DISA-STIG-RHEL-08-010020\n  - NIST-800-53-AC-17(2)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-MA-4(6)\n  - NIST-800-53-SC-12(2)\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SC-13\n  - PCI-DSSv4-2.2.7\n  - configure_crypto_policy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "configure_crypto_policy",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n        - name: configure-crypto-policy.service\n          enabled: true\n          contents: |\n            [Unit]\n            Before=kubelet.service\n            [Service]\n            Type=oneshot\n            ExecStart=update-crypto-policies --set {{.var_system_crypto_policy}}\n            RemainAfterExit=yes\n            [Install]\n            WantedBy=multi-user.target\n"
          },
          {
            "remediation_id": "configure_crypto_policy",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "\nvar_system_crypto_policy='DEFAULT:NO-SHA1'\n\n\nstderr_of_call=$(update-crypto-policies --set ${var_system_crypto_policy} 2>&1 > /dev/null)\nrc=$?\n\nif test \"$rc\" = 127; then\n\techo \"$stderr_of_call\" >&2\n\techo \"Make sure that the script is installed on the remediated system.\" >&2\n\techo \"See output of the 'dnf provides update-crypto-policies' command\" >&2\n\techo \"to see what package to (re)install\" >&2\n\n\tfalse  # end with an error code\nelif test \"$rc\" != 0; then\n\techo \"Error invoking the update-crypto-policies script: $stderr_of_call\" >&2\n\tfalse  # end with an error code\nfi\n"
          }
        ],
        "vuln_id": "SV-230223",
        "stig_id": "RHEL-08-010020"
      },
      "xccdf_org.ssgproject.content_rule_configure_ssh_crypto_policy": {
        "rule_id": "xccdf_org.ssgproject.content_rule_configure_ssh_crypto_policy",
        "title": "Configure SSH to use System Crypto Policy",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80939-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.22"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001453"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R4.2",
              "CIP-007-3 R5.1",
              "CIP-007-3 R7.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(2)",
              "AC-17(a)",
              "CM-6(a)",
              "MA-4(6)",
              "SC-13"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000250-GPOS-00093"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FCS_SSHC_EXT.1",
              "FCS_SSHS_EXT.1",
              "FCS_SSH_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.7"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010287"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244526r877394_rule"
            ]
          }
        ],
        "description": "Crypto Policies provide a centralized control over crypto algorithms usage of many packages.\nSSH is supported by crypto policy, but the SSH configuration may be\nset up to ignore it.\nTo check that Crypto Policies settings are configured correctly, ensure that\nthe <code>CRYPTO_POLICY</code> variable is either commented or not set at all\nin the <code>/etc/sysconfig/sshd</code>.",
        "rationale": "Overriding the system crypto policy makes the behavior of the SSH service violate expectations,\nand makes system configuration more fragmented.",
        "oval_definition_id": "oval:ssg-configure_ssh_crypto_policy:def:1",
        "remediations": [
          {
            "remediation_id": "configure_ssh_crypto_policy",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: Configure SSH to use System Crypto Policy\n  lineinfile:\n    dest: /etc/sysconfig/sshd\n    state: absent\n    regexp: (?i)^\\s*CRYPTO_POLICY.*$\n  tags:\n  - CCE-80939-2\n  - DISA-STIG-RHEL-08-010287\n  - NIST-800-53-AC-17(2)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-MA-4(6)\n  - NIST-800-53-SC-13\n  - PCI-DSS-Req-2.2\n  - PCI-DSSv4-2.2.7\n  - configure_ssh_crypto_policy\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n"
          },
          {
            "remediation_id": "configure_ssh_crypto_policy",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "\nSSH_CONF=\"/etc/sysconfig/sshd\"\n\nsed -i \"/^\\s*CRYPTO_POLICY.*$/Id\" $SSH_CONF\n"
          }
        ],
        "vuln_id": "SV-244526",
        "stig_id": "RHEL-08-010287"
      },
      "xccdf_org.ssgproject.content_rule_partition_for_dev_shm": {
        "rule_id": "xccdf_org.ssgproject.content_rule_partition_for_dev_shm",
        "title": "Ensure /dev/shm is configured",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-86282-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.2.1"
            ]
          }
        ],
        "description": "The <code>/dev/shm</code> is a traditional shared memory concept.\nOne program will create a memory portion, which other processes\n(if permitted) can access. If <code>/dev/shm</code> is not configured,\ntmpfs will be mounted to /dev/shm by systemd.",
        "rationale": "Any user can upload and execute files inside the <code>/dev/shm</code> similar to\nthe <code>/tmp</code> partition. Configuring <code>/dev/shm</code> allows an administrator\nto set the noexec option on the mount, making /dev/shm useless for an attacker to\ninstall executable code. It would also prevent an attacker from establishing a\nhardlink to a system setuid program and wait for it to be updated. Once the program\nwas updated, the hardlink would be broken and the attacker would have his own copy\nof the program. If the program happened to have a security vulnerability, the attacker\ncould continue to exploit the known flaw.",
        "warnings": [
          {
            "text": "This rule does not have a remedation.\nIt is expected that this will be managed by systemd and will be a tmpfs partition.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-partition_for_dev_shm:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_partition_for_tmp": {
        "rule_id": "xccdf_org.ssgproject.content_rule_partition_for_tmp",
        "title": "Ensure /tmp Located On Separate Partition",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-80851-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "15",
              "8"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "DSS05.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "SC-5(2)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010543"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230295r627750_rule"
            ]
          }
        ],
        "description": "The <code>/tmp</code> directory is a world-writable directory used\nfor temporary file storage. Ensure it has its own partition or\nlogical volume at installation time, or migrate it using LVM.",
        "rationale": "The <code>/tmp</code> partition is used as temporary storage by many programs.\nPlacing <code>/tmp</code> in its own partition enables the setting of more\nrestrictive mount options, which can help protect programs which use it.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-partition_for_tmp:def:1",
        "remediations": [
          {
            "remediation_id": "partition_for_tmp",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[customizations.filesystem]]\nmountpoint = \"/tmp\"\nsize = 1073741824\n"
          }
        ],
        "vuln_id": "SV-230295",
        "stig_id": "RHEL-08-010543"
      },
      "xccdf_org.ssgproject.content_rule_dconf_db_up_to_date": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_db_up_to_date",
        "title": "Make sure that the dconf databases are up-to-date with regards to respective keyfiles",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-81003-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "reload_dconf_db"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(5)(ii)(A)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-6.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          }
        ],
        "description": "By default, DConf uses a binary database as a data backend.\nThe system-level database is compiled from keyfiles in the /etc/dconf/db/\ndirectory by the <pre>dconf update</pre> command. More specifically, content present\nin the following directories:\n<pre>/etc/dconf/db/gdm.d</pre>\n        <pre>/etc/dconf/db/local.d</pre>\n       ",
        "rationale": "Unlike text-based keyfiles, the binary database is impossible to check by OVAL.\nTherefore, in order to evaluate dconf configuration, both have to be true at the same time -\nconfiguration files have to be compliant, and the database needs to be more recent than those keyfiles,\nwhich gives confidence that it reflects them.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_db_up_to_date:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_db_up_to_date",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-81003-6\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-8.2.8\n  - dconf_db_up_to_date\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Run dconf update\n  ansible.builtin.command:\n    cmd: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81003-6\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-8.2.8\n  - dconf_db_up_to_date\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_db_up_to_date",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_user_list": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_user_list",
        "title": "Disable the GNOME3 Login User List",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86195-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-23",
              "CM-6(a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020032"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244536r743857_rule"
            ]
          }
        ],
        "description": "In the default graphical environment, users logging directly into the\nsystem are greeted with a login screen that displays all known users.\nThis functionality should be disabled by setting <code>disable-user-list</code>\nto <code>true</code>.\n<br>\n         <br>\nTo disable, add or edit <code>disable-user-list</code> to\n<code>/etc/dconf/db/gdm.d/00-security-settings</code>. For example:\n<pre>[org/gnome/login-screen]\ndisable-user-list=true</pre>\nOnce the setting has been added, add a lock to\n<code>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</code> to prevent\nuser modification. For example:\n<pre>/org/gnome/login-screen/disable-user-list</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "Leaving the user list enabled is a security risk since it allows anyone\nwith physical access to the system to quickly enumerate known user accounts\nwithout logging in.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_disable_user_list:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_disable_user_list",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86195-5\n  - DISA-STIG-RHEL-08-020032\n  - NIST-800-53-AC-23\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_disable_user_list\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Disable the GNOME3 Login User List\n  ini_file:\n    dest: /etc/dconf/db/gdm.d/00-security-settings\n    section: org/gnome/login-screen\n    option: disable-user-list\n    value: 'true'\n    no_extra_spaces: true\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86195-5\n  - DISA-STIG-RHEL-08-020032\n  - NIST-800-53-AC-23\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_disable_user_list\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME3 disablement of Login User List\n  lineinfile:\n    path: /etc/dconf/db/gdm.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/login-screen/disable-user-list$\n    line: /org/gnome/login-screen/disable-user-list\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86195-5\n  - DISA-STIG-RHEL-08-020032\n  - NIST-800-53-AC-23\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_disable_user_list\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86195-5\n  - DISA-STIG-RHEL-08-020032\n  - NIST-800-53-AC-23\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_disable_user_list\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_disable_user_list",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*disable-user-list\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)disable-user-list(\\s*=)/#\\1disable-user-list\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*disable-user-list\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*disable-user-list\\\\s*=\\\\s*.*/disable-user-list=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\disable-user-list=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/login-screen/disable-user-list$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|gdm.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/gdm.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/login-screen/disable-user-list$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/login-screen/disable-user-list$\" /etc/dconf/db/gdm.d/\nthen\n    echo \"/org/gnome/login-screen/disable-user-list\" >> \"/etc/dconf/db/gdm.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244536",
        "stig_id": "RHEL-08-020032"
      },
      "xccdf_org.ssgproject.content_rule_gnome_gdm_disable_xdmcp": {
        "rule_id": "xccdf_org.ssgproject.content_rule_gnome_gdm_disable_xdmcp",
        "title": "Disable XDMCP in GDM",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-86007-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.10"
            ]
          }
        ],
        "description": "XDMCP is an unencrypted protocol, and therefore, presents a security risk, see e.g.\n<a href=\"https://help.gnome.org/admin/gdm/stable/security.html.en_GB#xdmcpsecurity\">XDMCP Gnome docs</a>.\n\nTo disable XDMCP support in Gnome, set <code>Enable</code> to <code>false</code> under the <code>[xdmcp]</code> configuration section in <code>/etc/gdm/custom.conf</code>. For example:\n<pre>\n[xdmcp]\nEnable=false\n</pre>\n        ",
        "rationale": "XDMCP provides unencrypted remote access through the Gnome Display Manager (GDM) which does\nnot provide for the confidentiality and integrity of user passwords or the\nremote session. If a privileged user were to login using XDMCP, the\nprivileged user password could be compromised due to typed XEvents\nand keystrokes will traversing over the network in clear text.",
        "oval_definition_id": "oval:ssg-gnome_gdm_disable_xdmcp:def:1",
        "remediations": [
          {
            "remediation_id": "gnome_gdm_disable_xdmcp",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86007-2\n  - gnome_gdm_disable_xdmcp\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Disable XDMCP in GDM\n  ini_file:\n    path: /etc/gdm/custom.conf\n    section: xdmcp\n    option: Enable\n    value: 'false'\n    create: true\n    mode: 420\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-86007-2\n  - gnome_gdm_disable_xdmcp\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "gnome_gdm_disable_xdmcp",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm; then\n\n# Try find '[xdmcp]' and 'Enable' in '/etc/gdm/custom.conf', if it exists, set\n# to 'false', if it isn't here, add it, if '[xdmcp]' doesn't exist, add it there\nif grep -qzosP '[[:space:]]*\\[xdmcp]([^\\n\\[]*\\n+)+?[[:space:]]*Enable' '/etc/gdm/custom.conf'; then\n    \n    sed -i \"s/Enable[^(\\n)]*/Enable=false/\" '/etc/gdm/custom.conf'\nelif grep -qs '[[:space:]]*\\[xdmcp]' '/etc/gdm/custom.conf'; then\n    sed -i \"/[[:space:]]*\\[xdmcp]/a Enable=false\" '/etc/gdm/custom.conf'\nelse\n    if test -d \"/etc/gdm\"; then\n        printf '%s\\n' '[xdmcp]' \"Enable=false\" >> '/etc/gdm/custom.conf'\n    else\n        echo \"Config file directory '/etc/gdm' doesnt exist, not remediating, assuming non-applicability.\" >&2\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount",
        "title": "Disable GNOME3 Automounting",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-89904-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "DSS01.04",
              "DSS05.03",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000778",
              "CCI-001958"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.2",
              "4.3.3.6.6",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.13",
              "SR 1.2",
              "SR 1.4",
              "SR 1.5",
              "SR 1.9",
              "SR 2.1",
              "SR 2.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.13.1.1",
              "A.13.2.1",
              "A.6.2.1",
              "A.6.2.2",
              "A.7.1.1",
              "A.9.2.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.AC-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000114-GPOS-00059",
              "SRG-OS-000378-GPOS-00163",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "3.4.2"
            ]
          }
        ],
        "description": "The system&#x27;s default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount within GNOME3, add or set\n<code>automount</code> to <code>false</code> in <code>/etc/dconf/db/local.d/00-security-settings</code>.\nFor example:\n<pre>[org/gnome/desktop/media-handling]\nautomount=false</pre>\nOnce the settings have been added, add a lock to\n<code>/etc/dconf/db/local.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/desktop/media-handling/automount</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "Disabling automatic mounting in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_disable_automount:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_disable_automount",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-89904-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Disable GNOME3 Automounting - automount\n  ini_file:\n    dest: /etc/dconf/db/local.d/00-security-settings\n    section: org/gnome/desktop/media-handling\n    option: automount\n    value: 'false'\n    create: true\n    no_extra_spaces: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-89904-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME3 Automounting - automount\n  lineinfile:\n    path: /etc/dconf/db/local.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/desktop/media-handling/automount$\n    line: /org/gnome/desktop/media-handling/automount\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-89904-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-89904-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_disable_automount",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*automount\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)automount(\\s*=)/#\\1automount\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"false\")\"\nif grep -q \"^\\\\s*automount\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*automount\\\\s*=\\\\s*.*/automount=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\automount=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/automount$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/automount$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/automount$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/automount\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount_open": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount_open",
        "title": "Disable GNOME3 Automount Opening",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83693-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "DSS01.04",
              "DSS05.03",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000778",
              "CCI-001958"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.2",
              "4.3.3.6.6",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.13",
              "SR 1.2",
              "SR 1.4",
              "SR 1.5",
              "SR 1.9",
              "SR 2.1",
              "SR 2.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.13.1.1",
              "A.13.2.1",
              "A.6.2.1",
              "A.6.2.2",
              "A.7.1.1",
              "A.9.2.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.AC-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000114-GPOS-00059",
              "SRG-OS-000378-GPOS-00163",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "3.4.2"
            ]
          }
        ],
        "description": "The system&#x27;s default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount-open within GNOME3, add or set\n<code>automount-open</code> to <code>false</code> in <code>/etc/dconf/db/local.d/00-security-settings</code>.\nFor example:\n<pre>[org/gnome/desktop/media-handling]\nautomount-open=false</pre>\nOnce the settings have been added, add a lock to\n<code>/etc/dconf/db/local.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/desktop/media-handling/automount-open</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "Automatically mounting file systems permits easy introduction of unknown devices, thereby facilitating malicious activity.\nDisabling automatic mounting in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_disable_automount_open:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_disable_automount_open",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83693-2\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount_open\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Disable GNOME3 Automounting - automount-open\n  ini_file:\n    dest: /etc/dconf/db/local.d/00-security-settings\n    section: org/gnome/desktop/media-handling\n    option: automount-open\n    value: 'false'\n    create: true\n    no_extra_spaces: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83693-2\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount_open\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME3 Automounting - automount-open\n  lineinfile:\n    path: /etc/dconf/db/local.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/desktop/media-handling/automount-open$\n    line: /org/gnome/desktop/media-handling/automount-open\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83693-2\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount_open\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83693-2\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-3.4.2\n  - dconf_gnome_disable_automount_open\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_disable_automount_open",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*automount-open\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)automount-open(\\s*=)/#\\1automount-open\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"false\")\"\nif grep -q \"^\\\\s*automount-open\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*automount-open\\\\s*=\\\\s*.*/automount-open=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\automount-open=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/automount-open$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/automount-open$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/automount-open$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/automount-open\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_autorun": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_disable_autorun",
        "title": "Disable GNOME3 Automount running",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-83742-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "DSS01.04",
              "DSS05.03",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000778",
              "CCI-001958"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.2",
              "4.3.3.6.6",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.13",
              "SR 1.2",
              "SR 1.4",
              "SR 1.5",
              "SR 1.9",
              "SR 2.1",
              "SR 2.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.13.1.1",
              "A.13.2.1",
              "A.6.2.1",
              "A.6.2.2",
              "A.7.1.1",
              "A.9.2.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.AC-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000114-GPOS-00059",
              "SRG-OS-000378-GPOS-00163",
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "The system&#x27;s default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable autorun-never within GNOME3, add or set\n<code>autorun-never</code> to <code>true</code> in <code>/etc/dconf/db/local.d/00-security-settings</code>.\nFor example:\n<pre>[org/gnome/desktop/media-handling]\nautorun-never=true</pre>\nOnce the settings have been added, add a lock to\n<code>/etc/dconf/db/local.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/desktop/media-handling/autorun-never</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "Automatically mounting file systems permits easy introduction of unknown devices, thereby facilitating malicious activity.\nDisabling automatic mount running in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_disable_autorun:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_disable_autorun",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83742-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - dconf_gnome_disable_autorun\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Disable GNOME3 Automounting - autorun-never\n  ini_file:\n    dest: /etc/dconf/db/local.d/00-security-settings\n    section: org/gnome/desktop/media-handling\n    option: autorun-never\n    value: 'true'\n    create: true\n    no_extra_spaces: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83742-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - dconf_gnome_disable_autorun\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME3 Automounting - autorun-never\n  lineinfile:\n    path: /etc/dconf/db/local.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/desktop/media-handling/autorun-never$\n    line: /org/gnome/desktop/media-handling/autorun-never\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83742-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - dconf_gnome_disable_autorun\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83742-7\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - dconf_gnome_disable_autorun\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_disable_autorun",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*autorun-never\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)autorun-never(\\s*=)/#\\1autorun-never\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*autorun-never\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*autorun-never\\\\s*=\\\\s*.*/autorun-never=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\autorun-never=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/autorun-never$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/autorun-never$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/autorun-never$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/autorun-never\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_idle_delay": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_idle_delay",
        "title": "Set GNOME3 Screensaver Inactivity Timeout",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80775-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000057",
              "CCI-000060"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-11(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000029-GPOS-00010",
              "SRG-OS-000031-GPOS-00012"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020060"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230352r646876_rule"
            ]
          }
        ],
        "description": "The idle time-out value for inactivity in the GNOME3 desktop is configured via the <code>idle-delay</code>\nsetting must be set under an appropriate configuration file(s) in the <code>/etc/dconf/db/local.d</code> directory\nand locked in <code>/etc/dconf/db/local.d/locks</code> directory to prevent user modification.\n<br>\n         <br>\nFor example, to configure the system for a 15 minute delay, add the following to\n<code>/etc/dconf/db/local.d/00-security-settings</code>:\n<pre>[org/gnome/desktop/session]\nidle-delay=uint32 900</pre>\n        ",
        "rationale": "A session time-out lock is a temporary action taken when a user stops work and moves away from\nthe immediate physical vicinity of the information system but does not logout because of the\ntemporary nature of the absence. Rather than relying on the user to manually lock their operating\nsystem session prior to vacating the vicinity, GNOME3 can be configured to identify when\na user&#x27;s session has idled and take action to initiate a session lock.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_screensaver_idle_delay:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_screensaver_idle_delay",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80775-0\n  - CJIS-5.5.5\n  - DISA-STIG-RHEL-08-020060\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_idle_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n- name: XCCDF Value inactivity_timeout_value # promote to variable\n  set_fact:\n    inactivity_timeout_value: !!str 900\n  tags:\n    - always\n\n- name: Set GNOME3 Screensaver Inactivity Timeout\n  ini_file:\n    dest: /etc/dconf/db/local.d/00-security-settings\n    section: org/gnome/desktop/session\n    option: idle-delay\n    value: uint32 {{ inactivity_timeout_value }}\n    create: true\n    no_extra_spaces: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80775-0\n  - CJIS-5.5.5\n  - DISA-STIG-RHEL-08-020060\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_idle_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80775-0\n  - CJIS-5.5.5\n  - DISA-STIG-RHEL-08-020060\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_idle_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_screensaver_idle_delay",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\ninactivity_timeout_value='900'\n\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/session\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*idle-delay\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)idle-delay(\\s*=)/#\\1idle-delay\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/session\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/session]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"uint32 ${inactivity_timeout_value}\")\"\nif grep -q \"^\\\\s*idle-delay\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*idle-delay\\\\s*=\\\\s*.*/idle-delay=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/session\\\\]|a\\\\idle-delay=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230352",
        "stig_id": "RHEL-08-020060"
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_delay": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_delay",
        "title": "Set GNOME3 Screensaver Lock Delay After Activation Period",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80776-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000056",
              "CCI-000057",
              "CCI-000060"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-11(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000029-GPOS-00010",
              "SRG-OS-000031-GPOS-00012"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020031"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244535r743854_rule"
            ]
          }
        ],
        "description": "To activate the locking delay of the screensaver in the GNOME3 desktop when\nthe screensaver is activated, add or set <code>lock-delay</code> to <code>uint32 5\n         </code> in\n<code>/etc/dconf/db/local.d/00-security-settings</code>. For example:\n<pre>[org/gnome/desktop/screensaver]\nlock-delay=uint32 5\n         </pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity\nof the information system but does not want to logout because of the temporary nature of the absense.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_screensaver_lock_delay:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_screensaver_lock_delay",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80776-8\n  - DISA-STIG-RHEL-08-020031\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_lock_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n- name: XCCDF Value var_screensaver_lock_delay # promote to variable\n  set_fact:\n    var_screensaver_lock_delay: !!str 5\n  tags:\n    - always\n\n- name: Set GNOME3 Screensaver Lock Delay After Activation Period\n  ini_file:\n    dest: /etc/dconf/db/local.d/00-security-settings\n    section: org/gnome/desktop/screensaver\n    option: lock-delay\n    value: uint32 {{ var_screensaver_lock_delay }}\n    create: true\n    no_extra_spaces: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80776-8\n  - DISA-STIG-RHEL-08-020031\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_lock_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80776-8\n  - DISA-STIG-RHEL-08-020031\n  - NIST-800-171-3.1.10\n  - NIST-800-53-AC-11(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_screensaver_lock_delay\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_screensaver_lock_delay",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nvar_screensaver_lock_delay='5'\n\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*lock-delay\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)lock-delay(\\s*=)/#\\1lock-delay\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/screensaver]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"uint32 ${var_screensaver_lock_delay}\")\"\nif grep -q \"^\\\\s*lock-delay\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*lock-delay\\\\s*=\\\\s*.*/lock-delay=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/screensaver\\\\]|a\\\\lock-delay=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244535",
        "stig_id": "RHEL-08-020031"
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_user_locks": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_user_locks",
        "title": "Ensure Users Cannot Change GNOME3 Screensaver Settings",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80780-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000057",
              "CCI-000060"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000029-GPOS-00010",
              "SRG-OS-000031-GPOS-00012"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020080"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230354r743990_rule"
            ]
          }
        ],
        "description": "If not already configured, ensure that users cannot change GNOME3 screensaver lock settings\nby adding <code>/org/gnome/desktop/screensaver/lock-delay</code>\nto <code>/etc/dconf/db/local.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/desktop/screensaver/lock-delay</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate\nphysical vicinity of the information system but does not logout because of the temporary nature of the absence.\nRather than relying on the user to manually lock their operating system session prior to vacating the vicinity,\nGNOME desktops can be configured to identify when a user&#x27;s session has idled and take action to initiate the\nsession lock. As such, users should not be allowed to change session settings.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_screensaver_user_locks:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_screensaver_user_locks",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80780-0\n  - DISA-STIG-RHEL-08-020080\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_screensaver_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME lock-delay\n  lineinfile:\n    path: /etc/dconf/db/local.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/desktop/screensaver/lock-delay$\n    line: /org/gnome/desktop/screensaver/lock-delay\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80780-0\n  - DISA-STIG-RHEL-08-020080\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_screensaver_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80780-0\n  - DISA-STIG-RHEL-08-020080\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - dconf_gnome_screensaver_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_screensaver_user_locks",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/screensaver/lock-delay$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/screensaver/lock-delay$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/screensaver/lock-delay$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/screensaver/lock-delay\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230354",
        "stig_id": "RHEL-08-020080"
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_session_idle_user_locks": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_session_idle_user_locks",
        "title": "Ensure Users Cannot Change GNOME3 Session Idle Settings",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80781-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000057",
              "CCI-000060"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000029-GPOS-00010",
              "SRG-OS-000031-GPOS-00012"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020081"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244538r743863_rule"
            ]
          }
        ],
        "description": "If not already configured, ensure that users cannot change GNOME3 session idle settings\nby adding <code>/org/gnome/desktop/session/idle-delay</code>\nto <code>/etc/dconf/db/local.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/desktop/session/idle-delay</pre>\nAfter the settings have been set, run <code>dconf update</code>.",
        "rationale": "A session time-out lock is a temporary action taken when a user stops work and moves away from the immediate\nphysical vicinity of the information system but does not logout because of the temporary nature of the absence.\nRather than relying on the user to manually lock their operating system session prior to vacating the vicinity,\nGNOME desktops can be configured to identify when a user&#x27;s session has idled and take action to initiate the\nsession lock. As such, users should not be allowed to change session settings.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-dconf_gnome_session_idle_user_locks:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_session_idle_user_locks",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80781-8\n  - DISA-STIG-RHEL-08-020081\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_session_idle_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME Session idle-delay\n  lineinfile:\n    path: /etc/dconf/db/local.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/desktop/session/idle-delay$\n    line: /org/gnome/desktop/session/idle-delay\n    create: true\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80781-8\n  - DISA-STIG-RHEL-08-020081\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_session_idle_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when:\n  - '\"gdm\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80781-8\n  - DISA-STIG-RHEL-08-020081\n  - NIST-800-171-3.1.10\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - dconf_gnome_session_idle_user_locks\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_session_idle_user_locks",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/session/idle-delay$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/session/idle-delay$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/session/idle-delay$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/session/idle-delay\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244538",
        "stig_id": "RHEL-08-020081"
      },
      "xccdf_org.ssgproject.content_rule_package_sudo_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_sudo_installed",
        "title": "Install sudo Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82214-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R33"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1382",
              "1384",
              "1386"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000324-GPOS-00125"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>sudo</code> package can be installed with the following command:\n<pre>\n$ sudo yum install sudo</pre>\n       ",
        "rationale": "<code>sudo</code> is a program designed to allow a system administrator to give\nlimited root privileges to users and log root activity. The basic philosophy\nis to give as few privileges as possible but still allow system users to\nget their work done.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-package_sudo_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_sudo_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure sudo is installed\n  package:\n    name: sudo\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82214-8\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_sudo_installed\n"
          },
          {
            "remediation_id": "package_sudo_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_sudo\n\nclass install_sudo {\n  package { 'sudo':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_sudo_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"sudo\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_sudo_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"sudo\" ; then\n    yum install -y \"sudo\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sudo_add_use_pty": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sudo_add_use_pty",
        "title": "Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo use_pty",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83798-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R39"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.2"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.2.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The sudo <code>use_pty</code> tag, when specified, will only execute sudo\ncommands from users logged in to a real tty.\nThis should be enabled by making sure that the <code>use_pty</code> tag exists in\n<code>/etc/sudoers</code> configuration file or any sudo configuration snippets\nin <code>/etc/sudoers.d/</code>.",
        "rationale": "Requiring that sudo commands be run in a pseudo-terminal can prevent an attacker from retaining\naccess to the user&#x27;s terminal after the main program has finished executing.",
        "platforms": [
          "#package_sudo"
        ],
        "oval_definition_id": "oval:ssg-sudo_add_use_pty:def:1",
        "remediations": [
          {
            "remediation_id": "sudo_add_use_pty",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83798-9\n  - PCI-DSS-Req-10.2.5\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_add_use_pty\n\n- name: Ensure use_pty is enabled in /etc/sudoers\n  lineinfile:\n    path: /etc/sudoers\n    regexp: ^[\\s]*Defaults.*\\buse_pty\\b.*$\n    line: Defaults use_pty\n    validate: /usr/sbin/visudo -cf %s\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-83798-9\n  - PCI-DSS-Req-10.2.5\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_add_use_pty\n"
          },
          {
            "remediation_id": "sudo_add_use_pty",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q sudo; then\n\nif /usr/sbin/visudo -qcf /etc/sudoers; then\n    cp /etc/sudoers /etc/sudoers.bak\n    if ! grep -P '^[\\s]*Defaults[\\s]*\\buse_pty\\b.*$' /etc/sudoers; then\n        # sudoers file doesn't define Option use_pty\n        echo \"Defaults use_pty\" >> /etc/sudoers\n    fi\n    \n    # Check validity of sudoers and cleanup bak\n    if /usr/sbin/visudo -qcf /etc/sudoers; then\n        rm -f /etc/sudoers.bak\n    else\n        echo \"Fail to validate remediated /etc/sudoers, reverting to original file.\"\n        mv /etc/sudoers.bak /etc/sudoers\n        false\n    fi\nelse\n    echo \"Skipping remediation, /etc/sudoers failed to validate\"\n    false\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sudo_custom_logfile": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sudo_custom_logfile",
        "title": "Ensure Sudo Logfile Exists - sudo logfile",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-83601-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.3"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.2.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "A custom log sudo file can be configured with the &#x27;logfile&#x27; tag. This rule configures\na sudo custom logfile at the default location suggested by CIS, which uses\n/var/log/sudo.log.",
        "rationale": "A sudo log file simplifies auditing of sudo commands.",
        "platforms": [
          "#package_sudo"
        ],
        "oval_definition_id": "oval:ssg-sudo_custom_logfile:def:1",
        "remediations": [
          {
            "remediation_id": "sudo_custom_logfile",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83601-5\n  - PCI-DSS-Req-10.2.5\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_custom_logfile\n- name: XCCDF Value var_sudo_logfile # promote to variable\n  set_fact:\n    var_sudo_logfile: !!str /var/log/sudo.log\n  tags:\n    - always\n\n- name: Ensure logfile is enabled with the appropriate value in /etc/sudoers\n  lineinfile:\n    path: /etc/sudoers\n    regexp: ^[\\s]*Defaults\\s(.*)\\blogfile=[-]?.+\\b(.*)$\n    line: Defaults \\1logfile={{ var_sudo_logfile }}\\2\n    validate: /usr/sbin/visudo -cf %s\n    backrefs: true\n  register: edit_sudoers_logfile_option\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-83601-5\n  - PCI-DSS-Req-10.2.5\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_custom_logfile\n\n- name: Enable logfile option with appropriate value in /etc/sudoers\n  lineinfile:\n    path: /etc/sudoers\n    line: Defaults logfile={{ var_sudo_logfile }}\n    validate: /usr/sbin/visudo -cf %s\n  when:\n  - '\"sudo\" in ansible_facts.packages'\n  - edit_sudoers_logfile_option is defined and not edit_sudoers_logfile_option.changed\n  tags:\n  - CCE-83601-5\n  - PCI-DSS-Req-10.2.5\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_custom_logfile\n"
          },
          {
            "remediation_id": "sudo_custom_logfile",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q sudo; then\n\nvar_sudo_logfile='/var/log/sudo.log'\n\n\nif /usr/sbin/visudo -qcf /etc/sudoers; then\n    cp /etc/sudoers /etc/sudoers.bak\n    if ! grep -P '^[\\s]*Defaults[\\s]*\\blogfile\\s*=\\s*(?:\"?([^\",\\s]+)\"?)\\b.*$' /etc/sudoers; then\n        # sudoers file doesn't define Option logfile\n        echo \"Defaults logfile=${var_sudo_logfile}\" >> /etc/sudoers\n    else\n        # sudoers file defines Option logfile, remediate if appropriate value is not set\n        if ! grep -P \"^[\\s]*Defaults.*\\blogfile=${var_sudo_logfile}\\b.*$\" /etc/sudoers; then\n            \n            escaped_variable=${var_sudo_logfile//$'/'/$'\\/'}\n            sed -Ei \"s/(^[\\s]*Defaults.*\\blogfile=)[-]?.+(\\b.*$)/\\1$escaped_variable\\2/\" /etc/sudoers\n        fi\n    fi\n    \n    # Check validity of sudoers and cleanup bak\n    if /usr/sbin/visudo -qcf /etc/sudoers; then\n        rm -f /etc/sudoers.bak\n    else\n        echo \"Fail to validate remediated /etc/sudoers, reverting to original file.\"\n        mv /etc/sudoers.bak /etc/sudoers\n        false\n    fi\nelse\n    echo \"Skipping remediation, /etc/sudoers failed to validate\"\n    false\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sudo_require_authentication": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sudo_require_authentication",
        "title": "Ensure Users Re-Authenticate for Privilege Escalation - sudo",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82279-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.4",
              "4.3.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002038"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-11"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000373-GPOS-00156"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The sudo <code>NOPASSWD</code> and <code>!authenticate</code> option, when\nspecified, allows a user to execute commands using sudo without having to\nauthenticate. This should be disabled by making sure that\n<code>NOPASSWD</code> and/or <code>!authenticate</code> do not exist in\n<code>/etc/sudoers</code> configuration file or any sudo configuration snippets\nin <code>/etc/sudoers.d/</code>.&quot;",
        "rationale": "Without re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.\n<br>\n        <br>\nWhen operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate.",
        "oval_definition_id": "oval:ssg-sudo_require_authentication:def:1",
        "remediations": [
          {
            "remediation_id": "sudo_require_authentication",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Find /etc/sudoers.d/ files\n  ansible.builtin.find:\n    paths:\n    - /etc/sudoers.d/\n  register: sudoers\n  tags:\n  - CCE-82279-1\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_authentication\n\n- name: Remove lines containing NOPASSWD from sudoers files\n  ansible.builtin.replace:\n    regexp: (^(?!#).*[\\s]+NOPASSWD[\\s]*\\:.*$)\n    replace: '# \\g<1>'\n    path: '{{ item.path }}'\n    validate: /usr/sbin/visudo -cf %s\n  with_items:\n  - path: /etc/sudoers\n  - '{{ sudoers.files }}'\n  tags:\n  - CCE-82279-1\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_authentication\n\n- name: Find /etc/sudoers.d/ files\n  ansible.builtin.find:\n    paths:\n    - /etc/sudoers.d/\n  register: sudoers\n  tags:\n  - CCE-82279-1\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_authentication\n\n- name: Remove lines containing !authenticate from sudoers files\n  ansible.builtin.replace:\n    regexp: (^(?!#).*[\\s]+\\!authenticate.*$)\n    replace: '# \\g<1>'\n    path: '{{ item.path }}'\n    validate: /usr/sbin/visudo -cf %s\n  with_items:\n  - path: /etc/sudoers\n  - '{{ sudoers.files }}'\n  tags:\n  - CCE-82279-1\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_authentication\n"
          },
          {
            "remediation_id": "sudo_require_authentication",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nfor f in /etc/sudoers /etc/sudoers.d/* ; do\n  if [ ! -e \"$f\" ] ; then\n    continue\n  fi\n  matching_list=$(grep -P '^(?!#).*[\\s]+NOPASSWD[\\s]*\\:.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      # comment out \"NOPASSWD\" matches to preserve user data\n      sed -i \"s/^${entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n\n    /usr/sbin/visudo -cf $f &> /dev/null || echo \"Fail to validate $f with visudo\"\n  fi\ndone\n\nfor f in /etc/sudoers /etc/sudoers.d/* ; do\n  if [ ! -e \"$f\" ] ; then\n    continue\n  fi\n  matching_list=$(grep -P '^(?!#).*[\\s]+\\!authenticate.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      # comment out \"!authenticate\" matches to preserve user data\n      sed -i \"s/^${entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n\n    /usr/sbin/visudo -cf $f &> /dev/null || echo \"Fail to validate $f with visudo\"\n  fi\ndone\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sudo_require_reauthentication": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sudo_require_reauthentication",
        "title": "Require Re-Authentication When Using the sudo Command",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87838-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002038"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "IA-11"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000373-GPOS-00156",
              "SRG-OS-000373-GPOS-00157",
              "SRG-OS-000373-GPOS-00158"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010384"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-237643r861088_rule"
            ]
          }
        ],
        "description": "The sudo <code>timestamp_timeout</code> tag sets the amount of time sudo password prompt waits.\nThe default <code>timestamp_timeout</code> value is 5 minutes.\nThe timestamp_timeout should be configured by making sure that the\n<code>timestamp_timeout</code> tag exists in\n<code>/etc/sudoers</code> configuration file or any sudo configuration snippets\nin <code>/etc/sudoers.d/</code>.\nIf the value is set to an integer less than 0, the user&#x27;s time stamp will not expire\nand the user will not have to re-authenticate for privileged actions until the user&#x27;s session is terminated.",
        "rationale": "Without re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.\n<br>\n        <br>\nWhen operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate.",
        "platforms": [
          "#package_sudo"
        ],
        "oval_definition_id": "oval:ssg-sudo_require_reauthentication:def:1",
        "remediations": [
          {
            "remediation_id": "sudo_require_reauthentication",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n- name: XCCDF Value var_sudo_timestamp_timeout # promote to variable\n  set_fact:\n    var_sudo_timestamp_timeout: !!str 5\n  tags:\n    - always\n\n- name: Require Re-Authentication When Using the sudo Command - Find /etc/sudoers.d/*\n    files containing 'Defaults timestamp_timeout'\n  ansible.builtin.find:\n    path: /etc/sudoers.d\n    patterns: '*'\n    contains: ^[\\s]*Defaults\\s.*\\btimestamp_timeout[\\s]*=.*\n  register: sudoers_d_defaults_timestamp_timeout\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n\n- name: Require Re-Authentication When Using the sudo Command - Remove 'Defaults timestamp_timeout'\n    from /etc/sudoers.d/* files\n  ansible.builtin.lineinfile:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*Defaults\\s.*\\btimestamp_timeout[\\s]*=.*\n    state: absent\n  with_items: '{{ sudoers_d_defaults_timestamp_timeout.files }}'\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n\n- name: Require Re-Authentication When Using the sudo Command - Ensure timestamp_timeout\n    has the appropriate value in /etc/sudoers\n  ansible.builtin.lineinfile:\n    path: /etc/sudoers\n    regexp: ^[\\s]*Defaults\\s(.*)\\btimestamp_timeout[\\s]*=[\\s]*[-]?\\w+\\b(.*)$\n    line: Defaults \\1timestamp_timeout={{ var_sudo_timestamp_timeout }}\\2\n    validate: /usr/sbin/visudo -cf %s\n    backrefs: true\n  register: edit_sudoers_timestamp_timeout_option\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n\n- name: Require Re-Authentication When Using the sudo Command - Enable timestamp_timeout\n    option with correct value in /etc/sudoers\n  ansible.builtin.lineinfile:\n    path: /etc/sudoers\n    line: Defaults timestamp_timeout={{ var_sudo_timestamp_timeout }}\n    validate: /usr/sbin/visudo -cf %s\n  when:\n  - '\"sudo\" in ansible_facts.packages'\n  - |\n    edit_sudoers_timestamp_timeout_option is defined and not edit_sudoers_timestamp_timeout_option.changed\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n\n- name: Require Re-Authentication When Using the sudo Command - Remove timestamp_timeout\n    wrong values in /etc/sudoers\n  ansible.builtin.lineinfile:\n    path: /etc/sudoers\n    regexp: ^[\\s]*Defaults\\s.*\\btimestamp_timeout[\\s]*=[\\s]*(?!{{ var_sudo_timestamp_timeout\n      }}\\b)[-]?\\w+\\b.*$\n    state: absent\n    validate: /usr/sbin/visudo -cf %s\n  when: '\"sudo\" in ansible_facts.packages'\n  tags:\n  - CCE-87838-9\n  - DISA-STIG-RHEL-08-010384\n  - NIST-800-53-IA-11\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sudo_require_reauthentication\n"
          },
          {
            "remediation_id": "sudo_require_reauthentication",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q sudo; then\n\nvar_sudo_timestamp_timeout='5'\n\n\nif grep -Px '^[\\s]*Defaults.*timestamp_timeout[\\s]*=.*' /etc/sudoers.d/*; then\n    find /etc/sudoers.d/ -type f -exec sed -Ei \"/^[[:blank:]]*Defaults.*timestamp_timeout[[:blank:]]*=.*/d\" {} \\;\nfi\n\nif /usr/sbin/visudo -qcf /etc/sudoers; then\n    cp /etc/sudoers /etc/sudoers.bak\n    if ! grep -P '^[\\s]*Defaults.*timestamp_timeout[\\s]*=[\\s]*[-]?\\w+.*$' /etc/sudoers; then\n        # sudoers file doesn't define Option timestamp_timeout\n        echo \"Defaults timestamp_timeout=${var_sudo_timestamp_timeout}\" >> /etc/sudoers\n    else\n        # sudoers file defines Option timestamp_timeout, remediate wrong values if present\n        if grep -qP \"^[\\s]*Defaults\\s.*\\btimestamp_timeout[\\s]*=[\\s]*(?!${var_sudo_timestamp_timeout}\\b)[-]?\\w+\\b.*$\" /etc/sudoers; then\n            sed -Ei \"s/(^[[:blank:]]*Defaults.*timestamp_timeout[[:blank:]]*=)[[:blank:]]*[-]?\\w+(.*$)/\\1${var_sudo_timestamp_timeout}\\2/\" /etc/sudoers\n        fi\n    fi\n    \n    # Check validity of sudoers and cleanup bak\n    if /usr/sbin/visudo -qcf /etc/sudoers; then\n        rm -f /etc/sudoers.bak\n    else\n        echo \"Fail to validate remediated /etc/sudoers, reverting to original file.\"\n        mv /etc/sudoers.bak /etc/sudoers\n        false\n    fi\nelse\n    echo \"Skipping remediation, /etc/sudoers failed to validate\"\n    false\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-237643",
        "stig_id": "RHEL-08-010384"
      },
      "xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated": {
        "rule_id": "xccdf_org.ssgproject.content_rule_ensure_gpgcheck_globally_activated",
        "title": "Ensure gpgcheck Enabled In Main yum Configuration",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80790-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R59"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "2",
              "3",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.4.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI03.05",
              "BAI06.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001749"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.312(b)",
              "164.312(c)(1)",
              "164.312(c)(2)",
              "164.312(e)(2)(i)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.3",
              "SR 3.4",
              "SR 3.8",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.4",
              "A.12.1.2",
              "A.12.2.1",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-11(a)",
              "CM-11(b)",
              "CM-5(3)",
              "CM-6(a)",
              "SA-12",
              "SA-12(10)",
              "SC-12",
              "SC-12(3)",
              "SI-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.DS-6",
              "PR.DS-8",
              "PR.IP-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000366-GPOS-00153"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FPT_TUD_EXT.1",
              "FPT_TUD_EXT.2"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-6.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "6.3.3"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010370"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230264r880711_rule"
            ]
          }
        ],
        "description": "The <code>gpgcheck</code> option controls whether\nRPM packages&#x27; signatures are always checked prior to installation.\nTo configure yum to check package signatures before installing\nthem, ensure the following line appears in <code>/etc/yum.conf</code> in\nthe <code>[main]</code> section:\n<pre>gpgcheck=1</pre>\n       ",
        "rationale": "Changes to any software components can have significant effects on the\noverall security of the operating system. This requirement ensures the\nsoftware has not been tampered with and that it has been provided by a\ntrusted vendor.\n<br>\nAccordingly, patches, service packs, device drivers, or operating system\ncomponents must be signed with a certificate recognized and approved by the\norganization.\n<br>Verifying the authenticity of the software prior to installation\nvalidates the integrity of the patch or upgrade received from a vendor.\nThis ensures the software has not been tampered with and that it has been\nprovided by a trusted vendor. Self-signed certificates are disallowed by\nthis requirement. Certificates used to verify the software must be from an\napproved Certificate Authority (CA).",
        "platforms": [
          "#package_yum"
        ],
        "oval_definition_id": "oval:ssg-ensure_gpgcheck_globally_activated:def:1",
        "remediations": [
          {
            "remediation_id": "ensure_gpgcheck_globally_activated",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80790-9\n  - CJIS-5.10.4.1\n  - DISA-STIG-RHEL-08-010370\n  - NIST-800-171-3.4.8\n  - NIST-800-53-CM-11(a)\n  - NIST-800-53-CM-11(b)\n  - NIST-800-53-CM-5(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SA-12\n  - NIST-800-53-SA-12(10)\n  - NIST-800-53-SC-12\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SI-7\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-6.3.3\n  - configure_strategy\n  - ensure_gpgcheck_globally_activated\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n\n- name: Ensure GPG check is globally activated\n  ini_file:\n    dest: /etc/yum.conf\n    section: main\n    option: gpgcheck\n    value: 1\n    no_extra_spaces: true\n    create: false\n  when: '\"yum\" in ansible_facts.packages'\n  tags:\n  - CCE-80790-9\n  - CJIS-5.10.4.1\n  - DISA-STIG-RHEL-08-010370\n  - NIST-800-171-3.4.8\n  - NIST-800-53-CM-11(a)\n  - NIST-800-53-CM-11(b)\n  - NIST-800-53-CM-5(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SA-12\n  - NIST-800-53-SA-12(10)\n  - NIST-800-53-SC-12\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SI-7\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-6.3.3\n  - configure_strategy\n  - ensure_gpgcheck_globally_activated\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "ensure_gpgcheck_globally_activated",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q yum; then\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^gpgcheck\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"1\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^gpgcheck\\\\>\" \"/etc/yum.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^gpgcheck\\\\>.*/$escaped_formatted_output/gi\" \"/etc/yum.conf\"\nelse\n    if [[ -s \"/etc/yum.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/yum.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/yum.conf\"\n    fi\n    cce=\"CCE-80790-9\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/yum.conf\" >> \"/etc/yum.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/yum.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230264",
        "stig_id": "RHEL-08-010370"
      },
      "xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_ensure_gpgcheck_never_disabled",
        "title": "Ensure gpgcheck Enabled for All yum Package Repositories",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80792-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R59"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "2",
              "3",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.4.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI03.05",
              "BAI06.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001749"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.312(b)",
              "164.312(c)(1)",
              "164.312(c)(2)",
              "164.312(e)(2)(i)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.3",
              "SR 3.4",
              "SR 3.8",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.4",
              "A.12.1.2",
              "A.12.2.1",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-11(a)",
              "CM-11(b)",
              "CM-5(3)",
              "CM-6(a)",
              "SA-12",
              "SA-12(10)",
              "SC-12",
              "SC-12(3)",
              "SI-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.DS-6",
              "PR.DS-8",
              "PR.IP-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000366-GPOS-00153"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FPT_TUD_EXT.1",
              "FPT_TUD_EXT.2"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-6.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "6.3.3"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010370"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230264r880711_rule"
            ]
          }
        ],
        "description": "To ensure signature checking is not disabled for\nany repos, remove any lines from files in <code>/etc/yum.repos.d</code> of the form:\n<pre>gpgcheck=0</pre>\n       ",
        "rationale": "Verifying the authenticity of the software prior to installation validates\nthe integrity of the patch or upgrade received from a vendor. This ensures\nthe software has not been tampered with and that it has been provided by a\ntrusted vendor. Self-signed certificates are disallowed by this\nrequirement. Certificates used to verify the software must be from an\napproved Certificate Authority (CA).&quot;",
        "oval_definition_id": "oval:ssg-ensure_gpgcheck_never_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "ensure_gpgcheck_never_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "enable",
            "fix": "- name: Grep for yum repo section names\n  shell: |\n    set -o pipefail\n    grep -HEr '^\\[.+\\]' -r /etc/yum.repos.d/\n  register: repo_grep_results\n  failed_when: repo_grep_results.rc not in [0, 1]\n  changed_when: false\n  tags:\n  - CCE-80792-5\n  - CJIS-5.10.4.1\n  - DISA-STIG-RHEL-08-010370\n  - NIST-800-171-3.4.8\n  - NIST-800-53-CM-11(a)\n  - NIST-800-53-CM-11(b)\n  - NIST-800-53-CM-5(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SA-12\n  - NIST-800-53-SA-12(10)\n  - NIST-800-53-SC-12\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SI-7\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-6.3.3\n  - enable_strategy\n  - ensure_gpgcheck_never_disabled\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n\n- name: Set gpgcheck=1 for each yum repo\n  ini_file:\n    path: '{{ item[0] }}'\n    section: '{{ item[1] }}'\n    option: gpgcheck\n    value: '1'\n    no_extra_spaces: true\n  loop: '{{ repo_grep_results.stdout |regex_findall( ''(.+\\.repo):\\[(.+)\\]\\n?'' )\n    if repo_grep_results is not skipped else [] }}'\n  when: repo_grep_results is not skipped\n  tags:\n  - CCE-80792-5\n  - CJIS-5.10.4.1\n  - DISA-STIG-RHEL-08-010370\n  - NIST-800-171-3.4.8\n  - NIST-800-53-CM-11(a)\n  - NIST-800-53-CM-11(b)\n  - NIST-800-53-CM-5(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SA-12\n  - NIST-800-53-SA-12(10)\n  - NIST-800-53-SC-12\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SI-7\n  - PCI-DSS-Req-6.2\n  - PCI-DSSv4-6.3.3\n  - enable_strategy\n  - ensure_gpgcheck_never_disabled\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "ensure_gpgcheck_never_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "\nsed -i 's/gpgcheck\\s*=.*/gpgcheck=1/g' /etc/yum.repos.d/*\n"
          }
        ],
        "vuln_id": "SV-230264",
        "stig_id": "RHEL-08-010370"
      },
      "xccdf_org.ssgproject.content_rule_enable_authselect": {
        "rule_id": "xccdf_org.ssgproject.content_rule_enable_authselect",
        "title": "Enable authselect",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-88248-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R31"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "enable_authselect"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000213"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_AFL.1",
              "FIA_UAU.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.4"
            ]
          }
        ],
        "description": "Configure user authentication setup to use the <code>authselect</code> tool.\nIf authselect profile is selected, the rule will enable the sssd profile.",
        "rationale": "Authselect is a successor to authconfig.\nIt is a tool to select system authentication and identity sources from a list of supported\nprofiles instead of letting the administrator manually build the PAM stack.\n\nThat way, it avoids potential breakage of configuration, as it ships several tested profiles\nthat are well tested and supported to solve different use-cases.",
        "warnings": [
          {
            "text": "If the <code>sudo authselect select</code> command returns an error informing that the chosen\nprofile cannot be selected, it is probably because PAM files have already been modified by\nthe administrator. If this is the case, in order to not overwrite the desired changes made\nby the administrator, the current PAM settings should be investigated before forcing the\nselection of the chosen authselect profile.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-enable_authselect:def:1",
        "remediations": [
          {
            "remediation_id": "enable_authselect",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: XCCDF Value var_authselect_profile # promote to variable\n  set_fact:\n    var_authselect_profile: !!str sssd\n  tags:\n    - always\n\n- name: Enable authselect - Check Current authselect Profile\n  ansible.builtin.command:\n    cmd: authselect current\n  register: result_authselect_current\n  changed_when: false\n  failed_when: false\n  tags:\n  - CCE-88248-0\n  - NIST-800-53-AC-3\n  - PCI-DSSv4-8.3.4\n  - configure_strategy\n  - enable_authselect\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Enable authselect - Try to Select an authselect Profile\n  ansible.builtin.command:\n    cmd: authselect select \"{{ var_authselect_profile }}\"\n  register: result_authselect_select\n  changed_when: result_authselect_select.rc == 0\n  failed_when: false\n  when: result_authselect_current.rc != 0\n  tags:\n  - CCE-88248-0\n  - NIST-800-53-AC-3\n  - PCI-DSSv4-8.3.4\n  - configure_strategy\n  - enable_authselect\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Enable authselect - Verify If pam Has Been Altered\n  ansible.builtin.command:\n    cmd: rpm -qV pam\n  register: result_altered_authselect\n  changed_when: false\n  failed_when: false\n  when:\n  - result_authselect_select is not skipped\n  - result_authselect_select.rc != 0\n  tags:\n  - CCE-88248-0\n  - NIST-800-53-AC-3\n  - PCI-DSSv4-8.3.4\n  - configure_strategy\n  - enable_authselect\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Enable authselect - Informative Message Based on authselect Integrity Check\n  ansible.builtin.assert:\n    that:\n    - result_authselect_current.rc == 0 or result_altered_authselect is skipped or\n      result_altered_authselect.rc == 0\n    fail_msg:\n    - authselect is not used but files from the 'pam' package have been altered, so\n      the authselect configuration won't be forced.\n  tags:\n  - CCE-88248-0\n  - NIST-800-53-AC-3\n  - PCI-DSSv4-8.3.4\n  - configure_strategy\n  - enable_authselect\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Enable authselect - Force authselect Profile Selection\n  ansible.builtin.command:\n    cmd: authselect select --force \"{{ var_authselect_profile }}\"\n  when:\n  - result_authselect_current.rc != 0\n  - result_authselect_select.rc != 0\n  - result_altered_authselect.rc == 0\n  tags:\n  - CCE-88248-0\n  - NIST-800-53-AC-3\n  - PCI-DSSv4-8.3.4\n  - configure_strategy\n  - enable_authselect\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "enable_authselect",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "\nvar_authselect_profile='sssd'\n\n\nauthselect current\n\nif test \"$?\" -ne 0; then\n    authselect select \"$var_authselect_profile\"\n\n    if test \"$?\" -ne 0; then\n        if rpm --quiet --verify pam; then\n            authselect select --force \"$var_authselect_profile\"\n        else\n\t        echo \"authselect is not used but files from the 'pam' package have been altered, so the authselect configuration won't be forced.\" >&2\n        fi\n    fi\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_banner_etc_issue": {
        "rule_id": "xccdf_org.ssgproject.content_rule_banner_etc_issue",
        "title": "Modify the System Login Banner",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80763-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000048",
              "CCI-000050",
              "CCI-001384",
              "CCI-001385",
              "CCI-001386",
              "CCI-001387",
              "CCI-001388"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-8(a)",
              "AC-8(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000023-GPOS-00006",
              "SRG-OS-000228-GPOS-00088"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010060"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230227r627750_rule"
            ]
          }
        ],
        "description": "\nTo configure the system login banner edit <code>/etc/issue</code>. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\n\nThe DoD required text is either:\n<br>\n        <br>\n        <code>You are accessing a U.S. Government (USG) Information System (IS) that\nis provided for USG-authorized use only. By using this IS (which includes\nany device attached to this IS), you consent to the following conditions:\n<br>-The USG routinely intercepts and monitors communications on this IS\nfor purposes including, but not limited to, penetration testing, COMSEC\nmonitoring, network operations and defense, personnel misconduct (PM), law\nenforcement (LE), and counterintelligence (CI) investigations.\n<br>-At any time, the USG may inspect and seize data stored on this IS.\n<br>-Communications using, or data stored on, this IS are not private,\nare subject to routine monitoring, interception, and search, and may be\ndisclosed or used for any USG-authorized purpose.\n<br>-This IS includes security measures (e.g., authentication and access\ncontrols) to protect USG interests -- not for your personal benefit or\nprivacy.\n<br>-Notwithstanding the above, using this IS does not constitute consent\nto PM, LE or CI investigative searching or monitoring of the content of\nprivileged communications, or work product, related to personal\nrepresentation or services by attorneys, psychotherapists, or clergy, and\ntheir assistants. Such communications and work product are private and\nconfidential. See User Agreement for details.</code>\n        <br>\n        <br>\nOR:\n<br>\n        <br>\n        <code>I&#x27;ve read &amp; consent to terms in IS user agreem&#x27;t.</code>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.\n<br>\n        <br>\nSystem use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-banner_etc_issue:def:1",
        "remediations": [
          {
            "remediation_id": "banner_etc_issue",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: XCCDF Value login_banner_text # promote to variable\n  set_fact:\n    login_banner_text: !!str ^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$\n  tags:\n    - always\n\n- name: Modify the System Login Banner - Ensure Correct Banner\n  copy:\n    dest: /etc/issue\n    content: '{{ login_banner_text | regex_replace(\"^\\^(.*)\\$$\", \"\\1\") | regex_replace(\"^\\((.*\\.)\\|.*\\)$\",\n      \"\\1\") | regex_replace(\"\\[\\\\s\\\\n\\]\\+\",\" \") | regex_replace(\"\\(\\?:\\[\\\\n\\]\\+\\|\\(\\?:\\\\\\\\n\\)\\+\\)\",\n      \"\\n\") | regex_replace(\"\\\\\", \"\") | wordwrap() }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80763-6\n  - DISA-STIG-RHEL-08-010060\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - banner_etc_issue\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "banner_etc_issue",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nmetadata:\n  labels:\n    machineconfiguration.openshift.io/role: master\n    machineconfiguration.openshift.io/role: worker\n  name: 75-banner-etc-issue\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,You%20are%20accessing%20a%20U.S.%20Government%20%28USG%29%20Information%20System%20%28IS%29%20that%20is%20%0Aprovided%20for%20USG-authorized%20use%20only.%20By%20using%20this%20IS%20%28which%20includes%20any%20%0Adevice%20attached%20to%20this%20IS%29%2C%20you%20consent%20to%20the%20following%20conditions%3A%0A%0A-The%20USG%20routinely%20intercepts%20and%20monitors%20communications%20on%20this%20IS%20for%20%0Apurposes%20including%2C%20but%20not%20limited%20to%2C%20penetration%20testing%2C%20COMSEC%20monitoring%2C%20%0Anetwork%20operations%20and%20defense%2C%20personnel%20misconduct%20%28PM%29%2C%20law%20enforcement%20%0A%28LE%29%2C%20and%20counterintelligence%20%28CI%29%20investigations.%0A%0A-At%20any%20time%2C%20the%20USG%20may%20inspect%20and%20seize%20data%20stored%20on%20this%20IS.%0A%0A-Communications%20using%2C%20or%20data%20stored%20on%2C%20this%20IS%20are%20not%20private%2C%20are%20subject%20%0Ato%20routine%20monitoring%2C%20interception%2C%20and%20search%2C%20and%20may%20be%20disclosed%20or%20used%20%0Afor%20any%20USG-authorized%20purpose.%0A%0A-This%20IS%20includes%20security%20measures%20%28e.g.%2C%20authentication%20and%20access%20controls%29%20%0Ato%20protect%20USG%20interests--not%20for%20your%20personal%20benefit%20or%20privacy.%0A%0A-Notwithstanding%20the%20above%2C%20using%20this%20IS%20does%20not%20constitute%20consent%20to%20PM%2C%20LE%20%0Aor%20CI%20investigative%20searching%20or%20monitoring%20of%20the%20content%20of%20privileged%20%0Acommunications%2C%20or%20work%20product%2C%20related%20to%20personal%20representation%20or%20services%20%0Aby%20attorneys%2C%20psychotherapists%2C%20or%20clergy%2C%20and%20their%20assistants.%20Such%20%0Acommunications%20and%20work%20product%20are%20private%20and%20confidential.%20See%20User%20%0AAgreement%20for%20details.\n        mode: 0644\n        path: /etc/issue.d/legal-notice\n        overwrite: true\n"
          },
          {
            "remediation_id": "banner_etc_issue",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nlogin_banner_text='^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$'\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newlines. (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"\\n\")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/\\n/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\\\//g')\nformatted=$(echo \"$login_banner_text\" | fold -sw 80)\ncat <<EOF >/etc/issue\n$formatted\nEOF\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230227",
        "stig_id": "RHEL-08-010060"
      },
      "xccdf_org.ssgproject.content_rule_banner_etc_issue_net": {
        "rule_id": "xccdf_org.ssgproject.content_rule_banner_etc_issue_net",
        "title": "Modify the System Login Banner for Remote Connections",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86147-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000048",
              "CCI-001384",
              "CCI-001385",
              "CCI-001386",
              "CCI-001387",
              "CCI-001388"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000023-GPOS-00006",
              "SRG-OS-000228-GPOS-00088"
            ]
          }
        ],
        "description": "To configure the system login banner edit <code>/etc/issue.net</code>. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:\n<br>\n        <br>\n        <code>You are accessing a U.S. Government (USG) Information System (IS) that\nis provided for USG-authorized use only. By using this IS (which includes\nany device attached to this IS), you consent to the following conditions:\n<br>-The USG routinely intercepts and monitors communications on this IS\nfor purposes including, but not limited to, penetration testing, COMSEC\nmonitoring, network operations and defense, personnel misconduct (PM), law\nenforcement (LE), and counterintelligence (CI) investigations.\n<br>-At any time, the USG may inspect and seize data stored on this IS.\n<br>-Communications using, or data stored on, this IS are not private,\nare subject to routine monitoring, interception, and search, and may be\ndisclosed or used for any USG-authorized purpose.\n<br>-This IS includes security measures (e.g., authentication and access\ncontrols) to protect USG interests -- not for your personal benefit or\nprivacy.\n<br>-Notwithstanding the above, using this IS does not constitute consent\nto PM, LE or CI investigative searching or monitoring of the content of\nprivileged communications, or work product, related to personal\nrepresentation or services by attorneys, psychotherapists, or clergy, and\ntheir assistants. Such communications and work product are private and\nconfidential. See User Agreement for details.</code>\n        <br>\n        <br>\nOR:\n<br>\n        <br>\n        <code>I&#x27;ve read &amp; consent to terms in IS user agreem&#x27;t.</code>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.\n<br>\n        <br>\nSystem use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-banner_etc_issue_net:def:1",
        "remediations": [
          {
            "remediation_id": "banner_etc_issue_net",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: XCCDF Value remote_login_banner_text # promote to variable\n  set_fact:\n    remote_login_banner_text: !!str ^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$\n  tags:\n    - always\n\n- name: Modify the System Login Banner for Remote Connections - ensure correct banner\n  copy:\n    dest: /etc/issue.net\n    content: '{{ remote_login_banner_text | regex_replace(\"^\\^(.*)\\$$\", \"\\1\") | regex_replace(\"^\\((.*\\.)\\|.*\\)$\",\n      \"\\1\") | regex_replace(\"\\[\\\\s\\\\n\\]\\+\",\" \") | regex_replace(\"\\(\\?:\\[\\\\n\\]\\+\\|\\(\\?:\\\\\\\\n\\)\\+\\)\",\n      \"\\n\") | regex_replace(\"\\\\\", \"\") | wordwrap() }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86147-6\n  - banner_etc_issue_net\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "banner_etc_issue_net",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nremote_login_banner_text='^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$'\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nremote_login_banner_text=$(echo \"$remote_login_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nremote_login_banner_text=$(echo \"$remote_login_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nremote_login_banner_text=$(echo \"$remote_login_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newlines. (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"\\n\")\nremote_login_banner_text=$(echo \"$remote_login_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/\\n/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nremote_login_banner_text=$(echo \"$remote_login_banner_text\" | sed 's/\\\\//g')\nformatted=$(echo \"$remote_login_banner_text\" | fold -sw 80)\n\ncat <<EOF >/etc/issue.net\n$formatted\nEOF\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_banner_etc_motd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_banner_etc_motd",
        "title": "Modify the System Message of the Day Banner",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83496-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.1"
            ]
          }
        ],
        "description": "To configure the system message banner edit <code>/etc/motd</code>. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:\n<br>\n        <br>\n        <code>You are accessing a U.S. Government (USG) Information System (IS) that\nis provided for USG-authorized use only. By using this IS (which includes\nany device attached to this IS), you consent to the following conditions:\n<br>-The USG routinely intercepts and monitors communications on this IS\nfor purposes including, but not limited to, penetration testing, COMSEC\nmonitoring, network operations and defense, personnel misconduct (PM), law\nenforcement (LE), and counterintelligence (CI) investigations.\n<br>-At any time, the USG may inspect and seize data stored on this IS.\n<br>-Communications using, or data stored on, this IS are not private,\nare subject to routine monitoring, interception, and search, and may be\ndisclosed or used for any USG-authorized purpose.\n<br>-This IS includes security measures (e.g., authentication and access\ncontrols) to protect USG interests -- not for your personal benefit or\nprivacy.\n<br>-Notwithstanding the above, using this IS does not constitute consent\nto PM, LE or CI investigative searching or monitoring of the content of\nprivileged communications, or work product, related to personal\nrepresentation or services by attorneys, psychotherapists, or clergy, and\ntheir assistants. Such communications and work product are private and\nconfidential. See User Agreement for details.</code>\n        <br>\n        <br>\nOR:\n<br>\n        <br>\n        <code>I&#x27;ve read &amp; consent to terms in IS user agreem&#x27;t.</code>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.\n<br>\n        <br>\nSystem use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-banner_etc_motd:def:1",
        "remediations": [
          {
            "remediation_id": "banner_etc_motd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: XCCDF Value motd_banner_text # promote to variable\n  set_fact:\n    motd_banner_text: !!str ^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$\n  tags:\n    - always\n\n- name: Modify the System Message of the Day Banner - ensure correct banner\n  copy:\n    dest: /etc/motd\n    content: '{{ motd_banner_text | regex_replace(\"^\\^(.*)\\$$\", \"\\1\") | regex_replace(\"^\\((.*\\.)\\|.*\\)$\",\n      \"\\1\") | regex_replace(\"\\[\\\\s\\\\n\\]\\+\",\" \") | regex_replace(\"\\(\\?:\\[\\\\n\\]\\+\\|\\(\\?:\\\\\\\\n\\)\\+\\)\",\n      \"\\n\") | regex_replace(\"\\\\\", \"\") | wordwrap() }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83496-0\n  - banner_etc_motd\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "banner_etc_motd",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nmotd_banner_text='^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$'\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newlines. (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"\\n\")\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/\\n/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/\\\\//g')\nformatted=$(echo \"$motd_banner_text\" | fold -sw 80)\n\ncat <<EOF >/etc/motd\n$formatted\nEOF\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue",
        "title": "Verify Group Ownership of System Login Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83708-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.5"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/issue</code>, run the command:\n<pre>$ sudo chgrp root /etc/issue</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper group ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_issue:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_issue",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue\n  stat:\n    path: /etc/issue\n  register: file_exists\n  tags:\n  - CCE-83708-8\n  - configure_strategy\n  - file_groupowner_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/issue\n  file:\n    path: /etc/issue\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83708-8\n  - configure_strategy\n  - file_groupowner_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_issue",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/issue\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue_net": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue_net",
        "title": "Verify Group Ownership of System Login Banner for Remote Connections",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86051-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.6"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.8"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/issue.net</code>, run the command:\n<pre>$ sudo chgrp root /etc/issue.net</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper group ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_issue_net:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_issue_net",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue.net\n  stat:\n    path: /etc/issue.net\n  register: file_exists\n  tags:\n  - CCE-86051-0\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_groupowner_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/issue.net\n  file:\n    path: /etc/issue.net\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86051-0\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_groupowner_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_issue_net",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/issue.net\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_motd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_motd",
        "title": "Verify Group Ownership of Message of the Day Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83728-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.4"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/motd</code>, run the command:\n<pre>$ sudo chgrp root /etc/motd</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper group ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_motd:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_motd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/motd\n  stat:\n    path: /etc/motd\n  register: file_exists\n  tags:\n  - CCE-83728-6\n  - configure_strategy\n  - file_groupowner_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/motd\n  file:\n    path: /etc/motd\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83728-6\n  - configure_strategy\n  - file_groupowner_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_motd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/motd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_issue": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_issue",
        "title": "Verify ownership of System Login Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83718-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.5"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/issue</code>, run the command:\n<pre>$ sudo chown root /etc/issue </pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_owner_etc_issue:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_issue",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue\n  stat:\n    path: /etc/issue\n  register: file_exists\n  tags:\n  - CCE-83718-7\n  - configure_strategy\n  - file_owner_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/issue\n  file:\n    path: /etc/issue\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83718-7\n  - configure_strategy\n  - file_owner_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_issue",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/issue\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_issue_net": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_issue_net",
        "title": "Verify ownership of System Login Banner for Remote Connections",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86054-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.6"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.8"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/issue.net</code>, run the command:\n<pre>$ sudo chown root /etc/issue.net </pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_owner_etc_issue_net:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_issue_net",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue.net\n  stat:\n    path: /etc/issue.net\n  register: file_exists\n  tags:\n  - CCE-86054-4\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_owner_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/issue.net\n  file:\n    path: /etc/issue.net\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86054-4\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_owner_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_issue_net",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/issue.net\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_motd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_motd",
        "title": "Verify ownership of Message of the Day Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83738-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.4"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/motd</code>, run the command:\n<pre>$ sudo chown root /etc/motd </pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper ownership will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_owner_etc_motd:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_motd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/motd\n  stat:\n    path: /etc/motd\n  register: file_exists\n  tags:\n  - CCE-83738-5\n  - configure_strategy\n  - file_owner_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/motd\n  file:\n    path: /etc/motd\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83738-5\n  - configure_strategy\n  - file_owner_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_motd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/motd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue",
        "title": "Verify permissions on System Login Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83348-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.5"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/issue</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/issue</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper permissions will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_issue:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_issue",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue\n  stat:\n    path: /etc/issue\n  register: file_exists\n  tags:\n  - CCE-83348-3\n  - configure_strategy\n  - file_permissions_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/issue\n  file:\n    path: /etc/issue\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83348-3\n  - configure_strategy\n  - file_permissions_etc_issue\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_issue",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/issue\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue_net": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_issue_net",
        "title": "Verify permissions on System Login Banner for Remote Connections",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86047-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.6"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.8"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/issue.net</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/issue.net</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper permissions will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_issue_net:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_issue_net",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/issue.net\n  stat:\n    path: /etc/issue.net\n  register: file_exists\n  tags:\n  - CCE-86047-8\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_permissions_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/issue.net\n  file:\n    path: /etc/issue.net\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86047-8\n  - PCI-DSSv4-1.2.8\n  - configure_strategy\n  - file_permissions_etc_issue_net\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_issue_net",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/issue.net\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_motd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_motd",
        "title": "Verify permissions on Message of the Day Banner",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83338-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.7.4"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/motd</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/motd</pre>\n       ",
        "rationale": "Display of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.<br>\nProper permissions will ensure that only root user can modify the banner.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_motd:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_motd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/motd\n  stat:\n    path: /etc/motd\n  register: file_exists\n  tags:\n  - CCE-83338-4\n  - configure_strategy\n  - file_permissions_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/motd\n  file:\n    path: /etc/motd\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83338-4\n  - configure_strategy\n  - file_permissions_etc_motd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_motd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/motd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_banner_enabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_banner_enabled",
        "title": "Enable GNOME3 Login Warning Banner",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80768-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000048",
              "CCI-000050",
              "CCI-001384",
              "CCI-001385",
              "CCI-001386",
              "CCI-001387",
              "CCI-001388"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-8(a)",
              "AC-8(b)",
              "AC-8(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000023-GPOS-00006",
              "SRG-OS-000228-GPOS-00088"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010049"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244519r743806_rule"
            ]
          }
        ],
        "description": "In the default graphical environment, displaying a login warning banner\nin the GNOME Display Manager&#x27;s login screen can be enabled on the login\nscreen by setting <code>banner-message-enable</code> to <code>true</code>.\n<br>\n         <br>\nTo enable, add or edit <code>banner-message-enable</code> to\n<code>/etc/dconf/db/gdm.d/00-security-settings</code>. For example:\n<pre>[org/gnome/login-screen]\nbanner-message-enable=true</pre>\nOnce the setting has been added, add a lock to\n<code>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/login-screen/banner-message-enable</pre>\nAfter the settings have been set, run <code>dconf update</code>.\nThe banner text must also be set.",
        "rationale": "Display of a standardized and approved use notification before granting access to the operating system\nensures privacy and security notification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.\n<br>\n         <br>\nFor U.S. Government systems, system use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not exist.",
        "oval_definition_id": "oval:ssg-dconf_gnome_banner_enabled:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_banner_enabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80768-5\n  - DISA-STIG-RHEL-08-010049\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(b)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_banner_enabled\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Enable GNOME3 Login Warning Banner\n  ini_file:\n    dest: /etc/dconf/db/gdm.d/00-security-settings\n    section: org/gnome/login-screen\n    option: banner-message-enable\n    value: 'true'\n    create: true\n    no_extra_spaces: true\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80768-5\n  - DISA-STIG-RHEL-08-010049\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(b)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_banner_enabled\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of GNOME banner-message-enabled\n  lineinfile:\n    path: /etc/dconf/db/gdm.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/login-screen/banner-message-enable$\n    line: /org/gnome/login-screen/banner-message-enable\n    create: true\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80768-5\n  - DISA-STIG-RHEL-08-010049\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(b)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_banner_enabled\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80768-5\n  - DISA-STIG-RHEL-08-010049\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(b)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_banner_enabled\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_banner_enabled",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*banner-message-enable\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)banner-message-enable(\\s*=)/#\\1banner-message-enable\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*banner-message-enable\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*banner-message-enable\\\\s*=\\\\s*.*/banner-message-enable=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\banner-message-enable=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/login-screen/banner-message-enable$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|gdm.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/gdm.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/login-screen/banner-message-enable$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/login-screen/banner-message-enable$\" /etc/dconf/db/gdm.d/\nthen\n    echo \"/org/gnome/login-screen/banner-message-enable\" >> \"/etc/dconf/db/gdm.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244519",
        "stig_id": "RHEL-08-010049"
      },
      "xccdf_org.ssgproject.content_rule_dconf_gnome_login_banner_text": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dconf_gnome_login_banner_text",
        "title": "Set the GNOME3 Login Warning Banner Text",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80770-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.8.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000048",
              "CCI-001384",
              "CCI-001385",
              "CCI-001386",
              "CCI-001387",
              "CCI-001388"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-8(a)",
              "AC-8(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000023-GPOS-00006",
              "SRG-OS-000228-GPOS-00088"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010050"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230226r743916_rule"
            ]
          }
        ],
        "description": "In the default graphical environment, configuring the login warning banner text\nin the GNOME Display Manager&#x27;s login screen can be configured on the login\nscreen by setting <code>banner-message-text</code> to <code>&#x27;<i>APPROVED_BANNER</i>&#x27;</code>\nwhere <i>APPROVED_BANNER</i> is the approved banner for your environment.\n<br>\n         <br>\nTo enable, add or edit <code>banner-message-text</code> to\n\n<code>/etc/dconf/db/gdm.d/00-security-settings</code>. For example:\n<pre>[org/gnome/login-screen]\nbanner-message-text=&#x27;<i>APPROVED_BANNER</i>&#x27;</pre>\nOnce the setting has been added, add a lock to\n<code>/etc/dconf/db/gdm.d/locks/00-security-settings-lock</code> to prevent user modification.\nFor example:\n<pre>/org/gnome/login-screen/banner-message-text</pre>\n\nAfter the settings have been set, run <code>dconf update</code>.\nWhen entering a warning banner that spans several lines, remember\nto begin and end the string with <code>&#x27;</code> and use <code>\\n</code> for new lines.",
        "rationale": "An appropriate warning message reinforces policy awareness during the logon\nprocess and facilitates possible legal action against attackers.",
        "oval_definition_id": "oval:ssg-dconf_gnome_login_banner_text:def:1",
        "remediations": [
          {
            "remediation_id": "dconf_gnome_login_banner_text",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n- name: XCCDF Value login_banner_text # promote to variable\n  set_fact:\n    login_banner_text: !!str ^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$\n  tags:\n    - always\n\n- name: Set the GNOME3 Login Warning Banner Text\n  file:\n    path: /etc/dconf/db/{{ item }}\n    owner: root\n    group: root\n    mode: 493\n    state: directory\n  with_items:\n  - gdm.d\n  - gdm.d/locks\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Set the GNOME3 Login Warning Banner Text\n  file:\n    path: /etc/dconf/db/gdm.d/{{ item }}\n    owner: root\n    group: root\n    mode: 420\n    state: touch\n  with_items:\n  - 00-security-settings\n  - locks/00-security-settings-lock\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Set the GNOME3 Login Warning Banner Text\n  ini_file:\n    dest: /etc/dconf/db/gdm.d/00-security-settings\n    section: org/gnome/login-screen\n    option: banner-message-text\n    value: '''{{ login_banner_text | regex_replace(\"^\\^(.*)\\$$\", \"\\1\") | regex_replace(\"^\\((.*\\.)\\|.*\\)$\",\n      \"\\1\") | regex_replace(\"\\[\\\\s\\\\n\\]\\+\",\" \") | regex_replace(\"\\(\\?:\\[\\\\n\\]\\+\\|\\(\\?:\\\\\\\\n\\)\\+\\)\",\n      \"(n)*\") | regex_replace(\"\\\\\", \"\") | regex_replace(\"\\(n\\)\\*\", \"\\\\n\") }}'''\n    create: true\n    no_extra_spaces: true\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Prevent user modification of the GNOME3 Login Warning Banner Text\n  lineinfile:\n    path: /etc/dconf/db/gdm.d/locks/00-security-settings-lock\n    regexp: ^/org/gnome/login-screen/banner-message-text$\n    line: /org/gnome/login-screen/banner-message-text\n    create: true\n    state: present\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n\n- name: Dconf Update\n  command: dconf update\n  when: '\"gdm\" in ansible_facts.packages'\n  tags:\n  - CCE-80770-1\n  - DISA-STIG-RHEL-08-010050\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - dconf_gnome_login_banner_text\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n"
          },
          {
            "remediation_id": "dconf_gnome_login_banner_text",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q gdm; then\n\nlogin_banner_text='^(Authorized[\\s\\n]+uses[\\s\\n]+only\\.[\\s\\n]+All[\\s\\n]+activity[\\s\\n]+may[\\s\\n]+be[\\s\\n]+monitored[\\s\\n]+and[\\s\\n]+reported\\.|^(?!.*(\\\\|fedora|rhel|sle|ubuntu)).*)$'\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newline \"tokens\". (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"(n)*\")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/(n)*/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\\\//g')\n# 5 - Removes the newline \"token.\" (Transforms them into newline escape sequences \"\\n\").\n#    ( Needs to be done after 4, otherwise the escapce sequence will become just \"n\".\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(n)\\*/\\\\n/g')\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*banner-message-text\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)banner-message-text(\\s*=)/#\\1banner-message-text\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"'${login_banner_text}'\")\"\nif grep -q \"^\\\\s*banner-message-text\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*banner-message-text\\\\s*=\\\\s*.*/banner-message-text=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\banner-message-text=${escaped_value}\" \"${DCONFFILE}\"\nfi\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/login-screen/banner-message-text$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|gdm.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/gdm.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/login-screen/banner-message-text$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/login-screen/banner-message-text$\" /etc/dconf/db/gdm.d/\nthen\n    echo \"/org/gnome/login-screen/banner-message-text\" >> \"/etc/dconf/db/gdm.d/locks/00-security-settings-lock\"\nfi\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230226",
        "stig_id": "RHEL-08-010050"
      },
      "xccdf_org.ssgproject.content_rule_package_pam_pwquality_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_pam_pwquality_installed",
        "title": "Install pam_pwquality Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86225-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.2.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00225"
            ]
          }
        ],
        "description": "\nThe <code>libpwquality</code> package can be installed with the following command:\n<pre>\n$ sudo yum install libpwquality</pre>\n       ",
        "rationale": "Use of a complex password helps to increase the time and resources required\nto compromise the password. Password complexity, or strength, is a measure\nof the effectiveness of a password in resisting attempts at guessing and\nbrute-force attacks. &quot;pwquality&quot; enforces complex password construction\nconfiguration and has the ability to limit brute-force attacks on the system.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-package_pam_pwquality_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_pam_pwquality_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86225-0\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_pam_pwquality_installed\n\n- name: Ensure libpwquality is installed\n  package:\n    name: libpwquality\n    state: present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-86225-0\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_pam_pwquality_installed\n"
          },
          {
            "remediation_id": "package_pam_pwquality_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_libpwquality\n\nclass install_libpwquality {\n  package { 'libpwquality':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_pam_pwquality_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"libpwquality\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_pam_pwquality_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nif ! rpm -q --quiet \"libpwquality\" ; then\n    yum install -y \"libpwquality\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_account_password_pam_faillock_password_auth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_account_password_pam_faillock_password_auth",
        "title": "Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth File.",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86931-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.2.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000044"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-7 (a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000021-GPOS-00005"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020026"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244534r743851_rule"
            ]
          }
        ],
        "description": "The pam_faillock.so module must be loaded in preauth in /etc/pam.d/password-auth.",
        "rationale": "If the pam_faillock.so module is not loaded the system will not correctly lockout accounts to prevent\npassword guessing attacks.",
        "oval_definition_id": "oval:ssg-account_password_pam_faillock_password_auth:def:1",
        "remediations": [
          {
            "remediation_id": "account_password_pam_faillock_password_auth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n    File. - Check if system relies on authselect tool\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  tags:\n  - CCE-86931-3\n  - DISA-STIG-RHEL-08-020026\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_password_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n    File. - Remediation where authselect tool is present\n  block:\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Check integrity of authselect current profile\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Informative message based on the authselect integrity check result\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Get authselect current features\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Ensure \"with-faillock\" feature is enabled using authselect tool\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-faillock\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-faillock\")\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Ensure authselect changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when: result_authselect_present.stat.exists\n  tags:\n  - CCE-86931-3\n  - DISA-STIG-RHEL-08-020026\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_password_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n    File. - Remediation where authselect tool is not present\n  block:\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Check if pam_faillock.so is already enabled\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail)\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_is_enabled\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Enable pam_faillock.so preauth editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so preauth\n      insertbefore: ^auth.*sufficient.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Enable pam_faillock.so authfail editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so authfail\n      insertbefore: ^auth.*required.*pam_deny\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/password-auth\n      File. - Enable pam_faillock.so account section editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: account     required      pam_faillock.so\n      insertbefore: ^account.*required.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n  when: not result_authselect_present.stat.exists\n  tags:\n  - CCE-86931-3\n  - DISA-STIG-RHEL-08-020026\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_password_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "account_password_pam_faillock_password_auth",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\nfor pam_file in \"${AUTH_FILES[@]}\"\ndo\n    if ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+(preauth silent|authfail).*$' \"$pam_file\" ; then\n        sed -i --follow-symlinks '/^auth.*sufficient.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth silent' \"$pam_file\"\n        sed -i --follow-symlinks '/^auth.*required.*pam_deny\\.so.*/i auth        required      pam_faillock.so authfail' \"$pam_file\"\n        sed -i --follow-symlinks '/^account.*required.*pam_unix\\.so.*/i account     required      pam_faillock.so' \"$pam_file\"\n    fi\n    sed -Ei 's/(auth.*)(\\[default=die\\])(.*pam_faillock\\.so)/\\1required     \\3/g' \"$pam_file\"\ndone\n\nfi\n"
          }
        ],
        "vuln_id": "SV-244534",
        "stig_id": "RHEL-08-020026"
      },
      "xccdf_org.ssgproject.content_rule_account_password_pam_faillock_system_auth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_account_password_pam_faillock_system_auth",
        "title": "Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth File.",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86916-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.2.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000044"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-7 (a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000021-GPOS-00005"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020025"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244533r743848_rule"
            ]
          }
        ],
        "description": "The pam_faillock.so module must be loaded in preauth in /etc/pam.d/system-auth.",
        "rationale": "If the pam_faillock.so module is not loaded the system will not correctly lockout accounts to prevent\npassword guessing attacks.",
        "oval_definition_id": "oval:ssg-account_password_pam_faillock_system_auth:def:1",
        "remediations": [
          {
            "remediation_id": "account_password_pam_faillock_system_auth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n    File. - Check if system relies on authselect tool\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  tags:\n  - CCE-86916-4\n  - DISA-STIG-RHEL-08-020025\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_system_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n    File. - Remediation where authselect tool is present\n  block:\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Check integrity of authselect current profile\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Informative message based on the authselect integrity check result\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Get authselect current features\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Ensure \"with-faillock\" feature is enabled using authselect tool\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-faillock\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-faillock\")\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Ensure authselect changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when: result_authselect_present.stat.exists\n  tags:\n  - CCE-86916-4\n  - DISA-STIG-RHEL-08-020025\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_system_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n    File. - Remediation where authselect tool is not present\n  block:\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Check if pam_faillock.so is already enabled\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail)\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_is_enabled\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Enable pam_faillock.so preauth editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so preauth\n      insertbefore: ^auth.*sufficient.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Enable pam_faillock.so authfail editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so authfail\n      insertbefore: ^auth.*required.*pam_deny\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Configure the Use of the pam_faillock.so Module in the /etc/pam.d/system-auth\n      File. - Enable pam_faillock.so account section editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: account     required      pam_faillock.so\n      insertbefore: ^account.*required.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n  when: not result_authselect_present.stat.exists\n  tags:\n  - CCE-86916-4\n  - DISA-STIG-RHEL-08-020025\n  - NIST-800-53-AC-7 (a)\n  - account_password_pam_faillock_system_auth\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "account_password_pam_faillock_system_auth",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\nfor pam_file in \"${AUTH_FILES[@]}\"\ndo\n    if ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+(preauth silent|authfail).*$' \"$pam_file\" ; then\n        sed -i --follow-symlinks '/^auth.*sufficient.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth silent' \"$pam_file\"\n        sed -i --follow-symlinks '/^auth.*required.*pam_deny\\.so.*/i auth        required      pam_faillock.so authfail' \"$pam_file\"\n        sed -i --follow-symlinks '/^account.*required.*pam_unix\\.so.*/i account     required      pam_faillock.so' \"$pam_file\"\n    fi\n    sed -Ei 's/(auth.*)(\\[default=die\\])(.*pam_faillock\\.so)/\\1required     \\3/g' \"$pam_file\"\ndone\n\nfi\n"
          }
        ],
        "vuln_id": "SV-244533",
        "stig_id": "RHEL-08-020025"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwhistory_remember_password_auth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwhistory_remember_password_auth",
        "title": "Limit Password Reuse: password-auth",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83478-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000200"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "IA-5(1)(e)",
              "IA-5(f)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000077-GPOS-00045"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.7"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020220"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230368r902759_rule"
            ]
          }
        ],
        "description": "Do not allow users to reuse recent passwords. This can be accomplished by using the\n<code>remember</code> option for the <code>pam_pwhistory</code> PAM module.\n<br>\n         <br>\n\nOn systems with newer versions of <code>authselect</code>, the <code>pam_pwhistory</code> PAM module\ncan be enabled via authselect feature:\n<pre>authselect enable-feature with-pwhistory</pre>\n\nOtherwise, it should be enabled using an authselect custom profile.\n<br>\n         <br>\nNewer systems also have the <code>/etc/security/pwhistory.conf</code> file for setting\n<code>pam_pwhistory</code> module options. This file should be used whenever available.\nOtherwise, the <code>pam_pwhistory</code> module options can be set in PAM files.\n<br>\n         <br>\nThe value for <code>remember</code> option must be equal or greater than\n24\n        ",
        "rationale": "Preventing re-use of previous passwords helps ensure that a compromised password is not\nre-used by a user.",
        "warnings": [
          {
            "text": "If the system relies on <code>authselect</code> tool to manage PAM settings, the remediation\nwill also use <code>authselect</code> tool. However, if any manual modification was made in\nPAM files, the <code>authselect</code> integrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.",
            "category": "general"
          },
          {
            "text": "Newer versions of <code>authselect</code> contain an authselect feature to easily and properly\nenable <code>pam_pwhistory.so</code> module. If this feature is not yet available in your\nsystem, an authselect custom profile must be used to avoid integrity issues in PAM files.\nIf a custom profile was created and used in the system before this authselect feature was\navailable, the new feature can&#x27;t be used with this custom profile and the\nremediation will fail. In this case, the custom profile should be recreated or manually\nupdated.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_pwhistory_remember_password_auth:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_pwhistory_remember_password_auth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n- name: XCCDF Value var_password_pam_remember # promote to variable\n  set_fact:\n    var_password_pam_remember: !!str 24\n  tags:\n    - always\n- name: XCCDF Value var_password_pam_remember_control_flag # promote to variable\n  set_fact:\n    var_password_pam_remember_control_flag: !!str requisite,required\n  tags:\n    - always\n\n- name: 'Limit Password Reuse: password-auth - Check if system relies on authselect\n    tool'\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - Collect the available authselect features'\n  ansible.builtin.command:\n    cmd: authselect list-features sssd\n  register: result_authselect_available_features\n  changed_when: false\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - Enable pam_pwhistory.so using authselect\n    feature'\n  block:\n\n  - name: 'Limit Password Reuse: password-auth - Check integrity of authselect current\n      profile'\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: 'Limit Password Reuse: password-auth - Informative message based on the\n      authselect integrity check result'\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: 'Limit Password Reuse: password-auth - Get authselect current features'\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: 'Limit Password Reuse: password-auth - Ensure \"with-pwhistory\" feature is\n      enabled using authselect tool'\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-pwhistory\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-pwhistory\")\n\n  - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  - result_authselect_available_features.stdout is search(\"with-pwhistory\")\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - Enable pam_pwhistory.so in appropriate\n    PAM files'\n  block:\n\n  - name: 'Limit Password Reuse: password-auth - Define the PAM file to be edited\n      as a local fact'\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/password-auth\n\n  - name: 'Limit Password Reuse: password-auth - Check if system relies on authselect\n      tool'\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: 'Limit Password Reuse: password-auth - Ensure authselect custom profile\n      is used if authselect is present'\n    block:\n\n    - name: 'Limit Password Reuse: password-auth - Check integrity of authselect current\n        profile'\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: 'Limit Password Reuse: password-auth - Informative message based on the\n        authselect integrity check result'\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: 'Limit Password Reuse: password-auth - Get authselect current profile'\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: 'Limit Password Reuse: password-auth - Define the current authselect profile\n        as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Define the new authselect custom\n        profile as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Get authselect current features\n        to also enable them in the custom profile'\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Check if any custom profile with\n        the same name was already created'\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Create an authselect custom profile\n        based on the current profile'\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the authselect custom profile\n        is selected'\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: password-auth - Restore the authselect features\n        in the custom profile'\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: 'Limit Password Reuse: password-auth - Change the PAM file to be edited\n        according to the custom authselect profile'\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: 'Limit Password Reuse: password-auth - Define a fact for control already\n      filtered in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: '{{ var_password_pam_remember_control_flag.split(\",\")[0]\n        }}'\n\n  - name: 'Limit Password Reuse: password-auth - Check if expected PAM module line\n      is present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: 'Limit Password Reuse: password-auth - Include or update the PAM module\n      line in {{ pam_file_path }}'\n    block:\n\n    - name: 'Limit Password Reuse: password-auth - Check if required PAM module line\n        is present in {{ pam_file_path }} with different control'\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the correct control for\n        the required PAM module line in {{ pam_file_path }}'\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the required PAM module\n        line is included in {{ pam_file_path }}'\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        insertafter: ^password.*requisite.*pam_pwquality\\.so\n        line: password    {{ pam_module_control }}    pam_pwhistory.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - |\n    (result_authselect_available_features.stdout is defined and result_authselect_available_features.stdout is not search(\"with-pwhistory\")) or result_authselect_available_features is not defined\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - Check the presence of /etc/security/pwhistory.conf\n    file'\n  ansible.builtin.stat:\n    path: /etc/security/pwhistory.conf\n  register: result_pwhistory_conf_check\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - pam_pwhistory.so parameters are configured\n    in /etc/security/pwhistory.conf file'\n  block:\n\n  - name: 'Limit Password Reuse: password-auth - Ensure the pam_pwhistory.so remember\n      parameter in /etc/security/pwhistory.conf'\n    ansible.builtin.lineinfile:\n      path: /etc/security/pwhistory.conf\n      regexp: ^\\s*remember\\s*=\n      line: remember = {{ var_password_pam_remember }}\n      state: present\n\n  - name: 'Limit Password Reuse: password-auth - Ensure the pam_pwhistory.so remember\n      parameter is removed from PAM files'\n    block:\n\n    - name: 'Limit Password Reuse: password-auth - Check if /etc/pam.d/password-auth\n        file is present'\n      ansible.builtin.stat:\n        path: /etc/pam.d/password-auth\n      register: result_pam_file_present\n\n    - name: 'Limit Password Reuse: password-auth - Check the proper remediation for\n        the system'\n      block:\n\n      - name: 'Limit Password Reuse: password-auth - Define the PAM file to be edited\n          as a local fact'\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/pam.d/password-auth\n\n      - name: 'Limit Password Reuse: password-auth - Check if system relies on authselect\n          tool'\n        ansible.builtin.stat:\n          path: /usr/bin/authselect\n        register: result_authselect_present\n\n      - name: 'Limit Password Reuse: password-auth - Ensure authselect custom profile\n          is used if authselect is present'\n        block:\n\n        - name: 'Limit Password Reuse: password-auth - Check integrity of authselect\n            current profile'\n          ansible.builtin.command:\n            cmd: authselect check\n          register: result_authselect_check_cmd\n          changed_when: false\n          failed_when: false\n\n        - name: 'Limit Password Reuse: password-auth - Informative message based on\n            the authselect integrity check result'\n          ansible.builtin.assert:\n            that:\n            - result_authselect_check_cmd.rc == 0\n            fail_msg:\n            - authselect integrity check failed. Remediation aborted!\n            - This remediation could not be applied because an authselect profile\n              was not selected or the selected profile is not intact.\n            - It is not recommended to manually edit the PAM files when authselect\n              tool is available.\n            - In cases where the default authselect profile does not cover a specific\n              demand, a custom authselect profile is recommended.\n            success_msg:\n            - authselect integrity check passed\n\n        - name: 'Limit Password Reuse: password-auth - Get authselect current profile'\n          ansible.builtin.shell:\n            cmd: authselect current -r | awk '{ print $1 }'\n          register: result_authselect_profile\n          changed_when: false\n          when:\n          - result_authselect_check_cmd is success\n\n        - name: 'Limit Password Reuse: password-auth - Define the current authselect\n            profile as a local fact'\n          ansible.builtin.set_fact:\n            authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n            authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_profile.stdout is match(\"custom/\")\n\n        - name: 'Limit Password Reuse: password-auth - Define the new authselect custom\n            profile as a local fact'\n          ansible.builtin.set_fact:\n            authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n            authselect_custom_profile: custom/hardening\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_profile.stdout is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: password-auth - Get authselect current features\n            to also enable them in the custom profile'\n          ansible.builtin.shell:\n            cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n          register: result_authselect_features\n          changed_when: false\n          when:\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: password-auth - Check if any custom profile\n            with the same name was already created'\n          ansible.builtin.stat:\n            path: /etc/authselect/{{ authselect_custom_profile }}\n          register: result_authselect_custom_profile_present\n          changed_when: false\n          when:\n          - authselect_current_profile is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: password-auth - Create an authselect custom\n            profile based on the current profile'\n          ansible.builtin.command:\n            cmd: authselect create-profile hardening -b {{ authselect_current_profile\n              }}\n          when:\n          - result_authselect_check_cmd is success\n          - authselect_current_profile is not match(\"custom/\")\n          - not result_authselect_custom_profile_present.stat.exists\n\n        - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are\n            applied'\n          ansible.builtin.command:\n            cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n          - authselect_custom_profile is not match(authselect_current_profile)\n\n        - name: 'Limit Password Reuse: password-auth - Ensure the authselect custom\n            profile is selected'\n          ansible.builtin.command:\n            cmd: authselect select {{ authselect_custom_profile }}\n          register: result_pam_authselect_select_profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n          - authselect_custom_profile is not match(authselect_current_profile)\n\n        - name: 'Limit Password Reuse: password-auth - Restore the authselect features\n            in the custom profile'\n          ansible.builtin.command:\n            cmd: authselect enable-feature {{ item }}\n          loop: '{{ result_authselect_features.stdout_lines }}'\n          register: result_pam_authselect_restore_features\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_features is not skipped\n          - result_pam_authselect_select_profile is not skipped\n\n        - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are\n            applied'\n          ansible.builtin.command:\n            cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - result_pam_authselect_restore_features is not skipped\n\n        - name: 'Limit Password Reuse: password-auth - Change the PAM file to be edited\n            according to the custom authselect profile'\n          ansible.builtin.set_fact:\n            pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n              | basename }}\n        when:\n        - result_authselect_present.stat.exists\n\n      - name: 'Limit Password Reuse: password-auth - Define a fact for control already\n          filtered in case filters are used'\n        ansible.builtin.set_fact:\n          pam_module_control: ''\n\n      - name: 'Limit Password Reuse: password-auth - Ensure the \"remember\" option\n          from \"pam_pwhistory.so\" is not present in {{ pam_file_path }}'\n        ansible.builtin.replace:\n          dest: '{{ pam_file_path }}'\n          regexp: (.*password.*pam_pwhistory.so.*)\\bremember\\b=?[0-9a-zA-Z]*(.*)\n          replace: \\1\\2\n        register: result_pam_option_removal\n\n      - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are\n          applied'\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b\n        when:\n        - result_authselect_present.stat.exists\n        - result_pam_option_removal is changed\n      when:\n      - result_pam_file_present.stat.exists\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pwhistory_conf_check.stat.exists\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: password-auth - pam_pwhistory.so parameters are configured\n    in PAM files'\n  block:\n\n  - name: 'Limit Password Reuse: password-auth - Define the PAM file to be edited\n      as a local fact'\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/password-auth\n\n  - name: 'Limit Password Reuse: password-auth - Check if system relies on authselect\n      tool'\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: 'Limit Password Reuse: password-auth - Ensure authselect custom profile\n      is used if authselect is present'\n    block:\n\n    - name: 'Limit Password Reuse: password-auth - Check integrity of authselect current\n        profile'\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: 'Limit Password Reuse: password-auth - Informative message based on the\n        authselect integrity check result'\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: 'Limit Password Reuse: password-auth - Get authselect current profile'\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: 'Limit Password Reuse: password-auth - Define the current authselect profile\n        as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Define the new authselect custom\n        profile as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Get authselect current features\n        to also enable them in the custom profile'\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Check if any custom profile with\n        the same name was already created'\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: password-auth - Create an authselect custom profile\n        based on the current profile'\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the authselect custom profile\n        is selected'\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: password-auth - Restore the authselect features\n        in the custom profile'\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: 'Limit Password Reuse: password-auth - Change the PAM file to be edited\n        according to the custom authselect profile'\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: 'Limit Password Reuse: password-auth - Define a fact for control already\n      filtered in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: requisite\n\n  - name: 'Limit Password Reuse: password-auth - Check if expected PAM module line\n      is present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: 'Limit Password Reuse: password-auth - Include or update the PAM module\n      line in {{ pam_file_path }}'\n    block:\n\n    - name: 'Limit Password Reuse: password-auth - Check if required PAM module line\n        is present in {{ pam_file_path }} with different control'\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the correct control for\n        the required PAM module line in {{ pam_file_path }}'\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: 'Limit Password Reuse: password-auth - Ensure the required PAM module\n        line is included in {{ pam_file_path }}'\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        line: password    {{ pam_module_control }}    pam_pwhistory.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n\n  - name: 'Limit Password Reuse: password-auth - Define a fact for control already\n      filtered in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: requisite\n\n  - name: 'Limit Password Reuse: password-auth - Check if the required PAM module\n      option is present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\\sremember\\b\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_module_accounts_password_pam_pwhistory_remember_password_auth_option_present\n\n  - name: 'Limit Password Reuse: password-auth - Ensure the \"remember\" PAM option\n      for \"pam_pwhistory.so\" is included in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so.*)\n      line: \\1 remember={{ var_password_pam_remember }}\n      state: present\n    register: result_pam_accounts_password_pam_pwhistory_remember_password_auth_add\n    when:\n    - result_pam_module_accounts_password_pam_pwhistory_remember_password_auth_option_present.found\n      == 0\n\n  - name: 'Limit Password Reuse: password-auth - Ensure the required value for \"remember\"\n      PAM option from \"pam_pwhistory.so\" in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s+.*)(remember)=[0-9a-zA-Z]+\\s*(.*)\n      line: \\1\\2={{ var_password_pam_remember }} \\3\n    register: result_pam_accounts_password_pam_pwhistory_remember_password_auth_edit\n    when:\n    - result_pam_module_accounts_password_pam_pwhistory_remember_password_auth_option_present.found\n      > 0\n\n  - name: 'Limit Password Reuse: password-auth - Ensure authselect changes are applied'\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - (result_pam_remember_add is defined and result_pam_remember_add.changed) or\n      (result_pam_remember_edit is defined and result_pam_remember_edit.changed)\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_pwhistory_conf_check.stat.exists\n  tags:\n  - CCE-83478-8\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020220\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_password_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "accounts_password_pam_pwhistory_remember_password_auth",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_remember='24'\nvar_password_pam_remember_control_flag='requisite,required'\n\n\nvar_password_pam_remember_control_flag=\"$(echo $var_password_pam_remember_control_flag | cut -d \\, -f 1)\"\n\nif [ -f /usr/bin/authselect ]; then\n    if authselect list-features sssd | grep -q with-pwhistory; then\n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n        authselect enable-feature with-pwhistory\n\n        authselect apply-changes -b\n    else\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/password-auth\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n        if ! grep -qP \"^\\s*password\\s+$var_password_pam_remember_control_flag\\s+pam_pwhistory.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n            # Line matching group + control + module was not found. Check group + module.\n            if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n                # The control is updated only if one single line matches.\n                sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1$var_password_pam_remember_control_flag \\2/\" \"$PAM_FILE_PATH\"\n            else\n                LAST_MATCH_LINE=$(grep -nP \"^password.*requisite.*pam_pwquality\\.so\" \"$PAM_FILE_PATH\" | tail -n 1 | cut -d: -f 1)\n                if [ ! -z $LAST_MATCH_LINE ]; then\n                    sed -i --follow-symlinks $LAST_MATCH_LINE\" a password     $var_password_pam_remember_control_flag    pam_pwhistory.so\" \"$PAM_FILE_PATH\"\n                else\n                    echo \"password    $var_password_pam_remember_control_flag    pam_pwhistory.so\" >> \"$PAM_FILE_PATH\"\n                fi\n            fi\n        fi\n    fi\nelse\n    if ! grep -qP \"^\\s*password\\s+$var_password_pam_remember_control_flag\\s+pam_pwhistory.so\\s*.*\" \"/etc/pam.d/password-auth\"; then\n        # Line matching group + control + module was not found. Check group + module.\n        if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"/etc/pam.d/password-auth\")\" -eq 1 ]; then\n            # The control is updated only if one single line matches.\n            sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1$var_password_pam_remember_control_flag \\2/\" \"/etc/pam.d/password-auth\"\n        else\n            LAST_MATCH_LINE=$(grep -nP \"^password.*requisite.*pam_pwquality\\.so\" \"/etc/pam.d/password-auth\" | tail -n 1 | cut -d: -f 1)\n            if [ ! -z $LAST_MATCH_LINE ]; then\n                sed -i --follow-symlinks $LAST_MATCH_LINE\" a password     $var_password_pam_remember_control_flag    pam_pwhistory.so\" \"/etc/pam.d/password-auth\"\n            else\n                echo \"password    $var_password_pam_remember_control_flag    pam_pwhistory.so\" >> \"/etc/pam.d/password-auth\"\n            fi\n        fi\n    fi\nfi\n\nPWHISTORY_CONF=\"/etc/security/pwhistory.conf\"\nif [ -f $PWHISTORY_CONF ]; then\n    regex=\"^\\s*remember\\s*=\"\n    line=\"remember = $var_password_pam_remember\"\n    if ! grep -q $regex $PWHISTORY_CONF; then\n        echo $line >> $PWHISTORY_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(remember\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_password_pam_remember\"'|g' $PWHISTORY_CONF\n    fi\n    if [ -e \"/etc/pam.d/password-auth\" ] ; then\n        PAM_FILE_PATH=\"/etc/pam.d/password-auth\"\n        if [ -f /usr/bin/authselect ]; then\n            \n            if ! authselect check; then\n            echo \"\n            authselect integrity check failed. Remediation aborted!\n            This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n            It is not recommended to manually edit the PAM files when authselect tool is available.\n            In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n            exit 1\n            fi\n\n            CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n            # If not already in use, a custom profile is created preserving the enabled features.\n            if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                authselect create-profile hardening -b $CURRENT_PROFILE\n                CURRENT_PROFILE=\"custom/hardening\"\n                \n                authselect apply-changes -b --backup=before-hardening-custom-profile\n                authselect select $CURRENT_PROFILE\n                for feature in $ENABLED_FEATURES; do\n                    authselect enable-feature $feature;\n                done\n                \n                authselect apply-changes -b --backup=after-hardening-custom-profile\n            fi\n            PAM_FILE_NAME=$(basename \"/etc/pam.d/password-auth\")\n            PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n            authselect apply-changes -b\n        fi\n        \n    if grep -qP \"^\\s*password\\s.*\\bpam_pwhistory.so\\s.*\\bremember\\b\" \"$PAM_FILE_PATH\"; then\n        sed -i -E --follow-symlinks \"s/(.*password.*pam_pwhistory.so.*)\\bremember\\b=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\n    fi\n        if [ -f /usr/bin/authselect ]; then\n            \n            authselect apply-changes -b\n        fi\n    else\n        echo \"/etc/pam.d/password-auth was not found\" >&2\n    fi\nelse\n    PAM_FILE_PATH=\"/etc/pam.d/password-auth\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/password-auth\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    if ! grep -qP \"^\\s*password\\s+requisite\\s+pam_pwhistory.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n        # Line matching group + control + module was not found. Check group + module.\n        if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n            # The control is updated only if one single line matches.\n            sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1requisite \\2/\" \"$PAM_FILE_PATH\"\n        else\n            echo \"password    requisite    pam_pwhistory.so\" >> \"$PAM_FILE_PATH\"\n        fi\n    fi\n    # Check the option\n    if ! grep -qP \"^\\s*password\\s+requisite\\s+pam_pwhistory.so\\s*.*\\sremember\\b\" \"$PAM_FILE_PATH\"; then\n        sed -i -E --follow-symlinks \"/\\s*password\\s+requisite\\s+pam_pwhistory.so.*/ s/$/ remember=$var_password_pam_remember/\" \"$PAM_FILE_PATH\"\n    else\n        sed -i -E --follow-symlinks \"s/(\\s*password\\s+requisite\\s+pam_pwhistory.so\\s+.*)(remember=)[[:alnum:]]+\\s*(.*)/\\1\\2$var_password_pam_remember \\3/\" \"$PAM_FILE_PATH\"\n    fi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230368",
        "stig_id": "RHEL-08-020220"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwhistory_remember_system_auth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_pwhistory_remember_system_auth",
        "title": "Limit Password Reuse: system-auth",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83480-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000200"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "IA-5(1)(e)",
              "IA-5(f)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000077-GPOS-00045"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.7"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020221"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-251717r902749_rule"
            ]
          }
        ],
        "description": "Do not allow users to reuse recent passwords. This can be accomplished by using the\n<code>remember</code> option for the <code>pam_pwhistory</code> PAM module.\n<br>\n         <br>\n\nOn systems with newer versions of <code>authselect</code>, the <code>pam_pwhistory</code> PAM module\ncan be enabled via authselect feature:\n<pre>authselect enable-feature with-pwhistory</pre>\n\nOtherwise, it should be enabled using an authselect custom profile.\n<br>\n         <br>\nNewer systems also have the <code>/etc/security/pwhistory.conf</code> file for setting\n<code>pam_pwhistory</code> module options. This file should be used whenever available.\nOtherwise, the <code>pam_pwhistory</code> module options can be set in PAM files.\n<br>\n         <br>\nThe value for <code>remember</code> option must be equal or greater than\n24\n        ",
        "rationale": "Preventing re-use of previous passwords helps ensure that a compromised password is not\nre-used by a user.",
        "warnings": [
          {
            "text": "If the system relies on <code>authselect</code> tool to manage PAM settings, the remediation\nwill also use <code>authselect</code> tool. However, if any manual modification was made in\nPAM files, the <code>authselect</code> integrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.",
            "category": "general"
          },
          {
            "text": "Newer versions of <code>authselect</code> contain an authselect feature to easily and properly\nenable <code>pam_pwhistory.so</code> module. If this feature is not yet available in your\nsystem, an authselect custom profile must be used to avoid integrity issues in PAM files.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_pwhistory_remember_system_auth:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_pwhistory_remember_system_auth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n- name: XCCDF Value var_password_pam_remember # promote to variable\n  set_fact:\n    var_password_pam_remember: !!str 24\n  tags:\n    - always\n- name: XCCDF Value var_password_pam_remember_control_flag # promote to variable\n  set_fact:\n    var_password_pam_remember_control_flag: !!str requisite,required\n  tags:\n    - always\n\n- name: 'Limit Password Reuse: system-auth - Check if system relies on authselect\n    tool'\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - Collect the available authselect features'\n  ansible.builtin.command:\n    cmd: authselect list-features sssd\n  register: result_authselect_available_features\n  changed_when: false\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - Enable pam_pwhistory.so using authselect\n    feature'\n  block:\n\n  - name: 'Limit Password Reuse: system-auth - Check integrity of authselect current\n      profile'\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: 'Limit Password Reuse: system-auth - Informative message based on the authselect\n      integrity check result'\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: 'Limit Password Reuse: system-auth - Get authselect current features'\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: 'Limit Password Reuse: system-auth - Ensure \"with-pwhistory\" feature is\n      enabled using authselect tool'\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-pwhistory\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-pwhistory\")\n\n  - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  - result_authselect_available_features.stdout is search(\"with-pwhistory\")\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - Enable pam_pwhistory.so in appropriate\n    PAM files'\n  block:\n\n  - name: 'Limit Password Reuse: system-auth - Define the PAM file to be edited as\n      a local fact'\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/system-auth\n\n  - name: 'Limit Password Reuse: system-auth - Check if system relies on authselect\n      tool'\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: 'Limit Password Reuse: system-auth - Ensure authselect custom profile is\n      used if authselect is present'\n    block:\n\n    - name: 'Limit Password Reuse: system-auth - Check integrity of authselect current\n        profile'\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: 'Limit Password Reuse: system-auth - Informative message based on the\n        authselect integrity check result'\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: 'Limit Password Reuse: system-auth - Get authselect current profile'\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: 'Limit Password Reuse: system-auth - Define the current authselect profile\n        as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Define the new authselect custom\n        profile as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Get authselect current features to\n        also enable them in the custom profile'\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Check if any custom profile with\n        the same name was already created'\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Create an authselect custom profile\n        based on the current profile'\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the authselect custom profile\n        is selected'\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: system-auth - Restore the authselect features in\n        the custom profile'\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: 'Limit Password Reuse: system-auth - Change the PAM file to be edited\n        according to the custom authselect profile'\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: 'Limit Password Reuse: system-auth - Define a fact for control already filtered\n      in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: '{{ var_password_pam_remember_control_flag.split(\",\")[0]\n        }}'\n\n  - name: 'Limit Password Reuse: system-auth - Check if expected PAM module line is\n      present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: 'Limit Password Reuse: system-auth - Include or update the PAM module line\n      in {{ pam_file_path }}'\n    block:\n\n    - name: 'Limit Password Reuse: system-auth - Check if required PAM module line\n        is present in {{ pam_file_path }} with different control'\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the correct control for the\n        required PAM module line in {{ pam_file_path }}'\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the required PAM module line\n        is included in {{ pam_file_path }}'\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        insertafter: ^password.*requisite.*pam_pwquality\\.so\n        line: password    {{ pam_module_control }}    pam_pwhistory.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - |\n    (result_authselect_available_features.stdout is defined and result_authselect_available_features.stdout is not search(\"with-pwhistory\")) or result_authselect_available_features is not defined\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - Check the presence of /etc/security/pwhistory.conf\n    file'\n  ansible.builtin.stat:\n    path: /etc/security/pwhistory.conf\n  register: result_pwhistory_conf_check\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - pam_pwhistory.so parameters are configured\n    in /etc/security/pwhistory.conf file'\n  block:\n\n  - name: 'Limit Password Reuse: system-auth - Ensure the pam_pwhistory.so remember\n      parameter in /etc/security/pwhistory.conf'\n    ansible.builtin.lineinfile:\n      path: /etc/security/pwhistory.conf\n      regexp: ^\\s*remember\\s*=\n      line: remember = {{ var_password_pam_remember }}\n      state: present\n\n  - name: 'Limit Password Reuse: system-auth - Ensure the pam_pwhistory.so remember\n      parameter is removed from PAM files'\n    block:\n\n    - name: 'Limit Password Reuse: system-auth - Check if /etc/pam.d/system-auth file\n        is present'\n      ansible.builtin.stat:\n        path: /etc/pam.d/system-auth\n      register: result_pam_file_present\n\n    - name: 'Limit Password Reuse: system-auth - Check the proper remediation for\n        the system'\n      block:\n\n      - name: 'Limit Password Reuse: system-auth - Define the PAM file to be edited\n          as a local fact'\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/pam.d/system-auth\n\n      - name: 'Limit Password Reuse: system-auth - Check if system relies on authselect\n          tool'\n        ansible.builtin.stat:\n          path: /usr/bin/authselect\n        register: result_authselect_present\n\n      - name: 'Limit Password Reuse: system-auth - Ensure authselect custom profile\n          is used if authselect is present'\n        block:\n\n        - name: 'Limit Password Reuse: system-auth - Check integrity of authselect\n            current profile'\n          ansible.builtin.command:\n            cmd: authselect check\n          register: result_authselect_check_cmd\n          changed_when: false\n          failed_when: false\n\n        - name: 'Limit Password Reuse: system-auth - Informative message based on\n            the authselect integrity check result'\n          ansible.builtin.assert:\n            that:\n            - result_authselect_check_cmd.rc == 0\n            fail_msg:\n            - authselect integrity check failed. Remediation aborted!\n            - This remediation could not be applied because an authselect profile\n              was not selected or the selected profile is not intact.\n            - It is not recommended to manually edit the PAM files when authselect\n              tool is available.\n            - In cases where the default authselect profile does not cover a specific\n              demand, a custom authselect profile is recommended.\n            success_msg:\n            - authselect integrity check passed\n\n        - name: 'Limit Password Reuse: system-auth - Get authselect current profile'\n          ansible.builtin.shell:\n            cmd: authselect current -r | awk '{ print $1 }'\n          register: result_authselect_profile\n          changed_when: false\n          when:\n          - result_authselect_check_cmd is success\n\n        - name: 'Limit Password Reuse: system-auth - Define the current authselect\n            profile as a local fact'\n          ansible.builtin.set_fact:\n            authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n            authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_profile.stdout is match(\"custom/\")\n\n        - name: 'Limit Password Reuse: system-auth - Define the new authselect custom\n            profile as a local fact'\n          ansible.builtin.set_fact:\n            authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n            authselect_custom_profile: custom/hardening\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_profile.stdout is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: system-auth - Get authselect current features\n            to also enable them in the custom profile'\n          ansible.builtin.shell:\n            cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n          register: result_authselect_features\n          changed_when: false\n          when:\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: system-auth - Check if any custom profile with\n            the same name was already created'\n          ansible.builtin.stat:\n            path: /etc/authselect/{{ authselect_custom_profile }}\n          register: result_authselect_custom_profile_present\n          changed_when: false\n          when:\n          - authselect_current_profile is not match(\"custom/\")\n\n        - name: 'Limit Password Reuse: system-auth - Create an authselect custom profile\n            based on the current profile'\n          ansible.builtin.command:\n            cmd: authselect create-profile hardening -b {{ authselect_current_profile\n              }}\n          when:\n          - result_authselect_check_cmd is success\n          - authselect_current_profile is not match(\"custom/\")\n          - not result_authselect_custom_profile_present.stat.exists\n\n        - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are\n            applied'\n          ansible.builtin.command:\n            cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n          - authselect_custom_profile is not match(authselect_current_profile)\n\n        - name: 'Limit Password Reuse: system-auth - Ensure the authselect custom\n            profile is selected'\n          ansible.builtin.command:\n            cmd: authselect select {{ authselect_custom_profile }}\n          register: result_pam_authselect_select_profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - authselect_current_profile is not match(\"custom/\")\n          - authselect_custom_profile is not match(authselect_current_profile)\n\n        - name: 'Limit Password Reuse: system-auth - Restore the authselect features\n            in the custom profile'\n          ansible.builtin.command:\n            cmd: authselect enable-feature {{ item }}\n          loop: '{{ result_authselect_features.stdout_lines }}'\n          register: result_pam_authselect_restore_features\n          when:\n          - result_authselect_profile is not skipped\n          - result_authselect_features is not skipped\n          - result_pam_authselect_select_profile is not skipped\n\n        - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are\n            applied'\n          ansible.builtin.command:\n            cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n          when:\n          - result_authselect_check_cmd is success\n          - result_authselect_profile is not skipped\n          - result_pam_authselect_restore_features is not skipped\n\n        - name: 'Limit Password Reuse: system-auth - Change the PAM file to be edited\n            according to the custom authselect profile'\n          ansible.builtin.set_fact:\n            pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n              | basename }}\n        when:\n        - result_authselect_present.stat.exists\n\n      - name: 'Limit Password Reuse: system-auth - Define a fact for control already\n          filtered in case filters are used'\n        ansible.builtin.set_fact:\n          pam_module_control: ''\n\n      - name: 'Limit Password Reuse: system-auth - Ensure the \"remember\" option from\n          \"pam_pwhistory.so\" is not present in {{ pam_file_path }}'\n        ansible.builtin.replace:\n          dest: '{{ pam_file_path }}'\n          regexp: (.*password.*pam_pwhistory.so.*)\\bremember\\b=?[0-9a-zA-Z]*(.*)\n          replace: \\1\\2\n        register: result_pam_option_removal\n\n      - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b\n        when:\n        - result_authselect_present.stat.exists\n        - result_pam_option_removal is changed\n      when:\n      - result_pam_file_present.stat.exists\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pwhistory_conf_check.stat.exists\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: 'Limit Password Reuse: system-auth - pam_pwhistory.so parameters are configured\n    in PAM files'\n  block:\n\n  - name: 'Limit Password Reuse: system-auth - Define the PAM file to be edited as\n      a local fact'\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/system-auth\n\n  - name: 'Limit Password Reuse: system-auth - Check if system relies on authselect\n      tool'\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: 'Limit Password Reuse: system-auth - Ensure authselect custom profile is\n      used if authselect is present'\n    block:\n\n    - name: 'Limit Password Reuse: system-auth - Check integrity of authselect current\n        profile'\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: 'Limit Password Reuse: system-auth - Informative message based on the\n        authselect integrity check result'\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: 'Limit Password Reuse: system-auth - Get authselect current profile'\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: 'Limit Password Reuse: system-auth - Define the current authselect profile\n        as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Define the new authselect custom\n        profile as a local fact'\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Get authselect current features to\n        also enable them in the custom profile'\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Check if any custom profile with\n        the same name was already created'\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: 'Limit Password Reuse: system-auth - Create an authselect custom profile\n        based on the current profile'\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the authselect custom profile\n        is selected'\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: 'Limit Password Reuse: system-auth - Restore the authselect features in\n        the custom profile'\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: 'Limit Password Reuse: system-auth - Change the PAM file to be edited\n        according to the custom authselect profile'\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: 'Limit Password Reuse: system-auth - Define a fact for control already filtered\n      in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: requisite\n\n  - name: 'Limit Password Reuse: system-auth - Check if expected PAM module line is\n      present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: 'Limit Password Reuse: system-auth - Include or update the PAM module line\n      in {{ pam_file_path }}'\n    block:\n\n    - name: 'Limit Password Reuse: system-auth - Check if required PAM module line\n        is present in {{ pam_file_path }} with different control'\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the correct control for the\n        required PAM module line in {{ pam_file_path }}'\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: 'Limit Password Reuse: system-auth - Ensure the required PAM module line\n        is included in {{ pam_file_path }}'\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        line: password    {{ pam_module_control }}    pam_pwhistory.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n\n  - name: 'Limit Password Reuse: system-auth - Define a fact for control already filtered\n      in case filters are used'\n    ansible.builtin.set_fact:\n      pam_module_control: requisite\n\n  - name: 'Limit Password Reuse: system-auth - Check if the required PAM module option\n      is present in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s*.*\\sremember\\b\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_module_accounts_password_pam_pwhistory_remember_system_auth_option_present\n\n  - name: 'Limit Password Reuse: system-auth - Ensure the \"remember\" PAM option for\n      \"pam_pwhistory.so\" is included in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so.*)\n      line: \\1 remember={{ var_password_pam_remember }}\n      state: present\n    register: result_pam_accounts_password_pam_pwhistory_remember_system_auth_add\n    when:\n    - result_pam_module_accounts_password_pam_pwhistory_remember_system_auth_option_present.found\n      == 0\n\n  - name: 'Limit Password Reuse: system-auth - Ensure the required value for \"remember\"\n      PAM option from \"pam_pwhistory.so\" in {{ pam_file_path }}'\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_pwhistory.so\\s+.*)(remember)=[0-9a-zA-Z]+\\s*(.*)\n      line: \\1\\2={{ var_password_pam_remember }} \\3\n    register: result_pam_accounts_password_pam_pwhistory_remember_system_auth_edit\n    when:\n    - result_pam_module_accounts_password_pam_pwhistory_remember_system_auth_option_present.found\n      > 0\n\n  - name: 'Limit Password Reuse: system-auth - Ensure authselect changes are applied'\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - (result_pam_remember_add is defined and result_pam_remember_add.changed) or\n      (result_pam_remember_edit is defined and result_pam_remember_edit.changed)\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_pwhistory_conf_check.stat.exists\n  tags:\n  - CCE-83480-4\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020221\n  - NIST-800-171-3.5.8\n  - NIST-800-53-IA-5(1)(e)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.5\n  - PCI-DSSv4-8.3.7\n  - accounts_password_pam_pwhistory_remember_system_auth\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "accounts_password_pam_pwhistory_remember_system_auth",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_remember='24'\nvar_password_pam_remember_control_flag='requisite,required'\n\n\nvar_password_pam_remember_control_flag=\"$(echo $var_password_pam_remember_control_flag | cut -d \\, -f 1)\"\n\nif [ -f /usr/bin/authselect ]; then\n    if authselect list-features sssd | grep -q with-pwhistory; then\n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n        authselect enable-feature with-pwhistory\n\n        authselect apply-changes -b\n    else\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/system-auth\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n        if ! grep -qP \"^\\s*password\\s+$var_password_pam_remember_control_flag\\s+pam_pwhistory.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n            # Line matching group + control + module was not found. Check group + module.\n            if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n                # The control is updated only if one single line matches.\n                sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1$var_password_pam_remember_control_flag \\2/\" \"$PAM_FILE_PATH\"\n            else\n                LAST_MATCH_LINE=$(grep -nP \"^password.*requisite.*pam_pwquality\\.so\" \"$PAM_FILE_PATH\" | tail -n 1 | cut -d: -f 1)\n                if [ ! -z $LAST_MATCH_LINE ]; then\n                    sed -i --follow-symlinks $LAST_MATCH_LINE\" a password     $var_password_pam_remember_control_flag    pam_pwhistory.so\" \"$PAM_FILE_PATH\"\n                else\n                    echo \"password    $var_password_pam_remember_control_flag    pam_pwhistory.so\" >> \"$PAM_FILE_PATH\"\n                fi\n            fi\n        fi\n    fi\nelse\n    if ! grep -qP \"^\\s*password\\s+$var_password_pam_remember_control_flag\\s+pam_pwhistory.so\\s*.*\" \"/etc/pam.d/system-auth\"; then\n        # Line matching group + control + module was not found. Check group + module.\n        if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"/etc/pam.d/system-auth\")\" -eq 1 ]; then\n            # The control is updated only if one single line matches.\n            sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1$var_password_pam_remember_control_flag \\2/\" \"/etc/pam.d/system-auth\"\n        else\n            LAST_MATCH_LINE=$(grep -nP \"^password.*requisite.*pam_pwquality\\.so\" \"/etc/pam.d/system-auth\" | tail -n 1 | cut -d: -f 1)\n            if [ ! -z $LAST_MATCH_LINE ]; then\n                sed -i --follow-symlinks $LAST_MATCH_LINE\" a password     $var_password_pam_remember_control_flag    pam_pwhistory.so\" \"/etc/pam.d/system-auth\"\n            else\n                echo \"password    $var_password_pam_remember_control_flag    pam_pwhistory.so\" >> \"/etc/pam.d/system-auth\"\n            fi\n        fi\n    fi\nfi\n\nPWHISTORY_CONF=\"/etc/security/pwhistory.conf\"\nif [ -f $PWHISTORY_CONF ]; then\n    regex=\"^\\s*remember\\s*=\"\n    line=\"remember = $var_password_pam_remember\"\n    if ! grep -q $regex $PWHISTORY_CONF; then\n        echo $line >> $PWHISTORY_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(remember\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_password_pam_remember\"'|g' $PWHISTORY_CONF\n    fi\n    if [ -e \"/etc/pam.d/system-auth\" ] ; then\n        PAM_FILE_PATH=\"/etc/pam.d/system-auth\"\n        if [ -f /usr/bin/authselect ]; then\n            \n            if ! authselect check; then\n            echo \"\n            authselect integrity check failed. Remediation aborted!\n            This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n            It is not recommended to manually edit the PAM files when authselect tool is available.\n            In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n            exit 1\n            fi\n\n            CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n            # If not already in use, a custom profile is created preserving the enabled features.\n            if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                authselect create-profile hardening -b $CURRENT_PROFILE\n                CURRENT_PROFILE=\"custom/hardening\"\n                \n                authselect apply-changes -b --backup=before-hardening-custom-profile\n                authselect select $CURRENT_PROFILE\n                for feature in $ENABLED_FEATURES; do\n                    authselect enable-feature $feature;\n                done\n                \n                authselect apply-changes -b --backup=after-hardening-custom-profile\n            fi\n            PAM_FILE_NAME=$(basename \"/etc/pam.d/system-auth\")\n            PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n            authselect apply-changes -b\n        fi\n        \n    if grep -qP \"^\\s*password\\s.*\\bpam_pwhistory.so\\s.*\\bremember\\b\" \"$PAM_FILE_PATH\"; then\n        sed -i -E --follow-symlinks \"s/(.*password.*pam_pwhistory.so.*)\\bremember\\b=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\n    fi\n        if [ -f /usr/bin/authselect ]; then\n            \n            authselect apply-changes -b\n        fi\n    else\n        echo \"/etc/pam.d/system-auth was not found\" >&2\n    fi\nelse\n    PAM_FILE_PATH=\"/etc/pam.d/system-auth\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/system-auth\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    if ! grep -qP \"^\\s*password\\s+requisite\\s+pam_pwhistory.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n        # Line matching group + control + module was not found. Check group + module.\n        if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_pwhistory.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n            # The control is updated only if one single line matches.\n            sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_pwhistory.so.*)/\\1requisite \\2/\" \"$PAM_FILE_PATH\"\n        else\n            echo \"password    requisite    pam_pwhistory.so\" >> \"$PAM_FILE_PATH\"\n        fi\n    fi\n    # Check the option\n    if ! grep -qP \"^\\s*password\\s+requisite\\s+pam_pwhistory.so\\s*.*\\sremember\\b\" \"$PAM_FILE_PATH\"; then\n        sed -i -E --follow-symlinks \"/\\s*password\\s+requisite\\s+pam_pwhistory.so.*/ s/$/ remember=$var_password_pam_remember/\" \"$PAM_FILE_PATH\"\n    else\n        sed -i -E --follow-symlinks \"s/(\\s*password\\s+requisite\\s+pam_pwhistory.so\\s+.*)(remember=)[[:alnum:]]+\\s*(.*)/\\1\\2$var_password_pam_remember \\3/\" \"$PAM_FILE_PATH\"\n    fi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-251717",
        "stig_id": "RHEL-08-020221"
      },
      "xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny",
        "title": "Lock Accounts After Failed Password Attempts",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80667-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R31"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.3"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000044",
              "CCI-002236",
              "CCI-002237",
              "CCI-002238"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-7(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000021-GPOS-00005",
              "SRG-OS-000329-GPOS-00128"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_AFL.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.6"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.4"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020011"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230333r743966_rule"
            ]
          }
        ],
        "description": "This rule configures the system to lock out accounts after a number of incorrect login attempts\nusing <code>pam_faillock.so</code>.\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected.\nEnsure that the file <code>/etc/security/faillock.conf</code> contains the following entry:\n<code>deny = &lt;count&gt;</code>\nWhere count should be less than or equal to\n5 and greater than 0.\n\nIn order to avoid errors when manually editing these files, it is\nrecommended to use the appropriate tools, such as <code>authselect</code> or <code>authconfig</code>,\ndepending on the OS version.",
        "rationale": "By limiting the number of failed logon attempts, the risk of unauthorized system access via\nuser password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking\nthe account.",
        "warnings": [
          {
            "text": "If the system relies on <code>authselect</code> tool to manage PAM settings, the remediation\nwill also use <code>authselect</code> tool. However, if any manual modification was made in\nPAM files, the <code>authselect</code> integrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nIf the system supports the <code>/etc/security/faillock.conf</code> file, the pam_faillock\nparameters should be defined in <code>faillock.conf</code> file.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_passwords_pam_faillock_deny:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_passwords_pam_faillock_deny",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Check if system relies on authselect\n    tool\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Remediation where authselect\n    tool is present\n  block:\n\n  - name: Lock Accounts After Failed Password Attempts - Check integrity of authselect\n      current profile\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: Lock Accounts After Failed Password Attempts - Informative message based\n      on the authselect integrity check result\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: Lock Accounts After Failed Password Attempts - Get authselect current features\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure \"with-faillock\" feature\n      is enabled using authselect tool\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-faillock\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-faillock\")\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n      are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Remediation where authselect\n    tool is not present\n  block:\n\n  - name: Lock Accounts After Failed Password Attempts - Check if pam_faillock.so\n      is already enabled\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail)\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_is_enabled\n\n  - name: Lock Accounts After Failed Password Attempts - Enable pam_faillock.so preauth\n      editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so preauth\n      insertbefore: ^auth.*sufficient.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Lock Accounts After Failed Password Attempts - Enable pam_faillock.so authfail\n      editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so authfail\n      insertbefore: ^auth.*required.*pam_deny\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Lock Accounts After Failed Password Attempts - Enable pam_faillock.so account\n      section editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: account     required      pam_faillock.so\n      insertbefore: ^account.*required.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_authselect_present.stat.exists\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_passwords_pam_faillock_deny # promote to variable\n  set_fact:\n    var_accounts_passwords_pam_faillock_deny: !!str 5\n  tags:\n    - always\n\n- name: Lock Accounts After Failed Password Attempts - Check the presence of /etc/security/faillock.conf\n    file\n  ansible.builtin.stat:\n    path: /etc/security/faillock.conf\n  register: result_faillock_conf_check\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Ensure the pam_faillock.so\n    deny parameter in /etc/security/faillock.conf\n  ansible.builtin.lineinfile:\n    path: /etc/security/faillock.conf\n    regexp: ^\\s*deny\\s*=\n    line: deny = {{ var_accounts_passwords_pam_faillock_deny }}\n    state: present\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Ensure the pam_faillock.so\n    deny parameter not in PAM files\n  block:\n\n  - name: Lock Accounts After Failed Password Attempts - Check if /etc/pam.d/system-auth\n      file is present\n    ansible.builtin.stat:\n      path: /etc/pam.d/system-auth\n    register: result_pam_file_present\n\n  - name: Lock Accounts After Failed Password Attempts - Check the proper remediation\n      for the system\n    block:\n\n    - name: Lock Accounts After Failed Password Attempts - Define the PAM file to\n        be edited as a local fact\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/pam.d/system-auth\n\n    - name: Lock Accounts After Failed Password Attempts - Check if system relies\n        on authselect tool\n      ansible.builtin.stat:\n        path: /usr/bin/authselect\n      register: result_authselect_present\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure authselect custom\n        profile is used if authselect is present\n      block:\n\n      - name: Lock Accounts After Failed Password Attempts - Check integrity of authselect\n          current profile\n        ansible.builtin.command:\n          cmd: authselect check\n        register: result_authselect_check_cmd\n        changed_when: false\n        failed_when: false\n\n      - name: Lock Accounts After Failed Password Attempts - Informative message based\n          on the authselect integrity check result\n        ansible.builtin.assert:\n          that:\n          - result_authselect_check_cmd.rc == 0\n          fail_msg:\n          - authselect integrity check failed. Remediation aborted!\n          - This remediation could not be applied because an authselect profile was\n            not selected or the selected profile is not intact.\n          - It is not recommended to manually edit the PAM files when authselect tool\n            is available.\n          - In cases where the default authselect profile does not cover a specific\n            demand, a custom authselect profile is recommended.\n          success_msg:\n          - authselect integrity check passed\n\n      - name: Lock Accounts After Failed Password Attempts - Get authselect current\n          profile\n        ansible.builtin.shell:\n          cmd: authselect current -r | awk '{ print $1 }'\n        register: result_authselect_profile\n        changed_when: false\n        when:\n        - result_authselect_check_cmd is success\n\n      - name: Lock Accounts After Failed Password Attempts - Define the current authselect\n          profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Define the new authselect\n          custom profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: custom/hardening\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Get authselect current\n          features to also enable them in the custom profile\n        ansible.builtin.shell:\n          cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n        register: result_authselect_features\n        changed_when: false\n        when:\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Check if any custom profile\n          with the same name was already created\n        ansible.builtin.stat:\n          path: /etc/authselect/{{ authselect_custom_profile }}\n        register: result_authselect_custom_profile_present\n        changed_when: false\n        when:\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Create an authselect\n          custom profile based on the current profile\n        ansible.builtin.command:\n          cmd: authselect create-profile hardening -b {{ authselect_current_profile\n            }}\n        when:\n        - result_authselect_check_cmd is success\n        - authselect_current_profile is not match(\"custom/\")\n        - not result_authselect_custom_profile_present.stat.exists\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure the authselect\n          custom profile is selected\n        ansible.builtin.command:\n          cmd: authselect select {{ authselect_custom_profile }}\n        register: result_pam_authselect_select_profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Lock Accounts After Failed Password Attempts - Restore the authselect\n          features in the custom profile\n        ansible.builtin.command:\n          cmd: authselect enable-feature {{ item }}\n        loop: '{{ result_authselect_features.stdout_lines }}'\n        register: result_pam_authselect_restore_features\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_features is not skipped\n        - result_pam_authselect_select_profile is not skipped\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - result_pam_authselect_restore_features is not skipped\n\n      - name: Lock Accounts After Failed Password Attempts - Change the PAM file to\n          be edited according to the custom authselect profile\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n            | basename }}\n      when:\n      - result_authselect_present.stat.exists\n\n    - name: Lock Accounts After Failed Password Attempts - Define a fact for control\n        already filtered in case filters are used\n      ansible.builtin.set_fact:\n        pam_module_control: ''\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure the \"deny\" option\n        from \"pam_faillock.so\" is not present in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: (.*auth.*pam_faillock.so.*)\\bdeny\\b=?[0-9a-zA-Z]*(.*)\n        replace: \\1\\2\n      register: result_pam_option_removal\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n        are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present.stat.exists\n      - result_pam_option_removal is changed\n    when:\n    - result_pam_file_present.stat.exists\n\n  - name: Lock Accounts After Failed Password Attempts - Check if /etc/pam.d/password-auth\n      file is present\n    ansible.builtin.stat:\n      path: /etc/pam.d/password-auth\n    register: result_pam_file_present\n\n  - name: Lock Accounts After Failed Password Attempts - Check the proper remediation\n      for the system\n    block:\n\n    - name: Lock Accounts After Failed Password Attempts - Define the PAM file to\n        be edited as a local fact\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/pam.d/password-auth\n\n    - name: Lock Accounts After Failed Password Attempts - Check if system relies\n        on authselect tool\n      ansible.builtin.stat:\n        path: /usr/bin/authselect\n      register: result_authselect_present\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure authselect custom\n        profile is used if authselect is present\n      block:\n\n      - name: Lock Accounts After Failed Password Attempts - Check integrity of authselect\n          current profile\n        ansible.builtin.command:\n          cmd: authselect check\n        register: result_authselect_check_cmd\n        changed_when: false\n        failed_when: false\n\n      - name: Lock Accounts After Failed Password Attempts - Informative message based\n          on the authselect integrity check result\n        ansible.builtin.assert:\n          that:\n          - result_authselect_check_cmd.rc == 0\n          fail_msg:\n          - authselect integrity check failed. Remediation aborted!\n          - This remediation could not be applied because an authselect profile was\n            not selected or the selected profile is not intact.\n          - It is not recommended to manually edit the PAM files when authselect tool\n            is available.\n          - In cases where the default authselect profile does not cover a specific\n            demand, a custom authselect profile is recommended.\n          success_msg:\n          - authselect integrity check passed\n\n      - name: Lock Accounts After Failed Password Attempts - Get authselect current\n          profile\n        ansible.builtin.shell:\n          cmd: authselect current -r | awk '{ print $1 }'\n        register: result_authselect_profile\n        changed_when: false\n        when:\n        - result_authselect_check_cmd is success\n\n      - name: Lock Accounts After Failed Password Attempts - Define the current authselect\n          profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Define the new authselect\n          custom profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: custom/hardening\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Get authselect current\n          features to also enable them in the custom profile\n        ansible.builtin.shell:\n          cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n        register: result_authselect_features\n        changed_when: false\n        when:\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Check if any custom profile\n          with the same name was already created\n        ansible.builtin.stat:\n          path: /etc/authselect/{{ authselect_custom_profile }}\n        register: result_authselect_custom_profile_present\n        changed_when: false\n        when:\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Lock Accounts After Failed Password Attempts - Create an authselect\n          custom profile based on the current profile\n        ansible.builtin.command:\n          cmd: authselect create-profile hardening -b {{ authselect_current_profile\n            }}\n        when:\n        - result_authselect_check_cmd is success\n        - authselect_current_profile is not match(\"custom/\")\n        - not result_authselect_custom_profile_present.stat.exists\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure the authselect\n          custom profile is selected\n        ansible.builtin.command:\n          cmd: authselect select {{ authselect_custom_profile }}\n        register: result_pam_authselect_select_profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Lock Accounts After Failed Password Attempts - Restore the authselect\n          features in the custom profile\n        ansible.builtin.command:\n          cmd: authselect enable-feature {{ item }}\n        loop: '{{ result_authselect_features.stdout_lines }}'\n        register: result_pam_authselect_restore_features\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_features is not skipped\n        - result_pam_authselect_select_profile is not skipped\n\n      - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - result_pam_authselect_restore_features is not skipped\n\n      - name: Lock Accounts After Failed Password Attempts - Change the PAM file to\n          be edited according to the custom authselect profile\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n            | basename }}\n      when:\n      - result_authselect_present.stat.exists\n\n    - name: Lock Accounts After Failed Password Attempts - Define a fact for control\n        already filtered in case filters are used\n      ansible.builtin.set_fact:\n        pam_module_control: ''\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure the \"deny\" option\n        from \"pam_faillock.so\" is not present in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: (.*auth.*pam_faillock.so.*)\\bdeny\\b=?[0-9a-zA-Z]*(.*)\n        replace: \\1\\2\n      register: result_pam_option_removal\n\n    - name: Lock Accounts After Failed Password Attempts - Ensure authselect changes\n        are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present.stat.exists\n      - result_pam_option_removal is changed\n    when:\n    - result_pam_file_present.stat.exists\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock Accounts After Failed Password Attempts - Ensure the pam_faillock.so\n    deny parameter in PAM files\n  block:\n\n  - name: Lock Accounts After Failed Password Attempts - Check if pam_faillock.so\n      deny parameter is already enabled in pam files\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail).*deny\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_deny_parameter_is_present\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure the inclusion of pam_faillock.so\n      preauth deny parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so preauth.*)\n      line: \\1required\\3 deny={{ var_accounts_passwords_pam_faillock_deny }}\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_deny_parameter_is_present.found == 0\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure the inclusion of pam_faillock.so\n      authfail deny parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so authfail.*)\n      line: \\1required\\3 deny={{ var_accounts_passwords_pam_faillock_deny }}\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_deny_parameter_is_present.found == 0\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure the desired value\n      for pam_faillock.so preauth deny parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so preauth.*)(deny)=[0-9]+(.*)\n      line: \\1required\\3\\4={{ var_accounts_passwords_pam_faillock_deny }}\\5\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_deny_parameter_is_present.found > 0\n\n  - name: Lock Accounts After Failed Password Attempts - Ensure the desired value\n      for pam_faillock.so authfail deny parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so authfail.*)(deny)=[0-9]+(.*)\n      line: \\1required\\3\\4={{ var_accounts_passwords_pam_faillock_deny }}\\5\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_deny_parameter_is_present.found > 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80667-9\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020011\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.6\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_deny\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_passwords_pam_faillock_deny",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_accounts_passwords_pam_faillock_deny='5'\n\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\nfor pam_file in \"${AUTH_FILES[@]}\"\ndo\n    if ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+(preauth silent|authfail).*$' \"$pam_file\" ; then\n        sed -i --follow-symlinks '/^auth.*sufficient.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth silent' \"$pam_file\"\n        sed -i --follow-symlinks '/^auth.*required.*pam_deny\\.so.*/i auth        required      pam_faillock.so authfail' \"$pam_file\"\n        sed -i --follow-symlinks '/^account.*required.*pam_unix\\.so.*/i account     required      pam_faillock.so' \"$pam_file\"\n    fi\n    sed -Ei 's/(auth.*)(\\[default=die\\])(.*pam_faillock\\.so)/\\1required     \\3/g' \"$pam_file\"\ndone\n\nfi\n\nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\n\nFAILLOCK_CONF=\"/etc/security/faillock.conf\"\nif [ -f $FAILLOCK_CONF ]; then\n    regex=\"^\\s*deny\\s*=\"\n    line=\"deny = $var_accounts_passwords_pam_faillock_deny\"\n    if ! grep -q $regex $FAILLOCK_CONF; then\n        echo $line >> $FAILLOCK_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(deny\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_accounts_passwords_pam_faillock_deny\"'|g' $FAILLOCK_CONF\n    fi\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if [ -e \"$pam_file\" ] ; then\n            PAM_FILE_PATH=\"$pam_file\"\n            if [ -f /usr/bin/authselect ]; then\n                \n                if ! authselect check; then\n                echo \"\n                authselect integrity check failed. Remediation aborted!\n                This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n                It is not recommended to manually edit the PAM files when authselect tool is available.\n                In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n                exit 1\n                fi\n\n                CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n                # If not already in use, a custom profile is created preserving the enabled features.\n                if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                    ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                    authselect create-profile hardening -b $CURRENT_PROFILE\n                    CURRENT_PROFILE=\"custom/hardening\"\n                    \n                    authselect apply-changes -b --backup=before-hardening-custom-profile\n                    authselect select $CURRENT_PROFILE\n                    for feature in $ENABLED_FEATURES; do\n                        authselect enable-feature $feature;\n                    done\n                    \n                    authselect apply-changes -b --backup=after-hardening-custom-profile\n                fi\n                PAM_FILE_NAME=$(basename \"$pam_file\")\n                PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n                authselect apply-changes -b\n            fi\n            \n        if grep -qP \"^\\s*auth\\s.*\\bpam_faillock.so\\s.*\\bdeny\\b\" \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks \"s/(.*auth.*pam_faillock.so.*)\\bdeny\\b=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\n        fi\n            if [ -f /usr/bin/authselect ]; then\n                \n                authselect apply-changes -b\n            fi\n        else\n            echo \"$pam_file was not found\" >&2\n        fi\n    done\nelse\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if ! grep -qE '^\\s*auth.*pam_faillock\\.so (preauth|authfail).*deny' \"$pam_file\"; then\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*preauth.*silent.*/ s/$/ deny='\"$var_accounts_passwords_pam_faillock_deny\"'/' \"$pam_file\"\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*authfail.*/ s/$/ deny='\"$var_accounts_passwords_pam_faillock_deny\"'/' \"$pam_file\"\n        else\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*preauth.*silent.*\\)\\('\"deny\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_deny\"'\\3/' \"$pam_file\"\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*authfail.*\\)\\('\"deny\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_deny\"'\\3/' \"$pam_file\"\n        fi\n    done\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230333",
        "stig_id": "RHEL-08-020011"
      },
      "xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time",
        "title": "Set Lockout Time for Failed Password Attempts",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80670-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R31"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.3"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000044",
              "CCI-002236",
              "CCI-002237",
              "CCI-002238"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-7(b)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000021-GPOS-00005",
              "SRG-OS-000329-GPOS-00128"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_AFL.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.4"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020014",
              "RHEL-08-020015"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230336r627750_rule",
              "SV-230337r743972_rule"
            ]
          }
        ],
        "description": "This rule configures the system to lock out accounts during a specified time period after a\nnumber of incorrect login attempts using <code>pam_faillock.so</code>.\n\nEnsure that the file <code>/etc/security/faillock.conf</code> contains the following entry:\n<code>unlock_time=&lt;interval-in-seconds&gt;</code> where\n<code>interval-in-seconds</code> is <code>900</code> or greater.\n\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected. In order to avoid any errors when manually editing these files,\nit is recommended to use the appropriate tools, such as <code>authselect</code> or <code>authconfig</code>,\ndepending on the OS version.\n\nIf <code>unlock_time</code> is set to <code>0</code>, manual intervention by an administrator is required\nto unlock a user. This should be done using the <code>faillock</code> tool.",
        "rationale": "By limiting the number of failed logon attempts the risk of unauthorized system\naccess via user password guessing, otherwise known as brute-forcing, is reduced.\nLimits are imposed by locking the account.",
        "warnings": [
          {
            "text": "If the system supports the new <code>/etc/security/faillock.conf</code> file but the\npam_faillock.so parameters are defined directly in <code>/etc/pam.d/system-auth</code> and\n<code>/etc/pam.d/password-auth</code>, the remediation will migrate the <code>unlock_time</code> parameter\nto <code>/etc/security/faillock.conf</code> to ensure compatibility with <code>authselect</code> tool.\nThe parameters <code>deny</code> and <code>fail_interval</code>, if used, also have to be migrated\nby their respective remediation.",
            "category": "general"
          },
          {
            "text": "If the system relies on <code>authselect</code> tool to manage PAM settings, the remediation\nwill also use <code>authselect</code> tool. However, if any manual modification was made in\nPAM files, the <code>authselect</code> integrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nIf the system supports the <code>/etc/security/faillock.conf</code> file, the pam_faillock\nparameters should be defined in <code>faillock.conf</code> file.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_passwords_pam_faillock_unlock_time:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_passwords_pam_faillock_unlock_time",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Check if system relies on\n    authselect tool\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Remediation where authselect\n    tool is present\n  block:\n\n  - name: Set Lockout Time for Failed Password Attempts - Check integrity of authselect\n      current profile\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: Set Lockout Time for Failed Password Attempts - Informative message based\n      on the authselect integrity check result\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: Set Lockout Time for Failed Password Attempts - Get authselect current features\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure \"with-faillock\" feature\n      is enabled using authselect tool\n    ansible.builtin.command:\n      cmd: authselect enable-feature with-faillock\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"with-faillock\")\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n      are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_authselect_present.stat.exists\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Remediation where authselect\n    tool is not present\n  block:\n\n  - name: Set Lockout Time for Failed Password Attempts - Check if pam_faillock.so\n      is already enabled\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail)\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_is_enabled\n\n  - name: Set Lockout Time for Failed Password Attempts - Enable pam_faillock.so preauth\n      editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so preauth\n      insertbefore: ^auth.*sufficient.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Set Lockout Time for Failed Password Attempts - Enable pam_faillock.so authfail\n      editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: auth        required      pam_faillock.so authfail\n      insertbefore: ^auth.*required.*pam_deny\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n\n  - name: Set Lockout Time for Failed Password Attempts - Enable pam_faillock.so account\n      section editing PAM files\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      line: account     required      pam_faillock.so\n      insertbefore: ^account.*required.*pam_unix\\.so.*\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_is_enabled.found == 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_authselect_present.stat.exists\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_passwords_pam_faillock_unlock_time # promote to variable\n  set_fact:\n    var_accounts_passwords_pam_faillock_unlock_time: !!str 900\n  tags:\n    - always\n\n- name: Set Lockout Time for Failed Password Attempts - Check the presence of /etc/security/faillock.conf\n    file\n  ansible.builtin.stat:\n    path: /etc/security/faillock.conf\n  register: result_faillock_conf_check\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Ensure the pam_faillock.so\n    unlock_time parameter in /etc/security/faillock.conf\n  ansible.builtin.lineinfile:\n    path: /etc/security/faillock.conf\n    regexp: ^\\s*unlock_time\\s*=\n    line: unlock_time = {{ var_accounts_passwords_pam_faillock_unlock_time }}\n    state: present\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Ensure the pam_faillock.so\n    unlock_time parameter not in PAM files\n  block:\n\n  - name: Set Lockout Time for Failed Password Attempts - Check if /etc/pam.d/system-auth\n      file is present\n    ansible.builtin.stat:\n      path: /etc/pam.d/system-auth\n    register: result_pam_file_present\n\n  - name: Set Lockout Time for Failed Password Attempts - Check the proper remediation\n      for the system\n    block:\n\n    - name: Set Lockout Time for Failed Password Attempts - Define the PAM file to\n        be edited as a local fact\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/pam.d/system-auth\n\n    - name: Set Lockout Time for Failed Password Attempts - Check if system relies\n        on authselect tool\n      ansible.builtin.stat:\n        path: /usr/bin/authselect\n      register: result_authselect_present\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure authselect custom\n        profile is used if authselect is present\n      block:\n\n      - name: Set Lockout Time for Failed Password Attempts - Check integrity of authselect\n          current profile\n        ansible.builtin.command:\n          cmd: authselect check\n        register: result_authselect_check_cmd\n        changed_when: false\n        failed_when: false\n\n      - name: Set Lockout Time for Failed Password Attempts - Informative message\n          based on the authselect integrity check result\n        ansible.builtin.assert:\n          that:\n          - result_authselect_check_cmd.rc == 0\n          fail_msg:\n          - authselect integrity check failed. Remediation aborted!\n          - This remediation could not be applied because an authselect profile was\n            not selected or the selected profile is not intact.\n          - It is not recommended to manually edit the PAM files when authselect tool\n            is available.\n          - In cases where the default authselect profile does not cover a specific\n            demand, a custom authselect profile is recommended.\n          success_msg:\n          - authselect integrity check passed\n\n      - name: Set Lockout Time for Failed Password Attempts - Get authselect current\n          profile\n        ansible.builtin.shell:\n          cmd: authselect current -r | awk '{ print $1 }'\n        register: result_authselect_profile\n        changed_when: false\n        when:\n        - result_authselect_check_cmd is success\n\n      - name: Set Lockout Time for Failed Password Attempts - Define the current authselect\n          profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Define the new authselect\n          custom profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: custom/hardening\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Get authselect current\n          features to also enable them in the custom profile\n        ansible.builtin.shell:\n          cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n        register: result_authselect_features\n        changed_when: false\n        when:\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Check if any custom\n          profile with the same name was already created\n        ansible.builtin.stat:\n          path: /etc/authselect/{{ authselect_custom_profile }}\n        register: result_authselect_custom_profile_present\n        changed_when: false\n        when:\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Create an authselect\n          custom profile based on the current profile\n        ansible.builtin.command:\n          cmd: authselect create-profile hardening -b {{ authselect_current_profile\n            }}\n        when:\n        - result_authselect_check_cmd is success\n        - authselect_current_profile is not match(\"custom/\")\n        - not result_authselect_custom_profile_present.stat.exists\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure the authselect\n          custom profile is selected\n        ansible.builtin.command:\n          cmd: authselect select {{ authselect_custom_profile }}\n        register: result_pam_authselect_select_profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Set Lockout Time for Failed Password Attempts - Restore the authselect\n          features in the custom profile\n        ansible.builtin.command:\n          cmd: authselect enable-feature {{ item }}\n        loop: '{{ result_authselect_features.stdout_lines }}'\n        register: result_pam_authselect_restore_features\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_features is not skipped\n        - result_pam_authselect_select_profile is not skipped\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - result_pam_authselect_restore_features is not skipped\n\n      - name: Set Lockout Time for Failed Password Attempts - Change the PAM file\n          to be edited according to the custom authselect profile\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n            | basename }}\n      when:\n      - result_authselect_present.stat.exists\n\n    - name: Set Lockout Time for Failed Password Attempts - Define a fact for control\n        already filtered in case filters are used\n      ansible.builtin.set_fact:\n        pam_module_control: ''\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure the \"unlock_time\"\n        option from \"pam_faillock.so\" is not present in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: (.*auth.*pam_faillock.so.*)\\bunlock_time\\b=?[0-9a-zA-Z]*(.*)\n        replace: \\1\\2\n      register: result_pam_option_removal\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n        are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present.stat.exists\n      - result_pam_option_removal is changed\n    when:\n    - result_pam_file_present.stat.exists\n\n  - name: Set Lockout Time for Failed Password Attempts - Check if /etc/pam.d/password-auth\n      file is present\n    ansible.builtin.stat:\n      path: /etc/pam.d/password-auth\n    register: result_pam_file_present\n\n  - name: Set Lockout Time for Failed Password Attempts - Check the proper remediation\n      for the system\n    block:\n\n    - name: Set Lockout Time for Failed Password Attempts - Define the PAM file to\n        be edited as a local fact\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/pam.d/password-auth\n\n    - name: Set Lockout Time for Failed Password Attempts - Check if system relies\n        on authselect tool\n      ansible.builtin.stat:\n        path: /usr/bin/authselect\n      register: result_authselect_present\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure authselect custom\n        profile is used if authselect is present\n      block:\n\n      - name: Set Lockout Time for Failed Password Attempts - Check integrity of authselect\n          current profile\n        ansible.builtin.command:\n          cmd: authselect check\n        register: result_authselect_check_cmd\n        changed_when: false\n        failed_when: false\n\n      - name: Set Lockout Time for Failed Password Attempts - Informative message\n          based on the authselect integrity check result\n        ansible.builtin.assert:\n          that:\n          - result_authselect_check_cmd.rc == 0\n          fail_msg:\n          - authselect integrity check failed. Remediation aborted!\n          - This remediation could not be applied because an authselect profile was\n            not selected or the selected profile is not intact.\n          - It is not recommended to manually edit the PAM files when authselect tool\n            is available.\n          - In cases where the default authselect profile does not cover a specific\n            demand, a custom authselect profile is recommended.\n          success_msg:\n          - authselect integrity check passed\n\n      - name: Set Lockout Time for Failed Password Attempts - Get authselect current\n          profile\n        ansible.builtin.shell:\n          cmd: authselect current -r | awk '{ print $1 }'\n        register: result_authselect_profile\n        changed_when: false\n        when:\n        - result_authselect_check_cmd is success\n\n      - name: Set Lockout Time for Failed Password Attempts - Define the current authselect\n          profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Define the new authselect\n          custom profile as a local fact\n        ansible.builtin.set_fact:\n          authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n          authselect_custom_profile: custom/hardening\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_profile.stdout is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Get authselect current\n          features to also enable them in the custom profile\n        ansible.builtin.shell:\n          cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n        register: result_authselect_features\n        changed_when: false\n        when:\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Check if any custom\n          profile with the same name was already created\n        ansible.builtin.stat:\n          path: /etc/authselect/{{ authselect_custom_profile }}\n        register: result_authselect_custom_profile_present\n        changed_when: false\n        when:\n        - authselect_current_profile is not match(\"custom/\")\n\n      - name: Set Lockout Time for Failed Password Attempts - Create an authselect\n          custom profile based on the current profile\n        ansible.builtin.command:\n          cmd: authselect create-profile hardening -b {{ authselect_current_profile\n            }}\n        when:\n        - result_authselect_check_cmd is success\n        - authselect_current_profile is not match(\"custom/\")\n        - not result_authselect_custom_profile_present.stat.exists\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure the authselect\n          custom profile is selected\n        ansible.builtin.command:\n          cmd: authselect select {{ authselect_custom_profile }}\n        register: result_pam_authselect_select_profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - authselect_current_profile is not match(\"custom/\")\n        - authselect_custom_profile is not match(authselect_current_profile)\n\n      - name: Set Lockout Time for Failed Password Attempts - Restore the authselect\n          features in the custom profile\n        ansible.builtin.command:\n          cmd: authselect enable-feature {{ item }}\n        loop: '{{ result_authselect_features.stdout_lines }}'\n        register: result_pam_authselect_restore_features\n        when:\n        - result_authselect_profile is not skipped\n        - result_authselect_features is not skipped\n        - result_pam_authselect_select_profile is not skipped\n\n      - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n          are applied\n        ansible.builtin.command:\n          cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n        when:\n        - result_authselect_check_cmd is success\n        - result_authselect_profile is not skipped\n        - result_pam_authselect_restore_features is not skipped\n\n      - name: Set Lockout Time for Failed Password Attempts - Change the PAM file\n          to be edited according to the custom authselect profile\n        ansible.builtin.set_fact:\n          pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n            | basename }}\n      when:\n      - result_authselect_present.stat.exists\n\n    - name: Set Lockout Time for Failed Password Attempts - Define a fact for control\n        already filtered in case filters are used\n      ansible.builtin.set_fact:\n        pam_module_control: ''\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure the \"unlock_time\"\n        option from \"pam_faillock.so\" is not present in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: (.*auth.*pam_faillock.so.*)\\bunlock_time\\b=?[0-9a-zA-Z]*(.*)\n        replace: \\1\\2\n      register: result_pam_option_removal\n\n    - name: Set Lockout Time for Failed Password Attempts - Ensure authselect changes\n        are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present.stat.exists\n      - result_pam_option_removal is changed\n    when:\n    - result_pam_file_present.stat.exists\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Lockout Time for Failed Password Attempts - Ensure the pam_faillock.so\n    unlock_time parameter in PAM files\n  block:\n\n  - name: Set Lockout Time for Failed Password Attempts - Check if pam_faillock.so\n      unlock_time parameter is already enabled in pam files\n    ansible.builtin.lineinfile:\n      path: /etc/pam.d/system-auth\n      regexp: .*auth.*pam_faillock\\.so (preauth|authfail).*unlock_time\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_faillock_unlock_time_parameter_is_present\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure the inclusion of\n      pam_faillock.so preauth unlock_time parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so preauth.*)\n      line: \\1required\\3 unlock_time={{ var_accounts_passwords_pam_faillock_unlock_time\n        }}\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_unlock_time_parameter_is_present.found == 0\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure the inclusion of\n      pam_faillock.so authfail unlock_time parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so authfail.*)\n      line: \\1required\\3 unlock_time={{ var_accounts_passwords_pam_faillock_unlock_time\n        }}\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_unlock_time_parameter_is_present.found == 0\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure the desired value\n      for pam_faillock.so preauth unlock_time parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so preauth.*)(unlock_time)=[0-9]+(.*)\n      line: \\1required\\3\\4={{ var_accounts_passwords_pam_faillock_unlock_time }}\\5\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_unlock_time_parameter_is_present.found > 0\n\n  - name: Set Lockout Time for Failed Password Attempts - Ensure the desired value\n      for pam_faillock.so authfail unlock_time parameter in auth section\n    ansible.builtin.lineinfile:\n      path: '{{ item }}'\n      backrefs: true\n      regexp: (^\\s*auth\\s+)([\\w\\[].*\\b)(\\s+pam_faillock.so authfail.*)(unlock_time)=[0-9]+(.*)\n      line: \\1required\\3\\4={{ var_accounts_passwords_pam_faillock_unlock_time }}\\5\n      state: present\n    loop:\n    - /etc/pam.d/system-auth\n    - /etc/pam.d/password-auth\n    when:\n    - result_pam_faillock_unlock_time_parameter_is_present.found > 0\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - not result_faillock_conf_check.stat.exists\n  tags:\n  - CCE-80670-3\n  - CJIS-5.5.3\n  - DISA-STIG-RHEL-08-020014\n  - DISA-STIG-RHEL-08-020015\n  - NIST-800-171-3.1.8\n  - NIST-800-53-AC-7(b)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.1.7\n  - PCI-DSSv4-8.3.4\n  - accounts_passwords_pam_faillock_unlock_time\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_passwords_pam_faillock_unlock_time",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_accounts_passwords_pam_faillock_unlock_time='900'\n\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\nfor pam_file in \"${AUTH_FILES[@]}\"\ndo\n    if ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+(preauth silent|authfail).*$' \"$pam_file\" ; then\n        sed -i --follow-symlinks '/^auth.*sufficient.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth silent' \"$pam_file\"\n        sed -i --follow-symlinks '/^auth.*required.*pam_deny\\.so.*/i auth        required      pam_faillock.so authfail' \"$pam_file\"\n        sed -i --follow-symlinks '/^account.*required.*pam_unix\\.so.*/i account     required      pam_faillock.so' \"$pam_file\"\n    fi\n    sed -Ei 's/(auth.*)(\\[default=die\\])(.*pam_faillock\\.so)/\\1required     \\3/g' \"$pam_file\"\ndone\n\nfi\n\nAUTH_FILES=(\"/etc/pam.d/system-auth\" \"/etc/pam.d/password-auth\")\n\nFAILLOCK_CONF=\"/etc/security/faillock.conf\"\nif [ -f $FAILLOCK_CONF ]; then\n    regex=\"^\\s*unlock_time\\s*=\"\n    line=\"unlock_time = $var_accounts_passwords_pam_faillock_unlock_time\"\n    if ! grep -q $regex $FAILLOCK_CONF; then\n        echo $line >> $FAILLOCK_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(unlock_time\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_accounts_passwords_pam_faillock_unlock_time\"'|g' $FAILLOCK_CONF\n    fi\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if [ -e \"$pam_file\" ] ; then\n            PAM_FILE_PATH=\"$pam_file\"\n            if [ -f /usr/bin/authselect ]; then\n                \n                if ! authselect check; then\n                echo \"\n                authselect integrity check failed. Remediation aborted!\n                This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n                It is not recommended to manually edit the PAM files when authselect tool is available.\n                In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n                exit 1\n                fi\n\n                CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n                # If not already in use, a custom profile is created preserving the enabled features.\n                if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                    ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                    authselect create-profile hardening -b $CURRENT_PROFILE\n                    CURRENT_PROFILE=\"custom/hardening\"\n                    \n                    authselect apply-changes -b --backup=before-hardening-custom-profile\n                    authselect select $CURRENT_PROFILE\n                    for feature in $ENABLED_FEATURES; do\n                        authselect enable-feature $feature;\n                    done\n                    \n                    authselect apply-changes -b --backup=after-hardening-custom-profile\n                fi\n                PAM_FILE_NAME=$(basename \"$pam_file\")\n                PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n                authselect apply-changes -b\n            fi\n            \n        if grep -qP \"^\\s*auth\\s.*\\bpam_faillock.so\\s.*\\bunlock_time\\b\" \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks \"s/(.*auth.*pam_faillock.so.*)\\bunlock_time\\b=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\n        fi\n            if [ -f /usr/bin/authselect ]; then\n                \n                authselect apply-changes -b\n            fi\n        else\n            echo \"$pam_file was not found\" >&2\n        fi\n    done\nelse\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if ! grep -qE '^\\s*auth.*pam_faillock\\.so (preauth|authfail).*unlock_time' \"$pam_file\"; then\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*preauth.*silent.*/ s/$/ unlock_time='\"$var_accounts_passwords_pam_faillock_unlock_time\"'/' \"$pam_file\"\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*authfail.*/ s/$/ unlock_time='\"$var_accounts_passwords_pam_faillock_unlock_time\"'/' \"$pam_file\"\n        else\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*preauth.*silent.*\\)\\('\"unlock_time\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_unlock_time\"'\\3/' \"$pam_file\"\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*authfail.*\\)\\('\"unlock_time\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_unlock_time\"'\\3/' \"$pam_file\"\n        fi\n    done\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230336",
        "stig_id": "RHEL-08-020014"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_dictcheck": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_dictcheck",
        "title": "Ensure PAM Enforces Password Requirements - Prevent the Use of Dictionary Words",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86233-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(a)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00225"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020300"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230377r858789_rule"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>dictcheck</code> check if passwords contains dictionary words. When\n<code>dictcheck</code> is set to <code>1</code> passwords will be checked for dictionary words.",
        "rationale": "Use of a complex password helps to increase the time and resources required to compromise the password.\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at\nguessing and brute-force attacks.\n<br>\n          <br>\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more\ncomplex the password, the greater the number of possible combinations that need to be tested before the\npassword is compromised.\n<br>\n          <br>\nPasswords with dictionary words may be more vulnerable to password-guessing attacks.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_dictcheck:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_dictcheck",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86233-4\n  - DISA-STIG-RHEL-08-020300\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_dictcheck\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_password_pam_dictcheck # promote to variable\n  set_fact:\n    var_password_pam_dictcheck: !!str 1\n  tags:\n    - always\n\n- name: Ensure PAM Enforces Password Requirements - Prevent the Use of Dictionary\n    Words - Ensure PAM variable dictcheck is set accordingly\n  ansible.builtin.lineinfile:\n    create: true\n    dest: /etc/security/pwquality.conf\n    regexp: ^#?\\s*dictcheck\n    line: dictcheck = {{ var_password_pam_dictcheck }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-86233-4\n  - DISA-STIG-RHEL-08-020300\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_dictcheck\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_dictcheck",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_dictcheck='1'\n\n\n\n\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^dictcheck\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_dictcheck\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^dictcheck\\\\>\" \"/etc/security/pwquality.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^dictcheck\\\\>.*/$escaped_formatted_output/gi\" \"/etc/security/pwquality.conf\"\nelse\n    if [[ -s \"/etc/security/pwquality.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/security/pwquality.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/security/pwquality.conf\"\n    fi\n    cce=\"CCE-86233-4\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/security/pwquality.conf\" >> \"/etc/security/pwquality.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/security/pwquality.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230377",
        "stig_id": "RHEL-08-020300"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_difok": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_difok",
        "title": "Ensure PAM Enforces Password Requirements - Minimum Different Characters",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80654-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000195"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(b)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000072-GPOS-00040"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020170"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230363r858783_rule"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>difok</code> parameter sets the number of characters\nin a password that must not be present in and old password during a password change.\n<br>\n          <br>\nModify the <code>difok</code> setting in <code>/etc/security/pwquality.conf</code>\nto equal 2 to require differing characters\nwhen changing passwords.",
        "rationale": "Use of a complex password helps to increase the time and resources\nrequired to compromise the password. Password complexity, or strength,\nis a measure of the effectiveness of a password in resisting attempts\nat guessing and brute–force attacks.\n<br>\n          <br>\nPassword complexity is one factor of several that determines how long\nit takes to crack a password. The more complex the password, the\ngreater the number of possible combinations that need to be tested\nbefore the password is compromised.\n<br>\n          <br>\nRequiring a minimum number of different characters during password changes ensures that\nnewly changed passwords should not resemble previously compromised ones.\nNote that passwords which are changed on compromised systems will still be compromised, however.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_difok:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_difok",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80654-7\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020170\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(b)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_difok\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_password_pam_difok # promote to variable\n  set_fact:\n    var_password_pam_difok: !!str 2\n  tags:\n    - always\n\n- name: Ensure PAM Enforces Password Requirements - Minimum Different Characters -\n    Ensure PAM variable difok is set accordingly\n  ansible.builtin.lineinfile:\n    create: true\n    dest: /etc/security/pwquality.conf\n    regexp: ^#?\\s*difok\n    line: difok = {{ var_password_pam_difok }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80654-7\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020170\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(b)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_difok\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_difok",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_difok='2'\n\n\n\n\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^difok\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_difok\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^difok\\\\>\" \"/etc/security/pwquality.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^difok\\\\>.*/$escaped_formatted_output/gi\" \"/etc/security/pwquality.conf\"\nelse\n    if [[ -s \"/etc/security/pwquality.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/security/pwquality.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/security/pwquality.conf\"\n    fi\n    cce=\"CCE-80654-7\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/security/pwquality.conf\" >> \"/etc/security/pwquality.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/security/pwquality.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230363",
        "stig_id": "RHEL-08-020170"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_enforce_root": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_enforce_root",
        "title": "Ensure PAM Enforces Password Requirements - Enforce for root User",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83377-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000192",
              "CCI-000193",
              "CCI-000194",
              "CCI-000195",
              "CCI-000205",
              "CCI-000366",
              "CCI-001619"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(a)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000069-GPOS-00037",
              "SRG-OS-000070-GPOS-00038",
              "SRG-OS-000071-GPOS-00039",
              "SRG-OS-000072-GPOS-00040",
              "SRG-OS-000078-GPOS-00046",
              "SRG-OS-000266-GPOS-00101",
              "SRG-OS-000480-GPOS-00225"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>enforce_for_root</code> parameter controls requirements for\nenforcing password complexity for the root user. Enable the <code>enforce_for_root</code>\nsetting in <code>/etc/security/pwquality.conf</code> to require the <code>root</code> user\nto use complex passwords.",
        "rationale": "Use of a complex password helps to increase the time and resources required to compromise\nthe password. Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a\npassword. The more complex the password, the greater the number of possible combinations\nthat need to be tested before the password is compromised.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_enforce_root:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_enforce_root",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83377-2\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_enforce_root\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure PAM Enforces Password Requirements - Enforce for root User\n  lineinfile:\n    path: /etc/security/pwquality.conf\n    create: true\n    line: enforce_for_root\n    state: present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-83377-2\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_enforce_root\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_enforce_root",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nif [ -e \"/etc/security/pwquality.conf\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*enforce_for_root/Id\" \"/etc/security/pwquality.conf\"\nelse\n    touch \"/etc/security/pwquality.conf\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/security/pwquality.conf\"\n\ncp \"/etc/security/pwquality.conf\" \"/etc/security/pwquality.conf.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"enforce_for_root\" >> \"/etc/security/pwquality.conf\"\n# Clean up after ourselves.\nrm \"/etc/security/pwquality.conf.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxrepeat": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_maxrepeat",
        "title": "Set Password Maximum Consecutive Repeating Characters",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82066-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000195"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000072-GPOS-00040"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020150"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230361r858779_rule"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>maxrepeat</code> parameter controls requirements for\nconsecutive repeating characters. When set to a positive number, it will reject passwords\nwhich contain more than that number of consecutive characters. Modify the <code>maxrepeat</code> setting\nin <code>/etc/security/pwquality.conf</code> to equal 3 to prevent a\nrun of (3 + 1) or more identical characters.",
        "rationale": "Use of a complex password helps to increase the time and resources required to compromise the password.\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at\nguessing and brute-force attacks.\n<br>\n          <br>\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more\ncomplex the password, the greater the number of possible combinations that need to be tested before the\npassword is compromised.\n<br>\n          <br>\nPasswords with excessive repeating characters may be more vulnerable to password-guessing attacks.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_maxrepeat:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_maxrepeat",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82066-2\n  - DISA-STIG-RHEL-08-020150\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_maxrepeat\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_password_pam_maxrepeat # promote to variable\n  set_fact:\n    var_password_pam_maxrepeat: !!str 3\n  tags:\n    - always\n\n- name: Set Password Maximum Consecutive Repeating Characters - Ensure PAM variable\n    maxrepeat is set accordingly\n  ansible.builtin.lineinfile:\n    create: true\n    dest: /etc/security/pwquality.conf\n    regexp: ^#?\\s*maxrepeat\n    line: maxrepeat = {{ var_password_pam_maxrepeat }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-82066-2\n  - DISA-STIG-RHEL-08-020150\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_maxrepeat\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_maxrepeat",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_maxrepeat='3'\n\n\n\n\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^maxrepeat\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_maxrepeat\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^maxrepeat\\\\>\" \"/etc/security/pwquality.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^maxrepeat\\\\>.*/$escaped_formatted_output/gi\" \"/etc/security/pwquality.conf\"\nelse\n    if [[ -s \"/etc/security/pwquality.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/security/pwquality.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/security/pwquality.conf\"\n    fi\n    cce=\"CCE-82066-2\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/security/pwquality.conf\" >> \"/etc/security/pwquality.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/security/pwquality.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230361",
        "stig_id": "RHEL-08-020150"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass",
        "title": "Ensure PAM Enforces Password Requirements - Minimum Different Categories",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82046-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R68"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000195"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(a)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000072-GPOS-00040"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020160"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230362r858781_rule"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>minclass</code> parameter controls\nrequirements for usage of different character classes, or types, of character\nthat must exist in a password before it is considered valid. For example,\nsetting this value to three (3) requires that any password must have characters\nfrom at least three different categories in order to be approved. The default\nvalue is zero (0), meaning there are no required classes. There are four\ncategories available:\n<pre>\n* Upper-case characters\n* Lower-case characters\n* Digits\n* Special characters (for example, punctuation)\n</pre>\nModify the <code>minclass</code> setting in <code>/etc/security/pwquality.conf</code> entry\nto require 4\ndiffering categories of characters when changing passwords.",
        "rationale": "Use of a complex password helps to increase the time and resources required to compromise the password.\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts\nat guessing and brute-force attacks.\n<br>\n          <br>\nPassword complexity is one factor of several that determines how long it takes to crack a password. The\nmore complex the password, the greater the number of possible combinations that need to be tested before\nthe password is compromised.\n<br>\n          <br>\nRequiring a minimum number of character categories makes password guessing attacks more difficult\nby ensuring a larger search space.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_minclass:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_minclass",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82046-4\n  - DISA-STIG-RHEL-08-020160\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_minclass\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_password_pam_minclass # promote to variable\n  set_fact:\n    var_password_pam_minclass: !!str 4\n  tags:\n    - always\n\n- name: Ensure PAM Enforces Password Requirements - Minimum Different Categories -\n    Ensure PAM variable minclass is set accordingly\n  ansible.builtin.lineinfile:\n    create: true\n    dest: /etc/security/pwquality.conf\n    regexp: ^#?\\s*minclass\n    line: minclass = {{ var_password_pam_minclass }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-82046-4\n  - DISA-STIG-RHEL-08-020160\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - accounts_password_pam_minclass\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_minclass",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_minclass='4'\n\n\n\n\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^minclass\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_minclass\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^minclass\\\\>\" \"/etc/security/pwquality.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^minclass\\\\>.*/$escaped_formatted_output/gi\" \"/etc/security/pwquality.conf\"\nelse\n    if [[ -s \"/etc/security/pwquality.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/security/pwquality.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/security/pwquality.conf\"\n    fi\n    cce=\"CCE-82046-4\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/security/pwquality.conf\" >> \"/etc/security/pwquality.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/security/pwquality.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230362",
        "stig_id": "RHEL-08-020160"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen",
        "title": "Ensure PAM Enforces Password Requirements - Minimum Length",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80656-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R31",
              "R68"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000205"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(a)",
              "IA-5(4)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000078-GPOS-00046"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020230"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230369r858785_rule"
            ]
          }
        ],
        "description": "The pam_pwquality module&#x27;s <code>minlen</code> parameter controls requirements for\nminimum characters required in a password. Add <code>minlen=14\n          </code>\nafter pam_pwquality to set minimum password length requirements.",
        "rationale": "The shorter the password, the lower the number of possible combinations\nthat need to be tested before the password is compromised.\n<br>\nPassword complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks.\nPassword length is one factor of several that helps to determine strength\nand how long it takes to crack a password. Use of more characters in a password\nhelps to exponentially increase the time and/or resources required to\ncompromise the password.",
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_pam_minlen:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_pam_minlen",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80656-2\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020230\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.3\n  - PCI-DSSv4-8.3.6\n  - accounts_password_pam_minlen\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_password_pam_minlen # promote to variable\n  set_fact:\n    var_password_pam_minlen: !!str 14\n  tags:\n    - always\n\n- name: Ensure PAM Enforces Password Requirements - Minimum Length - Ensure PAM variable\n    minlen is set accordingly\n  ansible.builtin.lineinfile:\n    create: true\n    dest: /etc/security/pwquality.conf\n    regexp: ^#?\\s*minlen\n    line: minlen = {{ var_password_pam_minlen }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80656-2\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020230\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(4)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.3\n  - PCI-DSSv4-8.3.6\n  - accounts_password_pam_minlen\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_pam_minlen",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_pam_minlen='14'\n\n\n\n\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^minlen\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_password_pam_minlen\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^minlen\\\\>\" \"/etc/security/pwquality.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^minlen\\\\>.*/$escaped_formatted_output/gi\" \"/etc/security/pwquality.conf\"\nelse\n    if [[ -s \"/etc/security/pwquality.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/security/pwquality.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/security/pwquality.conf\"\n    fi\n    cce=\"CCE-80656-2\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/security/pwquality.conf\" >> \"/etc/security/pwquality.conf\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/security/pwquality.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230369",
        "stig_id": "RHEL-08-020230"
      },
      "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf": {
        "rule_id": "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_libuserconf",
        "title": "Set Password Hashing Algorithm in /etc/libuser.conf",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80891-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.13.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000196"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(c)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000073-GPOS-00041"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.2"
            ]
          }
        ],
        "description": "In <code>/etc/libuser.conf</code>, add or correct the following line in its <code>[defaults]</code>\nsection to ensure the system will use the sha512\nalgorithm for password hashing:\n<pre>crypt_style = sha512\n         </pre>\n        ",
        "rationale": "Passwords need to be protected at all times, and encryption is the standard method for\nprotecting passwords. If passwords are not encrypted, they can be plainly read\n(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm\nare no more protected than if they are kept in plain text.\n<br>\n         <br>\nThis setting ensures user and group account administration utilities are configured to store\nonly encrypted representations of passwords. Additionally, the <code>crypt_style</code>\nconfiguration option in <code>/etc/libuser.conf</code> ensures the use of a strong hashing\nalgorithm that makes password cracking attacks more difficult.",
        "platforms": [
          "#package_libuser"
        ],
        "oval_definition_id": "oval:ssg-set_password_hashing_algorithm_libuserconf:def:1",
        "remediations": [
          {
            "remediation_id": "set_password_hashing_algorithm_libuserconf",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80891-5\n  - CJIS-5.6.2.2\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - set_password_hashing_algorithm_libuserconf\n- name: XCCDF Value var_password_hashing_algorithm_pam # promote to variable\n  set_fact:\n    var_password_hashing_algorithm_pam: !!str sha512\n  tags:\n    - always\n\n- name: Set Password Hashing Algorithm in /etc/libuser.conf - Set Password Hashing\n    Algorithm in /etc/libuser.conf\n  ansible.builtin.lineinfile:\n    dest: /etc/libuser.conf\n    insertafter: ^\\s*\\[defaults]\n    regexp: ^#?crypt_style\n    line: crypt_style = {{ var_password_hashing_algorithm_pam }}\n    state: present\n    create: true\n  when: '\"libuser\" in ansible_facts.packages'\n  tags:\n  - CCE-80891-5\n  - CJIS-5.6.2.2\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - set_password_hashing_algorithm_libuserconf\n"
          },
          {
            "remediation_id": "set_password_hashing_algorithm_libuserconf",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q libuser; then\n\nvar_password_hashing_algorithm_pam='sha512'\n\nLIBUSER_CONF=\"/etc/libuser.conf\"\nCRYPT_STYLE_REGEX='[[:space:]]*\\[defaults](.*(\\n)+)+?[[:space:]]*crypt_style[[:space:]]*'\n\n# Try find crypt_style in [defaults] section. If it is here, then change algorithm to sha512.\n# If it isn't here, then add it to [defaults] section.\nif grep -qzosP $CRYPT_STYLE_REGEX $LIBUSER_CONF ; then\n        sed -i \"s/\\(crypt_style[[:space:]]*=[[:space:]]*\\).*/\\1$var_password_hashing_algorithm_pam/g\" $LIBUSER_CONF\nelif grep -qs \"\\[defaults]\" $LIBUSER_CONF ; then\n        sed -i \"/[[:space:]]*\\[defaults]/a crypt_style = $var_password_hashing_algorithm_pam\" $LIBUSER_CONF\nelse\n        echo -e \"[defaults]\\ncrypt_style = $var_password_hashing_algorithm_pam\" >> $LIBUSER_CONF\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs": {
        "rule_id": "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs",
        "title": "Set Password Hashing Algorithm in /etc/login.defs",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80892-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.13.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000196"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(c)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000073-GPOS-00041"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010110"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230231r877397_rule"
            ]
          }
        ],
        "description": "In <code>/etc/login.defs</code>, add or update the following line to ensure the system will use\nSHA512 as the hashing algorithm:\n<pre>ENCRYPT_METHOD SHA512\n         </pre>\n        ",
        "rationale": "Passwords need to be protected at all times, and encryption is the standard method for\nprotecting passwords. If passwords are not encrypted, they can be plainly read\n(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm\nare no more protected than if they are kept in plain text.\n<br>\n         <br>\nUsing a stronger hashing algorithm makes password cracking attacks more difficult.",
        "platforms": [
          "#package_shadow-utils"
        ],
        "oval_definition_id": "oval:ssg-set_password_hashing_algorithm_logindefs:def:1",
        "remediations": [
          {
            "remediation_id": "set_password_hashing_algorithm_logindefs",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80892-3\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010110\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - set_password_hashing_algorithm_logindefs\n- name: XCCDF Value var_password_hashing_algorithm # promote to variable\n  set_fact:\n    var_password_hashing_algorithm: !!str SHA512\n  tags:\n    - always\n\n- name: Set Password Hashing Algorithm in /etc/login.defs\n  lineinfile:\n    dest: /etc/login.defs\n    regexp: ^#?ENCRYPT_METHOD\n    line: ENCRYPT_METHOD {{ var_password_hashing_algorithm }}\n    state: present\n    create: true\n  when: '\"shadow-utils\" in ansible_facts.packages'\n  tags:\n  - CCE-80892-3\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010110\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - set_password_hashing_algorithm_logindefs\n"
          },
          {
            "remediation_id": "set_password_hashing_algorithm_logindefs",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q shadow-utils; then\n\nvar_password_hashing_algorithm='SHA512'\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^ENCRYPT_METHOD\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$var_password_hashing_algorithm\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^ENCRYPT_METHOD\\\\>\" \"/etc/login.defs\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^ENCRYPT_METHOD\\\\>.*/$escaped_formatted_output/gi\" \"/etc/login.defs\"\nelse\n    if [[ -s \"/etc/login.defs\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/login.defs\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/login.defs\"\n    fi\n    cce=\"CCE-80892-3\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/login.defs\" >> \"/etc/login.defs\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/login.defs\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230231",
        "stig_id": "RHEL-08-010110"
      },
      "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_passwordauth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_passwordauth",
        "title": "Set PAM''s Password Hashing Algorithm - password-auth",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85945-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.4.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.13.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000196",
              "CCI-000803"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(c)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000073-GPOS-00041",
              "SRG-OS-000120-GPOS-00061"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010160"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230237r809276_rule"
            ]
          }
        ],
        "description": "The PAM system service can be configured to only store encrypted representations of passwords.\nIn <code>/etc/pam.d/password-auth</code>, the <code>password</code> section of the file controls which\nPAM modules to execute during a password change.\n\nSet the <code>pam_unix.so</code> module in the <code>password</code> section to include the option\n<code>sha512</code> and no other hashing\nalgorithms as shown below:\n<br>\n         <pre>password    sufficient    pam_unix.so sha512\n          <i>other arguments...</i>\n         </pre>\n         <br>\nThis will help ensure that new passwords for local users will be stored using the\nsha512 algorithm.",
        "rationale": "Passwords need to be protected at all times, and encryption is the standard method for\nprotecting passwords. If passwords are not encrypted, they can be plainly read\n(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm\nare no more protected than if they are kept in plain text.\n<br>\n         <br>\nThis setting ensures user and group account administration utilities are configured to store\nonly encrypted representations of passwords. Additionally, the <code>crypt_style</code>\nconfiguration option in <code>/etc/libuser.conf</code> ensures the use of a strong hashing\nalgorithm that makes password cracking attacks more difficult.",
        "warnings": [
          {
            "text": "The hashing algorithms to be used with pam_unix.so are defined with independent module\noptions. There are at least 7 possible algorithms and likely more algorithms will be\nintroduced along the time. Due the the number of options and its possible combinations,\nthe use of multiple hashing algorithm options may bring unexpected behaviors to the\nsystem. For this reason the check will pass only when one hashing algorithm option is\ndefined and is aligned to the &quot;var_password_hashing_algorithm_pam&quot; variable. The\nremediation will ensure the correct option and remove any other extra hashing algorithm\noption.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-set_password_hashing_algorithm_passwordauth:def:1",
        "remediations": [
          {
            "remediation_id": "set_password_hashing_algorithm_passwordauth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-85945-4\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010160\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_passwordauth\n- name: XCCDF Value var_password_hashing_algorithm_pam # promote to variable\n  set_fact:\n    var_password_hashing_algorithm_pam: !!str sha512\n  tags:\n    - always\n\n- name: Set PAM's Password Hashing Algorithm - password-auth - Check if /etc/pam.d/password-auth\n    file is present\n  ansible.builtin.stat:\n    path: /etc/pam.d/password-auth\n  register: result_pam_file_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-85945-4\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010160\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_passwordauth\n\n- name: Set PAM's Password Hashing Algorithm - password-auth - Check the proper remediation\n    for the system\n  block:\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Define the PAM file\n      to be edited as a local fact\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/password-auth\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Check if system relies\n      on authselect tool\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n      custom profile is used if authselect is present\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Check integrity\n        of authselect current profile\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Informative message\n        based on the authselect integrity check result\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Get authselect\n        current profile\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Define the current\n        authselect profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Define the new\n        authselect custom profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Get authselect\n        current features to also enable them in the custom profile\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Check if any custom\n        profile with the same name was already created\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Create an authselect\n        custom profile based on the current profile\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n        changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure the authselect\n        custom profile is selected\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Restore the authselect\n        features in the custom profile\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n        changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Change the PAM\n        file to be edited according to the custom authselect profile\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Define a fact for\n      control already filtered in case filters are used\n    ansible.builtin.set_fact:\n      pam_module_control: sufficient\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Check if expected\n      PAM module line is present in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Include or update\n      the PAM module line in {{ pam_file_path }}\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Check if required\n        PAM module line is present in {{ pam_file_path }} with different control\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_unix.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure the correct\n        control for the required PAM module line in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_unix.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure the required\n        PAM module line is included in {{ pam_file_path }}\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        line: password    {{ pam_module_control }}    pam_unix.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n        changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Define a fact for\n      control already filtered in case filters are used\n    ansible.builtin.set_fact:\n      pam_module_control: sufficient\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Check if the required\n      PAM module option is present in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so\\s*.*\\s{{\n        var_password_hashing_algorithm_pam }}\\b\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_module_set_password_hashing_algorithm_passwordauth_option_present\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure the \"{{ var_password_hashing_algorithm_pam\n      }}\" PAM option for \"pam_unix.so\" is included in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so.*)\n      line: \\1 {{ var_password_hashing_algorithm_pam }}\n      state: present\n    register: result_pam_set_password_hashing_algorithm_passwordauth_add\n    when:\n    - result_pam_module_set_password_hashing_algorithm_passwordauth_option_present.found\n      == 0\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n      changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - |-\n      (result_pam_set_password_hashing_algorithm_passwordauth_add is defined and result_pam_set_password_hashing_algorithm_passwordauth_add.changed)\n       or (result_pam_set_password_hashing_algorithm_passwordauth_edit is defined and result_pam_set_password_hashing_algorithm_passwordauth_edit.changed)\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pam_file_present.stat.exists\n  tags:\n  - CCE-85945-4\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010160\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_passwordauth\n\n- name: Set PAM's Password Hashing Algorithm - password-auth - Check if /etc/pam.d/password-auth\n    File is Present\n  ansible.builtin.stat:\n    path: /etc/pam.d/password-auth\n  register: result_pam_file_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-85945-4\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010160\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_passwordauth\n\n- name: Set PAM's Password Hashing Algorithm - password-auth - Check The Proper Remediation\n    For The System\n  block:\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Define the PAM file\n      to be edited as a local fact\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/password-auth\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Check if system relies\n      on authselect tool\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n      custom profile is used if authselect is present\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Check integrity\n        of authselect current profile\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Informative message\n        based on the authselect integrity check result\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Get authselect\n        current profile\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Define the current\n        authselect profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Define the new\n        authselect custom profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Get authselect\n        current features to also enable them in the custom profile\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Check if any custom\n        profile with the same name was already created\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Create an authselect\n        custom profile based on the current profile\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n        changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure the authselect\n        custom profile is selected\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Restore the authselect\n        features in the custom profile\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n        changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - password-auth - Change the PAM\n        file to be edited according to the custom authselect profile\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure That Only\n      the Correct Hashing Algorithm Option For pam_unix.so Is Used in /etc/pam.d/password-auth\n    ansible.builtin.replace:\n      dest: '{{ pam_file_path }}'\n      regexp: (^\\s*password.*pam_unix\\.so.*)\\b{{ item }}\\b\\s*(.*)\n      replace: \\1\\2\n    when: item != var_password_hashing_algorithm_pam\n    loop:\n    - sha512\n    - yescrypt\n    - gost_yescrypt\n    - blowfish\n    - sha256\n    - md5\n    - bigcrypt\n    register: result_pam_hashing_options_removal\n\n  - name: Set PAM's Password Hashing Algorithm - password-auth - Ensure authselect\n      changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - result_pam_hashing_options_removal is changed\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pam_file_present.stat.exists\n  tags:\n  - CCE-85945-4\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010160\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_passwordauth\n"
          },
          {
            "remediation_id": "set_password_hashing_algorithm_passwordauth",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_hashing_algorithm_pam='sha512'\n\nPAM_FILE_PATH=\"/etc/pam.d/password-auth\"\n\nif [ -e \"$PAM_FILE_PATH\" ] ; then\n    PAM_FILE_PATH=\"$PAM_FILE_PATH\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"$PAM_FILE_PATH\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    if ! grep -qP \"^\\s*password\\s+sufficient\\s+pam_unix.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n            # Line matching group + control + module was not found. Check group + module.\n            if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_unix.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n                # The control is updated only if one single line matches.\n                sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_unix.so.*)/\\1sufficient \\2/\" \"$PAM_FILE_PATH\"\n            else\n                echo \"password    sufficient    pam_unix.so\" >> \"$PAM_FILE_PATH\"\n            fi\n        fi\n        # Check the option\n        if ! grep -qP \"^\\s*password\\s+sufficient\\s+pam_unix.so\\s*.*\\s$var_password_hashing_algorithm_pam\\b\" \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks \"/\\s*password\\s+sufficient\\s+pam_unix.so.*/ s/$/ $var_password_hashing_algorithm_pam/\" \"$PAM_FILE_PATH\"\n        fi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"$PAM_FILE_PATH was not found\" >&2\nfi\n\n# Ensure only the correct hashing algorithm option is used.\ndeclare -a HASHING_ALGORITHMS_OPTIONS=(\"sha512\" \"yescrypt\" \"gost_yescrypt\" \"blowfish\" \"sha256\" \"md5\" \"bigcrypt\")\n\nfor hash_option in \"${HASHING_ALGORITHMS_OPTIONS[@]}\"; do\n  if [ \"$hash_option\" != \"$var_password_hashing_algorithm_pam\" ]; then\n    if grep -qP \"^\\s*password\\s+.*\\s+pam_unix.so\\s+.*\\b$hash_option\\b\" \"$PAM_FILE_PATH\"; then\n      if [ -e \"$PAM_FILE_PATH\" ] ; then\n    PAM_FILE_PATH=\"$PAM_FILE_PATH\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"$PAM_FILE_PATH\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    \nif grep -qP \"^\\s*password\\s+.*\\s+pam_unix.so\\s.*\\b$hash_option\\b\" \"$PAM_FILE_PATH\"; then\n    sed -i -E --follow-symlinks \"s/(.*password.*.*.*pam_unix.so.*)\\s$hash_option=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\nfi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"$PAM_FILE_PATH was not found\" >&2\nfi\n    fi\n  fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230237",
        "stig_id": "RHEL-08-010160"
      },
      "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_systemauth",
        "title": "Set PAM''s Password Hashing Algorithm",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80893-1"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R68"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.4.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.13.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000196",
              "CCI-000803"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(c)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000073-GPOS-00041",
              "SRG-OS-000120-GPOS-00061"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010159"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244524r809331_rule"
            ]
          }
        ],
        "description": "The PAM system service can be configured to only store encrypted representations of passwords.\nIn &quot;/etc/pam.d/system-auth&quot;, the <code>password</code> section of the file controls which\nPAM modules to execute during a password change.\n\nSet the <code>pam_unix.so</code> module in the <code>password</code> section to include the option\n<code>sha512</code> and no other hashing\nalgorithms as shown below:\n<br>\n         <pre>password    sufficient    pam_unix.so sha512\n          <i>other arguments...</i>\n         </pre>\n         <br>\nThis will help ensure that new passwords for local users will be stored using the\nsha512 algorithm.",
        "rationale": "Passwords need to be protected at all times, and encryption is the standard method for\nprotecting passwords. If passwords are not encrypted, they can be plainly read\n(i.e., clear text) and easily compromised. Passwords that are encrypted with a weak algorithm\nare no more protected than if they are kept in plain text.\n<br>\n         <br>\nThis setting ensures user and group account administration utilities are configured to store\nonly encrypted representations of passwords. Additionally, the <code>crypt_style</code>\nconfiguration option in <code>/etc/libuser.conf</code> ensures the use of a strong hashing\nalgorithm that makes password cracking attacks more difficult.",
        "warnings": [
          {
            "text": "The hashing algorithms to be used with pam_unix.so are defined with independent module\noptions. There are at least 7 possible algorithms and likely more algorithms will be\nintroduced along the time. Due the the number of options and its possible combinations,\nthe use of multiple hashing algorithm options may bring unexpected behaviors to the\nsystem. For this reason the check will pass only when one hashing algorithm option is\ndefined and is aligned to the &quot;var_password_hashing_algorithm_pam&quot; variable. The\nremediation will ensure the correct option and remove any other extra hashing algorithm\noption.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-set_password_hashing_algorithm_systemauth:def:1",
        "remediations": [
          {
            "remediation_id": "set_password_hashing_algorithm_systemauth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80893-1\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010159\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_systemauth\n- name: XCCDF Value var_password_hashing_algorithm_pam # promote to variable\n  set_fact:\n    var_password_hashing_algorithm_pam: !!str sha512\n  tags:\n    - always\n\n- name: Set PAM's Password Hashing Algorithm - Check if /etc/pam.d/system-auth file\n    is present\n  ansible.builtin.stat:\n    path: /etc/pam.d/system-auth\n  register: result_pam_file_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80893-1\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010159\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_systemauth\n\n- name: Set PAM's Password Hashing Algorithm - Check the proper remediation for the\n    system\n  block:\n\n  - name: Set PAM's Password Hashing Algorithm - Define the PAM file to be edited\n      as a local fact\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/system-auth\n\n  - name: Set PAM's Password Hashing Algorithm - Check if system relies on authselect\n      tool\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure authselect custom profile\n      is used if authselect is present\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - Check integrity of authselect current\n        profile\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: Set PAM's Password Hashing Algorithm - Informative message based on the\n        authselect integrity check result\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: Set PAM's Password Hashing Algorithm - Get authselect current profile\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: Set PAM's Password Hashing Algorithm - Define the current authselect profile\n        as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Define the new authselect custom\n        profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Get authselect current features\n        to also enable them in the custom profile\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Check if any custom profile with\n        the same name was already created\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Create an authselect custom profile\n        based on the current profile\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure the authselect custom profile\n        is selected\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - Restore the authselect features\n        in the custom profile\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - Change the PAM file to be edited\n        according to the custom authselect profile\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: Set PAM's Password Hashing Algorithm - Define a fact for control already\n      filtered in case filters are used\n    ansible.builtin.set_fact:\n      pam_module_control: sufficient\n\n  - name: Set PAM's Password Hashing Algorithm - Check if expected PAM module line\n      is present in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so\\s*.*\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_line_present\n\n  - name: Set PAM's Password Hashing Algorithm - Include or update the PAM module\n      line in {{ pam_file_path }}\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - Check if required PAM module line\n        is present in {{ pam_file_path }} with different control\n      ansible.builtin.lineinfile:\n        path: '{{ pam_file_path }}'\n        regexp: ^\\s*password\\s+.*\\s+pam_unix.so\\s*\n        state: absent\n      check_mode: true\n      changed_when: false\n      register: result_pam_line_other_control_present\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure the correct control for\n        the required PAM module line in {{ pam_file_path }}\n      ansible.builtin.replace:\n        dest: '{{ pam_file_path }}'\n        regexp: ^(\\s*password\\s+).*(\\bpam_unix.so.*)\n        replace: \\1{{ pam_module_control }} \\2\n      register: result_pam_module_edit\n      when:\n      - result_pam_line_other_control_present.found == 1\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure the required PAM module\n        line is included in {{ pam_file_path }}\n      ansible.builtin.lineinfile:\n        dest: '{{ pam_file_path }}'\n        line: password    {{ pam_module_control }}    pam_unix.so\n      register: result_pam_module_add\n      when:\n      - result_pam_line_other_control_present.found == 0 or result_pam_line_other_control_present.found\n        > 1\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b\n      when:\n      - result_authselect_present is defined\n      - result_authselect_present.stat.exists\n      - |-\n        (result_pam_module_add is defined and result_pam_module_add.changed)\n         or (result_pam_module_edit is defined and result_pam_module_edit.changed)\n    when:\n    - result_pam_line_present.found is defined\n    - result_pam_line_present.found == 0\n\n  - name: Set PAM's Password Hashing Algorithm - Define a fact for control already\n      filtered in case filters are used\n    ansible.builtin.set_fact:\n      pam_module_control: sufficient\n\n  - name: Set PAM's Password Hashing Algorithm - Check if the required PAM module\n      option is present in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      regexp: ^\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so\\s*.*\\s{{\n        var_password_hashing_algorithm_pam }}\\b\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: result_pam_module_set_password_hashing_algorithm_systemauth_option_present\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure the \"{{ var_password_hashing_algorithm_pam\n      }}\" PAM option for \"pam_unix.so\" is included in {{ pam_file_path }}\n    ansible.builtin.lineinfile:\n      path: '{{ pam_file_path }}'\n      backrefs: true\n      regexp: ^(\\s*password\\s+{{ pam_module_control | regex_escape() }}\\s+pam_unix.so.*)\n      line: \\1 {{ var_password_hashing_algorithm_pam }}\n      state: present\n    register: result_pam_set_password_hashing_algorithm_systemauth_add\n    when:\n    - result_pam_module_set_password_hashing_algorithm_systemauth_option_present.found\n      == 0\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - |-\n      (result_pam_set_password_hashing_algorithm_systemauth_add is defined and result_pam_set_password_hashing_algorithm_systemauth_add.changed)\n       or (result_pam_set_password_hashing_algorithm_systemauth_edit is defined and result_pam_set_password_hashing_algorithm_systemauth_edit.changed)\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pam_file_present.stat.exists\n  tags:\n  - CCE-80893-1\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010159\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_systemauth\n\n- name: Set PAM's Password Hashing Algorithm - Check if /etc/pam.d/system-auth File\n    is Present\n  ansible.builtin.stat:\n    path: /etc/pam.d/system-auth\n  register: result_pam_file_present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-80893-1\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010159\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_systemauth\n\n- name: Set PAM's Password Hashing Algorithm - Check The Proper Remediation For The\n    System\n  block:\n\n  - name: Set PAM's Password Hashing Algorithm - Define the PAM file to be edited\n      as a local fact\n    ansible.builtin.set_fact:\n      pam_file_path: /etc/pam.d/system-auth\n\n  - name: Set PAM's Password Hashing Algorithm - Check if system relies on authselect\n      tool\n    ansible.builtin.stat:\n      path: /usr/bin/authselect\n    register: result_authselect_present\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure authselect custom profile\n      is used if authselect is present\n    block:\n\n    - name: Set PAM's Password Hashing Algorithm - Check integrity of authselect current\n        profile\n      ansible.builtin.command:\n        cmd: authselect check\n      register: result_authselect_check_cmd\n      changed_when: false\n      failed_when: false\n\n    - name: Set PAM's Password Hashing Algorithm - Informative message based on the\n        authselect integrity check result\n      ansible.builtin.assert:\n        that:\n        - result_authselect_check_cmd.rc == 0\n        fail_msg:\n        - authselect integrity check failed. Remediation aborted!\n        - This remediation could not be applied because an authselect profile was\n          not selected or the selected profile is not intact.\n        - It is not recommended to manually edit the PAM files when authselect tool\n          is available.\n        - In cases where the default authselect profile does not cover a specific\n          demand, a custom authselect profile is recommended.\n        success_msg:\n        - authselect integrity check passed\n\n    - name: Set PAM's Password Hashing Algorithm - Get authselect current profile\n      ansible.builtin.shell:\n        cmd: authselect current -r | awk '{ print $1 }'\n      register: result_authselect_profile\n      changed_when: false\n      when:\n      - result_authselect_check_cmd is success\n\n    - name: Set PAM's Password Hashing Algorithm - Define the current authselect profile\n        as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: '{{ result_authselect_profile.stdout }}'\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Define the new authselect custom\n        profile as a local fact\n      ansible.builtin.set_fact:\n        authselect_current_profile: '{{ result_authselect_profile.stdout }}'\n        authselect_custom_profile: custom/hardening\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_profile.stdout is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Get authselect current features\n        to also enable them in the custom profile\n      ansible.builtin.shell:\n        cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n      register: result_authselect_features\n      changed_when: false\n      when:\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Check if any custom profile with\n        the same name was already created\n      ansible.builtin.stat:\n        path: /etc/authselect/{{ authselect_custom_profile }}\n      register: result_authselect_custom_profile_present\n      changed_when: false\n      when:\n      - authselect_current_profile is not match(\"custom/\")\n\n    - name: Set PAM's Password Hashing Algorithm - Create an authselect custom profile\n        based on the current profile\n      ansible.builtin.command:\n        cmd: authselect create-profile hardening -b {{ authselect_current_profile\n          }}\n      when:\n      - result_authselect_check_cmd is success\n      - authselect_current_profile is not match(\"custom/\")\n      - not result_authselect_custom_profile_present.stat.exists\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=before-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure the authselect custom profile\n        is selected\n      ansible.builtin.command:\n        cmd: authselect select {{ authselect_custom_profile }}\n      register: result_pam_authselect_select_profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - authselect_current_profile is not match(\"custom/\")\n      - authselect_custom_profile is not match(authselect_current_profile)\n\n    - name: Set PAM's Password Hashing Algorithm - Restore the authselect features\n        in the custom profile\n      ansible.builtin.command:\n        cmd: authselect enable-feature {{ item }}\n      loop: '{{ result_authselect_features.stdout_lines }}'\n      register: result_pam_authselect_restore_features\n      when:\n      - result_authselect_profile is not skipped\n      - result_authselect_features is not skipped\n      - result_pam_authselect_select_profile is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n      ansible.builtin.command:\n        cmd: authselect apply-changes -b --backup=after-hardening-custom-profile\n      when:\n      - result_authselect_check_cmd is success\n      - result_authselect_profile is not skipped\n      - result_pam_authselect_restore_features is not skipped\n\n    - name: Set PAM's Password Hashing Algorithm - Change the PAM file to be edited\n        according to the custom authselect profile\n      ansible.builtin.set_fact:\n        pam_file_path: /etc/authselect/{{ authselect_custom_profile }}/{{ pam_file_path\n          | basename }}\n    when:\n    - result_authselect_present.stat.exists\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure That Only the Correct Hashing\n      Algorithm Option For pam_unix.so Is Used in /etc/pam.d/system-auth\n    ansible.builtin.replace:\n      dest: '{{ pam_file_path }}'\n      regexp: (^\\s*password.*pam_unix\\.so.*)\\b{{ item }}\\b\\s*(.*)\n      replace: \\1\\2\n    when: item != var_password_hashing_algorithm_pam\n    loop:\n    - sha512\n    - yescrypt\n    - gost_yescrypt\n    - blowfish\n    - sha256\n    - md5\n    - bigcrypt\n    register: result_pam_hashing_options_removal\n\n  - name: Set PAM's Password Hashing Algorithm - Ensure authselect changes are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_present.stat.exists\n    - result_pam_hashing_options_removal is changed\n  when:\n  - '\"pam\" in ansible_facts.packages'\n  - result_pam_file_present.stat.exists\n  tags:\n  - CCE-80893-1\n  - CJIS-5.6.2.2\n  - DISA-STIG-RHEL-08-010159\n  - NIST-800-171-3.13.11\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.1\n  - PCI-DSSv4-8.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - set_password_hashing_algorithm_systemauth\n"
          },
          {
            "remediation_id": "set_password_hashing_algorithm_systemauth",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_password_hashing_algorithm_pam='sha512'\n\n\nPAM_FILE_PATH=\"/etc/pam.d/system-auth\"\nCONTROL=\"sufficient\"\n\nif [ -e \"$PAM_FILE_PATH\" ] ; then\n    PAM_FILE_PATH=\"$PAM_FILE_PATH\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"$PAM_FILE_PATH\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    if ! grep -qP \"^\\s*password\\s+$CONTROL\\s+pam_unix.so\\s*.*\" \"$PAM_FILE_PATH\"; then\n            # Line matching group + control + module was not found. Check group + module.\n            if [ \"$(grep -cP '^\\s*password\\s+.*\\s+pam_unix.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n                # The control is updated only if one single line matches.\n                sed -i -E --follow-symlinks \"s/^(\\s*password\\s+).*(\\bpam_unix.so.*)/\\1$CONTROL \\2/\" \"$PAM_FILE_PATH\"\n            else\n                echo \"password    $CONTROL    pam_unix.so\" >> \"$PAM_FILE_PATH\"\n            fi\n        fi\n        # Check the option\n        if ! grep -qP \"^\\s*password\\s+$CONTROL\\s+pam_unix.so\\s*.*\\s$var_password_hashing_algorithm_pam\\b\" \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks \"/\\s*password\\s+$CONTROL\\s+pam_unix.so.*/ s/$/ $var_password_hashing_algorithm_pam/\" \"$PAM_FILE_PATH\"\n        fi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"$PAM_FILE_PATH was not found\" >&2\nfi\n\n# Ensure only the correct hashing algorithm option is used.\ndeclare -a HASHING_ALGORITHMS_OPTIONS=(\"sha512\" \"yescrypt\" \"gost_yescrypt\" \"blowfish\" \"sha256\" \"md5\" \"bigcrypt\")\n\nfor hash_option in \"${HASHING_ALGORITHMS_OPTIONS[@]}\"; do\n  if [ \"$hash_option\" != \"$var_password_hashing_algorithm_pam\" ]; then\n    if grep -qP \"^\\s*password\\s+.*\\s+pam_unix.so\\s+.*\\b$hash_option\\b\" \"$PAM_FILE_PATH\"; then\n      if [ -e \"$PAM_FILE_PATH\" ] ; then\n    PAM_FILE_PATH=\"$PAM_FILE_PATH\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"$PAM_FILE_PATH\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    \nif grep -qP \"^\\s*password\\s+.*\\s+pam_unix.so\\s.*\\b$hash_option\\b\" \"$PAM_FILE_PATH\"; then\n    sed -i -E --follow-symlinks \"s/(.*password.*.*.*pam_unix.so.*)\\s$hash_option=?[[:alnum:]]*(.*)/\\1\\2/g\" \"$PAM_FILE_PATH\"\nfi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"$PAM_FILE_PATH was not found\" >&2\nfi\n    fi\n  fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244524",
        "stig_id": "RHEL-08-010159"
      },
      "xccdf_org.ssgproject.content_rule_account_unique_id": {
        "rule_id": "xccdf_org.ssgproject.content_rule_account_unique_id",
        "title": "Ensure All Accounts on the System Have Unique User IDs",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-89903-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000135",
              "CCI-000764",
              "CCI-000804"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000104-GPOS-00051",
              "SRG-OS-000121-GPOS-00062"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020240"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230371r627750_rule"
            ]
          }
        ],
        "description": "Change user IDs (UIDs), or delete accounts, so each has a unique name.",
        "rationale": "To assure accountability and prevent unauthenticated access, interactive users must be identified and authenticated to prevent potential misuse and compromise of the system.",
        "warnings": [
          {
            "text": "Automatic remediation of this control is not available due to unique requirements of each\nsystem.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-account_unique_id:def:1",
        "vuln_id": "SV-230371",
        "stig_id": "RHEL-08-020240"
      },
      "xccdf_org.ssgproject.content_rule_group_unique_id": {
        "rule_id": "xccdf_org.ssgproject.content_rule_group_unique_id",
        "title": "Ensure All Groups on the System Have Unique Group ID",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86201-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000764"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000104-GPOS-00051"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          }
        ],
        "description": "Change the group name or delete groups, so each has a unique id.",
        "rationale": "To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.",
        "warnings": [
          {
            "text": "Automatic remediation of this control is not available due to the unique requirements of each system.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-group_unique_id:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_group_unique_name": {
        "rule_id": "xccdf_org.ssgproject.content_rule_group_unique_name",
        "title": "Ensure All Groups on the System Have Unique Group Names",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86328-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          }
        ],
        "description": "Change the group name or delete groups, so each has a unique name.",
        "rationale": "To assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.",
        "warnings": [
          {
            "text": "Automatic remediation of this control is not available due to the unique requirements of each system.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-group_unique_name:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration": {
        "rule_id": "xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration",
        "title": "Set Account Expiration Following Inactivity",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80954-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "7",
              "8"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000017",
              "CCI-000795"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-004-6 R2.2.2",
              "CIP-004-6 R2.2.3",
              "CIP-007-3 R.1.3",
              "CIP-007-3 R5",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.3",
              "CIP-007-3 R5.2.1",
              "CIP-007-3 R5.2.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-2(3)",
              "CM-6(a)",
              "IA-4(e)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000118-GPOS-00060"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020260"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230373r627750_rule"
            ]
          }
        ],
        "description": "To specify the number of days after a password expires (which\nsignifies inactivity) until an account is permanently disabled, add or correct\nthe following line in <code>/etc/default/useradd</code>:\n<pre>INACTIVE=<i>30</i>\n         </pre>\nIf a password is currently on the verge of expiration, then\n<code>30</code>\nday(s) remain(s) until the account is automatically\ndisabled. However, if the password will not expire for another 60 days, then 60\ndays plus <code>30</code> day(s) could\nelapse until the account would be automatically disabled. See the\n<code>useradd</code> man page for more information.",
        "rationale": "Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system.\nDisabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials.\nOwners of inactive accounts will not notice if unauthorized access to their user account has been obtained.",
        "platforms": [
          "#package_shadow-utils"
        ],
        "oval_definition_id": "oval:ssg-account_disable_post_pw_expiration:def:1",
        "remediations": [
          {
            "remediation_id": "account_disable_post_pw_expiration",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80954-1\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020260\n  - NIST-800-171-3.5.6\n  - NIST-800-53-AC-2(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-4(e)\n  - PCI-DSS-Req-8.1.4\n  - PCI-DSSv4-8.2.6\n  - account_disable_post_pw_expiration\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_account_disable_post_pw_expiration # promote to variable\n  set_fact:\n    var_account_disable_post_pw_expiration: !!str 30\n  tags:\n    - always\n\n- name: Set Account Expiration Following Inactivity\n  lineinfile:\n    create: true\n    dest: /etc/default/useradd\n    regexp: ^INACTIVE\n    line: INACTIVE={{ var_account_disable_post_pw_expiration }}\n  when: '\"shadow-utils\" in ansible_facts.packages'\n  tags:\n  - CCE-80954-1\n  - CJIS-5.6.2.1.1\n  - DISA-STIG-RHEL-08-020260\n  - NIST-800-171-3.5.6\n  - NIST-800-53-AC-2(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-4(e)\n  - PCI-DSS-Req-8.1.4\n  - PCI-DSSv4-8.2.6\n  - account_disable_post_pw_expiration\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "account_disable_post_pw_expiration",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q shadow-utils; then\n\nvar_account_disable_post_pw_expiration='30'\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^INACTIVE\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s=%s\" \"$stripped_key\" \"$var_account_disable_post_pw_expiration\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^INACTIVE\\\\>\" \"/etc/default/useradd\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^INACTIVE\\\\>.*/$escaped_formatted_output/gi\" \"/etc/default/useradd\"\nelse\n    if [[ -s \"/etc/default/useradd\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/default/useradd\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/default/useradd\"\n    fi\n    cce=\"CCE-80954-1\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/default/useradd\" >> \"/etc/default/useradd\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/default/useradd\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230373",
        "stig_id": "RHEL-08-020260"
      },
      "xccdf_org.ssgproject.content_rule_account_unique_name": {
        "rule_id": "xccdf_org.ssgproject.content_rule_account_unique_name",
        "title": "Ensure All Accounts on the System Have Unique Names",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80674-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.6"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000770",
              "CCI-000804"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          }
        ],
        "description": "Ensure accounts on the system have unique names.\n\nTo ensure all accounts have unique names, run the following command:\n<pre>$ sudo getent passwd | awk -F: &#x27;{ print $1}&#x27; | uniq -d</pre>\nIf a username is returned, change or delete the username.",
        "rationale": "Unique usernames allow for accountability on the system.",
        "oval_definition_id": "oval:ssg-account_unique_name:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs",
        "title": "Set Password Maximum Age",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80647-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.6.2.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000199"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(d)",
              "IA-5(f)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000076-GPOS-00044"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.9"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020200"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230366r646878_rule"
            ]
          }
        ],
        "description": "To specify password maximum age for new accounts,\nedit the file <code>/etc/login.defs</code>\nand add or correct the following line:\n<pre>PASS_MAX_DAYS 365\n         </pre>\nA value of 180 days is sufficient for many environments.\nThe DoD requirement is 60.\nThe profile requirement is <code>365</code>.",
        "rationale": "Any password, no matter how complex, can eventually be cracked. Therefore, passwords\nneed to be changed periodically. If the operating system does not limit the lifetime\nof passwords and force users to change their passwords, there is the risk that the\noperating system passwords could be compromised.\n<br>\n         <br>\nSetting the password maximum age ensures users are required to\nperiodically change their passwords. Requiring shorter password lifetimes\nincreases the risk of users writing down the password in a convenient\nlocation subject to physical compromise.",
        "platforms": [
          "#package_shadow-utils"
        ],
        "oval_definition_id": "oval:ssg-accounts_maximum_age_login_defs:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_maximum_age_login_defs",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80647-1\n  - CJIS-5.6.2.1\n  - DISA-STIG-RHEL-08-020200\n  - NIST-800-171-3.5.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.4\n  - PCI-DSSv4-8.3.9\n  - accounts_maximum_age_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_maximum_age_login_defs # promote to variable\n  set_fact:\n    var_accounts_maximum_age_login_defs: !!str 365\n  tags:\n    - always\n\n- name: Set Password Maximum Age\n  lineinfile:\n    create: true\n    dest: /etc/login.defs\n    regexp: ^#?PASS_MAX_DAYS\n    line: PASS_MAX_DAYS {{ var_accounts_maximum_age_login_defs }}\n  when: '\"shadow-utils\" in ansible_facts.packages'\n  tags:\n  - CCE-80647-1\n  - CJIS-5.6.2.1\n  - DISA-STIG-RHEL-08-020200\n  - NIST-800-171-3.5.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.4\n  - PCI-DSSv4-8.3.9\n  - accounts_maximum_age_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_maximum_age_login_defs",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q shadow-utils; then\n\nvar_accounts_maximum_age_login_defs='365'\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^PASS_MAX_DAYS\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$var_accounts_maximum_age_login_defs\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^PASS_MAX_DAYS\\\\>\" \"/etc/login.defs\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^PASS_MAX_DAYS\\\\>.*/$escaped_formatted_output/gi\" \"/etc/login.defs\"\nelse\n    if [[ -s \"/etc/login.defs\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/login.defs\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/login.defs\"\n    fi\n    cce=\"CCE-80647-1\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/login.defs\" >> \"/etc/login.defs\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/login.defs\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230366",
        "stig_id": "RHEL-08-020200"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_set_max_life_existing": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_set_max_life_existing",
        "title": "Set Existing Passwords Maximum Age",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82473-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000199"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(d)",
              "IA-5(f)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000076-GPOS-00044"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.9"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020210"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230367r627750_rule"
            ]
          }
        ],
        "description": "Configure non-compliant accounts to enforce a 365-day maximum password lifetime\nrestriction by running the following command:\n<pre>$ sudo chage -M 365\n          <i>USER</i>\n         </pre>\n        ",
        "rationale": "Any password, no matter how complex, can eventually be cracked. Therefore,\npasswords need to be changed periodically. If the operating system does\nnot limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised.",
        "oval_definition_id": "oval:ssg-accounts_password_set_max_life_existing:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_set_max_life_existing",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_accounts_maximum_age_login_defs # promote to variable\n  set_fact:\n    var_accounts_maximum_age_login_defs: !!str 365\n  tags:\n    - always\n\n- name: Collect users with not correct maximum time period between password changes\n  ansible.builtin.command:\n    cmd: awk -F':' '(/^[^:]+:[^!*]/ && ($5 > {{ var_accounts_maximum_age_login_defs\n      }} || $5 == \"\")) {print $1}' /etc/shadow\n  register: user_names\n  tags:\n  - CCE-82473-0\n  - DISA-STIG-RHEL-08-020210\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSSv4-8.3.9\n  - accounts_password_set_max_life_existing\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Change the maximum time period between password changes\n  ansible.builtin.user:\n    user: '{{ item }}'\n    password_expire_max: '{{ var_accounts_maximum_age_login_defs }}'\n  with_items: '{{ user_names.stdout_lines }}'\n  when: user_names.stdout_lines | length > 0\n  tags:\n  - CCE-82473-0\n  - DISA-STIG-RHEL-08-020210\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSSv4-8.3.9\n  - accounts_password_set_max_life_existing\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_set_max_life_existing",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nvar_accounts_maximum_age_login_defs='365'\n\n\nwhile IFS= read -r i; do\n    \n    chage -M $var_accounts_maximum_age_login_defs $i\n\ndone <   <(awk -v var=\"$var_accounts_maximum_age_login_defs\" -F: '(/^[^:]+:[^!*]/ && ($5 > var || $5 == \"\")) {print $1}' /etc/shadow)\n"
          }
        ],
        "vuln_id": "SV-230367",
        "stig_id": "RHEL-08-020210"
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_set_warn_age_existing": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_set_warn_age_existing",
        "title": "Set Existing Passwords Warning Age",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86914-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000198"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(d)",
              "IA-5(f)"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.9"
            ]
          }
        ],
        "description": "To configure how many days prior to password expiration that a warning will be issued to\nusers, run the command:\n<pre>$ sudo chage --warndays 7\n          <i>USER</i>\n         </pre>\nThe DoD requirement is 7, and CIS recommendation is no less than 7 days.\nThis profile requirement is <code>7</code>.",
        "rationale": "Providing an advance warning that a password will be expiring gives users \ntime to think of a secure password. Users caught unaware may choose a simple \npassword or write it down where it may be discovered.",
        "oval_definition_id": "oval:ssg-accounts_password_set_warn_age_existing:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_set_warn_age_existing",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: XCCDF Value var_accounts_password_warn_age_login_defs # promote to variable\n  set_fact:\n    var_accounts_password_warn_age_login_defs: !!str 7\n  tags:\n    - always\n\n- name: Set Existing Passwords Warning Age - Collect Users With Incorrect Number of\n    Days of Warning Before Password Expires\n  ansible.builtin.command:\n    cmd: awk -F':' '(($6 < {{ var_accounts_password_warn_age_login_defs }} || $6 ==\n      \"\") && $2 ~ /^\\$/) {print $1}' /etc/shadow\n  register: result_pass_warn_age_user_names\n  changed_when: false\n  tags:\n  - CCE-86914-9\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSSv4-8.3.9\n  - accounts_password_set_warn_age_existing\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set Existing Passwords Warning Age - Ensure the Number of Days of Warning\n    Before Password Expires\n  ansible.builtin.command:\n    cmd: chage --warndays {{ var_accounts_password_warn_age_login_defs }} {{ item\n      }}\n  with_items: '{{ result_pass_warn_age_user_names.stdout_lines }}'\n  when: result_pass_warn_age_user_names is not skipped and result_pass_warn_age_user_names.stdout_lines\n    | length > 0\n  tags:\n  - CCE-86914-9\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSSv4-8.3.9\n  - accounts_password_set_warn_age_existing\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "accounts_password_set_warn_age_existing",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\nvar_accounts_password_warn_age_login_defs='7'\n\n\nwhile IFS= read -r i; do\n    chage --warndays $var_accounts_password_warn_age_login_defs $i\ndone <   <(awk -v var=\"$var_accounts_password_warn_age_login_defs\" -F: '(($6 < var || $6 == \"\") && $2 ~ /^\\$/) {print $1}' /etc/shadow)\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs",
        "title": "Set Password Warning Age",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80671-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "7",
              "8"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.8"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0418",
              "1055",
              "1402"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(d)",
              "IA-5(f)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.9"
            ]
          }
        ],
        "description": "To specify how many days prior to password\nexpiration that a warning will be issued to users,\nedit the file <code>/etc/login.defs</code> and add or correct\n the following line:\n<pre>PASS_WARN_AGE 7\n         </pre>\nThe DoD requirement is 7.\nThe profile requirement is <code>7</code>.",
        "rationale": "Setting the password warning age enables users to\nmake the change at a practical time.",
        "platforms": [
          "#package_shadow-utils"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_warn_age_login_defs:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_password_warn_age_login_defs",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80671-1\n  - NIST-800-171-3.5.8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.4\n  - PCI-DSSv4-8.3.9\n  - accounts_password_warn_age_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_password_warn_age_login_defs # promote to variable\n  set_fact:\n    var_accounts_password_warn_age_login_defs: !!str 7\n  tags:\n    - always\n\n- name: Set Password Warning Age\n  lineinfile:\n    dest: /etc/login.defs\n    regexp: ^PASS_WARN_AGE *[0-9]*\n    state: present\n    line: PASS_WARN_AGE        {{ var_accounts_password_warn_age_login_defs }}\n    create: true\n  when: '\"shadow-utils\" in ansible_facts.packages'\n  tags:\n  - CCE-80671-1\n  - NIST-800-171-3.5.8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(d)\n  - NIST-800-53-IA-5(f)\n  - PCI-DSS-Req-8.2.4\n  - PCI-DSSv4-8.3.9\n  - accounts_password_warn_age_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_password_warn_age_login_defs",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q shadow-utils; then\n\nvar_accounts_password_warn_age_login_defs='7'\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^PASS_WARN_AGE\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$var_accounts_password_warn_age_login_defs\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^PASS_WARN_AGE\\\\>\" \"/etc/login.defs\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^PASS_WARN_AGE\\\\>.*/$escaped_formatted_output/gi\" \"/etc/login.defs\"\nelse\n    if [[ -s \"/etc/login.defs\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/login.defs\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/login.defs\"\n    fi\n    cce=\"CCE-80671-1\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/login.defs\" >> \"/etc/login.defs\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/login.defs\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_set_post_pw_existing": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_set_post_pw_existing",
        "title": "Set existing passwords a period of inactivity before they been locked",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86758-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.4"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000017",
              "CCI-000795"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-004-6 R2.2.2",
              "CIP-004-6 R2.2.3",
              "CIP-007-3 R.1.3",
              "CIP-007-3 R5",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.3",
              "CIP-007-3 R5.2.1",
              "CIP-007-3 R5.2.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-2(3)",
              "CM-6(a)",
              "IA-4(e)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000118-GPOS-00060"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.6"
            ]
          }
        ],
        "description": "Configure user accounts that have been inactive for over a given period of time\nto be automatically disabled by running the following command:\n<pre>$ sudo chage --inactive 30<i>USER</i>\n         </pre>\n        ",
        "rationale": "Inactive accounts pose a threat to system security since the users are not logging in to\nnotice failed login attempts or other anomalies.",
        "oval_definition_id": "oval:ssg-accounts_set_post_pw_existing:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_set_post_pw_existing",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_account_disable_post_pw_expiration # promote to variable\n  set_fact:\n    var_account_disable_post_pw_expiration: !!str 30\n  tags:\n    - always\n\n- name: Collect users with not correct INACTIVE parameter set\n  ansible.builtin.command:\n    cmd: awk -F':' '(($7 > {{ var_account_disable_post_pw_expiration }} || $7 == \"\")\n      && $2 ~ /^\\$/) {print $1}' /etc/shadow\n  register: user_names\n  changed_when: false\n  tags:\n  - CCE-86758-0\n  - NIST-800-171-3.5.6\n  - NIST-800-53-AC-2(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-4(e)\n  - PCI-DSS-Req-8.1.4\n  - PCI-DSSv4-8.2.6\n  - accounts_set_post_pw_existing\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Change the period of inactivity\n  ansible.builtin.command:\n    cmd: chage --inactive {{ var_account_disable_post_pw_expiration }} {{ item }}\n  with_items: '{{ user_names.stdout_lines }}'\n  when: user_names is not skipped and user_names.stdout_lines | length > 0\n  tags:\n  - CCE-86758-0\n  - NIST-800-171-3.5.6\n  - NIST-800-53-AC-2(3)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-4(e)\n  - PCI-DSS-Req-8.1.4\n  - PCI-DSSv4-8.2.6\n  - accounts_set_post_pw_existing\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_set_post_pw_existing",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nvar_account_disable_post_pw_expiration='30'\n\n\nwhile IFS= read -r i; do\n    chage --inactive $var_account_disable_post_pw_expiration $i\ndone <   <(awk -v var=\"$var_account_disable_post_pw_expiration\" -F: '(($7 > var || $7 == \"\") && $2 ~ /^\\$/) {print $1}' /etc/shadow)\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed",
        "title": "Verify All Account Password Hashes are Shadowed",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80651-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.5.10"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1410"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(h)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.2"
            ]
          }
        ],
        "description": "If any password hashes are stored in <code>/etc/passwd</code> (in the second field,\ninstead of an <code>x</code> or <code>*</code>), the cause of this misconfiguration should be\ninvestigated. The account should have its password reset and the hash should be\nproperly stored, or the account should be deleted entirely.",
        "rationale": "The hashes for all user account passwords should be stored in\nthe file <code>/etc/shadow</code> and never in <code>/etc/passwd</code>,\nwhich is readable by all users.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_all_shadowed:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_password_last_change_is_in_past": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_password_last_change_is_in_past",
        "title": "Ensure all users last password change date is in the past",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86525-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.1.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.5"
            ]
          }
        ],
        "description": "All users should have a password change date in the past.",
        "rationale": "If a user recorded password change date is in the future then they could\nbypass any set password expiration.",
        "warnings": [
          {
            "text": "Automatic remediation is not available, in order to avoid any system disruption.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-accounts_password_last_change_is_in_past:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_gid_passwd_group_same": {
        "rule_id": "xccdf_org.ssgproject.content_rule_gid_passwd_group_same",
        "title": "All GIDs referenced in /etc/passwd must be defined in /etc/group",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-80822-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-2"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000104-GPOS-00051"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.5.a"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.2"
            ]
          }
        ],
        "description": "Add a group to the system for each GID referenced without a corresponding group.",
        "rationale": "If a user is assigned the Group Identifier (GID) of a group not existing on the system, and a group\nwith the Group Identifier (GID) is subsequently created, the user may have unintended rights to\nany files associated with the group.",
        "oval_definition_id": "oval:ssg-gid_passwd_group_same:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_no_empty_passwords": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_empty_passwords",
        "title": "Prevent Login to Accounts With Empty Password",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80841-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.4.3.4.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.02",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.1",
              "3.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "IA-5(1)(a)",
              "IA-5(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.2.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020331",
              "RHEL-08-020332"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244540r743869_rule",
              "SV-244541r743872_rule"
            ]
          }
        ],
        "description": "If an account is configured for password authentication\nbut does not have an assigned password, it may be possible to log\ninto the account without authentication. Remove any instances of the\n<code>nullok</code> in\n\n<code>/etc/pam.d/system-auth</code> and\n<code>/etc/pam.d/password-auth</code>\n\nto prevent logins with empty passwords.",
        "rationale": "If an account has an empty password, anyone could log in and\nrun commands with the privileges of that account. Accounts with\nempty passwords should never be used in operational environments.",
        "warnings": [
          {
            "text": "If the system relies on <code>authselect</code> tool to manage PAM settings, the remediation\nwill also use <code>authselect</code> tool. However, if any manual modification was made in\nPAM files, the <code>authselect</code> integrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nNote that this rule is not applicable for systems running within a\ncontainer. Having user with empty password within a container is not\nconsidered a risk, because it should not be possible to directly login into\na container anyway.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-no_empty_passwords:def:1",
        "remediations": [
          {
            "remediation_id": "no_empty_passwords",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Prevent Login to Accounts With Empty Password - Check if system relies on\n    authselect\n  ansible.builtin.stat:\n    path: /usr/bin/authselect\n  register: result_authselect_present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80841-0\n  - CJIS-5.5.2\n  - DISA-STIG-RHEL-08-020331\n  - DISA-STIG-RHEL-08-020332\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.3\n  - PCI-DSSv4-8.3.1\n  - configure_strategy\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_empty_passwords\n  - no_reboot_needed\n\n- name: Prevent Login to Accounts With Empty Password - Remediate using authselect\n  block:\n\n  - name: Prevent Login to Accounts With Empty Password - Check integrity of authselect\n      current profile\n    ansible.builtin.command:\n      cmd: authselect check\n    register: result_authselect_check_cmd\n    changed_when: false\n    failed_when: false\n\n  - name: Prevent Login to Accounts With Empty Password - Informative message based\n      on the authselect integrity check result\n    ansible.builtin.assert:\n      that:\n      - result_authselect_check_cmd.rc == 0\n      fail_msg:\n      - authselect integrity check failed. Remediation aborted!\n      - This remediation could not be applied because an authselect profile was not\n        selected or the selected profile is not intact.\n      - It is not recommended to manually edit the PAM files when authselect tool\n        is available.\n      - In cases where the default authselect profile does not cover a specific demand,\n        a custom authselect profile is recommended.\n      success_msg:\n      - authselect integrity check passed\n\n  - name: Prevent Login to Accounts With Empty Password - Get authselect current features\n    ansible.builtin.shell:\n      cmd: authselect current | tail -n+3 | awk '{ print $2 }'\n    register: result_authselect_features\n    changed_when: false\n    when:\n    - result_authselect_check_cmd is success\n\n  - name: Prevent Login to Accounts With Empty Password - Ensure \"without-nullok\"\n      feature is enabled using authselect tool\n    ansible.builtin.command:\n      cmd: authselect enable-feature without-nullok\n    register: result_authselect_enable_feature_cmd\n    when:\n    - result_authselect_check_cmd is success\n    - result_authselect_features.stdout is not search(\"without-nullok\")\n\n  - name: Prevent Login to Accounts With Empty Password - Ensure authselect changes\n      are applied\n    ansible.builtin.command:\n      cmd: authselect apply-changes -b\n    when:\n    - result_authselect_enable_feature_cmd is not skipped\n    - result_authselect_enable_feature_cmd is success\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - result_authselect_present.stat.exists\n  tags:\n  - CCE-80841-0\n  - CJIS-5.5.2\n  - DISA-STIG-RHEL-08-020331\n  - DISA-STIG-RHEL-08-020332\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.3\n  - PCI-DSSv4-8.3.1\n  - configure_strategy\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_empty_passwords\n  - no_reboot_needed\n\n- name: Prevent Login to Accounts With Empty Password - Remediate directly editing\n    PAM files\n  ansible.builtin.replace:\n    dest: '{{ item }}'\n    regexp: nullok\n  loop:\n  - /etc/pam.d/system-auth\n  - /etc/pam.d/password-auth\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - not result_authselect_present.stat.exists\n  tags:\n  - CCE-80841-0\n  - CJIS-5.5.2\n  - DISA-STIG-RHEL-08-020331\n  - DISA-STIG-RHEL-08-020332\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(a)\n  - NIST-800-53-IA-5(c)\n  - PCI-DSS-Req-8.2.3\n  - PCI-DSSv4-8.3.1\n  - configure_strategy\n  - high_severity\n  - low_complexity\n  - medium_disruption\n  - no_empty_passwords\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "no_empty_passwords",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,%23%20Generated%20by%20authselect%20on%20Sat%20Oct%2027%2014%3A59%3A36%202018%0A%23%20Do%20not%20modify%20this%20file%20manually.%0A%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_env.so%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_faildelay.so%20delay%3D2000000%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_fprintd.so%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20try_first_pass%0Aauth%20%20%20%20%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet_success%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20forward_pass%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3C%201000%20quiet%0Aaccount%20%20%20%20%20%5Bdefault%3Dbad%20success%3Dok%20user_unknown%3Dignore%5D%20pam_sss.so%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_permit.so%0A%0Apassword%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_pwquality.so%20try_first_pass%20local_users_only%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20sha512%20shadow%20try_first_pass%20use_authtok%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20use_authtok%0Apassword%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_keyinit.so%20revoke%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_limits.so%0A-session%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_systemd.so%0Asession%20%20%20%20%20%5Bsuccess%3D1%20default%3Dignore%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20service%20in%20crond%20quiet%20use_uid%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%0A\n        mode: 0644\n        path: /etc/pam.d/password-auth\n        overwrite: true\n      - contents:\n          source: data:,%23%20Generated%20by%20authselect%20on%20Sat%20Oct%2027%2014%3A59%3A36%202018%0A%23%20Do%20not%20modify%20this%20file%20manually.%0A%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_env.so%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_faildelay.so%20delay%3D2000000%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_fprintd.so%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet%0Aauth%20%20%20%20%20%20%20%20%5Bdefault%3D1%20ignore%3Dignore%20success%3Dok%5D%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20try_first_pass%0Aauth%20%20%20%20%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3E%3D%201000%20quiet_success%0Aauth%20%20%20%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20forward_pass%0Aauth%20%20%20%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_localuser.so%0Aaccount%20%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20uid%20%3C%201000%20quiet%0Aaccount%20%20%20%20%20%5Bdefault%3Dbad%20success%3Dok%20user_unknown%3Dignore%5D%20pam_sss.so%0Aaccount%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_permit.so%0A%0Apassword%20%20%20%20requisite%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_pwquality.so%20try_first_pass%20local_users_only%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%20sha512%20shadow%20try_first_pass%20use_authtok%0Apassword%20%20%20%20sufficient%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%20use_authtok%0Apassword%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_deny.so%0A%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_keyinit.so%20revoke%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_limits.so%0A-session%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_systemd.so%0Asession%20%20%20%20%20%5Bsuccess%3D1%20default%3Dignore%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_succeed_if.so%20service%20in%20crond%20quiet%20use_uid%0Asession%20%20%20%20%20required%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_unix.so%0Asession%20%20%20%20%20optional%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pam_sss.so%0A\n        mode: 0644\n        path: /etc/pam.d/system-auth\n        overwrite: true\n"
          },
          {
            "remediation_id": "no_empty_passwords",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature without-nullok\n\nauthselect apply-changes -b\nelse\n    \nif grep -qP \"^\\s*auth\\s+sufficient\\s+pam_unix.so\\s.*\\bnullok\\b\" \"/etc/pam.d/system-auth\"; then\n    sed -i -E --follow-symlinks \"s/(.*auth.*sufficient.*pam_unix.so.*)\\snullok=?[[:alnum:]]*(.*)/\\1\\2/g\" \"/etc/pam.d/system-auth\"\nfi\n    \nif grep -qP \"^\\s*password\\s+sufficient\\s+pam_unix.so\\s.*\\bnullok\\b\" \"/etc/pam.d/system-auth\"; then\n    sed -i -E --follow-symlinks \"s/(.*password.*sufficient.*pam_unix.so.*)\\snullok=?[[:alnum:]]*(.*)/\\1\\2/g\" \"/etc/pam.d/system-auth\"\nfi\n    \nif grep -qP \"^\\s*auth\\s+sufficient\\s+pam_unix.so\\s.*\\bnullok\\b\" \"/etc/pam.d/password-auth\"; then\n    sed -i -E --follow-symlinks \"s/(.*auth.*sufficient.*pam_unix.so.*)\\snullok=?[[:alnum:]]*(.*)/\\1\\2/g\" \"/etc/pam.d/password-auth\"\nfi\n    \nif grep -qP \"^\\s*password\\s+sufficient\\s+pam_unix.so\\s.*\\bnullok\\b\" \"/etc/pam.d/password-auth\"; then\n    sed -i -E --follow-symlinks \"s/(.*password.*sufficient.*pam_unix.so.*)\\snullok=?[[:alnum:]]*(.*)/\\1\\2/g\" \"/etc/pam.d/password-auth\"\nfi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244540",
        "stig_id": "RHEL-08-020331"
      },
      "xccdf_org.ssgproject.content_rule_no_empty_passwords_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_empty_passwords_etc_shadow",
        "title": "Ensure There Are No Accounts With Blank or Null Passwords",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-85953-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(b)",
              "CM-6.1(iv)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010121"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-251706r809342_rule"
            ]
          }
        ],
        "description": "Check the &quot;/etc/shadow&quot; file for blank passwords with the\nfollowing command:\n<pre>$ sudo awk -F: &#x27;!$2 {print $1}&#x27; /etc/shadow</pre>\nIf the command returns any results, this is a finding.\nConfigure all accounts on the system to have a password or lock\nthe account with the following commands:\nPerform a password reset:\n<pre>$ sudo passwd [username]</pre>\nLock an account:\n<pre>$ sudo passwd -l [username]</pre>\n        ",
        "rationale": "If an account has an empty password, anyone could log in and\nrun commands with the privileges of that account. Accounts with\nempty passwords should never be used in operational environments.",
        "warnings": [
          {
            "text": "Note that this rule is not applicable for systems running within a container. Having user with empty password within a container is not considered a risk, because it should not be possible to directly login into a container anyway.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-no_empty_passwords_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "no_empty_passwords_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Collect users with no password\n  command: |\n    awk -F: '!$2 {print $1}' /etc/shadow\n  register: users_nopasswd\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85953-8\n  - DISA-STIG-RHEL-08-010121\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - PCI-DSSv4-2.2.2\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_empty_passwords_etc_shadow\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock users with no password\n  command: |\n    passwd -l {{ item }}\n  with_items: '{{ users_nopasswd.stdout_lines }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - users_nopasswd is not skipped and users_nopasswd.stdout_lines | length > 0\n  tags:\n  - CCE-85953-8\n  - DISA-STIG-RHEL-08-010121\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - PCI-DSSv4-2.2.2\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_empty_passwords_etc_shadow\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "no_empty_passwords_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nreadarray -t users_with_empty_pass < <(sudo awk -F: '!$2 {print $1}' /etc/shadow)\n\nfor user_with_empty_pass in \"${users_with_empty_pass[@]}\"\ndo\n    passwd -l $user_with_empty_pass\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-251706",
        "stig_id": "RHEL-08-010121"
      },
      "xccdf_org.ssgproject.content_rule_no_forward_files": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_forward_files",
        "title": "Verify No .forward Files Exist",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86755-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          }
        ],
        "description": "The <code>.forward</code> file specifies an email address to forward the user&#x27;s mail to.",
        "rationale": "Use of the <code>.forward</code> file poses a security risk in that sensitive data may\nbe inadvertently transferred outside the organization. The .forward file\nalso poses a risk as it can be used to execute commands that may perform\nunintended actions.",
        "oval_definition_id": "oval:ssg-no_forward_files:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero",
        "title": "Verify Only Root Has UID 0",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80649-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.9"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.02",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.1",
              "3.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(5)",
              "IA-2",
              "IA-4(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040200"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230534r627750_rule"
            ]
          }
        ],
        "description": "If any account other than root has a UID of 0, this misconfiguration should\nbe investigated and the accounts other than root should be removed or have\ntheir UID changed.\n<br>\nIf the account is associated with system commands or applications the UID\nshould be changed to one greater than &quot;0&quot; but less than &quot;1000.&quot;\nOtherwise assign a UID greater than &quot;1000&quot; that has not already been\nassigned.",
        "rationale": "An account has root authority if it has a UID of 0. Multiple accounts\nwith a UID of 0 afford more opportunity for potential intruders to\nguess a password for a privileged account. Proper configuration of\nsudo is recommended to afford multiple system administrators\naccess to root privileges in an accountable manner.",
        "oval_definition_id": "oval:ssg-accounts_no_uid_except_zero:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_no_uid_except_zero",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Get all /etc/passwd file entries\n  getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-80649-7\n  - DISA-STIG-RHEL-08-040200\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-AC-6(5)\n  - NIST-800-53-IA-2\n  - NIST-800-53-IA-4(b)\n  - PCI-DSS-Req-8.5\n  - PCI-DSSv4-8.2.1\n  - accounts_no_uid_except_zero\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Lock the password of the user accounts other than root with uid 0\n  command: passwd -l {{ item.key }}\n  loop: '{{ getent_passwd | dict2items | rejectattr(''key'', ''search'', ''root'')\n    | list }}'\n  when: item.value.1  == '0'\n  tags:\n  - CCE-80649-7\n  - DISA-STIG-RHEL-08-040200\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-AC-6(5)\n  - NIST-800-53-IA-2\n  - NIST-800-53-IA-4(b)\n  - PCI-DSS-Req-8.5\n  - PCI-DSSv4-8.2.1\n  - accounts_no_uid_except_zero\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_no_uid_except_zero",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "awk -F: '$3 == 0 && $1 != \"root\" { print $1 }' /etc/passwd | xargs --no-run-if-empty --max-lines=1 passwd -l\n"
          }
        ],
        "vuln_id": "SV-230534",
        "stig_id": "RHEL-08-040200"
      },
      "xccdf_org.ssgproject.content_rule_accounts_root_gid_zero": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_root_gid_zero",
        "title": "Verify Root Has A Primary GID 0",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-86297-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.2.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.1"
            ]
          }
        ],
        "description": "The <code>root</code> user should have a primary group of 0.",
        "rationale": "To help ensure that root-owned files are not inadvertently exposed to other users.",
        "oval_definition_id": "oval:ssg-accounts_root_gid_zero:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_ensure_pam_wheel_group_empty": {
        "rule_id": "xccdf_org.ssgproject.content_rule_ensure_pam_wheel_group_empty",
        "title": "Ensure the Group Used by pam_wheel.so Module Exists on System and is Empty",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86071-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "Ensure that the group <code>sugroup</code> referenced by\n<code>var_pam_wheel_group_for_su</code> variable and used as value for the <code>pam_wheel.so</code>\n         <code>group</code> option exists and has no members. This empty group used by\n<code>pam_wheel.so</code> in <code>/etc/pam.d/su</code> ensures that no user can run commands with\naltered privileges through the <code>su</code> command.",
        "rationale": "The <code>su</code> program allows to run commands with a substitute user and group ID.\nIt is commonly used to run commands as the root user.\nLimiting access to such command is considered a good security practice.",
        "warnings": [
          {
            "text": "Note that this rule just ensures the group exists and has no members. This rule does not\nconfigure <code>pam_wheel.so</code> module. The <code>pam_wheel.so</code> module configuration is\naccomplished by <code>use_pam_wheel_group_for_su</code> rule.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-ensure_pam_wheel_group_empty:def:1",
        "remediations": [
          {
            "remediation_id": "ensure_pam_wheel_group_empty",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86071-8\n  - PCI-DSSv4-2.2.6\n  - ensure_pam_wheel_group_empty\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_pam_wheel_group_for_su # promote to variable\n  set_fact:\n    var_pam_wheel_group_for_su: !!str sugroup\n  tags:\n    - always\n\n- name: Ensure the Group Used by pam_wheel.so Module Exists on System and is Empty\n    - Ensure {{ var_pam_wheel_group_for_su }} Group Exists\n  ansible.builtin.group:\n    name: '{{ var_pam_wheel_group_for_su }}'\n    state: present\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-86071-8\n  - PCI-DSSv4-2.2.6\n  - ensure_pam_wheel_group_empty\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Group Used by pam_wheel.so Module Exists on System and is Empty\n    - Ensure {{ var_pam_wheel_group_for_su }} Group is Empty\n  ansible.builtin.lineinfile:\n    path: /etc/group\n    regexp: ^({{ var_pam_wheel_group_for_su }}:[^:]+:[0-9]+:).*$\n    line: \\1\n    backrefs: true\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-86071-8\n  - PCI-DSSv4-2.2.6\n  - ensure_pam_wheel_group_empty\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "ensure_pam_wheel_group_empty",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_pam_wheel_group_for_su='sugroup'\n\n\nif ! grep -q \"^${var_pam_wheel_group_for_su}:[^:]*:[^:]*:[^:]*\" /etc/group; then\n    groupadd ${var_pam_wheel_group_for_su}\nfi\n\n# group must be empty\ngpasswd -M '' ${var_pam_wheel_group_for_su}\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_ensure_root_password_configured": {
        "rule_id": "xccdf_org.ssgproject.content_rule_ensure_root_password_configured",
        "title": "Ensure Authentication Required for Single User Mode",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86517-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.2"
            ]
          }
        ],
        "description": "Single user mode is used for recovery when the system detects an\nissue during boot or by manual selection from the bootloader.",
        "rationale": "Requiring authentication in single user mode prevents an unauthorized\nuser from rebooting the system into single user to gain root privileges\nwithout credentials.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-ensure_root_password_configured:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_no_password_auth_for_systemaccounts": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_password_auth_for_systemaccounts",
        "title": "Ensure that System Accounts Are Locked",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86112-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.2.3"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "CM-6(a)"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.2"
            ]
          }
        ],
        "description": "Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. An attacker should not be able to log into these accounts.\n<br>\n         <br>\nSystem accounts are those user accounts with a user ID less than <code>1000</code>.\nIf any system account other than <code>root</code>, <code>halt</code>, <code>sync</code>, <code>shutdown</code>\nand <code>nfsnobody</code> has an unlocked password, disable it with the command:\n<pre>$ sudo usermod -L <i>account</i>\n         </pre>\n        ",
        "rationale": "Disabling authentication for default system accounts makes it more difficult for attackers\nto make use of them to compromise a system.",
        "oval_definition_id": "oval:ssg-no_password_auth_for_systemaccounts:def:1",
        "remediations": [
          {
            "remediation_id": "no_password_auth_for_systemaccounts",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "restrict",
            "fix": "- name: Ensure that System Accounts Are Locked - Get All Local Users From /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-86112-0\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_password_auth_for_systemaccounts\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure that System Accounts Are Locked - Create local_users Variable From\n    getent_passwd Facts\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd | dict2items }}'\n  tags:\n  - CCE-86112-0\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_password_auth_for_systemaccounts\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure that System Accounts Are Locked - Lock System Accounts\n  ansible.builtin.user:\n    name: '{{ item.key }}'\n    password_lock: true\n  loop: '{{ local_users }}'\n  when:\n  - item.value[1]|int < 1000\n  - item.key not in ['root', 'halt', 'sync', 'shutdown', 'nfsnobody']\n  tags:\n  - CCE-86112-0\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_password_auth_for_systemaccounts\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "no_password_auth_for_systemaccounts",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "restrict",
            "fix": "\nreadarray -t systemaccounts < <(awk -F: \\\n  '($3 < 1000 && $3 != root && $3 != halt && $3 != sync && $3 != shutdown \\\n  && $3 != nfsnobody) { print $1 }' /etc/passwd)\n\nfor systemaccount in \"${systemaccounts[@]}\"; do\n    usermod -L \"$systemaccount\"\ndone\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts",
        "title": "Ensure that System Accounts Do Not Run a Shell Upon Login",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80843-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "7",
              "8"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1491"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "CM-6(a)",
              "CM-6(b)",
              "CM-6.1(iv)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.2"
            ]
          }
        ],
        "description": "Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. Should an attacker be able to log into these accounts, they should\nnot be granted access to a shell.\n<br>\n         <br>\nThe login shell for each local account is stored in the last field of each line in\n<code>/etc/passwd</code>. System accounts are those user accounts with a user ID less than\n<code>1000</code>. The user ID is stored in the third field. If any system account\nother than <code>root</code> has a login shell, disable it with the command:\n<pre>$ sudo usermod -s /sbin/nologin <i>account</i>\n         </pre>\n        ",
        "rationale": "Ensuring shells are not given to system accounts upon login makes it more difficult for\nattackers to make use of system accounts.",
        "warnings": [
          {
            "text": "Do not perform the steps in this section on the root account. Doing so might cause the\nsystem to become inaccessible.",
            "category": "functionality"
          }
        ],
        "oval_definition_id": "oval:ssg-no_shelllogin_for_systemaccounts:def:1",
        "remediations": [
          {
            "remediation_id": "no_shelllogin_for_systemaccounts",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "restrict",
            "fix": "- name: Ensure that System Accounts Do Not Run a Shell Upon Login - Get All Local\n    Users From /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-80843-6\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - no_shelllogin_for_systemaccounts\n  - restrict_strategy\n\n- name: Ensure that System Accounts Do Not Run a Shell Upon Login - Create local_users\n    Variable From getent_passwd Facts\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd | dict2items }}'\n  tags:\n  - CCE-80843-6\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - no_shelllogin_for_systemaccounts\n  - restrict_strategy\n\n- name: Ensure that System Accounts Do Not Run a Shell Upon Login -  Disable Login\n    Shell for System Accounts\n  ansible.builtin.user:\n    name: '{{ item.key }}'\n    shell: /sbin/nologin\n  loop: '{{ local_users }}'\n  when:\n  - item.key not in ['root']\n  - item.value[1]|int < 1000\n  - item.value[5] not in ['/sbin/shutdown', '/sbin/halt', '/bin/sync']\n  tags:\n  - CCE-80843-6\n  - NIST-800-53-AC-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - PCI-DSSv4-8.2.2\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - no_shelllogin_for_systemaccounts\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "no_shelllogin_for_systemaccounts",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "restrict",
            "fix": "\nreadarray -t systemaccounts < <(awk -F: '($3 < 1000 && $3 != root \\\n  && $7 != \"\\/sbin\\/shutdown\" && $7 != \"\\/sbin\\/halt\" && $7 != \"\\/bin\\/sync\") \\\n  { print $1 }' /etc/passwd)\n\nfor systemaccount in \"${systemaccounts[@]}\"; do\n    usermod -s /sbin/nologin \"$systemaccount\"\ndone\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_use_pam_wheel_group_for_su": {
        "rule_id": "xccdf_org.ssgproject.content_rule_use_pam_wheel_group_for_su",
        "title": "Enforce Usage of pam_wheel with Group Parameter for su Authentication",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86064-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.3.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "To ensure that only users who are members of the group set in the <code>group</code> option of\n<code>pam_wheel.so</code> module can run commands with altered privileges through the <code>su</code>\ncommand, make sure that the following line exists in the file <code>/etc/pam.d/su</code>:\n<pre>auth required pam_wheel.so use_uid group=sugroup\n         </pre>\n        ",
        "rationale": "The <code>su</code> program allows to run commands with a substitute user and group ID.\nIt is commonly used to run commands as the root user.\nLimiting access to such command is considered a good security practice.",
        "warnings": [
          {
            "text": "Note that <code>ensure_pam_wheel_group_empty</code> rule complements this requirement by\nensuring the referenced group exists and has no members.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_pam"
        ],
        "oval_definition_id": "oval:ssg-use_pam_wheel_group_for_su:def:1",
        "remediations": [
          {
            "remediation_id": "use_pam_wheel_group_for_su",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86064-3\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - use_pam_wheel_group_for_su\n- name: XCCDF Value var_pam_wheel_group_for_su # promote to variable\n  set_fact:\n    var_pam_wheel_group_for_su: !!str sugroup\n  tags:\n    - always\n\n- name: Enforce Usage of pam_wheel with Group Parameter for su Authentication - Add\n    the group to the /etc/pam.d/su file\n  ansible.builtin.lineinfile:\n    path: /etc/pam.d/su\n    state: present\n    regexp: ^[\\s]*#[\\s]*auth[\\s]+required[\\s]+pam_wheel\\.so[\\s]+use_uid group=$\n    line: auth             required        pam_wheel.so use_uid group={{ var_pam_wheel_group_for_su\n      }}\n  when: '\"pam\" in ansible_facts.packages'\n  tags:\n  - CCE-86064-3\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - use_pam_wheel_group_for_su\n"
          },
          {
            "remediation_id": "use_pam_wheel_group_for_su",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q pam; then\n\nvar_pam_wheel_group_for_su='sugroup'\n\n\nPAM_CONF=/etc/pam.d/su\n\npamstr=$(grep -P '^auth\\s+required\\s+pam_wheel\\.so\\s+(?=[^#]*\\buse_uid\\b)(?=[^#]*\\bgroup=)' ${PAM_CONF})\nif [ -z \"$pamstr\" ]; then\n    sed -Ei '/^auth\\b.*\\brequired\\b.*\\bpam_wheel\\.so/d' ${PAM_CONF} # remove any remaining uncommented pam_wheel.so line\n    sed -Ei \"/^auth\\s+sufficient\\s+pam_rootok\\.so.*$/a auth             required        pam_wheel.so use_uid group=${var_pam_wheel_group_for_su}\" ${PAM_CONF}\nelse\n    group_val=$(echo -n \"$pamstr\" | grep -Eo '\\bgroup=[_a-z][-0-9_a-z]*' | cut -d '=' -f 2)\n    if [ -z \"${group_val}\" ] || [ ${group_val} != ${var_pam_wheel_group_for_su} ]; then\n        sed -Ei \"s/(^auth\\s+required\\s+pam_wheel.so\\s+[^#]*group=)[_a-z][-0-9_a-z]*/\\1${var_pam_wheel_group_for_su}/\" ${PAM_CONF}\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_tmout": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_tmout",
        "title": "Set Interactive Session Timeout",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80673-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R32"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000057",
              "CCI-001133",
              "CCI-002361"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-004-6 R2.2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-12",
              "AC-2(5)",
              "CM-6(a)",
              "SC-10"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000029-GPOS-00010",
              "SRG-OS-000163-GPOS-00072"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_MOF_EXT.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.6.1"
            ]
          }
        ],
        "description": "Setting the <code>TMOUT</code> option in <code>/etc/profile</code> ensures that\nall user sessions will terminate based on inactivity.\nThe value of TMOUT should be exported and read only.\nThe <code>TMOUT</code>\n\nsetting in a file loaded by <code>/etc/profile</code>, e.g.\n<code>/etc/profile.d/tmout.sh</code> should read as follows:\n<pre>typeset -xr TMOUT=900\n        </pre>\nor\n<pre>declare -xr TMOUT=900\n        </pre>\nUsing the <code>typeset</code> keyword is preferred for wider compatibility with ksh and other shells.",
        "rationale": "Terminating an idle session within a short time period reduces\nthe window of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been\nleft unattended.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-accounts_tmout:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_tmout",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_accounts_tmout # promote to variable\n  set_fact:\n    var_accounts_tmout: !!str 900\n  tags:\n    - always\n\n- name: Correct any occurrence of TMOUT in /etc/profile\n  replace:\n    path: /etc/profile\n    regexp: ^[^#].*TMOUT=.*\n    replace: typeset -xr TMOUT={{ var_accounts_tmout }}\n  register: profile_replaced\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80673-7\n  - NIST-800-171-3.1.11\n  - NIST-800-53-AC-12\n  - NIST-800-53-AC-2(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-10\n  - PCI-DSSv4-8.6.1\n  - accounts_tmout\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set Interactive Session Timeout\n  lineinfile:\n    path: /etc/profile.d/tmout.sh\n    create: true\n    regexp: TMOUT=\n    line: typeset -xr TMOUT={{ var_accounts_tmout }}\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80673-7\n  - NIST-800-171-3.1.11\n  - NIST-800-53-AC-12\n  - NIST-800-53-AC-2(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-10\n  - PCI-DSSv4-8.6.1\n  - accounts_tmout\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_tmout",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_accounts_tmout='900'\n\n\n# if 0, no occurence of tmout found, if 1, occurence found\ntmout_found=0\n\n\nfor f in /etc/profile /etc/profile.d/*.sh; do\n\n    if grep --silent '^[^#].*TMOUT' $f; then\n        sed -i -E \"s/^(.*)TMOUT\\s*=\\s*(\\w|\\$)*(.*)$/typeset -xr TMOUT=$var_accounts_tmout\\3/g\" $f\n        tmout_found=1\n    fi\ndone\n\nif [ $tmout_found -eq 0 ]; then\n        echo -e \"\\n# Set TMOUT to $var_accounts_tmout per security requirements\" >> /etc/profile.d/tmout.sh\n        echo \"typeset -xr TMOUT=$var_accounts_tmout\" >> /etc/profile.d/tmout.sh\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_user_dot_group_ownership": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_user_dot_group_ownership",
        "title": "User Initialization Files Must Be Group-Owned By The Primary Group",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86314-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "Change the group owner of interactive users files to the group found\nin <pre>/etc/passwd</pre> for the user. To change the group owner of a local\ninteractive user home directory, use the following command:\n<pre>$ sudo chgrp <i>USER_GROUP</i> /home/<i>USER</i>/.<i>INIT_FILE</i>\n        </pre>\n\nThis rule ensures every initialization file related to an interactive user\nis group-owned by an interactive user.",
        "rationale": "Local initialization files for interactive users are used to configure the\nuser&#x27;s shell environment upon logon. Malicious modification of these files could\ncompromise accounts upon logon.",
        "warnings": [
          {
            "text": "Due to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the group-ownership\nof their respective initialization files.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-accounts_user_dot_group_ownership:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_user_dot_group_ownership",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure interactive local users are the group-owners of their respective initialization\n    files\n  ansible.builtin.command:\n    cmd: awk -F':' '{ if ($3 >= 1000 && $3 != 65534) system(\"chgrp -f \" $4\" \"$6\"/.[^\\.]?*\")\n      }' /etc/passwd\n  tags:\n  - CCE-86314-2\n  - accounts_user_dot_group_ownership\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_user_dot_group_ownership",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nawk -F':' '{ if ($3 >= 1000 && $3 != 65534) system(\"chgrp -f \" $4\" \"$6\"/.[^\\.]?*\") }' /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_user_dot_user_ownership": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_user_dot_user_ownership",
        "title": "User Initialization Files Must Be Owned By the Primary User",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86316-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "Set the owner of the user initialization files for interactive users to\nthe primary owner with the following command:\n<pre>$ sudo chown <i>USER</i> /home/<i>USER</i>/.*</pre>\n\nThis rule ensures every initialization file related to an interactive user\nis owned by an interactive user.",
        "rationale": "Local initialization files are used to configure the user&#x27;s shell environment\nupon logon. Malicious modification of these files could compromise accounts upon\nlogon.",
        "warnings": [
          {
            "text": "Due to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the ownership of\ntheir respective initialization files.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-accounts_user_dot_user_ownership:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_user_dot_user_ownership",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure interactive local users are the owners of their respective initialization\n    files\n  ansible.builtin.command:\n    cmd: awk -F':' '{ if ($3 >= 1000 && $3 != 65534) system(\"chown -f \" $3\" \"$6\"/.[^\\.]?*\")\n      }' /etc/passwd\n  tags:\n  - CCE-86316-7\n  - accounts_user_dot_user_ownership\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_user_dot_user_ownership",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nawk -F':' '{ if ($3 >= 1000 && $3 != 65534) system(\"chown -f \" $3\" \"$6\"/.[^\\.]?*\") }' /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_user_interactive_home_directory_exists": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_user_interactive_home_directory_exists",
        "title": "All Interactive Users Home Directories Must Exist",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83424-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010750"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230323r627750_rule"
            ]
          }
        ],
        "description": "Create home directories to all local interactive users that currently do not\nhave a home directory assigned. Use the following commands to create the user\nhome directory assigned in <code>/etc/passwd</code>:\n<pre>$ sudo mkdir /home/<i>USER</i>\n        </pre>\n       ",
        "rationale": "If a local interactive user has a home directory defined that does not exist,\nthe user may be given access to the / directory as the current working directory\nupon logon. This could create a Denial of Service because the user would not be\nable to access their logon configuration files, and it may give them visibility\nto system files they normally would not be able to access.",
        "oval_definition_id": "oval:ssg-accounts_user_interactive_home_directory_exists:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_user_interactive_home_directory_exists",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Get all local users from /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-83424-2\n  - DISA-STIG-RHEL-08-010750\n  - accounts_user_interactive_home_directory_exists\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Create local_users variable from the getent output\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd|dict2items }}'\n  tags:\n  - CCE-83424-2\n  - DISA-STIG-RHEL-08-010750\n  - accounts_user_interactive_home_directory_exists\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure interactive users have a home directory exists\n  ansible.builtin.user:\n    name: '{{ item.key }}'\n    create_home: true\n  loop: '{{ local_users }}'\n  when:\n  - item.value[2]|int >= 1000\n  - item.value[2]|int != 65534\n  tags:\n  - CCE-83424-2\n  - DISA-STIG-RHEL-08-010750\n  - accounts_user_interactive_home_directory_exists\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_user_interactive_home_directory_exists",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nfor user in $(awk -F':' '{ if ($3 >= 1000 && $3 != 65534) print $1}' /etc/passwd); do\n    mkhomedir_helper $user 0077;\ndone\n"
          }
        ],
        "vuln_id": "SV-230323",
        "stig_id": "RHEL-08-010750"
      },
      "xccdf_org.ssgproject.content_rule_accounts_users_netrc_file_permissions": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_users_netrc_file_permissions",
        "title": "Ensure users' .netrc Files are not group or world accessible",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87369-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          }
        ],
        "description": "While the system administrator can establish secure permissions for users&#x27; .netrc files, the\nusers can easily override these.\n\nThis rule ensures every .netrc file or directory under the home directory related\nto an interactive user is not group or world accessible",
        "rationale": ".netrc files may contain unencrypted passwords that may be used to attack other systems.\nNote: While the complete removal of .netrc files is recommended, if any are required on the\n      system, secure permissions must be applied.",
        "oval_definition_id": "oval:ssg-accounts_users_netrc_file_permissions:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_users_netrc_file_permissions",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Get all local users from /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-87369-5\n  - accounts_users_netrc_file_permissions\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Create local_users variable from the getent output\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd|dict2items }}'\n  tags:\n  - CCE-87369-5\n  - accounts_users_netrc_file_permissions\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Test for existence of .netrc file in home directories to avoid creating them,\n    but only fixing permissions\n  ansible.builtin.stat:\n    path: '{{ item.value[4] }}/.netrc'\n  register: path_exists\n  loop: '{{ local_users }}'\n  when:\n  - item.value[1]|int >= 1000\n  - item.value[1]|int != 65534\n  tags:\n  - CCE-87369-5\n  - accounts_users_netrc_file_permissions\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure group and world cannot access respective .netrc files\n  ansible.builtin.file:\n    path: '{{ item.item.value[4] }}/.netrc'\n    mode: '0600'\n    state: file\n  loop: '{{ path_exists.results }}'\n  when: item.stat is defined and item.stat.exists\n  tags:\n  - CCE-87369-5\n  - accounts_users_netrc_file_permissions\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_users_netrc_file_permissions",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nfor user in $(awk -F':' '{ if ($3 >= 1000 && $3 != 65534) print $1 }' /etc/passwd); do\n    home_dir=$(getent passwd \"$user\" | cut -d: -f6)\n    find \"${home_dir}/.netrc\" -exec chmod 0600 {} \\;\ndone\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_ownership_home_directories": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_ownership_home_directories",
        "title": "All Interactive User Home Directories Must Be Owned By The Primary User",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86131-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "Change the owner of interactive users home directories to that correct\nowner. To change the owner of a interactive users home directory, use\nthe following command:\n<pre>$ sudo chown <i>USER</i> /home/<i>USER</i>\n        </pre>\n\nThis rule ensures every home directory related to an interactive user is\nowned by an interactive user. It also ensures that interactive users are\nowners of one and only one home directory.",
        "rationale": "If a local interactive user does not own their home directory, unauthorized\nusers could access or modify the user&#x27;s files, and the users may not be able to\naccess their own files.",
        "warnings": [
          {
            "text": "Due to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the ownership of\ntheir respective home directories.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-file_ownership_home_directories:def:1",
        "remediations": [
          {
            "remediation_id": "file_ownership_home_directories",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Get all local users from /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-86131-0\n  - file_ownership_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Create local_users variable from the getent output\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd|dict2items }}'\n  tags:\n  - CCE-86131-0\n  - file_ownership_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Test for existence of home directories to avoid creating them, but only fixing\n    ownership\n  ansible.builtin.stat:\n    path: '{{ item.value[4] }}'\n  register: path_exists\n  loop: '{{ local_users }}'\n  when:\n  - item.value[1]|int >= 1000\n  - item.value[1]|int != 65534\n  tags:\n  - CCE-86131-0\n  - file_ownership_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure interactive local users are the owners of their respective home directories\n  ansible.builtin.file:\n    path: '{{ item.0.value[4] }}'\n    owner: '{{ item.0.value[1] }}'\n  loop: '{{ local_users|zip(path_exists.results)|list }}'\n  when: item.1.stat is defined and item.1.stat.exists\n  tags:\n  - CCE-86131-0\n  - file_ownership_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "file_ownership_home_directories",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nawk -F':' '{ if ($3 >= 1000 && $3 != 65534) system(\"chown -f \" $3\" \"$6) }' /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permission_user_init_files": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permission_user_init_files",
        "title": "Ensure All User Initialization Files Have Mode 0740 Or Less Permissive",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-84043-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010770"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230325r917879_rule"
            ]
          }
        ],
        "description": "Set the mode of the user initialization files to <code>0740</code> with the\nfollowing command:\n<pre>$ sudo chmod 0740 /home/<i>USER</i>/.<i>INIT_FILE</i>\n        </pre>\n       ",
        "rationale": "Local initialization files are used to configure the user&#x27;s shell environment\nupon logon. Malicious modification of these files could compromise accounts upon\nlogon.",
        "oval_definition_id": "oval:ssg-file_permission_user_init_files:def:1",
        "remediations": [
          {
            "remediation_id": "file_permission_user_init_files",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_user_initialization_files_regex # promote to variable\n  set_fact:\n    var_user_initialization_files_regex: !!str ^\\.[\\w\\- ]+$\n  tags:\n    - always\n\n- name: Ensure All User Initialization Files Have Mode 0740 Or Less Permissive - Gather\n    User Info\n  ansible.builtin.getent:\n    database: passwd\n  tags:\n  - CCE-84043-9\n  - DISA-STIG-RHEL-08-010770\n  - file_permission_user_init_files\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure All User Initialization Files Have Mode 0740 Or Less Permissive - Find\n    Init Files\n  ansible.builtin.find:\n    paths: '{{ item.value[4] }}'\n    pattern: '{{ var_user_initialization_files_regex }}'\n    hidden: true\n    use_regex: true\n  with_dict: '{{ ansible_facts.getent_passwd }}'\n  when:\n  - item.value[4] != \"/sbin/nologin\"\n  - item.key not in [\"nobody\", \"nfsnobody\"]\n  - item.value[1] | int >= 1000\n  register: found_init_files\n  tags:\n  - CCE-84043-9\n  - DISA-STIG-RHEL-08-010770\n  - file_permission_user_init_files\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure All User Initialization Files Have Mode 0740 Or Less Permissive - Fix\n    Init Files Permissions\n  ansible.builtin.file:\n    path: '{{ item.1.path }}'\n    mode: u-s,g-wxs,o=\n  loop: '{{ q(''ansible.builtin.subelements'', found_init_files.results, ''files'',\n    {''skip_missing'': True}) }}'\n  tags:\n  - CCE-84043-9\n  - DISA-STIG-RHEL-08-010770\n  - file_permission_user_init_files\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "file_permission_user_init_files",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nvar_user_initialization_files_regex='^\\.[\\w\\- ]+$'\n\n\nreadarray -t interactive_users < <(awk -F: '$3>=1000   {print $1}' /etc/passwd)\nreadarray -t interactive_users_home < <(awk -F: '$3>=1000   {print $6}' /etc/passwd)\nreadarray -t interactive_users_shell < <(awk -F: '$3>=1000   {print $7}' /etc/passwd)\n\nUSERS_IGNORED_REGEX='nobody|nfsnobody'\n\nfor (( i=0; i<\"${#interactive_users[@]}\"; i++ )); do\n    if ! grep -qP \"$USERS_IGNORED_REGEX\" <<< \"${interactive_users[$i]}\" && \\\n        [ \"${interactive_users_shell[$i]}\" != \"/sbin/nologin\" ]; then\n        \n        readarray -t init_files < <(find \"${interactive_users_home[$i]}\" -maxdepth 1 \\\n            -exec basename {} \\; | grep -P \"$var_user_initialization_files_regex\")\n        for file in \"${init_files[@]}\"; do\n            chmod u-s,g-wxs,o= \"${interactive_users_home[$i]}/$file\"\n        done\n    fi\ndone\n"
          }
        ],
        "vuln_id": "SV-230325",
        "stig_id": "RHEL-08-010770"
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_home_directories": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_home_directories",
        "title": "All Interactive User Home Directories Must Have mode 0750 Or Less Permissive",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-84038-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010730"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230321r627750_rule"
            ]
          }
        ],
        "description": "Change the mode of interactive users home directories to <code>0750</code>. To\nchange the mode of interactive users home directory, use the\nfollowing command:\n<pre>$ sudo chmod 0750 /home/<i>USER</i>\n        </pre>\n       ",
        "rationale": "Excessive permissions on local interactive user home directories may allow\nunauthorized access to user files by other users.",
        "oval_definition_id": "oval:ssg-file_permissions_home_directories:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_home_directories",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Get all local users from /etc/passwd\n  ansible.builtin.getent:\n    database: passwd\n    split: ':'\n  tags:\n  - CCE-84038-9\n  - DISA-STIG-RHEL-08-010730\n  - file_permissions_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Create local_users variable from the getent output\n  ansible.builtin.set_fact:\n    local_users: '{{ ansible_facts.getent_passwd|dict2items }}'\n  tags:\n  - CCE-84038-9\n  - DISA-STIG-RHEL-08-010730\n  - file_permissions_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Test for existence home directories to avoid creating them.\n  ansible.builtin.stat:\n    path: '{{ item.value[4] }}'\n  register: path_exists\n  loop: '{{ local_users }}'\n  when:\n  - item.value[1]|int >= 1000\n  - item.value[1]|int != 65534\n  tags:\n  - CCE-84038-9\n  - DISA-STIG-RHEL-08-010730\n  - file_permissions_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure interactive local users have proper permissions on their respective\n    home directories\n  ansible.builtin.file:\n    path: '{{ item.0.value[4] }}'\n    mode: u-s,g-w-s,o=-\n    follow: false\n    recurse: false\n  loop: '{{ local_users|zip(path_exists.results)|list }}'\n  when: item.1.stat is defined and item.1.stat.exists\n  tags:\n  - CCE-84038-9\n  - DISA-STIG-RHEL-08-010730\n  - file_permissions_home_directories\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "file_permissions_home_directories",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nfor home_dir in $(awk -F':' '{ if ($3 >= 1000 && $3 != 65534) print $6 }' /etc/passwd); do\n    # Only update the permissions when necessary. This will avoid changing the inode timestamp when\n    # the permission is already defined as expected, therefore not impacting in possible integrity\n    # check systems that also check inodes timestamps.\n    find \"$home_dir\" -maxdepth 0 -perm /7027 -exec chmod u-s,g-w-s,o=- {} \\;\ndone\n"
          }
        ],
        "vuln_id": "SV-230321",
        "stig_id": "RHEL-08-010730"
      },
      "xccdf_org.ssgproject.content_rule_accounts_root_path_dirs_no_write": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_root_path_dirs_no_write",
        "title": "Ensure that Root's Path Does Not Include World or Group-Writable Directories",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80672-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1"
            ]
          }
        ],
        "description": "For each element in root&#x27;s path, run:\n<pre># ls -ld <i>DIR</i>\n         </pre>\nand ensure that write permissions are disabled for group and\nother.",
        "rationale": "Such entries increase the risk that root could\nexecute code provided by unprivileged users,\nand potentially malicious code.",
        "oval_definition_id": "oval:ssg-accounts_root_path_dirs_no_write:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_root_path_dirs_no_write",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "restrict",
            "fix": "- name: Get root paths which are not symbolic links\n  stat:\n    path: '{{ item }}'\n  changed_when: false\n  failed_when: false\n  register: root_paths\n  with_items: '{{ ansible_env.PATH.split('':'') }}'\n  tags:\n  - CCE-80672-9\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(a)\n  - accounts_root_path_dirs_no_write\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Disable writability to root directories\n  file:\n    path: '{{ item.item }}'\n    mode: g-w,o-w\n  with_items: '{{ root_paths.results }}'\n  when:\n  - root_paths.results is defined\n  - item.stat.exists\n  - not item.stat.islnk\n  tags:\n  - CCE-80672-9\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(a)\n  - accounts_root_path_dirs_no_write\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_root_path_no_dot": {
        "rule_id": "xccdf_org.ssgproject.content_rule_root_path_no_dot",
        "title": "Ensure that Root's Path Does Not Include Relative Paths or Null Directories",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-85914-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1"
            ]
          }
        ],
        "description": "Ensure that none of the directories in root&#x27;s path is equal to a single\n<code>.</code> character, or\nthat it contains any instances that lead to relative path traversal, such as\n<code>..</code> or beginning a path without the slash (<code>/</code>) character.\nAlso ensure that there are no &quot;empty&quot; elements in the path, such as in these examples:\n<pre>PATH=:/bin\nPATH=/bin:\nPATH=/bin::/sbin</pre>\nThese empty elements have the same effect as a single <code>.</code> character.",
        "rationale": "Including these entries increases the risk that root could\nexecute code from an untrusted location.",
        "oval_definition_id": "oval:ssg-root_path_no_dot:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc",
        "title": "Ensure the Default Bash Umask is Set Correctly",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81036-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R36"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.3.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "18"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI03.01",
              "BAI03.02",
              "BAI03.03"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.3"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.14.1.1",
              "A.14.2.1",
              "A.14.2.5",
              "A.6.1.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227",
              "SRG-OS-000480-GPOS-00228"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020353"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230385r792902_rule"
            ]
          }
        ],
        "description": "To ensure the default umask for users of the Bash shell is set properly,\nadd or correct the <code>umask</code> setting in <code>/etc/bashrc</code> to read\nas follows:\n<pre>umask 027\n         </pre>\n        ",
        "rationale": "The umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read or\nwritten to by unauthorized users.",
        "platforms": [
          "#package_bash"
        ],
        "oval_definition_id": "oval:ssg-accounts_umask_etc_bashrc:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_umask_etc_bashrc",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-81036-6\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_bashrc\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_user_umask # promote to variable\n  set_fact:\n    var_accounts_user_umask: !!str 027\n  tags:\n    - always\n\n- name: Check if umask in /etc/bashrc is already set\n  ansible.builtin.lineinfile:\n    path: /etc/bashrc\n    regexp: ^[^#]*\\bumask\\s+\\d+$\n    state: absent\n  check_mode: true\n  changed_when: false\n  register: umask_replace\n  when: '\"bash\" in ansible_facts.packages'\n  tags:\n  - CCE-81036-6\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_bashrc\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Replace user umask in /etc/bashrc\n  ansible.builtin.replace:\n    path: /etc/bashrc\n    regexp: ^([^#]*\\b)umask\\s+\\d+$\n    replace: \\g<1>umask {{ var_accounts_user_umask }}\n  when:\n  - '\"bash\" in ansible_facts.packages'\n  - umask_replace.found > 0\n  tags:\n  - CCE-81036-6\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_bashrc\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Default umask is Appended Correctly\n  ansible.builtin.lineinfile:\n    create: true\n    path: /etc/bashrc\n    line: umask {{ var_accounts_user_umask }}\n  when:\n  - '\"bash\" in ansible_facts.packages'\n  - umask_replace.found == 0\n  tags:\n  - CCE-81036-6\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_bashrc\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_umask_etc_bashrc",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q bash; then\n\nvar_accounts_user_umask='027'\n\n\n\n\n\n\ngrep -q \"^[^#]*\\bumask\" /etc/bashrc && \\\n  sed -i -E -e \"s/^([^#]*\\bumask).*/\\1 $var_accounts_user_umask/g\" /etc/bashrc\nif ! [ $? -eq 0 ]; then\n    echo \"umask $var_accounts_user_umask\" >> /etc/bashrc\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230385",
        "stig_id": "RHEL-08-020353"
      },
      "xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs",
        "title": "Ensure the Default Umask is Set Correctly in login.defs",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82888-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R36"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.3.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "18",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI03.01",
              "BAI03.02",
              "BAI03.03",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.1.1",
              "A.14.2.1",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.14.2.5",
              "A.6.1.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.IP-2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00228"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020351"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230383r627750_rule"
            ]
          }
        ],
        "description": "To ensure the default umask controlled by <code>/etc/login.defs</code> is set properly,\nadd or correct the <code>UMASK</code> setting in <code>/etc/login.defs</code> to read as follows:\n<pre>UMASK 027\n         </pre>\n        ",
        "rationale": "The umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read and\nwritten to by unauthorized users.",
        "platforms": [
          "#package_shadow-utils"
        ],
        "oval_definition_id": "oval:ssg-accounts_umask_etc_login_defs:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_umask_etc_login_defs",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82888-9\n  - DISA-STIG-RHEL-08-020351\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n- name: XCCDF Value var_accounts_user_umask # promote to variable\n  set_fact:\n    var_accounts_user_umask: !!str 027\n  tags:\n    - always\n\n- name: Check if UMASK is already set\n  ansible.builtin.lineinfile:\n    path: /etc/login.defs\n    regexp: ^(\\s*)UMASK\\s+.*\n    state: absent\n  check_mode: true\n  changed_when: false\n  register: result_umask_is_set\n  when: '\"shadow-utils\" in ansible_facts.packages'\n  tags:\n  - CCE-82888-9\n  - DISA-STIG-RHEL-08-020351\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Replace user UMASK in /etc/login.defs\n  ansible.builtin.replace:\n    path: /etc/login.defs\n    regexp: ^(\\s*)UMASK(\\s+).*\n    replace: \\g<1>UMASK\\g<2>{{ var_accounts_user_umask }}\n  when:\n  - '\"shadow-utils\" in ansible_facts.packages'\n  - result_umask_is_set.found > 0\n  tags:\n  - CCE-82888-9\n  - DISA-STIG-RHEL-08-020351\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Default UMASK is Appended Correctly\n  ansible.builtin.lineinfile:\n    create: true\n    path: /etc/login.defs\n    line: UMASK {{ var_accounts_user_umask }}\n  when:\n  - '\"shadow-utils\" in ansible_facts.packages'\n  - result_umask_is_set.found == 0\n  tags:\n  - CCE-82888-9\n  - DISA-STIG-RHEL-08-020351\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_login_defs\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_umask_etc_login_defs",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q shadow-utils; then\n\nvar_accounts_user_umask='027'\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^UMASK\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$var_accounts_user_umask\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^UMASK\\\\>\" \"/etc/login.defs\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^UMASK\\\\>.*/$escaped_formatted_output/gi\" \"/etc/login.defs\"\nelse\n    if [[ -s \"/etc/login.defs\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/login.defs\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/login.defs\"\n    fi\n    cce=\"CCE-82888-9\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/login.defs\" >> \"/etc/login.defs\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/login.defs\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230383",
        "stig_id": "RHEL-08-020351"
      },
      "xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile": {
        "rule_id": "xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile",
        "title": "Ensure the Default Umask is Set Correctly in /etc/profile",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81035-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R36"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.5.3.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "18"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI03.01",
              "BAI03.02",
              "BAI03.03"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.3"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.14.1.1",
              "A.14.2.1",
              "A.14.2.5",
              "A.6.1.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227",
              "SRG-OS-000480-GPOS-00228"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020353"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230385r792902_rule"
            ]
          }
        ],
        "description": "To ensure the default umask controlled by <code>/etc/profile</code> is set properly,\nadd or correct the <code>umask</code> setting in <code>/etc/profile</code> to read as follows:\n<pre>umask 027\n         </pre>\n\nNote that <code>/etc/profile</code> also reads scrips within <code>/etc/profile.d</code> directory.\nThese scripts are also valid files to set umask value. Therefore, they should also be\nconsidered during the check and properly remediated, if necessary.",
        "rationale": "The umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read or\nwritten to by unauthorized users.",
        "oval_definition_id": "oval:ssg-accounts_umask_etc_profile:def:1",
        "remediations": [
          {
            "remediation_id": "accounts_umask_etc_profile",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_accounts_user_umask # promote to variable\n  set_fact:\n    var_accounts_user_umask: !!str 027\n  tags:\n    - always\n\n- name: Ensure the Default Umask is Set Correctly in /etc/profile - Locate Profile\n    Configuration Files Where umask Is Defined\n  ansible.builtin.find:\n    paths:\n    - /etc/profile.d\n    patterns:\n    - sh.local\n    - '*.sh'\n    contains: ^[\\s]*umask\\s+\\d+\n  register: result_profile_d_files\n  tags:\n  - CCE-81035-8\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_profile\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Default Umask is Set Correctly in /etc/profile - Replace Existing\n    umask Value in Files From /etc/profile.d\n  ansible.builtin.replace:\n    path: '{{ item.path }}'\n    regexp: ^(\\s*)umask\\s+\\d+\n    replace: \\1umask {{ var_accounts_user_umask }}\n  loop: '{{ result_profile_d_files.files }}'\n  register: result_umask_replaced_profile_d\n  when: result_profile_d_files.matched\n  tags:\n  - CCE-81035-8\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_profile\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Default Umask is Set Correctly in /etc/profile - Ensure umask Is\n    Set in /etc/profile if Not Already Set Elsewhere\n  ansible.builtin.lineinfile:\n    create: true\n    mode: 420\n    path: /etc/profile\n    line: umask {{ var_accounts_user_umask }}\n  when: not result_profile_d_files.matched\n  tags:\n  - CCE-81035-8\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_profile\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure the Default Umask is Set Correctly in /etc/profile - Ensure umask Value\n    For All Existing umask Definition in /etc/profile\n  ansible.builtin.replace:\n    path: /etc/profile\n    regexp: ^(\\s*)umask\\s+\\d+\n    replace: \\1umask {{ var_accounts_user_umask }}\n  register: result_umask_replaced_profile\n  tags:\n  - CCE-81035-8\n  - DISA-STIG-RHEL-08-020353\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - accounts_umask_etc_profile\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "accounts_umask_etc_profile",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "\nvar_accounts_user_umask='027'\n\n\nreadarray -t profile_files < <(find /etc/profile.d/ -type f -name '*.sh' -or -name 'sh.local')\n\nfor file in \"${profile_files[@]}\" /etc/profile; do\n  grep -qE '^[^#]*umask' \"$file\" && sed -i -E \"s/^(\\s*umask\\s*)[0-7]+/\\1$var_accounts_user_umask/g\" \"$file\"\ndone\n\nif ! grep -qrE '^[^#]*umask' /etc/profile*; then\n  echo \"umask $var_accounts_user_umask\" >> /etc/profile\nfi\n"
          }
        ],
        "vuln_id": "SV-230385",
        "stig_id": "RHEL-08-020353"
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_grub2_cfg",
        "title": "Verify /boot/grub2/grub.cfg Group Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80800-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/boot/grub2/grub.cfg</code> should\nbe group-owned by the <code>root</code> group to prevent\ndestruction or modification of the file.\n\nTo properly set the group owner of <code>/boot/grub2/grub.cfg</code>, run the command:\n<pre>$ sudo chgrp root /boot/grub2/grub.cfg</pre>\n       ",
        "rationale": "The <code>root</code> group is a highly-privileged group. Furthermore, the group-owner of this\nfile should not have any access privileges anyway.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_groupowner_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80800-6\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/grub.cfg\n  stat:\n    path: /boot/grub2/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80800-6\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /boot/grub2/grub.cfg\n  file:\n    path: /boot/grub2/grub.cfg\n    group: '0'\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80800-6\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchgrp -L 0 /boot/grub2/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_user_cfg",
        "title": "Verify /boot/grub2/user.cfg Group Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86009-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/boot/grub2/user.cfg</code> should be group-owned by the <code>root</code>\ngroup to prevent reading or modification of the file.\n\nTo properly set the group owner of <code>/boot/grub2/user.cfg</code>, run the command:\n<pre>$ sudo chgrp root /boot/grub2/user.cfg</pre>\n       ",
        "rationale": "The <code>root</code> group is a highly-privileged group. Furthermore, the group-owner of this\nfile should not have any access privileges anyway. Non-root users who read the boot parameters\nmay be able to identify weaknesses in security upon boot and be able to exploit them.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_groupowner_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86009-8\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/user.cfg\n  stat:\n    path: /boot/grub2/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86009-8\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /boot/grub2/user.cfg\n  file:\n    path: /boot/grub2/user.cfg\n    group: '0'\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86009-8\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchgrp -L 0 /boot/grub2/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_grub2_cfg",
        "title": "Verify /boot/grub2/grub.cfg User Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80805-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/boot/grub2/grub.cfg</code> should\nbe owned by the <code>root</code> user to prevent destruction\nor modification of the file.\n\nTo properly set the owner of <code>/boot/grub2/grub.cfg</code>, run the command:\n<pre>$ sudo chown root /boot/grub2/grub.cfg </pre>\n       ",
        "rationale": "Only root should be able to modify important boot parameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_owner_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80805-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/grub.cfg\n  stat:\n    path: /boot/grub2/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80805-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /boot/grub2/grub.cfg\n  file:\n    path: /boot/grub2/grub.cfg\n    owner: '0'\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80805-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchown -L 0 /boot/grub2/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_user_cfg",
        "title": "Verify /boot/grub2/user.cfg User Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86015-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/boot/grub2/user.cfg</code> should be owned by the <code>root</code>\nuser to prevent reading or modification of the file.\n\nTo properly set the owner of <code>/boot/grub2/user.cfg</code>, run the command:\n<pre>$ sudo chown root /boot/grub2/user.cfg </pre>\n       ",
        "rationale": "Only root should be able to modify important boot parameters. Also, non-root users who read\nthe boot parameters may be able to identify weaknesses in security upon boot and be able to\nexploit them.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_owner_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86015-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/user.cfg\n  stat:\n    path: /boot/grub2/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86015-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /boot/grub2/user.cfg\n  file:\n    path: /boot/grub2/user.cfg\n    owner: '0'\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86015-5\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchown -L 0 /boot/grub2/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg",
        "title": "Verify /boot/grub2/grub.cfg Permissions",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80814-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "File permissions for <code>/boot/grub2/grub.cfg</code> should be set to 600.\n\nTo properly set the permissions of <code>/boot/grub2/grub.cfg</code>, run the command:\n<pre>$ sudo chmod 600 /boot/grub2/grub.cfg</pre>\n       ",
        "rationale": "Proper permissions ensure that only the root user can modify important boot\nparameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_permissions_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80814-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/grub.cfg\n  stat:\n    path: /boot/grub2/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80814-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /boot/grub2/grub.cfg\n  file:\n    path: /boot/grub2/grub.cfg\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80814-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchmod u-xs,g-xwrs,o-xwrt /boot/grub2/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_user_cfg",
        "title": "Verify /boot/grub2/user.cfg Permissions",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86024-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "File permissions for <code>/boot/grub2/user.cfg</code> should be set to 600.\n\nTo properly set the permissions of <code>/boot/grub2/user.cfg</code>, run the command:\n<pre>$ sudo chmod 600 /boot/grub2/user.cfg</pre>\n       ",
        "rationale": "Proper permissions ensure that only the root user can read or modify important boot\nparameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_permissions_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86024-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/grub2/user.cfg\n  stat:\n    path: /boot/grub2/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86024-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /boot/grub2/user.cfg\n  file:\n    path: /boot/grub2/user.cfg\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - '\"/boot/efi\" not in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86024-7\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchmod u-xs,g-xwrs,o-xwrt /boot/grub2/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_grub2_password": {
        "rule_id": "xccdf_org.ssgproject.content_rule_grub2_password",
        "title": "Set Boot Loader Password in grub2",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80828-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R5"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.06",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000213"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000080-GPOS-00048"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010150"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230235r743925_rule"
            ]
          }
        ],
        "description": "The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.\n<br>\n        <br>\nSince plaintext passwords are a security risk, generate a hash for the password\nby running the following command:\n\n<pre># grub2-setpassword</pre>\n\nWhen prompted, enter the password that was selected.\n<br>\n        <br>\n       ",
        "rationale": "Password protection on the boot loader configuration ensures\nusers with physical access cannot trivially alter\nimportant bootloader settings. These include which kernel to use,\nand whether to enter single-user mode.",
        "warnings": [
          {
            "text": "To prevent hard-coded passwords, automatic remediation of this control is not available. Remediation\nmust be automated as a component of machine provisioning, or followed manually as outlined above.\n\nAlso, do NOT manually add the superuser account and password to the\n<code>grub.cfg</code> file as the grub2-mkconfig command overwrites this file.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-grub2_password:def:1",
        "vuln_id": "SV-230235",
        "stig_id": "RHEL-08-010150"
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_efi_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_efi_grub2_cfg",
        "title": "Verify the UEFI Boot Loader grub.cfg Group Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85915-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          }
        ],
        "description": "The file <code>/boot/efi/EFI/redhat/grub.cfg</code> should\nbe group-owned by the <code>root</code> group to prevent\ndestruction or modification of the file.\n\nTo properly set the group owner of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:\n<pre>$ sudo chgrp root /boot/efi/EFI/redhat/grub.cfg</pre>\n       ",
        "rationale": "The <code>root</code> group is a highly-privileged group. Furthermore, the group-owner of this\nfile should not have any access privileges anyway.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_groupowner_efi_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-85915-7\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/grub.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85915-7\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /boot/efi/EFI/redhat/grub.cfg\n  file:\n    path: /boot/efi/EFI/redhat/grub.cfg\n    group: '0'\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-85915-7\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchgrp -L 0 /boot/efi/EFI/redhat/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_efi_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_efi_user_cfg",
        "title": "Verify /boot/efi/EFI/redhat/user.cfg Group Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86012-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          }
        ],
        "description": "The file <code>/boot/efi/EFI/redhat/user.cfg</code> should be group-owned by the\n<code>root</code> group to prevent reading or modification of the file.\n\nTo properly set the group owner of <code>/boot/efi/EFI/redhat/user.cfg</code>, run the command:\n<pre>$ sudo chgrp root /boot/efi/EFI/redhat/user.cfg</pre>\n       ",
        "rationale": "The <code>root</code> group is a highly-privileged group. Furthermore, the group-owner of this\nfile should not have any access privileges anyway. Non-root users who read the boot parameters\nmay be able to identify weaknesses in security upon boot and be able to exploit them.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_groupowner_efi_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_efi_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86012-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/user.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86012-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /boot/efi/EFI/redhat/user.cfg\n  file:\n    path: /boot/efi/EFI/redhat/user.cfg\n    group: '0'\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86012-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_groupowner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_efi_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchgrp -L 0 /boot/efi/EFI/redhat/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_efi_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_efi_grub2_cfg",
        "title": "Verify the UEFI Boot Loader grub.cfg User Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85913-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          }
        ],
        "description": "The file <code>/boot/efi/EFI/redhat/grub.cfg</code> should\nbe owned by the <code>root</code> user to prevent destruction\nor modification of the file.\n\nTo properly set the owner of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:\n<pre>$ sudo chown root /boot/efi/EFI/redhat/grub.cfg </pre>\n       ",
        "rationale": "Only root should be able to modify important boot parameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_owner_efi_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-85913-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/grub.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85913-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /boot/efi/EFI/redhat/grub.cfg\n  file:\n    path: /boot/efi/EFI/redhat/grub.cfg\n    owner: '0'\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-85913-2\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchown -L 0 /boot/efi/EFI/redhat/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_efi_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_efi_user_cfg",
        "title": "Verify /boot/efi/EFI/redhat/user.cfg User Ownership",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86021-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-7.1"
            ]
          }
        ],
        "description": "The file <code>/boot/efi/EFI/redhat/user.cfg</code> should be owned by the <code>root</code>\nuser to prevent reading or modification of the file.\n\nTo properly set the owner of <code>/boot/efi/EFI/redhat/user.cfg</code>, run the command:\n<pre>$ sudo chown root /boot/efi/EFI/redhat/user.cfg </pre>\n       ",
        "rationale": "Only root should be able to modify important boot parameters. Also, non-root users who read\nthe boot parameters may be able to identify weaknesses in security upon boot and be able to\nexploit them.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_owner_efi_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_efi_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86021-3\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/user.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86021-3\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /boot/efi/EFI/redhat/user.cfg\n  file:\n    path: /boot/efi/EFI/redhat/user.cfg\n    owner: '0'\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86021-3\n  - CJIS-5.5.2.2\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-7.1\n  - configure_strategy\n  - file_owner_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_efi_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchown -L 0 /boot/efi/EFI/redhat/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_efi_grub2_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_efi_grub2_cfg",
        "title": "Verify the UEFI Boot Loader grub.cfg Permissions",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85912-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          }
        ],
        "description": "File permissions for <code>/boot/efi/EFI/redhat/grub.cfg</code> should be set to 700.\n\nTo properly set the permissions of <code>/boot/efi/EFI/redhat/grub.cfg</code>, run the command:\n<pre>$ sudo chmod 700 /boot/efi/EFI/redhat/grub.cfg</pre>\n       ",
        "rationale": "Proper permissions ensure that only the root user can modify important boot\nparameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_permissions_efi_grub2_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-85912-4\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/grub.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/grub.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85912-4\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-s,g-xwrs,o-xwrt on /boot/efi/EFI/redhat/grub.cfg\n  file:\n    path: /boot/efi/EFI/redhat/grub.cfg\n    mode: u-s,g-xwrs,o-xwrt\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-85912-4\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_grub2_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_efi_grub2_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchmod u-s,g-xwrs,o-xwrt /boot/efi/EFI/redhat/grub.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_efi_user_cfg": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_efi_user_cfg",
        "title": "Verify /boot/efi/EFI/redhat/user.cfg Permissions",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86028-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R29"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000225"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          }
        ],
        "description": "File permissions for <code>/boot/efi/EFI/redhat/user.cfg</code> should be set to 600.\n\nTo properly set the permissions of <code>/boot/efi/EFI/redhat/user.cfg</code>, run the command:\n<pre>$ sudo chmod 600 /boot/efi/EFI/redhat/user.cfg</pre>\n       ",
        "rationale": "Proper permissions ensure that only the root user can read or modify important boot\nparameters.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-file_permissions_efi_user_cfg:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_efi_user_cfg",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-86028-8\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Test for existence /boot/efi/EFI/redhat/user.cfg\n  stat:\n    path: /boot/efi/EFI/redhat/user.cfg\n  register: file_exists\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86028-8\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-s,g-xwrs,o-xwrt on /boot/efi/EFI/redhat/user.cfg\n  file:\n    path: /boot/efi/EFI/redhat/user.cfg\n    mode: u-s,g-xwrs,o-xwrt\n  when:\n  - '\"/boot/efi\" in ansible_mounts | map(attribute=\"mount\") | list'\n  - '\"grub2-common\" in ansible_facts.packages'\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86028-8\n  - NIST-800-171-3.4.5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_efi_user_cfg\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_efi_user_cfg",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ -d /sys/firmware/efi ] && rpm --quiet -q grub2-common && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nchmod u-s,g-xwrs,o-xwrt /boot/efi/EFI/redhat/user.cfg\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_grub2_uefi_password": {
        "rule_id": "xccdf_org.ssgproject.content_rule_grub2_uefi_password",
        "title": "Set the UEFI Boot Loader Password",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80829-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R5"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000213"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(B)",
              "164.308(a)(7)(i)",
              "164.308(a)(7)(ii)(A)",
              "164.310(a)(1)",
              "164.310(a)(2)(i)",
              "164.310(a)(2)(ii)",
              "164.310(a)(2)(iii)",
              "164.310(b)",
              "164.310(c)",
              "164.310(d)(1)",
              "164.310(d)(2)(iii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000080-GPOS-00048"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010140"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230234r743922_rule"
            ]
          }
        ],
        "description": "The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.\n<br>\n        <br>\nSince plaintext passwords are a security risk, generate a hash for the password\nby running the following command:\n\n<pre># grub2-setpassword</pre>\n\nWhen prompted, enter the password that was selected.\n<br>\n        <br>\n       ",
        "rationale": "Password protection on the boot loader configuration ensures\nusers with physical access cannot trivially alter\nimportant bootloader settings. These include which kernel to use,\nand whether to enter single-user mode.",
        "warnings": [
          {
            "text": "To prevent hard-coded passwords, automatic remediation of this control is not available. Remediation\nmust be automated as a component of machine provisioning, or followed manually as outlined above.\n\nAlso, do NOT manually add the superuser account and password to the\n<code>grub.cfg</code> file as the grub2-mkconfig command overwrites this file.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-grub2_uefi_password:def:1",
        "vuln_id": "SV-230234",
        "stig_id": "RHEL-08-010140"
      },
      "xccdf_org.ssgproject.content_rule_package_rsyslog_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_rsyslog_installed",
        "title": "Ensure rsyslog is Installed",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80847-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "14",
              "15",
              "16",
              "3",
              "5",
              "6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO11.04",
              "BAI03.05",
              "DSS05.04",
              "DSS05.07",
              "MEA02.01"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001311",
              "CCI-001312"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.312(a)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.3.9",
              "4.3.3.5.8",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.8",
              "SR 2.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.7.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.PT-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000051-GPOS-00024",
              "SRG-OS-000479-GPOS-00224",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FTP_ITC_EXT.1.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-030670"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230477r627750_rule"
            ]
          }
        ],
        "description": "Rsyslog is installed by default. The <code>rsyslog</code> package can be installed with the following command: <pre> $ sudo yum install rsyslog</pre>\n      ",
        "rationale": "The rsyslog package provides the rsyslog daemon, which provides\nsystem logging services.",
        "oval_definition_id": "oval:ssg-package_rsyslog_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_rsyslog_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure rsyslog is installed\n  package:\n    name: rsyslog\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80847-7\n  - DISA-STIG-RHEL-08-030670\n  - NIST-800-53-CM-6(a)\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_rsyslog_installed\n"
          },
          {
            "remediation_id": "package_rsyslog_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_rsyslog\n\nclass install_rsyslog {\n  package { 'rsyslog':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_rsyslog_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"rsyslog\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_rsyslog_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"rsyslog\" ; then\n    yum install -y \"rsyslog\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230477",
        "stig_id": "RHEL-08-030670"
      },
      "xccdf_org.ssgproject.content_rule_service_rsyslog_enabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_rsyslog_enabled",
        "title": "Enable rsyslog Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80886-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "5",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO10.01",
              "APO10.03",
              "APO10.04",
              "APO10.05",
              "APO11.04",
              "APO13.01",
              "BAI03.05",
              "BAI04.04",
              "DSS01.03",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "MEA01.01",
              "MEA01.02",
              "MEA01.03",
              "MEA01.04",
              "MEA01.05",
              "MEA02.01"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001311",
              "CCI-001312",
              "CCI-001557",
              "CCI-001851"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.312(a)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.2.6.7",
              "4.3.3.3.9",
              "4.3.3.5.8",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.8",
              "SR 2.9",
              "SR 6.1",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.3",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.7.1",
              "A.14.2.7",
              "A.15.2.1",
              "A.15.2.2",
              "A.17.2.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AU-4(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "DE.CM-7",
              "ID.SC-4",
              "PR.DS-4",
              "PR.PT-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010561"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230298r627750_rule"
            ]
          }
        ],
        "description": "The <code>rsyslog</code> service provides syslog-style logging by default on Red Hat Enterprise Linux 8.\n\nThe <code>rsyslog</code> service can be enabled with the following command:\n<pre>$ sudo systemctl enable rsyslog.service</pre>\n      ",
        "rationale": "The <code>rsyslog</code> service must be running in order to provide\nlogging services, which are essential to system administration.",
        "oval_definition_id": "oval:ssg-service_rsyslog_enabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_rsyslog_enabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Enable rsyslog Service - Enable service rsyslog\n  block:\n\n  - name: Gather the package facts\n    package_facts:\n      manager: auto\n\n  - name: Enable rsyslog Service - Enable Service rsyslog\n    ansible.builtin.systemd:\n      name: rsyslog\n      enabled: true\n      state: started\n      masked: false\n    when:\n    - '\"rsyslog\" in ansible_facts.packages'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80886-5\n  - DISA-STIG-RHEL-08-010561\n  - NIST-800-53-AU-4(1)\n  - NIST-800-53-CM-6(a)\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_rsyslog_enabled\n"
          },
          {
            "remediation_id": "service_rsyslog_enabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include enable_rsyslog\n\nclass enable_rsyslog {\n  service {'rsyslog':\n    enable => true,\n    ensure => 'running',\n  }\n}\n"
          },
          {
            "remediation_id": "service_rsyslog_enabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nenabled = [\"rsyslog\"]\n"
          },
          {
            "remediation_id": "service_rsyslog_enabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" unmask 'rsyslog.service'\n\"$SYSTEMCTL_EXEC\" start 'rsyslog.service'\n\"$SYSTEMCTL_EXEC\" enable 'rsyslog.service'\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230298",
        "stig_id": "RHEL-08-010561"
      },
      "xccdf_org.ssgproject.content_rule_rsyslog_filecreatemode": {
        "rule_id": "xccdf_org.ssgproject.content_rule_rsyslog_filecreatemode",
        "title": "Ensure rsyslog Default File Permissions Configured",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-88321-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.1.4"
            ]
          }
        ],
        "description": "rsyslog will create logfiles that do not already exist on the system.\nThis settings controls what permissions will be applied to these newly\ncreated files.",
        "rationale": "It is important to ensure that log files have the correct permissions\nto ensure that sensitive data is archived and protected.",
        "oval_definition_id": "oval:ssg-rsyslog_filecreatemode:def:1",
        "remediations": [
          {
            "remediation_id": "rsyslog_filecreatemode",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure rsyslog Default File Permissions Configured - Search for $FileCreateMode\n    Parameter in rsyslog Main Config File\n  ansible.builtin.find:\n    paths: /etc\n    pattern: rsyslog.conf\n    contains: ^\\s*\\$FileCreateMode\\s*\\d+\n  register: rsyslog_main_file_with_filecreatemode\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n\n- name: Ensure rsyslog Default File Permissions Configured - Search for $FileCreateMode\n    Parameter in rsyslog Include Files\n  ansible.builtin.find:\n    paths: /etc/rsyslog.d/\n    pattern: '*.conf'\n    contains: ^\\s*\\$FileCreateMode\\s*\\d+\n  register: rsyslog_includes_with_filecreatemode\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n\n- name: Ensure rsyslog Default File Permissions Configured - Assemble List of rsyslog\n    Configuration Files with $FileCreateMode Parameter\n  ansible.builtin.set_fact:\n    rsyslog_filecreatemode_files: '{{ rsyslog_main_file_with_filecreatemode.files\n      | map(attribute=''path'') | list + rsyslog_includes_with_filecreatemode.files\n      | map(attribute=''path'') | list }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n\n- name: Ensure rsyslog Default File Permissions Configured - Remove $FileCreateMode\n    Parameter from Multiple Files to Avoid Conflicts\n  ansible.builtin.lineinfile:\n    path: '{{ item }}'\n    regexp: \\$FileCreateMode.*\n    state: absent\n  register: result_rsyslog_filecreatemode_removed\n  loop: '{{ rsyslog_filecreatemode_files }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_filecreatemode_files | length > 1\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n\n- name: Ensure rsyslog Default File Permissions Configured - Add $FileCreateMode Parameter\n    and Expected Value\n  ansible.builtin.lineinfile:\n    path: /etc/rsyslog.d/99-rsyslog_filecreatemode.conf\n    line: $FileCreateMode 0640\n    mode: 416\n    create: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_filecreatemode_files | length == 0 or result_rsyslog_filecreatemode_removed\n    is not skipped\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n\n- name: Ensure rsyslog Default File Permissions Configured - Ensure Correct Value\n    of Existing $FileCreateMode Parameter\n  ansible.builtin.lineinfile:\n    path: '{{ item }}'\n    regexp: ^\\$FileCreateMode\n    line: $FileCreateMode 0640\n  loop: '{{ rsyslog_filecreatemode_files }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_filecreatemode_files | length == 1\n  tags:\n  - CCE-88321-5\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_filecreatemode\n"
          },
          {
            "remediation_id": "rsyslog_filecreatemode",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nreadarray -t targets < <(grep -H '^\\s*$FileCreateMode' /etc/rsyslog.conf /etc/rsyslog.d/*)\n\n# if $FileCreateMode set in multiple places\nif [ ${#targets[@]} -gt 1 ]; then\n    # delete all and create new entry with expected value\n    sed -i '/^\\s*$FileCreateMode/d' /etc/rsyslog.conf /etc/rsyslog.d/*\n    echo '$FileCreateMode 0640' > /etc/rsyslog.d/99-rsyslog_filecreatemode.conf\n# if $FileCreateMode set in only one place\nelif [ \"${#targets[@]}\" -eq 1 ]; then\n    filename=$(echo \"${targets[0]}\" | cut -d':' -f1)\n    value=$(echo \"${targets[0]}\" | cut -d' ' -f2)\n    #convert to decimal and bitwise or operation\n    result=$((8#$value | 416))\n    # if more permissive than expected, then set it to 0640\n    if [ $result -ne 416 ]; then\n        # if value is wrong remove it\n        sed -i '/^\\s*$FileCreateMode/d' $filename\n        echo '$FileCreateMode 0640' > $filename\n    fi\nelse\n    echo '$FileCreateMode 0640' > /etc/rsyslog.d/99-rsyslog_filecreatemode.conf\nfi\n\nsystemctl restart rsyslog.service\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership": {
        "rule_id": "xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership",
        "title": "Ensure Log Files Are Owned By Appropriate Group",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80860-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R71"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001314"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.5.1",
              "Req-10.5.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.3.2"
            ]
          }
        ],
        "description": "The group-owner of all log files written by\n<code>rsyslog</code> should be <code>root</code>.\nThese log files are determined by the second part of each Rule line in\n<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.\nFor each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,\nrun the following command to inspect the file&#x27;s group owner:\n<pre>$ ls -l <i>LOGFILE</i>\n        </pre>\nIf the owner is not <code>root</code>,\nrun the following command to\ncorrect this:\n<pre>$ sudo chgrp root <i>LOGFILE</i>\n        </pre>\n       ",
        "rationale": "The log files generated by rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Log files should be\nprotected from unauthorized access.",
        "oval_definition_id": "oval:ssg-rsyslog_files_groupownership:def:1",
        "remediations": [
          {
            "remediation_id": "rsyslog_files_groupownership",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Ensure Log Files Are Owned By Appropriate Group - Set rsyslog logfile configuration\n    facts\n  ansible.builtin.set_fact:\n    rsyslog_etc_config: /etc/rsyslog.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Get IncludeConfig directive\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -e '$IncludeConfig' {{ rsyslog_etc_config }} | cut -d ' ' -f 2 || true\n  register: rsyslog_old_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Get include files directives\n  ansible.builtin.shell: |\n    set -o pipefail\n    awk '/)/{f=0} /include\\(/{f=1} f{ nf=gensub(\"^(include\\\\(|\\\\s*)file=\\\"(\\\\S+)\\\".*\",\"\\\\2\",1); if($0!=nf){ print nf }}' {{ rsyslog_etc_config }} || true\n  register: rsyslog_new_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Aggregate rsyslog includes\n  ansible.builtin.set_fact:\n    include_config_output: '{{ rsyslog_old_inc.stdout_lines + rsyslog_new_inc.stdout_lines\n      }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_old_inc is not skipped and rsyslog_new_inc is not skipped\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - List all config files\n  ansible.builtin.find:\n    paths: '{{ item | dirname }}'\n    patterns: '{{ item | basename }}'\n    hidden: false\n    follow: true\n  loop: '{{ include_config_output | list + [rsyslog_etc_config] }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - include_config_output is defined\n  register: rsyslog_config_files\n  failed_when: false\n  changed_when: false\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Extract log files old format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -oP '^[^(\\s|#|\\$)]+[\\s]+.*[\\s]+-?(/+[^:;\\s]+);*\\.*$' {{ item.1.path }} | \\\n    awk '{print $NF}' | \\\n    sed -e 's/^-//' || true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_old\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Extract log files new format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -ozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" {{ item.1.path }} | \\\n    grep -aoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\" | \\\n    grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\" | \\\n    tr -d \"\\\"\"|| true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_new\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group - Sum all log files found\n  ansible.builtin.set_fact:\n    log_files: '{{ log_files_new.results | map(attribute=''stdout_lines'') | list\n      | flatten | unique + log_files_old.results | map(attribute=''stdout_lines'')\n      | list | flatten | unique }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n\n- name: Ensure Log Files Are Owned By Appropriate Group -Setup log files attribute\n  ansible.builtin.file:\n    path: '{{ item }}'\n    group: root\n    state: file\n  loop: '{{ log_files | list | flatten | unique }}'\n  failed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80860-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_groupownership\n"
          },
          {
            "remediation_id": "rsyslog_files_groupownership",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# List of log file paths to be inspected for correct permissions\n# * Primarily inspect log file paths listed in /etc/rsyslog.conf\nRSYSLOG_ETC_CONFIG=\"/etc/rsyslog.conf\"\n# * And also the log file paths listed after rsyslog's $IncludeConfig directive\n#   (store the result into array for the case there's shell glob used as value of IncludeConfig)\nreadarray -t OLD_INC < <(grep -e \"\\$IncludeConfig[[:space:]]\\+[^[:space:];]\\+\" /etc/rsyslog.conf | cut -d ' ' -f 2)\nreadarray -t RSYSLOG_INCLUDE_CONFIG < <(for INCPATH in \"${OLD_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\nreadarray -t NEW_INC < <(sed -n '/^\\s*include(/,/)/Ip' /etc/rsyslog.conf | sed -n 's@.*file\\s*=\\s*\"\\([/[:alnum:][:punct:]]*\\)\".*@\\1@Ip')\nreadarray -t RSYSLOG_INCLUDE < <(for INCPATH in \"${NEW_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\n\n# Declare an array to hold the final list of different log file paths\ndeclare -a LOG_FILE_PATHS\n\n# Array to hold all rsyslog config entries\nRSYSLOG_CONFIGS=()\nRSYSLOG_CONFIGS=(\"${RSYSLOG_ETC_CONFIG}\" \"${RSYSLOG_INCLUDE_CONFIG[@]}\" \"${RSYSLOG_INCLUDE[@]}\")\n\n# Get full list of files to be checked\n# RSYSLOG_CONFIGS may contain globs such as\n# /etc/rsyslog.d/*.conf /etc/rsyslog.d/*.frule\n# So, loop over the entries in RSYSLOG_CONFIGS and use find to get the list of included files.\nRSYSLOG_CONFIG_FILES=()\nfor ENTRY in \"${RSYSLOG_CONFIGS[@]}\"\ndo\n\t# If directory, rsyslog will search for config files in recursively.\n\t# However, files in hidden sub-directories or hidden files will be ignored.\n\tif [ -d \"${ENTRY}\" ]\n\tthen\n\t\treadarray -t FINDOUT < <(find \"${ENTRY}\" -not -path '*/.*' -type f)\n\t\tRSYSLOG_CONFIG_FILES+=(\"${FINDOUT[@]}\")\n\telif [ -f \"${ENTRY}\" ]\n\tthen\n\t\tRSYSLOG_CONFIG_FILES+=(\"${ENTRY}\")\n\telse\n\t\techo \"Invalid include object: ${ENTRY}\"\n\tfi\ndone\n\n# Browse each file selected above as containing paths of log files\n# ('/etc/rsyslog.conf' and '/etc/rsyslog.d/*.conf' in the default configuration)\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\t# From each of these files extract just particular log file path(s), thus:\n\t# * Ignore lines starting with space (' '), comment ('#\"), or variable syntax ('$') characters,\n\t# * Ignore empty lines,\n\t# * Strip quotes and closing brackets from paths.\n\t# * Ignore paths that match /dev|/etc.*\\.conf, as those are paths, but likely not log files\n\t# * From the remaining valid rows select only fields constituting a log file path\n\t# Text file column is understood to represent a log file path if and only if all of the\n\t# following are met:\n\t# * it contains at least one slash '/' character,\n\t# * it is preceded by space\n\t# * it doesn't contain space (' '), colon (':'), and semicolon (';') characters\n\t# Search log file for path(s) only in case it exists!\n\tif [[ -f \"${LOG_FILE}\" ]]\n\tthen\n\t\tNORMALIZED_CONFIG_FILE_LINES=$(sed -e \"/^[#|$]/d\" \"${LOG_FILE}\")\n\t\tLINES_WITH_PATHS=$(grep '[^/]*\\s\\+\\S*/\\S\\+$' <<< \"${NORMALIZED_CONFIG_FILE_LINES}\")\n\t\tFILTERED_PATHS=$(awk '{if(NF>=2&&($NF~/^\\//||$NF~/^-\\//)){sub(/^-\\//,\"/\",$NF);print $NF}}' <<< \"${LINES_WITH_PATHS}\")\n\t\tCLEANED_PATHS=$(sed -e \"s/[\\\"')]//g; /\\\\/etc.*\\.conf/d; /\\\\/dev\\\\//d\" <<< \"${FILTERED_PATHS}\")\n\t\tMATCHED_ITEMS=$(sed -e \"/^$/d\" <<< \"${CLEANED_PATHS}\")\n\t\t# Since above sed command might return more than one item (delimited by newline), split\n\t\t# the particular matches entries into new array specific for this log file\n\t\treadarray -t ARRAY_FOR_LOG_FILE <<< \"$MATCHED_ITEMS\"\n\t\t# Concatenate the two arrays - previous content of $LOG_FILE_PATHS array with\n\t\t# items from newly created array for this log file\n\t\tLOG_FILE_PATHS+=(\"${ARRAY_FOR_LOG_FILE[@]}\")\n\t\t# Delete the temporary array\n\t\tunset ARRAY_FOR_LOG_FILE\n\tfi\ndone\n\n# Check for RainerScript action log format which might be also multiline so grep regex is a bit\n# curly:\n# extract possibly multiline action omfile expressions\n# extract File=\"logfile\" expression\n# match only \"logfile\" expression\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\tACTION_OMFILE_LINES=$(grep -iozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" \"${LOG_FILE}\")\n\tOMFILE_LINES=$(echo \"${ACTION_OMFILE_LINES}\"| grep -iaoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\")\n\tLOG_FILE_PATHS+=(\"$(echo \"${OMFILE_LINES}\"| grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\"|tr -d \"\\\"\")\")\ndone\n\n# Ensure the correct attribute if file exists\nFILE_CMD=\"chgrp\"\nfor LOG_FILE_PATH in \"${LOG_FILE_PATHS[@]}\"\ndo\n\t# Sanity check - if particular $LOG_FILE_PATH is empty string, skip it from further processing\n\tif [ -z \"$LOG_FILE_PATH\" ]\n\tthen\n\t\tcontinue\n\tfi\n\t$FILE_CMD \"root\" \"$LOG_FILE_PATH\"\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_rsyslog_files_ownership": {
        "rule_id": "xccdf_org.ssgproject.content_rule_rsyslog_files_ownership",
        "title": "Ensure Log Files Are Owned By Appropriate User",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80861-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R71"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001314"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.5.1",
              "Req-10.5.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.3.2"
            ]
          }
        ],
        "description": "The owner of all log files written by\n<code>rsyslog</code> should be\n\n<code>root</code>.\n\nThese log files are determined by the second part of each Rule line in\n<code>/etc/rsyslog.conf</code> and typically all appear in <code>/var/log</code>.\nFor each log file <i>LOGFILE</i> referenced in <code>/etc/rsyslog.conf</code>,\nrun the following command to inspect the file&#x27;s owner:\n<pre>$ ls -l <i>LOGFILE</i>\n        </pre>\nIf the owner is not\n\n<code>root</code>,\n\nrun the following command to\ncorrect this:\n\n<pre>$ sudo chown root <i>LOGFILE</i>\n        </pre>\n       ",
        "rationale": "The log files generated by rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Log files should be\nprotected from unauthorized access.",
        "oval_definition_id": "oval:ssg-rsyslog_files_ownership:def:1",
        "remediations": [
          {
            "remediation_id": "rsyslog_files_ownership",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Ensure Log Files Are Owned By Appropriate User - Set rsyslog logfile configuration\n    facts\n  ansible.builtin.set_fact:\n    rsyslog_etc_config: /etc/rsyslog.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Get IncludeConfig directive\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -e '$IncludeConfig' {{ rsyslog_etc_config }} | cut -d ' ' -f 2 || true\n  register: rsyslog_old_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Get include files directives\n  ansible.builtin.shell: |\n    set -o pipefail\n    awk '/)/{f=0} /include\\(/{f=1} f{ nf=gensub(\"^(include\\\\(|\\\\s*)file=\\\"(\\\\S+)\\\".*\",\"\\\\2\",1); if($0!=nf){ print nf }}' {{ rsyslog_etc_config }} || true\n  register: rsyslog_new_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Aggregate rsyslog includes\n  ansible.builtin.set_fact:\n    include_config_output: '{{ rsyslog_old_inc.stdout_lines + rsyslog_new_inc.stdout_lines\n      }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_old_inc is not skipped and rsyslog_new_inc is not skipped\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - List all config files\n  ansible.builtin.find:\n    paths: '{{ item | dirname }}'\n    patterns: '{{ item | basename }}'\n    hidden: false\n    follow: true\n  loop: '{{ include_config_output | list + [rsyslog_etc_config] }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - include_config_output is defined\n  register: rsyslog_config_files\n  failed_when: false\n  changed_when: false\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Extract log files old format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -oP '^[^(\\s|#|\\$)]+[\\s]+.*[\\s]+-?(/+[^:;\\s]+);*\\.*$' {{ item.1.path }} | \\\n    awk '{print $NF}' | \\\n    sed -e 's/^-//' || true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_old\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Extract log files new format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -ozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" {{ item.1.path }} | \\\n    grep -aoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\" | \\\n    grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\" | \\\n    tr -d \"\\\"\"|| true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_new\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User - Sum all log files found\n  ansible.builtin.set_fact:\n    log_files: '{{ log_files_new.results | map(attribute=''stdout_lines'') | list\n      | flatten | unique + log_files_old.results | map(attribute=''stdout_lines'')\n      | list | flatten | unique }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n\n- name: Ensure Log Files Are Owned By Appropriate User -Setup log files attribute\n  ansible.builtin.file:\n    path: '{{ item }}'\n    owner: root\n    state: file\n  loop: '{{ log_files | list | flatten | unique }}'\n  failed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80861-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.2\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_ownership\n"
          },
          {
            "remediation_id": "rsyslog_files_ownership",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# List of log file paths to be inspected for correct permissions\n# * Primarily inspect log file paths listed in /etc/rsyslog.conf\nRSYSLOG_ETC_CONFIG=\"/etc/rsyslog.conf\"\n# * And also the log file paths listed after rsyslog's $IncludeConfig directive\n#   (store the result into array for the case there's shell glob used as value of IncludeConfig)\nreadarray -t OLD_INC < <(grep -e \"\\$IncludeConfig[[:space:]]\\+[^[:space:];]\\+\" /etc/rsyslog.conf | cut -d ' ' -f 2)\nreadarray -t RSYSLOG_INCLUDE_CONFIG < <(for INCPATH in \"${OLD_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\nreadarray -t NEW_INC < <(sed -n '/^\\s*include(/,/)/Ip' /etc/rsyslog.conf | sed -n 's@.*file\\s*=\\s*\"\\([/[:alnum:][:punct:]]*\\)\".*@\\1@Ip')\nreadarray -t RSYSLOG_INCLUDE < <(for INCPATH in \"${NEW_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\n\n# Declare an array to hold the final list of different log file paths\ndeclare -a LOG_FILE_PATHS\n\n# Array to hold all rsyslog config entries\nRSYSLOG_CONFIGS=()\nRSYSLOG_CONFIGS=(\"${RSYSLOG_ETC_CONFIG}\" \"${RSYSLOG_INCLUDE_CONFIG[@]}\" \"${RSYSLOG_INCLUDE[@]}\")\n\n# Get full list of files to be checked\n# RSYSLOG_CONFIGS may contain globs such as\n# /etc/rsyslog.d/*.conf /etc/rsyslog.d/*.frule\n# So, loop over the entries in RSYSLOG_CONFIGS and use find to get the list of included files.\nRSYSLOG_CONFIG_FILES=()\nfor ENTRY in \"${RSYSLOG_CONFIGS[@]}\"\ndo\n\t# If directory, rsyslog will search for config files in recursively.\n\t# However, files in hidden sub-directories or hidden files will be ignored.\n\tif [ -d \"${ENTRY}\" ]\n\tthen\n\t\treadarray -t FINDOUT < <(find \"${ENTRY}\" -not -path '*/.*' -type f)\n\t\tRSYSLOG_CONFIG_FILES+=(\"${FINDOUT[@]}\")\n\telif [ -f \"${ENTRY}\" ]\n\tthen\n\t\tRSYSLOG_CONFIG_FILES+=(\"${ENTRY}\")\n\telse\n\t\techo \"Invalid include object: ${ENTRY}\"\n\tfi\ndone\n\n# Browse each file selected above as containing paths of log files\n# ('/etc/rsyslog.conf' and '/etc/rsyslog.d/*.conf' in the default configuration)\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\t# From each of these files extract just particular log file path(s), thus:\n\t# * Ignore lines starting with space (' '), comment ('#\"), or variable syntax ('$') characters,\n\t# * Ignore empty lines,\n\t# * Strip quotes and closing brackets from paths.\n\t# * Ignore paths that match /dev|/etc.*\\.conf, as those are paths, but likely not log files\n\t# * From the remaining valid rows select only fields constituting a log file path\n\t# Text file column is understood to represent a log file path if and only if all of the\n\t# following are met:\n\t# * it contains at least one slash '/' character,\n\t# * it is preceded by space\n\t# * it doesn't contain space (' '), colon (':'), and semicolon (';') characters\n\t# Search log file for path(s) only in case it exists!\n\tif [[ -f \"${LOG_FILE}\" ]]\n\tthen\n\t\tNORMALIZED_CONFIG_FILE_LINES=$(sed -e \"/^[#|$]/d\" \"${LOG_FILE}\")\n\t\tLINES_WITH_PATHS=$(grep '[^/]*\\s\\+\\S*/\\S\\+$' <<< \"${NORMALIZED_CONFIG_FILE_LINES}\")\n\t\tFILTERED_PATHS=$(awk '{if(NF>=2&&($NF~/^\\//||$NF~/^-\\//)){sub(/^-\\//,\"/\",$NF);print $NF}}' <<< \"${LINES_WITH_PATHS}\")\n\t\tCLEANED_PATHS=$(sed -e \"s/[\\\"')]//g; /\\\\/etc.*\\.conf/d; /\\\\/dev\\\\//d\" <<< \"${FILTERED_PATHS}\")\n\t\tMATCHED_ITEMS=$(sed -e \"/^$/d\" <<< \"${CLEANED_PATHS}\")\n\t\t# Since above sed command might return more than one item (delimited by newline), split\n\t\t# the particular matches entries into new array specific for this log file\n\t\treadarray -t ARRAY_FOR_LOG_FILE <<< \"$MATCHED_ITEMS\"\n\t\t# Concatenate the two arrays - previous content of $LOG_FILE_PATHS array with\n\t\t# items from newly created array for this log file\n\t\tLOG_FILE_PATHS+=(\"${ARRAY_FOR_LOG_FILE[@]}\")\n\t\t# Delete the temporary array\n\t\tunset ARRAY_FOR_LOG_FILE\n\tfi\ndone\n\n# Check for RainerScript action log format which might be also multiline so grep regex is a bit\n# curly:\n# extract possibly multiline action omfile expressions\n# extract File=\"logfile\" expression\n# match only \"logfile\" expression\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\tACTION_OMFILE_LINES=$(grep -iozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" \"${LOG_FILE}\")\n\tOMFILE_LINES=$(echo \"${ACTION_OMFILE_LINES}\"| grep -iaoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\")\n\tLOG_FILE_PATHS+=(\"$(echo \"${OMFILE_LINES}\"| grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\"|tr -d \"\\\"\")\")\ndone\n\n# Ensure the correct attribute if file exists\nFILE_CMD=\"chown\"\nfor LOG_FILE_PATH in \"${LOG_FILE_PATHS[@]}\"\ndo\n\t# Sanity check - if particular $LOG_FILE_PATH is empty string, skip it from further processing\n\tif [ -z \"$LOG_FILE_PATH\" ]\n\tthen\n\t\tcontinue\n\tfi\n\t$FILE_CMD \"root\" \"$LOG_FILE_PATH\"\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_rsyslog_files_permissions": {
        "rule_id": "xccdf_org.ssgproject.content_rule_rsyslog_files_permissions",
        "title": "Ensure System Log Files Have Correct Permissions",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80862-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R71"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001314"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.5.1",
              "Req-10.5.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.3.1"
            ]
          }
        ],
        "description": "The file permissions for all log files written by <code>rsyslog</code> should\nbe set to 640, or more restrictive. These log files are determined by the\nsecond part of each Rule line in <code>/etc/rsyslog.conf</code> and typically\nall appear in <code>/var/log</code>. For each log file <i>LOGFILE</i>\nreferenced in <code>/etc/rsyslog.conf</code>, run the following command to\ninspect the file&#x27;s permissions:\n<pre>$ ls -l <i>LOGFILE</i>\n        </pre>\nIf the permissions are not 640 or more restrictive, run the following\ncommand to correct this:\n<pre>$ sudo chmod 640 <i>LOGFILE</i>\n        </pre>&quot;",
        "rationale": "Log files can contain valuable information regarding system\nconfiguration. If the system log files are not protected unauthorized\nusers could change the logged data, eliminating their forensic value.",
        "oval_definition_id": "oval:ssg-rsyslog_files_permissions:def:1",
        "remediations": [
          {
            "remediation_id": "rsyslog_files_permissions",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "configure",
            "fix": "- name: Ensure System Log Files Have Correct Permissions - Set rsyslog logfile configuration\n    facts\n  ansible.builtin.set_fact:\n    rsyslog_etc_config: /etc/rsyslog.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Get IncludeConfig directive\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -e '$IncludeConfig' {{ rsyslog_etc_config }} | cut -d ' ' -f 2 || true\n  register: rsyslog_old_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Get include files directives\n  ansible.builtin.shell: |\n    set -o pipefail\n    awk '/)/{f=0} /include\\(/{f=1} f{ nf=gensub(\"^(include\\\\(|\\\\s*)file=\\\"(\\\\S+)\\\".*\",\"\\\\2\",1); if($0!=nf){ print nf }}' {{ rsyslog_etc_config }} || true\n  register: rsyslog_new_inc\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Aggregate rsyslog includes\n  ansible.builtin.set_fact:\n    include_config_output: '{{ rsyslog_old_inc.stdout_lines + rsyslog_new_inc.stdout_lines\n      }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_old_inc is not skipped and rsyslog_new_inc is not skipped\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - List all config files\n  ansible.builtin.find:\n    paths: '{{ item | dirname }}'\n    patterns: '{{ item | basename }}'\n    hidden: false\n    follow: true\n  loop: '{{ include_config_output | list + [rsyslog_etc_config] }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - include_config_output is defined\n  register: rsyslog_config_files\n  failed_when: false\n  changed_when: false\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Extract log files old format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -oP '^[^(\\s|#|\\$)]+[\\s]+.*[\\s]+-?(/+[^:;\\s]+);*\\.*$' {{ item.1.path }} | \\\n    awk '{print $NF}' | \\\n    sed -e 's/^-//' || true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_old\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Extract log files new format\n  ansible.builtin.shell: |\n    set -o pipefail\n    grep -ozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" {{ item.1.path }} | \\\n    grep -aoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\" | \\\n    grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\" | \\\n    tr -d \"\\\"\"|| true\n  loop: '{{ rsyslog_config_files.results | default([]) | subelements(''files'') }}'\n  register: log_files_new\n  changed_when: false\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_config_files is not skipped\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions - Sum all log files found\n  ansible.builtin.set_fact:\n    log_files: '{{ log_files_new.results | map(attribute=''stdout_lines'') | list\n      | flatten | unique + log_files_old.results | map(attribute=''stdout_lines'')\n      | list | flatten | unique }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n\n- name: Ensure System Log Files Have Correct Permissions -Setup log files attribute\n  ansible.builtin.file:\n    path: '{{ item }}'\n    mode: '0640'\n    state: file\n  loop: '{{ log_files | list | flatten | unique }}'\n  failed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80862-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.5.1\n  - PCI-DSS-Req-10.5.2\n  - PCI-DSSv4-10.3.1\n  - configure_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_files_permissions\n"
          },
          {
            "remediation_id": "rsyslog_files_permissions",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# List of log file paths to be inspected for correct permissions\n# * Primarily inspect log file paths listed in /etc/rsyslog.conf\nRSYSLOG_ETC_CONFIG=\"/etc/rsyslog.conf\"\n# * And also the log file paths listed after rsyslog's $IncludeConfig directive\n#   (store the result into array for the case there's shell glob used as value of IncludeConfig)\nreadarray -t OLD_INC < <(grep -e \"\\$IncludeConfig[[:space:]]\\+[^[:space:];]\\+\" /etc/rsyslog.conf | cut -d ' ' -f 2)\nreadarray -t RSYSLOG_INCLUDE_CONFIG < <(for INCPATH in \"${OLD_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\nreadarray -t NEW_INC < <(sed -n '/^\\s*include(/,/)/Ip' /etc/rsyslog.conf | sed -n 's@.*file\\s*=\\s*\"\\([/[:alnum:][:punct:]]*\\)\".*@\\1@Ip')\nreadarray -t RSYSLOG_INCLUDE < <(for INCPATH in \"${NEW_INC[@]}\"; do eval printf '%s\\\\n' \"${INCPATH}\"; done)\n\n# Declare an array to hold the final list of different log file paths\ndeclare -a LOG_FILE_PATHS\n\n# Array to hold all rsyslog config entries\nRSYSLOG_CONFIGS=()\nRSYSLOG_CONFIGS=(\"${RSYSLOG_ETC_CONFIG}\" \"${RSYSLOG_INCLUDE_CONFIG[@]}\" \"${RSYSLOG_INCLUDE[@]}\")\n\n# Get full list of files to be checked\n# RSYSLOG_CONFIGS may contain globs such as\n# /etc/rsyslog.d/*.conf /etc/rsyslog.d/*.frule\n# So, loop over the entries in RSYSLOG_CONFIGS and use find to get the list of included files.\nRSYSLOG_CONFIG_FILES=()\nfor ENTRY in \"${RSYSLOG_CONFIGS[@]}\"\ndo\n\t# If directory, rsyslog will search for config files in recursively.\n\t# However, files in hidden sub-directories or hidden files will be ignored.\n\tif [ -d \"${ENTRY}\" ]\n\tthen\n\t\treadarray -t FINDOUT < <(find \"${ENTRY}\" -not -path '*/.*' -type f)\n\t\tRSYSLOG_CONFIG_FILES+=(\"${FINDOUT[@]}\")\n\telif [ -f \"${ENTRY}\" ]\n\tthen\n\t\tRSYSLOG_CONFIG_FILES+=(\"${ENTRY}\")\n\telse\n\t\techo \"Invalid include object: ${ENTRY}\"\n\tfi\ndone\n\n# Browse each file selected above as containing paths of log files\n# ('/etc/rsyslog.conf' and '/etc/rsyslog.d/*.conf' in the default configuration)\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\t# From each of these files extract just particular log file path(s), thus:\n\t# * Ignore lines starting with space (' '), comment ('#\"), or variable syntax ('$') characters,\n\t# * Ignore empty lines,\n\t# * Strip quotes and closing brackets from paths.\n\t# * Ignore paths that match /dev|/etc.*\\.conf, as those are paths, but likely not log files\n\t# * From the remaining valid rows select only fields constituting a log file path\n\t# Text file column is understood to represent a log file path if and only if all of the\n\t# following are met:\n\t# * it contains at least one slash '/' character,\n\t# * it is preceded by space\n\t# * it doesn't contain space (' '), colon (':'), and semicolon (';') characters\n\t# Search log file for path(s) only in case it exists!\n\tif [[ -f \"${LOG_FILE}\" ]]\n\tthen\n\t\tNORMALIZED_CONFIG_FILE_LINES=$(sed -e \"/^[#|$]/d\" \"${LOG_FILE}\")\n\t\tLINES_WITH_PATHS=$(grep '[^/]*\\s\\+\\S*/\\S\\+$' <<< \"${NORMALIZED_CONFIG_FILE_LINES}\")\n\t\tFILTERED_PATHS=$(awk '{if(NF>=2&&($NF~/^\\//||$NF~/^-\\//)){sub(/^-\\//,\"/\",$NF);print $NF}}' <<< \"${LINES_WITH_PATHS}\")\n\t\tCLEANED_PATHS=$(sed -e \"s/[\\\"')]//g; /\\\\/etc.*\\.conf/d; /\\\\/dev\\\\//d\" <<< \"${FILTERED_PATHS}\")\n\t\tMATCHED_ITEMS=$(sed -e \"/^$/d\" <<< \"${CLEANED_PATHS}\")\n\t\t# Since above sed command might return more than one item (delimited by newline), split\n\t\t# the particular matches entries into new array specific for this log file\n\t\treadarray -t ARRAY_FOR_LOG_FILE <<< \"$MATCHED_ITEMS\"\n\t\t# Concatenate the two arrays - previous content of $LOG_FILE_PATHS array with\n\t\t# items from newly created array for this log file\n\t\tLOG_FILE_PATHS+=(\"${ARRAY_FOR_LOG_FILE[@]}\")\n\t\t# Delete the temporary array\n\t\tunset ARRAY_FOR_LOG_FILE\n\tfi\ndone\n\n# Check for RainerScript action log format which might be also multiline so grep regex is a bit\n# curly:\n# extract possibly multiline action omfile expressions\n# extract File=\"logfile\" expression\n# match only \"logfile\" expression\nfor LOG_FILE in \"${RSYSLOG_CONFIG_FILES[@]}\"\ndo\n\tACTION_OMFILE_LINES=$(grep -iozP \"action\\s*\\(\\s*type\\s*=\\s*\\\"omfile\\\"[^\\)]*\\)\" \"${LOG_FILE}\")\n\tOMFILE_LINES=$(echo \"${ACTION_OMFILE_LINES}\"| grep -iaoP \"\\bFile\\s*=\\s*\\\"([/[:alnum:][:punct:]]*)\\\"\\s*\\)\")\n\tLOG_FILE_PATHS+=(\"$(echo \"${OMFILE_LINES}\"| grep -oE \"\\\"([/[:alnum:][:punct:]]*)\\\"\"|tr -d \"\\\"\")\")\ndone\n\n# Ensure the correct attribute if file exists\nFILE_CMD=\"chmod\"\nfor LOG_FILE_PATH in \"${LOG_FILE_PATHS[@]}\"\ndo\n\t# Sanity check - if particular $LOG_FILE_PATH is empty string, skip it from further processing\n\tif [ -z \"$LOG_FILE_PATH\" ]\n\tthen\n\t\tcontinue\n\tfi\n\t$FILE_CMD \"0640\" \"$LOG_FILE_PATH\"\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_systemd-journald_enabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_systemd-journald_enabled",
        "title": "Enable systemd-journald Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85921-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.2.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001665"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "SC-24"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000269-GPOS-00103"
            ]
          }
        ],
        "description": "The <code>systemd-journald</code> service is an essential component of\nsystemd.\n\nThe <code>systemd-journald</code> service can be enabled with the following command:\n<pre>$ sudo systemctl enable systemd-journald.service</pre>\n       ",
        "rationale": "In the event of a system failure, Red Hat Enterprise Linux 8 must preserve any information necessary to determine cause of failure and any information necessary to return to operations with least disruption to system processes.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-service_systemd-journald_enabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_systemd-journald_enabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Enable systemd-journald Service - Enable service systemd-journald\n  block:\n\n  - name: Gather the package facts\n    package_facts:\n      manager: auto\n\n  - name: Enable systemd-journald Service - Enable Service systemd-journald\n    ansible.builtin.systemd:\n      name: systemd-journald\n      enabled: true\n      state: started\n      masked: false\n    when:\n    - '\"systemd\" in ansible_facts.packages'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85921-5\n  - NIST-800-53-SC-24\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_systemd-journald_enabled\n"
          },
          {
            "remediation_id": "service_systemd-journald_enabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include enable_systemd-journald\n\nclass enable_systemd-journald {\n  service {'systemd-journald':\n    enable => true,\n    ensure => 'running',\n  }\n}\n"
          },
          {
            "remediation_id": "service_systemd-journald_enabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nenabled = [\"systemd-journald\"]\n"
          },
          {
            "remediation_id": "service_systemd-journald_enabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" unmask 'systemd-journald.service'\n\"$SYSTEMCTL_EXEC\" start 'systemd-journald.service'\n\"$SYSTEMCTL_EXEC\" enable 'systemd-journald.service'\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_journald_compress": {
        "rule_id": "xccdf_org.ssgproject.content_rule_journald_compress",
        "title": "Ensure journald is configured to compress large log files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85930-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.2.3"
            ]
          }
        ],
        "description": "The journald system can compress large log files to avoid fill the system disk.",
        "rationale": "Log files that are not properly compressed run the risk of growing so large that they fill up the log partition. Valuable logging information could be lost if the log partition becomes full.",
        "oval_definition_id": "oval:ssg-journald_compress:def:1",
        "remediations": [
          {
            "remediation_id": "journald_compress",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure journald is configured to compress large log files - Search for a section\n    in files\n  ansible.builtin.find:\n    paths: '{{item.path}}'\n    patterns: '{{item.pattern}}'\n    contains: ^\\s*\\[Journal\\]\n    read_whole_file: true\n    use_regex: true\n  register: systemd_dropin_files_with_section\n  loop:\n  - path: '{{ ''/etc/systemd/journald.conf'' | dirname }}'\n    pattern: '{{ ''/etc/systemd/journald.conf'' | basename | regex_escape }}'\n  - path: /etc/systemd/journald.conf.d\n    pattern: .*\\.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85930-6\n  - journald_compress\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to compress large log files - Count number of\n    files which contain the correct section\n  ansible.builtin.set_fact:\n    count_of_systemd_dropin_files_with_section: '{{systemd_dropin_files_with_section.results\n      | map(attribute=''matched'') | list | map(''int'') | sum}}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85930-6\n  - journald_compress\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to compress large log files - Add missing configuration\n    to correct section\n  ini_file:\n    path: '{{item}}'\n    section: Journal\n    option: Compress\n    value: 'yes'\n    state: present\n    no_extra_spaces: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int > 0\n  loop: '{{systemd_dropin_files_with_section.results | sum(attribute=''files'', start=[])\n    | map(attribute=''path'') | list }}'\n  tags:\n  - CCE-85930-6\n  - journald_compress\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to compress large log files - Add configuration\n    to new remediation file\n  ini_file:\n    path: /etc/systemd/journald.conf.d/complianceascode_hardening.conf\n    section: Journal\n    option: Compress\n    value: 'yes'\n    state: present\n    no_extra_spaces: true\n    create: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int == 0\n  tags:\n  - CCE-85930-6\n  - journald_compress\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "journald_compress",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfound=false\n\n# set value in all files if they contain section or key\nfor f in $(echo -n \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\"); do\n    if [ ! -e \"$f\" ]; then\n        continue\n    fi\n\n    # find key in section and change value\n    if grep -qzosP \"[[:space:]]*\\[Journal\\]([^\\n\\[]*\\n+)+?[[:space:]]*Compress\" \"$f\"; then\n\n            sed -i \"s/Compress[^(\\n)]*/Compress=yes/\" \"$f\"\n\n            found=true\n\n    # find section and add key = value to it\n    elif grep -qs \"[[:space:]]*\\[Journal\\]\" \"$f\"; then\n\n            sed -i \"/[[:space:]]*\\[Journal\\]/a Compress=yes\" \"$f\"\n\n            found=true\n    fi\ndone\n\n# if section not in any file, append section with key = value to FIRST file in files parameter\nif ! $found ; then\n    file=$(echo \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\" | cut -f1 -d ' ')\n    mkdir -p \"$(dirname \"$file\")\"\n\n    echo -e \"[Journal]\\nCompress=yes\" >> \"$file\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_journald_forward_to_syslog": {
        "rule_id": "xccdf_org.ssgproject.content_rule_journald_forward_to_syslog",
        "title": "Ensure journald is configured to send logs to rsyslog",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-85995-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.1.3"
            ]
          }
        ],
        "description": "Data from journald may be stored in volatile memory or persisted locally.\nUtilities exist to accept remote export of journald logs.",
        "rationale": "Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system.",
        "oval_definition_id": "oval:ssg-journald_forward_to_syslog:def:1",
        "remediations": [
          {
            "remediation_id": "journald_forward_to_syslog",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure journald is configured to send logs to rsyslog - Search for a section\n    in files\n  ansible.builtin.find:\n    paths: '{{item.path}}'\n    patterns: '{{item.pattern}}'\n    contains: ^\\s*\\[Journal\\]\n    read_whole_file: true\n    use_regex: true\n  register: systemd_dropin_files_with_section\n  loop:\n  - path: '{{ ''/etc/systemd/journald.conf'' | dirname }}'\n    pattern: '{{ ''/etc/systemd/journald.conf'' | basename | regex_escape }}'\n  - path: /etc/systemd/journald.conf.d\n    pattern: .*\\.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85995-9\n  - journald_forward_to_syslog\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to send logs to rsyslog - Count number of files\n    which contain the correct section\n  ansible.builtin.set_fact:\n    count_of_systemd_dropin_files_with_section: '{{systemd_dropin_files_with_section.results\n      | map(attribute=''matched'') | list | map(''int'') | sum}}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-85995-9\n  - journald_forward_to_syslog\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to send logs to rsyslog - Add missing configuration\n    to correct section\n  ini_file:\n    path: '{{item}}'\n    section: Journal\n    option: ForwardToSyslog\n    value: 'yes'\n    state: present\n    no_extra_spaces: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int > 0\n  loop: '{{systemd_dropin_files_with_section.results | sum(attribute=''files'', start=[])\n    | map(attribute=''path'') | list }}'\n  tags:\n  - CCE-85995-9\n  - journald_forward_to_syslog\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to send logs to rsyslog - Add configuration\n    to new remediation file\n  ini_file:\n    path: /etc/systemd/journald.conf.d/complianceascode_hardening.conf\n    section: Journal\n    option: ForwardToSyslog\n    value: 'yes'\n    state: present\n    no_extra_spaces: true\n    create: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int == 0\n  tags:\n  - CCE-85995-9\n  - journald_forward_to_syslog\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "journald_forward_to_syslog",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfound=false\n\n# set value in all files if they contain section or key\nfor f in $(echo -n \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\"); do\n    if [ ! -e \"$f\" ]; then\n        continue\n    fi\n\n    # find key in section and change value\n    if grep -qzosP \"[[:space:]]*\\[Journal\\]([^\\n\\[]*\\n+)+?[[:space:]]*ForwardToSyslog\" \"$f\"; then\n\n            sed -i \"s/ForwardToSyslog[^(\\n)]*/ForwardToSyslog=yes/\" \"$f\"\n\n            found=true\n\n    # find section and add key = value to it\n    elif grep -qs \"[[:space:]]*\\[Journal\\]\" \"$f\"; then\n\n            sed -i \"/[[:space:]]*\\[Journal\\]/a ForwardToSyslog=yes\" \"$f\"\n\n            found=true\n    fi\ndone\n\n# if section not in any file, append section with key = value to FIRST file in files parameter\nif ! $found ; then\n    file=$(echo \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\" | cut -f1 -d ' ')\n    mkdir -p \"$(dirname \"$file\")\"\n\n    echo -e \"[Journal]\\nForwardToSyslog=yes\" >> \"$file\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_journald_storage": {
        "rule_id": "xccdf_org.ssgproject.content_rule_journald_storage",
        "title": "Ensure journald is configured to write log files to persistent disk",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86045-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.2.4"
            ]
          }
        ],
        "description": "The journald system may store log files in volatile memory or locally on disk.\nIf the logs are only stored in volatile memory they will we lost upon reboot.",
        "rationale": "Log files contain valuable data and need to be persistent to aid in possible investigations.",
        "oval_definition_id": "oval:ssg-journald_storage:def:1",
        "remediations": [
          {
            "remediation_id": "journald_storage",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure journald is configured to write log files to persistent disk - Search\n    for a section in files\n  ansible.builtin.find:\n    paths: '{{item.path}}'\n    patterns: '{{item.pattern}}'\n    contains: ^\\s*\\[Journal\\]\n    read_whole_file: true\n    use_regex: true\n  register: systemd_dropin_files_with_section\n  loop:\n  - path: '{{ ''/etc/systemd/journald.conf'' | dirname }}'\n    pattern: '{{ ''/etc/systemd/journald.conf'' | basename | regex_escape }}'\n  - path: /etc/systemd/journald.conf.d\n    pattern: .*\\.conf\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86045-2\n  - journald_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to write log files to persistent disk - Count\n    number of files which contain the correct section\n  ansible.builtin.set_fact:\n    count_of_systemd_dropin_files_with_section: '{{systemd_dropin_files_with_section.results\n      | map(attribute=''matched'') | list | map(''int'') | sum}}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86045-2\n  - journald_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to write log files to persistent disk - Add\n    missing configuration to correct section\n  ini_file:\n    path: '{{item}}'\n    section: Journal\n    option: Storage\n    value: persistent\n    state: present\n    no_extra_spaces: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int > 0\n  loop: '{{systemd_dropin_files_with_section.results | sum(attribute=''files'', start=[])\n    | map(attribute=''path'') | list }}'\n  tags:\n  - CCE-86045-2\n  - journald_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure journald is configured to write log files to persistent disk - Add\n    configuration to new remediation file\n  ini_file:\n    path: /etc/systemd/journald.conf.d/complianceascode_hardening.conf\n    section: Journal\n    option: Storage\n    value: persistent\n    state: present\n    no_extra_spaces: true\n    create: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - count_of_systemd_dropin_files_with_section | int == 0\n  tags:\n  - CCE-86045-2\n  - journald_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "journald_storage",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfound=false\n\n# set value in all files if they contain section or key\nfor f in $(echo -n \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\"); do\n    if [ ! -e \"$f\" ]; then\n        continue\n    fi\n\n    # find key in section and change value\n    if grep -qzosP \"[[:space:]]*\\[Journal\\]([^\\n\\[]*\\n+)+?[[:space:]]*Storage\" \"$f\"; then\n\n            sed -i \"s/Storage[^(\\n)]*/Storage=persistent/\" \"$f\"\n\n            found=true\n\n    # find section and add key = value to it\n    elif grep -qs \"[[:space:]]*\\[Journal\\]\" \"$f\"; then\n\n            sed -i \"/[[:space:]]*\\[Journal\\]/a Storage=persistent\" \"$f\"\n\n            found=true\n    fi\ndone\n\n# if section not in any file, append section with key = value to FIRST file in files parameter\nif ! $found ; then\n    file=$(echo \"/etc/systemd/journald.conf.d/complianceascode_hardening.conf /etc/systemd/journald.conf.d/*.conf /etc/systemd/journald.conf\" | cut -f1 -d ' ')\n    mkdir -p \"$(dirname \"$file\")\"\n\n    echo -e \"[Journal]\\nStorage=persistent\" >> \"$file\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_socket_systemd-journal-remote_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_socket_systemd-journal-remote_disabled",
        "title": "Disable systemd-journal-remote Socket",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87605-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.2.1.4"
            ]
          }
        ],
        "description": "Journald supports the ability to receive messages from remote hosts,\nthus acting as a log server. Clients should not receive data from\nother hosts.\nNOTE:\n    The same package, systemd-journal-remote , is used for both sending\n    logs to remote hosts and receiving incoming logs.\n    With regards to receiving logs, there are two Systemd unit files;\n    systemd-journal-remote.socket and systemd-journal-remote.service.",
        "rationale": "If a client is configured to also receive data, thus turning it into\na server, the client system is acting outside it&#x27;s operational boundary.",
        "oval_definition_id": "oval:ssg-socket_systemd-journal-remote_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "socket_systemd-journal-remote_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Disable systemd-journal-remote Socket - Collect systemd Socket Units Present\n    in the System\n  ansible.builtin.command:\n    cmd: systemctl -q list-unit-files --type socket\n  register: result_systemd_unit_files\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87605-2\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - socket_systemd-journal-remote_disabled\n\n- name: Disable systemd-journal-remote Socket - Ensure systemd-journal-remote.socket\n    is Masked\n  ansible.builtin.systemd:\n    name: systemd-journal-remote.socket\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - result_systemd_unit_files.stdout_lines is search(\"systemd-journal-remote.socket\")\n  tags:\n  - CCE-87605-2\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - socket_systemd-journal-remote_disabled\n"
          },
          {
            "remediation_id": "socket_systemd-journal-remote_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSOCKET_NAME=\"systemd-journal-remote.socket\"\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files --type socket | grep -q \"$SOCKET_NAME\"; then\n    \"$SYSTEMCTL_EXEC\" stop \"$SOCKET_NAME\"\n    \"$SYSTEMCTL_EXEC\" mask \"$SOCKET_NAME\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_rsyslog_nolisten": {
        "rule_id": "xccdf_org.ssgproject.content_rule_rsyslog_nolisten",
        "title": "Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-84275-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "5.1.1.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "4",
              "5",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO11.04",
              "APO13.01",
              "BAI03.05",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.05",
              "DSS03.01",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02",
              "MEA02.01"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000318",
              "CCI-000366",
              "CCI-000368",
              "CCI-001812",
              "CCI-001813",
              "CCI-001814"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.3.9",
              "4.3.3.4",
              "4.3.3.5.8",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.8",
              "SR 2.9",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.5.1",
              "A.12.6.2",
              "A.12.7.1",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-1",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "The <code>rsyslog</code> daemon should not accept remote messages unless the system acts as a log\nserver. To ensure that it is not listening on the network, ensure any of the following lines\nare <i>not</i> found in <code>rsyslog</code> configuration files.\n\nIf using legacy syntax:\n<pre>$ModLoad imtcp\n$InputTCPServerRun <i>port</i>\n$ModLoad imudp\n$UDPServerRun <i>port</i>\n$ModLoad imrelp\n$InputRELPServerRun <i>port</i>\n        </pre>\n\nIf using RainerScript syntax:\n<pre>module(load=&quot;imtcp&quot;)\nmodule(load=&quot;imudp&quot;)\ninput(type=&quot;imtcp&quot; port=&quot;514&quot;)\ninput(type=&quot;imudp&quot; port=&quot;514&quot;)\n</pre>\n       ",
        "rationale": "Any process which receives messages from the network incurs some risk of receiving malicious\nmessages. This risk can be eliminated for rsyslog by configuring it not to listen on the\nnetwork.",
        "oval_definition_id": "oval:ssg-rsyslog_nolisten:def:1",
        "remediations": [
          {
            "remediation_id": "rsyslog_nolisten",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Define Rsyslog Config Lines Regex in Legacy Syntax\n  ansible.builtin.set_fact:\n    rsyslog_listen_legacy_regex: ^\\s*\\$(((Input(TCP|RELP)|UDP)ServerRun)|ModLoad\\s+(imtcp|imudp|imrelp))\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Search for Legacy Config Lines in Rsyslog Main Config File\n  ansible.builtin.find:\n    paths: /etc\n    pattern: rsyslog.conf\n    contains: '{{ rsyslog_listen_legacy_regex }}'\n  register: rsyslog_listen_legacy_main_file\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Search for Legacy Config Lines in Rsyslog Include Files\n  ansible.builtin.find:\n    paths: /etc/rsyslog.d/\n    pattern: '*.conf'\n    contains: '{{ rsyslog_listen_legacy_regex }}'\n  register: rsyslog_listen_legacy_include_files\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Assemble List of Config Files With Listen Lines in Legacy Syntax\n  ansible.builtin.set_fact:\n    rsyslog_legacy_remote_listen_files: '{{ rsyslog_listen_legacy_main_file.files\n      | map(attribute=''path'') | list + rsyslog_listen_legacy_include_files.files\n      | map(attribute=''path'') | list }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Comment Listen Config Lines Wherever Defined Using Legacy Syntax\n  ansible.builtin.replace:\n    path: '{{ item }}'\n    regexp: '{{ rsyslog_listen_legacy_regex }}'\n    replace: '# \\1'\n  loop: '{{ rsyslog_legacy_remote_listen_files }}'\n  register: rsyslog_listen_legacy_comment\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_legacy_remote_listen_files | length > 0\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Define Rsyslog Config Lines Regex in RainerScript Syntax\n  ansible.builtin.set_fact:\n    rsyslog_listen_rainer_regex: ^\\s*(module|input)\\((load|type)=\"(imtcp|imudp)\".*$\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Search for RainerScript Config Lines in Rsyslog Main Config File\n  ansible.builtin.find:\n    paths: /etc\n    pattern: rsyslog.conf\n    contains: '{{ rsyslog_listen_rainer_regex }}'\n  register: rsyslog_rainer_remote_main_file\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Search for RainerScript Config Lines in Rsyslog Include Files\n  ansible.builtin.find:\n    paths: /etc/rsyslog.d/\n    pattern: '*.conf'\n    contains: '{{ rsyslog_listen_rainer_regex }}'\n  register: rsyslog_rainer_remote_include_files\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Assemble List of Config Files With Listen Lines in RainerScript\n  ansible.builtin.set_fact:\n    rsyslog_rainer_remote_listen_files: '{{ rsyslog_rainer_remote_main_file.files\n      | map(attribute=''path'') | list + rsyslog_rainer_remote_include_files.files\n      | map(attribute=''path'') | list }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Comment Listen Config Lines Wherever Defined Using RainerScript\n  ansible.builtin.replace:\n    path: '{{ item }}'\n    regexp: '{{ rsyslog_listen_rainer_regex }}'\n    replace: '# \\1'\n  loop: '{{ rsyslog_rainer_remote_listen_files }}'\n  register: rsyslog_listen_rainer_comment\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_rainer_remote_listen_files | length > 0\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n\n- name: Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server\n    - Restart Rsyslog if Any Line Were Commented Out\n  ansible.builtin.service:\n    name: rsyslog\n    state: restarted\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - rsyslog_listen_legacy_comment is changed or rsyslog_listen_rainer_comment is changed\n  tags:\n  - CCE-84275-7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - rsyslog_nolisten\n"
          },
          {
            "remediation_id": "rsyslog_nolisten",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nlegacy_regex='^\\s*\\$(((Input(TCP|RELP)|UDP)ServerRun)|ModLoad\\s+(imtcp|imudp|imrelp))'\nrainer_regex='^\\s*(module|input)\\((load|type)=\"(imtcp|imudp)\".*$'\n\nreadarray -t legacy_targets < <(grep -l -E -r \"${legacy_regex[@]}\" /etc/rsyslog.conf /etc/rsyslog.d/)\nreadarray -t rainer_targets < <(grep -l -E -r \"${rainer_regex[@]}\" /etc/rsyslog.conf /etc/rsyslog.d/)\n\nconfig_changed=false\nif [ ${#legacy_targets[@]} -gt 0 ]; then\n    for target in \"${legacy_targets[@]}\"; do\n        sed -E -i \"/$legacy_regex/ s/^/# /\" \"$target\"\n    done\n    config_changed=true\nfi\n\nif [ ${#rainer_targets[@]} -gt 0 ]; then\n    for target in \"${rainer_targets[@]}\"; do\n        sed -E -i \"/$rainer_regex/ s/^/# /\" \"$target\"\n    done\n    config_changed=true\nfi\n\nif $config_changed; then\n    systemctl restart rsyslog.service\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_firewalld_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_firewalld_installed",
        "title": "Install firewalld Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82998-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002314"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000096-GPOS-00050",
              "SRG-OS-000297-GPOS-00115",
              "SRG-OS-000298-GPOS-00116",
              "SRG-OS-000480-GPOS-00227",
              "SRG-OS-000480-GPOS-00232"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040100"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230505r854048_rule"
            ]
          }
        ],
        "description": "The <code>firewalld</code> package can be installed with the following command:\n<pre>\n$ sudo yum install firewalld</pre>\n        ",
        "rationale": "&quot;Firewalld&quot; provides an easy and effective way to block/limit remote access to the system via ports, services, and protocols.\n\nRemote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nRed Hat Enterprise Linux 8 functionality (e.g., SSH) must be capable of taking enforcement action if the audit reveals unauthorized activity.\nAutomated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).&quot;",
        "oval_definition_id": "oval:ssg-package_firewalld_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_firewalld_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure firewalld is installed\n  package:\n    name: firewalld\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82998-6\n  - DISA-STIG-RHEL-08-040100\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-1.2.1\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_firewalld_installed\n"
          },
          {
            "remediation_id": "package_firewalld_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_firewalld\n\nclass install_firewalld {\n  package { 'firewalld':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_firewalld_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"firewalld\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_firewalld_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"firewalld\" ; then\n    yum install -y \"firewalld\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230505",
        "stig_id": "RHEL-08-040100"
      },
      "xccdf_org.ssgproject.content_rule_service_firewalld_enabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_firewalld_enabled",
        "title": "Verify firewalld Enabled",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80877-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.3",
              "3.4.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000382",
              "CCI-002314"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R4",
              "CIP-003-8 R5",
              "CIP-004-6 R3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-4",
              "CA-3(5)",
              "CM-6(a)",
              "CM-7(b)",
              "SC-7(21)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000096-GPOS-00050",
              "SRG-OS-000297-GPOS-00115",
              "SRG-OS-000480-GPOS-00227",
              "SRG-OS-000480-GPOS-00231",
              "SRG-OS-000480-GPOS-00232"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040101"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244544r854073_rule"
            ]
          }
        ],
        "description": "\nThe <code>firewalld</code> service can be enabled with the following command:\n<pre>$ sudo systemctl enable firewalld.service</pre>\n        ",
        "rationale": "Access control methods provide the ability to enhance system security posture\nby restricting services and known good IP addresses and address ranges. This\nprevents connections from unknown hosts and protocols.",
        "platforms": [
          "#package_firewalld"
        ],
        "oval_definition_id": "oval:ssg-service_firewalld_enabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_firewalld_enabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80877-4\n  - DISA-STIG-RHEL-08-040101\n  - NIST-800-171-3.1.3\n  - NIST-800-171-3.4.7\n  - NIST-800-53-AC-4\n  - NIST-800-53-CA-3(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(21)\n  - PCI-DSSv4-1.2.1\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_firewalld_enabled\n\n- name: Verify firewalld Enabled - Enable service firewalld\n  block:\n\n  - name: Gather the package facts\n    package_facts:\n      manager: auto\n\n  - name: Verify firewalld Enabled - Enable Service firewalld\n    ansible.builtin.systemd:\n      name: firewalld\n      enabled: true\n      state: started\n      masked: false\n    when:\n    - '\"firewalld\" in ansible_facts.packages'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"firewalld\" in ansible_facts.packages'\n  tags:\n  - CCE-80877-4\n  - DISA-STIG-RHEL-08-040101\n  - NIST-800-171-3.1.3\n  - NIST-800-171-3.4.7\n  - NIST-800-53-AC-4\n  - NIST-800-53-CA-3(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(21)\n  - PCI-DSSv4-1.2.1\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_firewalld_enabled\n"
          },
          {
            "remediation_id": "service_firewalld_enabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include enable_firewalld\n\nclass enable_firewalld {\n  service {'firewalld':\n    enable => true,\n    ensure => 'running',\n  }\n}\n"
          },
          {
            "remediation_id": "service_firewalld_enabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nenabled = [\"firewalld\"]\n"
          },
          {
            "remediation_id": "service_firewalld_enabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { rpm --quiet -q firewalld; }; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" unmask 'firewalld.service'\n\"$SYSTEMCTL_EXEC\" start 'firewalld.service'\n\"$SYSTEMCTL_EXEC\" enable 'firewalld.service'\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244544",
        "stig_id": "RHEL-08-040101"
      },
      "xccdf_org.ssgproject.content_rule_firewalld_loopback_traffic_restricted": {
        "rule_id": "xccdf_org.ssgproject.content_rule_firewalld_loopback_traffic_restricted",
        "title": "Configure Firewalld to Restrict Loopback Traffic",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87272-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.2.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.1"
            ]
          }
        ],
        "description": "Configure <code>firewalld</code> to restrict loopback traffic to the <code>lo</code> interface.\n\nThe loopback traffic must be trusted by assigning the <code>lo</code> interface to the\n<code>firewalld</code>\n         <code>trusted</code> zone. However, the loopback traffic must be restricted\nto the loopback interface as an anti-spoofing measure.\n\nTo configure <code>firewalld</code> to restrict loopback traffic to the <code>lo</code> interface,\nrun the following commands:\n<pre>\nsudo firewall-cmd --permanent --zone=trusted --add-rich-rule=&#x27;rule family=ipv4 source address=&quot;127.0.0.1&quot; destination not address=&quot;127.0.0.1&quot; drop&#x27;\nsudo firewall-cmd --permanent --zone=trusted --add-rich-rule=&#x27;rule family=ipv6 source address=&quot;::1&quot; destination not address=&quot;::1&quot; drop&#x27;\n</pre>\n\nTo ensure <code>firewalld</code> settings are applied in runtime, run the following command:\n<pre>firewall-cmd --reload</pre>\n        ",
        "rationale": "Loopback traffic is generated between processes on machine and is typically critical to\noperation of the system. The loopback interface is the only place that loopback network\ntraffic should be seen, all other interfaces should ignore traffic on this network as an\nanti-spoofing measure.",
        "oval_definition_id": "oval:ssg-firewalld_loopback_traffic_restricted:def:1",
        "remediations": [
          {
            "remediation_id": "firewalld_loopback_traffic_restricted",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Configure Firewalld to Restrict Loopback Traffic - Ensure firewalld Package\n    is Installed\n  ansible.builtin.package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - firewalld\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87272-1\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_restricted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Restrict Loopback Traffic - Collect Facts About System\n    Services\n  ansible.builtin.service_facts: null\n  register: result_services_states\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87272-1\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_restricted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Restrict Loopback Traffic - Remediation is Applicable\n    if firewalld Service is Running\n  block:\n\n  - name: Configure Firewalld to Restrict Loopback Traffic - Ensure firewalld trusted\n      Zone Restricts IPv4 Loopback Traffic\n    ansible.builtin.command:\n      cmd: firewall-cmd --permanent --zone=trusted --add-rich-rule='rule family=ipv4\n        source address=\"127.0.0.1\" destination not address=\"127.0.0.1\" drop'\n    register: result_trusted_ipv4_restriction\n    changed_when:\n    - '''ALREADY_ENABLED'' not in result_trusted_ipv4_restriction.stderr'\n\n  - name: Configure Firewalld to Restrict Loopback Traffic - Ensure firewalld trusted\n      Zone Restricts IPv6 Loopback Traffic\n    ansible.builtin.command:\n      cmd: firewall-cmd --permanent --zone=trusted --add-rich-rule='rule family=ipv6\n        source address=\"::1\" destination not address=\"::1\" drop'\n    register: result_trusted_ipv6_restriction\n    changed_when:\n    - '''ALREADY_ENABLED'' not in result_trusted_ipv6_restriction.stderr'\n\n  - name: Configure Firewalld to Restrict Loopback Traffic - Ensure firewalld Changes\n      are Applied\n    ansible.builtin.service:\n      name: firewalld\n      state: reloaded\n    when:\n    - result_trusted_ipv4_restriction is changed or result_trusted_ipv6_restriction\n      is changed\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - ansible_facts.services['firewalld.service'].state == 'running'\n  tags:\n  - CCE-87272-1\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_restricted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Restrict Loopback Traffic - Informative Message Based\n    on Service State\n  ansible.builtin.assert:\n    that:\n    - ansible_facts.services['firewalld.service'].state == 'running'\n    fail_msg:\n    - firewalld service is not active. Remediation aborted!\n    - This remediation could not be applied because it depends on firewalld service\n      running.\n    - The service is not started by this remediation in order to prevent connection\n      issues.\n    success_msg:\n    - Configure Firewalld to Restrict Loopback Traffic remediation successfully executed\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87272-1\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_restricted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "firewalld_loopback_traffic_restricted",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"firewalld\" ; then\n    yum install -y \"firewalld\"\nfi\n\nipv4_rule='rule family=ipv4 source address=\"127.0.0.1\" destination not address=\"127.0.0.1\" drop'\nipv6_rule='rule family=ipv6 source address=\"::1\" destination not address=\"::1\" drop'\n\nif test \"$(stat -c %d:%i /)\" != \"$(stat -c %d:%i /proc/1/root/.)\"; then\n    firewall-offline-cmd --zone=trusted --add-rich-rule=\"${ipv4_rule}\"\n    firewall-offline-cmd --zone=trusted --add-rich-rule=\"${ipv6_rule}\"\nelif systemctl is-active firewalld; then\n    firewall-cmd --permanent --zone=trusted --add-rich-rule=\"${ipv4_rule}\"\n    firewall-cmd --permanent --zone=trusted --add-rich-rule=\"${ipv6_rule}\"\n    firewall-cmd --reload\nelse\n    echo \"\n    firewalld service is not active. Remediation aborted!\n    This remediation could not be applied because it depends on firewalld service running.\n    The service is not started by this remediation in order to prevent connection issues.\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_firewalld_loopback_traffic_trusted": {
        "rule_id": "xccdf_org.ssgproject.content_rule_firewalld_loopback_traffic_trusted",
        "title": "Configure Firewalld to Trust Loopback Traffic",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87278-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.2.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.1"
            ]
          }
        ],
        "description": "Assign loopback interface to the <code>firewalld</code>\n         <code>trusted</code> zone in order to\nexplicitly allow the loopback traffic in the system.\n\nTo configure <code>firewalld</code> to trust loopback traffic, run the following command:\n<pre>sudo firewall-cmd --permanent --zone=trusted --add-interface=lo</pre>\nTo ensure <code>firewalld</code> settings are applied in runtime, run the following command:\n<pre>firewall-cmd --reload</pre>\n        ",
        "rationale": "Loopback traffic is generated between processes on machine and is typically critical to\noperation of the system. The loopback interface is the only place that loopback network\ntraffic should be seen, all other interfaces should ignore traffic on this network as an\nanti-spoofing measure.",
        "oval_definition_id": "oval:ssg-firewalld_loopback_traffic_trusted:def:1",
        "remediations": [
          {
            "remediation_id": "firewalld_loopback_traffic_trusted",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Configure Firewalld to Trust Loopback Traffic - Ensure firewalld Package is\n    Installed\n  ansible.builtin.package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - firewalld\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87278-8\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_trusted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Trust Loopback Traffic - Collect Facts About System\n    Services\n  ansible.builtin.service_facts: null\n  register: result_services_states\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87278-8\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_trusted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Trust Loopback Traffic - Remediation is Applicable\n    if firewalld Service is Running\n  block:\n\n  - name: Configure Firewalld to Trust Loopback Traffic - Ensure firewalld trusted\n      Zone Includes lo Interface\n    ansible.builtin.command:\n      cmd: firewall-cmd --permanent --zone=trusted --add-interface=lo\n    register: result_lo_interface_assignment\n    changed_when:\n    - '''ALREADY_ENABLED'' not in result_lo_interface_assignment.stderr'\n\n  - name: Configure Firewalld to Trust Loopback Traffic - Ensure firewalld Changes\n      are Applied\n    ansible.builtin.service:\n      name: firewalld\n      state: reloaded\n    when:\n    - result_lo_interface_assignment is changed\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - ansible_facts.services['firewalld.service'].state == 'running'\n  tags:\n  - CCE-87278-8\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_trusted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure Firewalld to Trust Loopback Traffic - Informative Message Based\n    on Service State\n  ansible.builtin.assert:\n    that:\n    - ansible_facts.services['firewalld.service'].state == 'running'\n    fail_msg:\n    - firewalld service is not active. Remediation aborted!\n    - This remediation could not be applied because it depends on firewalld service\n      running.\n    - The service is not started by this remediation in order to prevent connection\n      issues.\n    success_msg:\n    - Configure Firewalld to Trust Loopback Traffic remediation successfully executed\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87278-8\n  - PCI-DSSv4-1.4.1\n  - configure_strategy\n  - firewalld_loopback_traffic_trusted\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "firewalld_loopback_traffic_trusted",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"firewalld\" ; then\n    yum install -y \"firewalld\"\nfi\n\nif test \"$(stat -c %d:%i /)\" != \"$(stat -c %d:%i /proc/1/root/.)\"; then\n    firewall-offline-cmd --zone=trusted --add-interface=lo\nelif systemctl is-active firewalld; then\n    firewall-cmd --permanent --zone=trusted --add-interface=lo\n    firewall-cmd --reload\nelse\n    echo \"\n    firewalld service is not active. Remediation aborted!\n    This remediation could not be applied because it depends on firewalld service running.\n    The service is not started by this remediation in order to prevent connection issues.\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_ra": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_ra",
        "title": "Configure Accepting Router Advertisements on All IPv6 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81006-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040261"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230541r858812_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.all.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_ra=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_ra = 0</pre>\n        ",
        "rationale": "An illicit router advertisement message could result in a man-in-the-middle attack.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_all_accept_ra:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_ra",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.all.accept_ra.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81006-9\n  - DISA-STIG-RHEL-08-040261\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_ra\n\n- name: Comment out any occurrences of net.ipv6.conf.all.accept_ra from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.all.accept_ra\n    replace: '#net.ipv6.conf.all.accept_ra'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81006-9\n  - DISA-STIG-RHEL-08-040261\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_ra\n- name: XCCDF Value sysctl_net_ipv6_conf_all_accept_ra_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_all_accept_ra_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.all.accept_ra is set\n  sysctl:\n    name: net.ipv6.conf.all.accept_ra\n    value: '{{ sysctl_net_ipv6_conf_all_accept_ra_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81006-9\n  - DISA-STIG-RHEL-08-040261\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_ra\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_ra",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.all.accept_ra%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_ra.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_ra",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.all.accept_ra from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.all.accept_ra.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.all.accept_ra\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_all_accept_ra_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.all.accept_ra\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.all.accept_ra=\"$sysctl_net_ipv6_conf_all_accept_ra_value\"\n\n#\n# If net.ipv6.conf.all.accept_ra present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.all.accept_ra = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.all.accept_ra\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_all_accept_ra_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.all.accept_ra\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.all.accept_ra\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81006-9\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230541",
        "stig_id": "RHEL-08-040261"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_redirects",
        "title": "Disable Accepting ICMP Redirects for All IPv6 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81009-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R13"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-6(b)",
              "CM-6.1(iv)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040280"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230544r858820_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_redirects = 0</pre>\n        ",
        "rationale": "An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_all_accept_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.all.accept_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81009-3\n  - DISA-STIG-RHEL-08-040280\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_redirects\n\n- name: Comment out any occurrences of net.ipv6.conf.all.accept_redirects from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.all.accept_redirects\n    replace: '#net.ipv6.conf.all.accept_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81009-3\n  - DISA-STIG-RHEL-08-040280\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_redirects\n- name: XCCDF Value sysctl_net_ipv6_conf_all_accept_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_all_accept_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.all.accept_redirects is set\n  sysctl:\n    name: net.ipv6.conf.all.accept_redirects\n    value: '{{ sysctl_net_ipv6_conf_all_accept_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81009-3\n  - DISA-STIG-RHEL-08-040280\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.all.accept_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.all.accept_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.all.accept_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.all.accept_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_all_accept_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.all.accept_redirects\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.all.accept_redirects=\"$sysctl_net_ipv6_conf_all_accept_redirects_value\"\n\n#\n# If net.ipv6.conf.all.accept_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.all.accept_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.all.accept_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_all_accept_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.all.accept_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.all.accept_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81009-3\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230544",
        "stig_id": "RHEL-08-040280"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_source_route": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_source_route",
        "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81013-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R13"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "4",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "DSS01.05",
              "DSS03.01",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-5",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040240"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230538r858801_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.accept_source_route=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.accept_source_route = 0</pre>\n        ",
        "rationale": "Source-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router, which can\nbe used to bypass network security measures. This requirement applies only to the\nforwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and\nthe system is functioning as a router.\n<br>\n         <br>\nAccepting source-routed packets in the IPv6 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_all_accept_source_route:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.all.accept_source_route.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81013-5\n  - DISA-STIG-RHEL-08-040240\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_source_route\n\n- name: Comment out any occurrences of net.ipv6.conf.all.accept_source_route from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.all.accept_source_route\n    replace: '#net.ipv6.conf.all.accept_source_route'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81013-5\n  - DISA-STIG-RHEL-08-040240\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_source_route\n- name: XCCDF Value sysctl_net_ipv6_conf_all_accept_source_route_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_all_accept_source_route_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.all.accept_source_route is set\n  sysctl:\n    name: net.ipv6.conf.all.accept_source_route\n    value: '{{ sysctl_net_ipv6_conf_all_accept_source_route_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81013-5\n  - DISA-STIG-RHEL-08-040240\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_accept_source_route\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.all.accept_source_route%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_all_accept_source_route.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.all.accept_source_route from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.all.accept_source_route.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.all.accept_source_route\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_all_accept_source_route_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.all.accept_source_route\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.all.accept_source_route=\"$sysctl_net_ipv6_conf_all_accept_source_route_value\"\n\n#\n# If net.ipv6.conf.all.accept_source_route present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.all.accept_source_route = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.all.accept_source_route\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_all_accept_source_route_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.all.accept_source_route\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.all.accept_source_route\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81013-5\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230538",
        "stig_id": "RHEL-08-040240"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_forwarding": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_forwarding",
        "title": "Disable Kernel Parameter for IPv6 Forwarding",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82863-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-6(b)",
              "CM-6.1(iv)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040260"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230540r858810_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.all.forwarding</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.all.forwarding=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.all.forwarding = 0</pre>\n        ",
        "rationale": "IP forwarding permits the kernel to forward packets from one network\ninterface to another. The ability to forward packets between two networks is\nonly appropriate for systems acting as routers.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_all_forwarding:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_forwarding",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.all.forwarding.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82863-2\n  - DISA-STIG-RHEL-08-040260\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_forwarding\n\n- name: Comment out any occurrences of net.ipv6.conf.all.forwarding from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.all.forwarding\n    replace: '#net.ipv6.conf.all.forwarding'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82863-2\n  - DISA-STIG-RHEL-08-040260\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_forwarding\n- name: XCCDF Value sysctl_net_ipv6_conf_all_forwarding_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_all_forwarding_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.all.forwarding is set\n  sysctl:\n    name: net.ipv6.conf.all.forwarding\n    value: '{{ sysctl_net_ipv6_conf_all_forwarding_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82863-2\n  - DISA-STIG-RHEL-08-040260\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_all_forwarding\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_all_forwarding",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.all.forwarding from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.all.forwarding.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.all.forwarding\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_all_forwarding_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.all.forwarding\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.all.forwarding=\"$sysctl_net_ipv6_conf_all_forwarding_value\"\n\n#\n# If net.ipv6.conf.all.forwarding present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.all.forwarding = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.all.forwarding\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_all_forwarding_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.all.forwarding\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.all.forwarding\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-82863-2\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230540",
        "stig_id": "RHEL-08-040260"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra",
        "title": "Disable Accepting Router Advertisements on all IPv6 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81007-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040262"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230542r858814_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.default.accept_ra</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_ra=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_ra = 0</pre>\n        ",
        "rationale": "An illicit router advertisement message could result in a man-in-the-middle attack.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_default_accept_ra:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_ra",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.default.accept_ra.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81007-7\n  - DISA-STIG-RHEL-08-040262\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_ra\n\n- name: Comment out any occurrences of net.ipv6.conf.default.accept_ra from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.default.accept_ra\n    replace: '#net.ipv6.conf.default.accept_ra'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81007-7\n  - DISA-STIG-RHEL-08-040262\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_ra\n- name: XCCDF Value sysctl_net_ipv6_conf_default_accept_ra_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_default_accept_ra_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.default.accept_ra is set\n  sysctl:\n    name: net.ipv6.conf.default.accept_ra\n    value: '{{ sysctl_net_ipv6_conf_default_accept_ra_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81007-7\n  - DISA-STIG-RHEL-08-040262\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_ra\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_ra",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.default.accept_ra%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_ra.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_ra",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.default.accept_ra from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.default.accept_ra.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.default.accept_ra\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_default_accept_ra_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.default.accept_ra\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.default.accept_ra=\"$sysctl_net_ipv6_conf_default_accept_ra_value\"\n\n#\n# If net.ipv6.conf.default.accept_ra present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.default.accept_ra = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.default.accept_ra\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_default_accept_ra_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.default.accept_ra\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.default.accept_ra\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81007-7\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230542",
        "stig_id": "RHEL-08-040262"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects",
        "title": "Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81010-1"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R13"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040210"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230535r858793_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_redirects = 0</pre>\n        ",
        "rationale": "An illicit ICMP redirect message could result in a man-in-the-middle attack.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_default_accept_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.default.accept_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81010-1\n  - DISA-STIG-RHEL-08-040210\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_redirects\n\n- name: Comment out any occurrences of net.ipv6.conf.default.accept_redirects from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.default.accept_redirects\n    replace: '#net.ipv6.conf.default.accept_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81010-1\n  - DISA-STIG-RHEL-08-040210\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_redirects\n- name: XCCDF Value sysctl_net_ipv6_conf_default_accept_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_default_accept_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.default.accept_redirects is set\n  sysctl:\n    name: net.ipv6.conf.default.accept_redirects\n    value: '{{ sysctl_net_ipv6_conf_default_accept_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81010-1\n  - DISA-STIG-RHEL-08-040210\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.default.accept_redirects%20%3D%200%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.default.accept_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.default.accept_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.default.accept_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_default_accept_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.default.accept_redirects\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.default.accept_redirects=\"$sysctl_net_ipv6_conf_default_accept_redirects_value\"\n\n#\n# If net.ipv6.conf.default.accept_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.default.accept_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.default.accept_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_default_accept_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.default.accept_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.default.accept_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81010-1\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230535",
        "stig_id": "RHEL-08-040210"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_source_route": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_source_route",
        "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81015-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R13"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "4",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "DSS01.05",
              "DSS03.01",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-6(b)",
              "CM-6.1(iv)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-5",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040250"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230539r861085_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv6.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv6.conf.default.accept_source_route=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv6.conf.default.accept_source_route = 0</pre>\n        ",
        "rationale": "Source-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router, which can\nbe used to bypass network security measures. This requirement applies only to the\nforwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and\nthe system is functioning as a router.\n\nAccepting source-routed packets in the IPv6 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv6_conf_default_accept_source_route:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv6.conf.default.accept_source_route.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81015-0\n  - DISA-STIG-RHEL-08-040250\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_source_route\n\n- name: Comment out any occurrences of net.ipv6.conf.default.accept_source_route from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv6.conf.default.accept_source_route\n    replace: '#net.ipv6.conf.default.accept_source_route'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81015-0\n  - DISA-STIG-RHEL-08-040250\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_source_route\n- name: XCCDF Value sysctl_net_ipv6_conf_default_accept_source_route_value # promote to variable\n  set_fact:\n    sysctl_net_ipv6_conf_default_accept_source_route_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv6.conf.default.accept_source_route is set\n  sysctl:\n    name: net.ipv6.conf.default.accept_source_route\n    value: '{{ sysctl_net_ipv6_conf_default_accept_source_route_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81015-0\n  - DISA-STIG-RHEL-08-040250\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(b)\n  - NIST-800-53-CM-6.1(iv)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv6_conf_default_accept_source_route\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv6.conf.default.accept_source_route%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv6_conf_default_accept_source_route.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv6_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv6.conf.default.accept_source_route from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv6.conf.default.accept_source_route.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv6.conf.default.accept_source_route\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv6_conf_default_accept_source_route_value='0'\n\n\n#\n# Set runtime for net.ipv6.conf.default.accept_source_route\n#\n/sbin/sysctl -q -n -w net.ipv6.conf.default.accept_source_route=\"$sysctl_net_ipv6_conf_default_accept_source_route_value\"\n\n#\n# If net.ipv6.conf.default.accept_source_route present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv6.conf.default.accept_source_route = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv6.conf.default.accept_source_route\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv6_conf_default_accept_source_route_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv6.conf.default.accept_source_route\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv6.conf.default.accept_source_route\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81015-0\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230539",
        "stig_id": "RHEL-08-040250"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects",
        "title": "Disable Accepting ICMP Redirects for All IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80917-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001503",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040279"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244553r858818_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.accept_redirects = 0</pre>\n        ",
        "rationale": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost&#x27;s route table and are unauthenticated. An illicit ICMP redirect\nmessage could result in a man-in-the-middle attack.\n<br>\nThis feature of the IPv4 protocol has few legitimate uses. It should be\ndisabled unless absolutely required.&quot;",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_accept_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.accept_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80917-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040279\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.all.accept_redirects from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.accept_redirects\n    replace: '#net.ipv4.conf.all.accept_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80917-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040279\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_redirects\n- name: XCCDF Value sysctl_net_ipv4_conf_all_accept_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_all_accept_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.all.accept_redirects is set\n  sysctl:\n    name: net.ipv4.conf.all.accept_redirects\n    value: '{{ sysctl_net_ipv4_conf_all_accept_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80917-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040279\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.accept_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.accept_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.accept_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.accept_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_all_accept_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.all.accept_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.accept_redirects=\"$sysctl_net_ipv4_conf_all_accept_redirects_value\"\n\n#\n# If net.ipv4.conf.all.accept_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.all.accept_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.accept_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_all_accept_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.accept_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.accept_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80917-8\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244553",
        "stig_id": "RHEL-08-040279"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route",
        "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81011-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040239"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244551r858799_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.accept_source_route=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.accept_source_route = 0</pre>\n        ",
        "rationale": "Source-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router,\nwhich can be used to bypass network security measures. This requirement\napplies only to the forwarding of source-routerd traffic, such as when IPv4\nforwarding is enabled and the system is functioning as a router.\n<br>\n         <br>\nAccepting source-routed packets in the IPv4 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_accept_source_route:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.accept_source_route.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81011-9\n  - DISA-STIG-RHEL-08-040239\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_source_route\n\n- name: Comment out any occurrences of net.ipv4.conf.all.accept_source_route from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.accept_source_route\n    replace: '#net.ipv4.conf.all.accept_source_route'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81011-9\n  - DISA-STIG-RHEL-08-040239\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_source_route\n- name: XCCDF Value sysctl_net_ipv4_conf_all_accept_source_route_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_all_accept_source_route_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.all.accept_source_route is set\n  sysctl:\n    name: net.ipv4.conf.all.accept_source_route\n    value: '{{ sysctl_net_ipv4_conf_all_accept_source_route_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81011-9\n  - DISA-STIG-RHEL-08-040239\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_accept_source_route\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.accept_source_route%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_accept_source_route.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_accept_source_route",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.accept_source_route from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.accept_source_route.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.accept_source_route\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_all_accept_source_route_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.all.accept_source_route\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.accept_source_route=\"$sysctl_net_ipv4_conf_all_accept_source_route_value\"\n\n#\n# If net.ipv4.conf.all.accept_source_route present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.all.accept_source_route = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.accept_source_route\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_all_accept_source_route_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.accept_source_route\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.accept_source_route\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81011-9\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244551",
        "stig_id": "RHEL-08-040239"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians",
        "title": "Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-81018-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.9"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.04",
              "DSS03.05",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000126"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5(3)(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.AC-3",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.log_martians=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.log_martians = 1</pre>\n        ",
        "rationale": "The presence of &quot;martian&quot; packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_log_martians:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_log_martians",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.log_martians.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81018-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_log_martians\n  - unknown_severity\n\n- name: Comment out any occurrences of net.ipv4.conf.all.log_martians from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.log_martians\n    replace: '#net.ipv4.conf.all.log_martians'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81018-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_log_martians\n  - unknown_severity\n- name: XCCDF Value sysctl_net_ipv4_conf_all_log_martians_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_all_log_martians_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.all.log_martians is set\n  sysctl:\n    name: net.ipv4.conf.all.log_martians\n    value: '{{ sysctl_net_ipv4_conf_all_log_martians_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81018-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_log_martians\n  - unknown_severity\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_log_martians",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.log_martians%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_log_martians.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_log_martians",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.log_martians from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.log_martians.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.log_martians\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_all_log_martians_value='1'\n\n\n#\n# Set runtime for net.ipv4.conf.all.log_martians\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.log_martians=\"$sysctl_net_ipv4_conf_all_log_martians_value\"\n\n#\n# If net.ipv4.conf.all.log_martians present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.all.log_martians = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.log_martians\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_all_log_martians_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.log_martians\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.log_martians\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81018-4\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter",
        "title": "Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81021-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.3"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040285"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230549r858830_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.rp_filter=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.rp_filter = 1</pre>\n        ",
        "rationale": "Enabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for\ncomplicated networks, but is helpful for end hosts and routers serving small\nnetworks.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_rp_filter:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_rp_filter",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.rp_filter.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81021-8\n  - DISA-STIG-RHEL-08-040285\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_rp_filter\n\n- name: Comment out any occurrences of net.ipv4.conf.all.rp_filter from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.rp_filter\n    replace: '#net.ipv4.conf.all.rp_filter'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81021-8\n  - DISA-STIG-RHEL-08-040285\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_rp_filter\n- name: XCCDF Value sysctl_net_ipv4_conf_all_rp_filter_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_all_rp_filter_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.all.rp_filter is set\n  sysctl:\n    name: net.ipv4.conf.all.rp_filter\n    value: '{{ sysctl_net_ipv4_conf_all_rp_filter_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81021-8\n  - DISA-STIG-RHEL-08-040285\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_rp_filter\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_rp_filter",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.rp_filter%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_rp_filter.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_rp_filter",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.rp_filter from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.rp_filter.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.rp_filter\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_all_rp_filter_value='1'\n\n\n#\n# Set runtime for net.ipv4.conf.all.rp_filter\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.rp_filter=\"$sysctl_net_ipv4_conf_all_rp_filter_value\"\n\n#\n# If net.ipv4.conf.all.rp_filter present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.all.rp_filter = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.rp_filter\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_all_rp_filter_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.rp_filter\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.rp_filter\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81021-8\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230549",
        "stig_id": "RHEL-08-040285"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects",
        "title": "Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81016-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001503",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.3"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.secure_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.secure_redirects = 0</pre>\n        ",
        "rationale": "Accepting &quot;secure&quot; ICMP redirects (from those gateways listed as\ndefault gateways) has few legitimate uses. It should be disabled unless it is\nabsolutely required.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_secure_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_secure_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.secure_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81016-8\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_secure_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.all.secure_redirects from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.secure_redirects\n    replace: '#net.ipv4.conf.all.secure_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81016-8\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_secure_redirects\n- name: XCCDF Value sysctl_net_ipv4_conf_all_secure_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_all_secure_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.all.secure_redirects is set\n  sysctl:\n    name: net.ipv4.conf.all.secure_redirects\n    value: '{{ sysctl_net_ipv4_conf_all_secure_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81016-8\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_secure_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_secure_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.secure_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_secure_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_secure_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.secure_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.secure_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.secure_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_all_secure_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.all.secure_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.secure_redirects=\"$sysctl_net_ipv4_conf_all_secure_redirects_value\"\n\n#\n# If net.ipv4.conf.all.secure_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.all.secure_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.secure_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_all_secure_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.secure_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.secure_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81016-8\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects",
        "title": "Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80919-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.3"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040209"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244550r858791_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.accept_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.accept_redirects = 0</pre>\n        ",
        "rationale": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost&#x27;s route table and are unauthenticated. An illicit ICMP redirect\nmessage could result in a man-in-the-middle attack.\n<br>This feature of the IPv4 protocol has few legitimate uses. It should\nbe disabled unless absolutely required.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_accept_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.accept_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80919-4\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040209\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.default.accept_redirects from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.accept_redirects\n    replace: '#net.ipv4.conf.default.accept_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80919-4\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040209\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_redirects\n- name: XCCDF Value sysctl_net_ipv4_conf_default_accept_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_default_accept_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.default.accept_redirects is set\n  sysctl:\n    name: net.ipv4.conf.default.accept_redirects\n    value: '{{ sysctl_net_ipv4_conf_default_accept_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80919-4\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040209\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.accept_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_accept_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.accept_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.accept_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.accept_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_default_accept_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.default.accept_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.accept_redirects=\"$sysctl_net_ipv4_conf_default_accept_redirects_value\"\n\n#\n# If net.ipv4.conf.default.accept_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.default.accept_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.accept_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_default_accept_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.accept_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.accept_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80919-4\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244550",
        "stig_id": "RHEL-08-040209"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route",
        "title": "Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80920-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040249"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244552r858803_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.accept_source_route</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.accept_source_route = 0</pre>\n        ",
        "rationale": "Source-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router,\nwhich can be used to bypass network security measures.\n<br>\nAccepting source-routed packets in the IPv4 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required, such as when\nIPv4 forwarding is enabled and the system is legitimately functioning as a\nrouter.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_accept_source_route:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.accept_source_route.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80920-2\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040249\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_source_route\n\n- name: Comment out any occurrences of net.ipv4.conf.default.accept_source_route from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.accept_source_route\n    replace: '#net.ipv4.conf.default.accept_source_route'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80920-2\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040249\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_source_route\n- name: XCCDF Value sysctl_net_ipv4_conf_default_accept_source_route_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_default_accept_source_route_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.default.accept_source_route is set\n  sysctl:\n    name: net.ipv4.conf.default.accept_source_route\n    value: '{{ sysctl_net_ipv4_conf_default_accept_source_route_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80920-2\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040249\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_accept_source_route\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.accept_source_route%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_accept_source_route.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_accept_source_route",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.accept_source_route from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.accept_source_route.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.accept_source_route\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_default_accept_source_route_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.default.accept_source_route\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.accept_source_route=\"$sysctl_net_ipv4_conf_default_accept_source_route_value\"\n\n#\n# If net.ipv4.conf.default.accept_source_route present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.default.accept_source_route = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.accept_source_route\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_default_accept_source_route_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.accept_source_route\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.accept_source_route\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80920-2\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244552",
        "stig_id": "RHEL-08-040249"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_log_martians": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_log_martians",
        "title": "Enable Kernel Paremeter to Log Martian Packets on all IPv4 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-81020-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.9"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.04",
              "DSS03.05",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000126"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5(3)(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.AC-3",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.log_martians</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.log_martians=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.log_martians = 1</pre>\n        ",
        "rationale": "The presence of &quot;martian&quot; packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_log_martians:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_log_martians",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.log_martians.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81020-0\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_log_martians\n  - unknown_severity\n\n- name: Comment out any occurrences of net.ipv4.conf.default.log_martians from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.log_martians\n    replace: '#net.ipv4.conf.default.log_martians'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81020-0\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_log_martians\n  - unknown_severity\n- name: XCCDF Value sysctl_net_ipv4_conf_default_log_martians_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_default_log_martians_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.default.log_martians is set\n  sysctl:\n    name: net.ipv4.conf.default.log_martians\n    value: '{{ sysctl_net_ipv4_conf_default_log_martians_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81020-0\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(3)(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_log_martians\n  - unknown_severity\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_log_martians",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.log_martians%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_log_martians.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_log_martians",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.log_martians from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.log_martians.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.log_martians\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_default_log_martians_value='1'\n\n\n#\n# Set runtime for net.ipv4.conf.default.log_martians\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.log_martians=\"$sysctl_net_ipv4_conf_default_log_martians_value\"\n\n#\n# If net.ipv4.conf.default.log_martians present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.default.log_martians = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.log_martians\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_default_log_martians_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.log_martians\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.log_martians\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81020-0\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter",
        "title": "Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81022-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.rp_filter</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.rp_filter=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.rp_filter = 1</pre>\n        ",
        "rationale": "Enabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for\ncomplicated networks, but is helpful for end hosts and routers serving small\nnetworks.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_rp_filter:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_rp_filter",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.rp_filter.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81022-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_rp_filter\n\n- name: Comment out any occurrences of net.ipv4.conf.default.rp_filter from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.rp_filter\n    replace: '#net.ipv4.conf.default.rp_filter'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81022-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_rp_filter\n- name: XCCDF Value sysctl_net_ipv4_conf_default_rp_filter_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_default_rp_filter_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.default.rp_filter is set\n  sysctl:\n    name: net.ipv4.conf.default.rp_filter\n    value: '{{ sysctl_net_ipv4_conf_default_rp_filter_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81022-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_rp_filter\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_rp_filter",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.rp_filter%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_rp_filter.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_rp_filter",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.rp_filter from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.rp_filter.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.rp_filter\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_default_rp_filter_value='1'\n\n\n#\n# Set runtime for net.ipv4.conf.default.rp_filter\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.rp_filter=\"$sysctl_net_ipv4_conf_default_rp_filter_value\"\n\n#\n# If net.ipv4.conf.default.rp_filter present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.default.rp_filter = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.rp_filter\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_default_rp_filter_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.rp_filter\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.rp_filter\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81022-6\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects",
        "title": "Configure Kernel Parameter for Accepting Secure Redirects By Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81017-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.secure_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.secure_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.secure_redirects = 0</pre>\n        ",
        "rationale": "Accepting &quot;secure&quot; ICMP redirects (from those gateways listed as\ndefault gateways) has few legitimate uses. It should be disabled unless it is\nabsolutely required.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_secure_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_secure_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.secure_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81017-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_secure_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.default.secure_redirects from\n    config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.secure_redirects\n    replace: '#net.ipv4.conf.default.secure_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81017-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_secure_redirects\n- name: XCCDF Value sysctl_net_ipv4_conf_default_secure_redirects_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_conf_default_secure_redirects_value: !!str 0\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.conf.default.secure_redirects is set\n  sysctl:\n    name: net.ipv4.conf.default.secure_redirects\n    value: '{{ sysctl_net_ipv4_conf_default_secure_redirects_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81017-6\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_secure_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_secure_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.secure_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_secure_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_secure_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.secure_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.secure_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.secure_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_conf_default_secure_redirects_value='0'\n\n\n#\n# Set runtime for net.ipv4.conf.default.secure_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.secure_redirects=\"$sysctl_net_ipv4_conf_default_secure_redirects_value\"\n\n#\n# If net.ipv4.conf.default.secure_redirects present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.conf.default.secure_redirects = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.secure_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_conf_default_secure_redirects_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.secure_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.secure_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81017-6\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts",
        "title": "Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80922-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040230"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230537r858797_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.icmp_echo_ignore_broadcasts</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.icmp_echo_ignore_broadcasts = 1</pre>\n        ",
        "rationale": "Responding to broadcast (ICMP) echoes facilitates network mapping\nand provides a vector for amplification attacks.\n<br>\nIgnoring ICMP echo requests (pings) sent to broadcast or multicast\naddresses makes the system slightly more difficult to enumerate on the network.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_icmp_echo_ignore_broadcasts:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_icmp_echo_ignore_broadcasts",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.icmp_echo_ignore_broadcasts.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80922-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040230\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_icmp_echo_ignore_broadcasts\n\n- name: Comment out any occurrences of net.ipv4.icmp_echo_ignore_broadcasts from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.icmp_echo_ignore_broadcasts\n    replace: '#net.ipv4.icmp_echo_ignore_broadcasts'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80922-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040230\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_icmp_echo_ignore_broadcasts\n- name: XCCDF Value sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.icmp_echo_ignore_broadcasts is set\n  sysctl:\n    name: net.ipv4.icmp_echo_ignore_broadcasts\n    value: '{{ sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80922-8\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040230\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_icmp_echo_ignore_broadcasts\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_icmp_echo_ignore_broadcasts",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.icmp_echo_ignore_broadcasts%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_icmp_echo_ignore_broadcasts.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_icmp_echo_ignore_broadcasts",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.icmp_echo_ignore_broadcasts from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.icmp_echo_ignore_broadcasts.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.icmp_echo_ignore_broadcasts\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_icmp_echo_ignore_broadcasts_value='1'\n\n\n#\n# Set runtime for net.ipv4.icmp_echo_ignore_broadcasts\n#\n/sbin/sysctl -q -n -w net.ipv4.icmp_echo_ignore_broadcasts=\"$sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value\"\n\n#\n# If net.ipv4.icmp_echo_ignore_broadcasts present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.icmp_echo_ignore_broadcasts = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.icmp_echo_ignore_broadcasts\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_icmp_echo_ignore_broadcasts_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.icmp_echo_ignore_broadcasts\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.icmp_echo_ignore_broadcasts\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80922-8\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230537",
        "stig_id": "RHEL-08-040230"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses",
        "title": "Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-81023-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-7(a)",
              "CM-7(b)",
              "SC-5"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.2"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.icmp_ignore_bogus_error_responses</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.icmp_ignore_bogus_error_responses = 1</pre>\n        ",
        "rationale": "Ignoring bogus ICMP error responses reduces\nlog size, although some activity would not be logged.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_icmp_ignore_bogus_error_responses:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_icmp_ignore_bogus_error_responses",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.icmp_ignore_bogus_error_responses.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81023-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_icmp_ignore_bogus_error_responses\n  - unknown_severity\n\n- name: Comment out any occurrences of net.ipv4.icmp_ignore_bogus_error_responses\n    from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.icmp_ignore_bogus_error_responses\n    replace: '#net.ipv4.icmp_ignore_bogus_error_responses'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81023-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_icmp_ignore_bogus_error_responses\n  - unknown_severity\n- name: XCCDF Value sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.icmp_ignore_bogus_error_responses is set\n  sysctl:\n    name: net.ipv4.icmp_ignore_bogus_error_responses\n    value: '{{ sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81023-4\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - PCI-DSS-Req-1.4.3\n  - PCI-DSSv4-1.4.2\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - reboot_required\n  - sysctl_net_ipv4_icmp_ignore_bogus_error_responses\n  - unknown_severity\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_icmp_ignore_bogus_error_responses",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.icmp_ignore_bogus_error_responses%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_icmp_ignore_bogus_error_responses.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_icmp_ignore_bogus_error_responses",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.icmp_ignore_bogus_error_responses from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.icmp_ignore_bogus_error_responses.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.icmp_ignore_bogus_error_responses\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_icmp_ignore_bogus_error_responses_value='1'\n\n\n#\n# Set runtime for net.ipv4.icmp_ignore_bogus_error_responses\n#\n/sbin/sysctl -q -n -w net.ipv4.icmp_ignore_bogus_error_responses=\"$sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value\"\n\n#\n# If net.ipv4.icmp_ignore_bogus_error_responses present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.icmp_ignore_bogus_error_responses = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.icmp_ignore_bogus_error_responses\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_icmp_ignore_bogus_error_responses_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.icmp_ignore_bogus_error_responses\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.icmp_ignore_bogus_error_responses\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81023-4\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies",
        "title": "Enable Kernel Parameter to Use TCP Syncookies on Network Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80923-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.10"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-001095"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-5(1)",
              "SC-5(2)",
              "SC-5(3)(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000142-GPOS-00071",
              "SRG-OS-000420-GPOS-00186",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.4.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.3"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.tcp_syncookies</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.tcp_syncookies=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.tcp_syncookies = 1</pre>\n        ",
        "rationale": "A TCP SYN flood attack can cause a denial of service by filling a\nsystem&#x27;s TCP connection table with connections in the SYN_RCVD state.\nSyncookies can be used to track a connection when a subsequent ACK is received,\nverifying the initiator is attempting a valid connection and is not a flood\nsource. This feature is activated when a flood condition is detected, and\nenables the system to continue servicing valid connection requests.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_tcp_syncookies:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_tcp_syncookies",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.tcp_syncookies.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80923-6\n  - CJIS-5.10.1.1\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(1)\n  - NIST-800-53-SC-5(2)\n  - NIST-800-53-SC-5(3)(a)\n  - PCI-DSS-Req-1.4.1\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_tcp_syncookies\n\n- name: Comment out any occurrences of net.ipv4.tcp_syncookies from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.tcp_syncookies\n    replace: '#net.ipv4.tcp_syncookies'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80923-6\n  - CJIS-5.10.1.1\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(1)\n  - NIST-800-53-SC-5(2)\n  - NIST-800-53-SC-5(3)(a)\n  - PCI-DSS-Req-1.4.1\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_tcp_syncookies\n- name: XCCDF Value sysctl_net_ipv4_tcp_syncookies_value # promote to variable\n  set_fact:\n    sysctl_net_ipv4_tcp_syncookies_value: !!str 1\n  tags:\n    - always\n\n- name: Ensure sysctl net.ipv4.tcp_syncookies is set\n  sysctl:\n    name: net.ipv4.tcp_syncookies\n    value: '{{ sysctl_net_ipv4_tcp_syncookies_value }}'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80923-6\n  - CJIS-5.10.1.1\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5(1)\n  - NIST-800-53-SC-5(2)\n  - NIST-800-53-SC-5(3)(a)\n  - PCI-DSS-Req-1.4.1\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_tcp_syncookies\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_tcp_syncookies",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.tcp_syncookies%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_tcp_syncookies.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_tcp_syncookies",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.tcp_syncookies from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.tcp_syncookies.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.tcp_syncookies\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\nsysctl_net_ipv4_tcp_syncookies_value='1'\n\n\n#\n# Set runtime for net.ipv4.tcp_syncookies\n#\n/sbin/sysctl -q -n -w net.ipv4.tcp_syncookies=\"$sysctl_net_ipv4_tcp_syncookies_value\"\n\n#\n# If net.ipv4.tcp_syncookies present in /etc/sysctl.conf, change value to appropriate value\n#\telse, add \"net.ipv4.tcp_syncookies = value\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.tcp_syncookies\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$sysctl_net_ipv4_tcp_syncookies_value\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.tcp_syncookies\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.tcp_syncookies\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80923-6\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects",
        "title": "Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80918-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.5"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040220"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230536r858795_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.all.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.all.send_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.all.send_redirects = 0</pre>\n        ",
        "rationale": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain information\nfrom the system&#x27;s route table possibly revealing portions of the network topology.\n<br>\nThe ability to send ICMP redirects is only appropriate for systems acting as routers.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_all_send_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_send_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.all.send_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80918-6\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040220\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_send_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.all.send_redirects from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.all.send_redirects\n    replace: '#net.ipv4.conf.all.send_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80918-6\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040220\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_send_redirects\n\n- name: Ensure sysctl net.ipv4.conf.all.send_redirects is set to 0\n  sysctl:\n    name: net.ipv4.conf.all.send_redirects\n    value: '0'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80918-6\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040220\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_all_send_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_send_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.all.send_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_all_send_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_all_send_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.all.send_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.all.send_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.all.send_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\n\n#\n# Set runtime for net.ipv4.conf.all.send_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.all.send_redirects=\"0\"\n\n#\n# If net.ipv4.conf.all.send_redirects present in /etc/sysctl.conf, change value to \"0\"\n#\telse, add \"net.ipv4.conf.all.send_redirects = 0\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.all.send_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"0\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.all.send_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.all.send_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80918-6\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230536",
        "stig_id": "RHEL-08-040220"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects",
        "title": "Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80921-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "2",
              "3",
              "4",
              "6",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.10.1.1"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS01.05",
              "DSS03.01",
              "DSS03.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "DE.CM-1",
              "ID.AM-3",
              "PR.AC-5",
              "PR.DS-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.5"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040270"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230543r858816_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.conf.default.send_redirects</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.conf.default.send_redirects=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.conf.default.send_redirects = 0</pre>\n        ",
        "rationale": "ICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain information\nfrom the system&#x27;s route table possibly revealing portions of the network topology.\n<br>\nThe ability to send ICMP redirects is only appropriate for systems acting as routers.",
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_conf_default_send_redirects:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_send_redirects",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.conf.default.send_redirects.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80921-0\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040270\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_send_redirects\n\n- name: Comment out any occurrences of net.ipv4.conf.default.send_redirects from config\n    files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.conf.default.send_redirects\n    replace: '#net.ipv4.conf.default.send_redirects'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80921-0\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040270\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_send_redirects\n\n- name: Ensure sysctl net.ipv4.conf.default.send_redirects is set to 0\n  sysctl:\n    name: net.ipv4.conf.default.send_redirects\n    value: '0'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80921-0\n  - CJIS-5.10.1.1\n  - DISA-STIG-RHEL-08-040270\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSSv4-1.4.5\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_conf_default_send_redirects\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_send_redirects",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,net.ipv4.conf.default.send_redirects%3D0%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_net_ipv4_conf_default_send_redirects.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_conf_default_send_redirects",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.conf.default.send_redirects from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.conf.default.send_redirects.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.conf.default.send_redirects\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\n\n#\n# Set runtime for net.ipv4.conf.default.send_redirects\n#\n/sbin/sysctl -q -n -w net.ipv4.conf.default.send_redirects=\"0\"\n\n#\n# If net.ipv4.conf.default.send_redirects present in /etc/sysctl.conf, change value to \"0\"\n#\telse, add \"net.ipv4.conf.default.send_redirects = 0\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.conf.default.send_redirects\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"0\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.conf.default.send_redirects\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.conf.default.send_redirects\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80921-0\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230543",
        "stig_id": "RHEL-08-040270"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_ip_forward": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_ip_forward",
        "title": "Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81024-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R12"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.3.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "2",
              "3",
              "7",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI04.04",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.03",
              "DSS03.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.07",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.20"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 6.2",
              "SR 7.1",
              "SR 7.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.1.3",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.17.2.1",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R4",
              "CIP-007-3 R4.1",
              "CIP-007-3 R4.2",
              "CIP-007-3 R5.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "SC-5",
              "SC-7(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "PR.DS-4",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.3.1",
              "Req-1.3.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.3"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>net.ipv4.ip_forward</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w net.ipv4.ip_forward=0</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>net.ipv4.ip_forward = 0</pre>\n        ",
        "rationale": "Routing protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this capability is used when\nnot required, system network information may be unnecessarily transmitted across\nthe network.",
        "warnings": [
          {
            "text": "Certain technologies such as virtual machines, containers, etc. rely on IPv4 forwarding to enable and use networking.\nDisabling IPv4 forwarding would cause those technologies to stop working. Therefore, this rule should not be used in\nprofiles or benchmarks that target usage of IPv4 forwarding.",
            "category": "functionality"
          },
          {
            "text": "This rule is disabled on Red Hat Virtualization Hosts and Managers, it will report not applicable.\nRHV host requires IPv4 forwarding for the Hosted Engine bootstrap VM to reach network outside of the initial host.",
            "category": "general"
          }
        ],
        "platforms": [
          "#no_ovirt"
        ],
        "oval_definition_id": "oval:ssg-sysctl_net_ipv4_ip_forward:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_net_ipv4_ip_forward",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*net.ipv4.ip_forward.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81024-2\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.3.1\n  - PCI-DSS-Req-1.3.2\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_ip_forward\n\n- name: Comment out any occurrences of net.ipv4.ip_forward from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*net.ipv4.ip_forward\n    replace: '#net.ipv4.ip_forward'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81024-2\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.3.1\n  - PCI-DSS-Req-1.3.2\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_ip_forward\n\n- name: Ensure sysctl net.ipv4.ip_forward is set to 0\n  sysctl:\n    name: net.ipv4.ip_forward\n    value: '0'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81024-2\n  - NIST-800-171-3.1.20\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-SC-5\n  - NIST-800-53-SC-7(a)\n  - PCI-DSS-Req-1.3.1\n  - PCI-DSS-Req-1.3.2\n  - PCI-DSSv4-1.4.3\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_net_ipv4_ip_forward\n"
          },
          {
            "remediation_id": "sysctl_net_ipv4_ip_forward",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of net.ipv4.ip_forward from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*net.ipv4.ip_forward.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"net.ipv4.ip_forward\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\n\n#\n# Set runtime for net.ipv4.ip_forward\n#\n/sbin/sysctl -q -n -w net.ipv4.ip_forward=\"0\"\n\n#\n# If net.ipv4.ip_forward present in /etc/sysctl.conf, change value to \"0\"\n#\telse, add \"net.ipv4.ip_forward = 0\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^net.ipv4.ip_forward\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"0\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^net.ipv4.ip_forward\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^net.ipv4.ip_forward\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-81024-2\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_nftables_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_nftables_installed",
        "title": "Install nftables Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86376-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.1.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.1"
            ]
          }
        ],
        "description": "nftables provides a new in-kernel packet classification framework that is based on a\nnetwork-specific Virtual Machine (VM) and a new nft userspace command line tool.\nnftables reuses the existing Netfilter subsystems such as the existing hook infrastructure,\nthe connection tracking system, NAT, userspace queuing and logging subsystem.\nThe <code>nftables</code> package can be installed with the following command:\n<pre>\n$ sudo yum install nftables</pre>\n       ",
        "rationale": "<code>nftables</code> is a subsystem of the Linux kernel that can protect against threats\noriginating from within a corporate network to include malicious mobile code and poorly\nconfigured software on a host.",
        "platforms": [
          "#machine_and_service_disabled_iptables_and_service_disabled_ufw"
        ],
        "oval_definition_id": "oval:ssg-package_nftables_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_nftables_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure nftables is installed\n  package:\n    name: nftables\n    state: present\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] )\n  tags:\n  - CCE-86376-1\n  - PCI-DSSv4-1.2.1\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_nftables_installed\n"
          },
          {
            "remediation_id": "package_nftables_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_nftables\n\nclass install_nftables {\n  package { 'nftables':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_nftables_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"nftables\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_nftables_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] ); then\n\nif ! rpm -q --quiet \"nftables\" ; then\n    yum install -y \"nftables\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_nftables_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_nftables_disabled",
        "title": "Verify nftables Service is Disabled",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-88428-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.4.1.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.1"
            ]
          }
        ],
        "description": "nftables is a subsystem of the Linux kernel providing filtering and classification of network\npackets/datagrams/frames and is the successor to iptables.\nThe <code>nftables</code> service can be disabled with the following command:\n<pre>systemctl disable nftables</pre>\n       ",
        "rationale": "Running both <code>firewalld</code> and <code>nftables</code> may lead to conflict. <code>nftables</code>\nis actually one of the backends for <code>firewalld</code> management tools.",
        "platforms": [
          "#machine_and_package_firewalld_and_package_nftables"
        ],
        "oval_definition_id": "oval:ssg-service_nftables_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_nftables_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-88428-8\n  - PCI-DSSv4-1.2.1\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_nftables_disabled\n\n- name: Verify nftables Service is Disabled - Collect systemd Services Present in\n    the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"firewalld\" in ansible_facts.packages and \"nftables\" in ansible_facts.packages\n    )\n  tags:\n  - CCE-88428-8\n  - PCI-DSSv4-1.2.1\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_nftables_disabled\n\n- name: Verify nftables Service is Disabled - Ensure nftables.service is Masked\n  ansible.builtin.systemd:\n    name: nftables.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"firewalld\" in ansible_facts.packages and \"nftables\" in ansible_facts.packages\n    )\n  - service_exists.stdout_lines is search(\"nftables.service\", multiline=True)\n  tags:\n  - CCE-88428-8\n  - PCI-DSSv4-1.2.1\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_nftables_disabled\n\n- name: Unit Socket Exists - nftables.socket\n  ansible.builtin.command: systemctl -q list-unit-files nftables.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"firewalld\" in ansible_facts.packages and \"nftables\" in ansible_facts.packages\n    )\n  tags:\n  - CCE-88428-8\n  - PCI-DSSv4-1.2.1\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_nftables_disabled\n\n- name: Verify nftables Service is Disabled - Disable Socket nftables\n  ansible.builtin.systemd:\n    name: nftables.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"firewalld\" in ansible_facts.packages and \"nftables\" in ansible_facts.packages\n    )\n  - socket_file_exists.stdout_lines is search(\"nftables.socket\", multiline=True)\n  tags:\n  - CCE-88428-8\n  - PCI-DSSv4-1.2.1\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_nftables_disabled\n"
          },
          {
            "remediation_id": "service_nftables_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: nftables.service\n        enabled: false\n        mask: true\n      - name: nftables.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_nftables_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_nftables\n\nclass disable_nftables {\n  service {'nftables':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_nftables_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"nftables\"]\n"
          },
          {
            "remediation_id": "service_nftables_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && rpm --quiet -q firewalld && rpm --quiet -q nftables ); then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'nftables.service'\n\"$SYSTEMCTL_EXEC\" disable 'nftables.service'\n\"$SYSTEMCTL_EXEC\" mask 'nftables.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files nftables.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'nftables.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'nftables.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'nftables.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_bluetooth_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_bluetooth_disabled",
        "title": "Disable Bluetooth Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87231-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.16"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000085",
              "CCI-001551"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-18(3)",
              "AC-18(a)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          }
        ],
        "description": "\nThe <code>bluetooth</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now bluetooth.service</pre>\n         <pre>$ sudo service bluetooth stop</pre>\n        ",
        "rationale": "Disabling the <code>bluetooth</code> service prevents the system from attempting\nconnections to Bluetooth devices, which entails some security risk.\nNevertheless, variation in this risk decision may be expected due to the\nutility of Bluetooth connectivity and its limited range.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-service_bluetooth_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_bluetooth_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Disable Bluetooth Service - Collect systemd Services Present in the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87231-7\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_bluetooth_disabled\n\n- name: Disable Bluetooth Service - Ensure bluetooth.service is Masked\n  ansible.builtin.systemd:\n    name: bluetooth.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - service_exists.stdout_lines is search(\"bluetooth.service\", multiline=True)\n  tags:\n  - CCE-87231-7\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_bluetooth_disabled\n\n- name: Unit Socket Exists - bluetooth.socket\n  ansible.builtin.command: systemctl -q list-unit-files bluetooth.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87231-7\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_bluetooth_disabled\n\n- name: Disable Bluetooth Service - Disable Socket bluetooth\n  ansible.builtin.systemd:\n    name: bluetooth.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - socket_file_exists.stdout_lines is search(\"bluetooth.socket\", multiline=True)\n  tags:\n  - CCE-87231-7\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_bluetooth_disabled\n"
          },
          {
            "remediation_id": "service_bluetooth_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: bluetooth.service\n        enabled: false\n        mask: true\n      - name: bluetooth.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_bluetooth_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_bluetooth\n\nclass disable_bluetooth {\n  service {'bluetooth':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_bluetooth_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"bluetooth\"]\n"
          },
          {
            "remediation_id": "service_bluetooth_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'bluetooth.service'\n\"$SYSTEMCTL_EXEC\" disable 'bluetooth.service'\n\"$SYSTEMCTL_EXEC\" mask 'bluetooth.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files bluetooth.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'bluetooth.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'bluetooth.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'bluetooth.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_wireless_disable_interfaces": {
        "rule_id": "xccdf_org.ssgproject.content_rule_wireless_disable_interfaces",
        "title": "Deactivate Wireless Network Interfaces",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83501-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "3.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.16"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000085",
              "CCI-001443",
              "CCI-001444",
              "CCI-002418",
              "CCI-002421"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "1315",
              "1319"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-18(3)",
              "AC-18(a)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000299-GPOS-00117",
              "SRG-OS-000300-GPOS-00118",
              "SRG-OS-000424-GPOS-00188",
              "SRG-OS-000481-GPOS-000481"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-1.3.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.3.3"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040110"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230506r627750_rule"
            ]
          }
        ],
        "description": "Deactivating wireless network interfaces should prevent normal usage of the wireless\ncapability.\n<br>\n         <br>\n\nConfigure the system to disable all wireless network interfaces with the following command:\n<pre>$ sudo nmcli radio all off</pre>\n        ",
        "rationale": "The use of wireless networking can introduce many different attack vectors into\nthe organization&#x27;s network. Common attack vectors such as malicious association\nand ad hoc networks will allow an attacker to spoof a wireless access point\n(AP), allowing validated systems to connect to the malicious AP and enabling the\nattacker to monitor and record network traffic. These malicious APs can also\nserve to create a man-in-the-middle attack or be used to create a denial of\nservice to valid network resources.",
        "platforms": [
          "#wifi-iface"
        ],
        "oval_definition_id": "oval:ssg-wireless_disable_interfaces:def:1",
        "remediations": [
          {
            "remediation_id": "wireless_disable_interfaces",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "unknown",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-83501-7\n  - DISA-STIG-RHEL-08-040110\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - PCI-DSS-Req-1.3.3\n  - PCI-DSSv4-1.3.3\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n  - wireless_disable_interfaces\n\n- name: Service facts\n  ansible.builtin.service_facts: null\n  tags:\n  - CCE-83501-7\n  - DISA-STIG-RHEL-08-040110\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - PCI-DSS-Req-1.3.3\n  - PCI-DSSv4-1.3.3\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n  - wireless_disable_interfaces\n\n- name: Ensure NetworkManager is installed\n  ansible.builtin.package:\n    name: '{{ item }}'\n    state: present\n  with_items:\n  - NetworkManager\n  tags:\n  - CCE-83501-7\n  - DISA-STIG-RHEL-08-040110\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - PCI-DSS-Req-1.3.3\n  - PCI-DSSv4-1.3.3\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n  - wireless_disable_interfaces\n\n- name: NetworkManager Deactivate Wireless Network Interfaces\n  command: nmcli radio wifi off\n  when:\n  - '''NetworkManager'' in ansible_facts.packages'\n  - ansible_facts.services['NetworkManager.service'].state == 'running'\n  tags:\n  - CCE-83501-7\n  - DISA-STIG-RHEL-08-040110\n  - NIST-800-171-3.1.16\n  - NIST-800-53-AC-18(3)\n  - NIST-800-53-AC-18(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - PCI-DSS-Req-1.3.3\n  - PCI-DSSv4-1.3.3\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - no_reboot_needed\n  - unknown_strategy\n  - wireless_disable_interfaces\n"
          },
          {
            "remediation_id": "wireless_disable_interfaces",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "\nif ! rpm -q --quiet \"NetworkManager\" ; then\n    yum install -y \"NetworkManager\"\nfi\n\nif command -v nmcli >/dev/null 2>&1 && systemctl is-active NetworkManager >/dev/null 2>&1; then\n    nmcli radio all off\nfi\n\nif command -v wicked >/dev/null 2>&1 && systemctl is-active wickedd >/dev/null 2>&1; then\n  if [ -n \"$(find /sys/class/net/*/ -type d -name wireless)\" ]; then\n    interfaces=$(find /sys/class/net/*/wireless -type d -name wireless | xargs -0 dirname | xargs basename)\n    for iface in $interfaces; do\n      wicked ifdown $iface\n      sed -i 's/STARTMODE=.*/STARTMODE=off/' /etc/sysconfig/network/ifcfg-$iface\n    done\n  fi\nfi\n"
          }
        ],
        "vuln_id": "SV-230506",
        "stig_id": "RHEL-08-040110"
      },
      "xccdf_org.ssgproject.content_rule_dir_perms_world_writable_sticky_bits": {
        "rule_id": "xccdf_org.ssgproject.content_rule_dir_perms_world_writable_sticky_bits",
        "title": "Verify that All World-Writable Directories Have Sticky Bits Set",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80783-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R54"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001090"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000138-GPOS-00069"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010190"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230243r792857_rule"
            ]
          }
        ],
        "description": "When the so-called &#x27;sticky bit&#x27; is set on a directory, only the owner of a given file may\nremove that file from the directory. Without the sticky bit, any user with write access to a\ndirectory may remove any file in the directory. Setting the sticky bit prevents users from\nremoving each other&#x27;s files. In cases where there is no reason for a directory to be\nworld-writable, a better solution is to remove that permission rather than to set the sticky\nbit. However, if a directory is used by a particular application, consult that application&#x27;s\ndocumentation instead of blindly changing modes.\n<br>\nTo set the sticky bit on a world-writable directory <i>DIR</i>, run the following command:\n<pre>$ sudo chmod +t <i>DIR</i>\n        </pre>\n       ",
        "rationale": "Failing to set the sticky bit on public directories allows unauthorized users to delete files\nin the directory structure.\n<br>\n        <br>\nThe only authorized public directories are those temporary directories supplied with the\nsystem, or those designed to be temporary file repositories. The setting is normally reserved\nfor directories used by the system, by users for temporary file storage (such as <code>/tmp</code>),\nand for directories requiring global read/write access.",
        "warnings": [
          {
            "text": "This rule can take a long time to perform the check and might consume a considerable\namount of resources depending on the number of directories present on the system. It is\nnot a problem in most cases, but especially systems with a large number of directories can\nbe affected. See <code>https://access.redhat.com/articles/6999111</code>.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-dir_perms_world_writable_sticky_bits:def:1",
        "remediations": [
          {
            "remediation_id": "dir_perms_world_writable_sticky_bits",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Verify that All World-Writable Directories Have Sticky Bits Set - Define Excluded\n    (Non-Local) File Systems and Paths\n  ansible.builtin.set_fact:\n    excluded_fstypes:\n    - afs\n    - ceph\n    - cifs\n    - smb3\n    - smbfs\n    - sshfs\n    - ncpfs\n    - ncp\n    - nfs\n    - nfs4\n    - gfs\n    - gfs2\n    - glusterfs\n    - gpfs\n    - pvfs2\n    - ocfs2\n    - lustre\n    - davfs\n    - fuse.sshfs\n    excluded_paths:\n    - dev\n    - proc\n    - run\n    - sys\n    search_paths: []\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Find Relevant\n    Root Directories Ignoring Pre-Defined Excluded Paths\n  ansible.builtin.find:\n    paths: /\n    file_type: directory\n    excludes: '{{ excluded_paths }}'\n    hidden: true\n    recurse: false\n  register: result_relevant_root_dirs\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Include\n    Relevant Root Directories in a List of Paths to be Searched\n  ansible.builtin.set_fact:\n    search_paths: '{{ search_paths | union([item.path]) }}'\n  loop: '{{ result_relevant_root_dirs.files }}'\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Increment\n    Search Paths List with Local Partitions Mount Points\n  ansible.builtin.set_fact:\n    search_paths: '{{ search_paths | union([item.mount]) }}'\n  loop: '{{ ansible_mounts }}'\n  when:\n  - item.fstype not in excluded_fstypes\n  - item.mount != '/'\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Increment\n    Search Paths List with Local NFS File System Targets\n  ansible.builtin.set_fact:\n    search_paths: '{{ search_paths | union([item.device.split('':'')[1]]) }}'\n  loop: '{{ ansible_mounts }}'\n  when: item.device is search(\"localhost:\")\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Define Rule\n    Specific Facts\n  ansible.builtin.set_fact:\n    world_writable_dirs: []\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Find All\n    Uncompliant Directories in Local File Systems\n  ansible.builtin.command:\n    cmd: find {{ item }} -xdev -type d ( -perm -0002 -a ! -perm -1000 )\n  loop: '{{ search_paths }}'\n  changed_when: false\n  register: result_found_dirs\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Create List\n    of World Writable Directories Without Sticky Bit\n  ansible.builtin.set_fact:\n    world_writable_dirs: '{{ world_writable_dirs | union(item.stdout_lines) | list\n      }}'\n  loop: '{{ result_found_dirs.results }}'\n  when: result_found_dirs is not skipped and item is not skipped\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Verify that All World-Writable Directories Have Sticky Bits Set - Ensure Sticky\n    Bit is Set on Local World Writable Directories\n  ansible.builtin.file:\n    path: '{{ item }}'\n    mode: a+t\n  loop: '{{ world_writable_dirs }}'\n  tags:\n  - CCE-80783-4\n  - DISA-STIG-RHEL-08-010190\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - dir_perms_world_writable_sticky_bits\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "dir_perms_world_writable_sticky_bits",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "df --local -P | awk '{if (NR!=1) print $6}' \\\n| xargs -I '$6' find '$6' -xdev -type d \\\n\\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null \\\n-exec chmod a+t {} +\n"
          }
        ],
        "vuln_id": "SV-230243",
        "stig_id": "RHEL-08-010190"
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_unauthorized_world_writable": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_unauthorized_world_writable",
        "title": "Ensure No World-Writable Files Exist",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80818-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R54"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "It is generally a good idea to remove global (other) write access to a file when it is\ndiscovered. However, check with documentation for specific applications before making changes.\nAlso, monitor for recurring world-writable files, as these may be symptoms of a misconfigured\napplication or user account. Finally, this applies to real files and not virtual files that\nare a part of pseudo file systems such as <code>sysfs</code> or <code>procfs</code>.",
        "rationale": "Data in world-writable files can be modified by any user on the system. In almost all\ncircumstances, files can be configured using a combination of user and group permissions to\nsupport whatever legitimate access is needed without the risk caused by world-writable files.",
        "warnings": [
          {
            "text": "This rule can take a long time to perform the check and might consume a considerable\namount of resources depending on the number of files present on the system. It is not a\nproblem in most cases, but especially systems with a large number of files can be affected.\nSee <code>https://access.redhat.com/articles/6999111</code>.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-file_permissions_unauthorized_world_writable:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_unauthorized_world_writable",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\nFILTER_NODEV=$(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,)\nPARTITIONS=$(findmnt -n -l -k -it $FILTER_NODEV | awk '{ print $1 }')\nfor PARTITION in $PARTITIONS; do\n  find \"${PARTITION}\" -xdev -type f -perm -002 -exec chmod o-w {} \\; 2>/dev/null\ndone\n\n# Ensure /tmp is also fixed whem tmpfs is used.\nif grep \"^tmpfs /tmp\" /proc/mounts; then\n  find /tmp -xdev -type f -perm -002 -exec chmod o-w {} \\; 2>/dev/null\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_ungroupowned": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_ungroupowned",
        "title": "Ensure All Files Are Owned by a Group",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83497-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R53"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.12"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06",
              "DSS06.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-002165"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.DS-5",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010790"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230327r627750_rule"
            ]
          }
        ],
        "description": "If any file is not group-owned by a group present in /etc/group, the cause of the lack of\ngroup-ownership must be investigated. Following this, those files should be deleted or\nassigned to an appropriate group.\n\nLocate the mount points related to local devices by the following command:\n<pre>$ findmnt -n -l -k -it $(awk &#x27;/nodev/ { print $2 }&#x27; /proc/filesystems | paste -sd,)</pre>\n\nFor all mount points listed by the previous command, it is necessary to search for files which\ndo not belong to a valid group using the following command:\n<pre>$ sudo find <i>MOUNTPOINT</i> -xdev -nogroup 2&gt;/dev/null</pre>\n       ",
        "rationale": "Unowned files do not directly imply a security problem, but they are generally a sign that\nsomething is amiss. They may be caused by an intruder, by incorrect software installation or\ndraft software removal, or by failure to remove all files belonging to a deleted account, or\nother similar cases. The files should be repaired so they will not cause problems when\naccounts are created in the future, and the cause should be discovered and addressed.",
        "warnings": [
          {
            "text": "This rule only considers local groups as valid groups.\nIf you have your groups defined outside <code>/etc/group</code>, the rule won&#x27;t consider those.",
            "category": "general"
          },
          {
            "text": "This rule can take a long time to perform the check and might consume a considerable\namount of resources depending on the number of files present on the system. It is not a\nproblem in most cases, but especially systems with a large number of files can be affected.\nSee <code>https://access.redhat.com/articles/6999111</code>.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-file_permissions_ungroupowned:def:1",
        "vuln_id": "SV-230327",
        "stig_id": "RHEL-08-010790"
      },
      "xccdf_org.ssgproject.content_rule_no_files_unowned_by_user": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_files_unowned_by_user",
        "title": "Ensure All Files Are Owned by a User",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83499-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R53"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.12"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-002165"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 5.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010780"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230326r627750_rule"
            ]
          }
        ],
        "description": "If any files are not owned by a user, then the cause of their lack of ownership should be\ninvestigated. Following this, the files should be deleted or assigned to an appropriate user.\n\nLocate the mount points related to local devices by the following command:\n<pre>$ findmnt -n -l -k -it $(awk &#x27;/nodev/ { print $2 }&#x27; /proc/filesystems | paste -sd,)</pre>\n\nFor all mount points listed by the previous command, it is necessary to search for files which\ndo not belong to a valid user using the following command:\n<pre>$ sudo find <i>MOUNTPOINT</i> -xdev -nouser 2&gt;/dev/null</pre>\n       ",
        "rationale": "Unowned files do not directly imply a security problem, but they are generally a sign that\nsomething is amiss. They may be caused by an intruder, by incorrect software installation or\ndraft software removal, or by failure to remove all files belonging to a deleted account, or\nother similar cases. The files should be repaired so they will not cause problems when\naccounts are created in the future, and the cause should be discovered and addressed.",
        "warnings": [
          {
            "text": "For this rule to evaluate centralized user accounts, <code>getent</code> must be working properly\nso that running the command <pre>getent passwd</pre> returns a list of all users in your organization.\nIf using the System Security Services Daemon (SSSD), <pre>enumerate = true</pre> must be configured\nin your organization&#x27;s domain to return a complete list of users",
            "category": "functionality"
          },
          {
            "text": "This rule can take a long time to perform the check and might consume a considerable\namount of resources depending on the number of files present on the system. It is not a\nproblem in most cases, but especially systems with a large number of files can be affected.\nSee <code>https://access.redhat.com/articles/6999111</code>.",
            "category": "general"
          }
        ],
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-no_files_unowned_by_user:def:1",
        "vuln_id": "SV-230326",
        "stig_id": "RHEL-08-010780"
      },
      "xccdf_org.ssgproject.content_rule_file_etc_security_opasswd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_etc_security_opasswd",
        "title": "Verify Permissions and Ownership of Old Passwords File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86140-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000200"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000077-GPOS-00045"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/security/opasswd</code>, run the command: <pre>$ sudo chown root /etc/security/opasswd </pre>\nTo properly set the group owner of <code>/etc/security/opasswd</code>, run the command: <pre>$ sudo chgrp root /etc/security/opasswd</pre>\nTo properly set the permissions of <code>/etc/security/opasswd</code>, run the command: <pre>$ sudo chmod 0600 /etc/security/opasswd</pre>\n        ",
        "rationale": "The <code>/etc/security/opasswd</code> file stores old passwords to prevent\npassword reuse. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_etc_security_opasswd:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_group",
        "title": "Verify Group Who Owns Backup group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83475-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/group-</code>, run the command: <pre>$ sudo chgrp root /etc/group-</pre>\n        ",
        "rationale": "The <code>/etc/group-</code> file is a backup file of <code>/etc/group</code>, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_backup_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_backup_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group-\n  stat:\n    path: /etc/group-\n  register: file_exists\n  tags:\n  - CCE-83475-4\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/group-\n  file:\n    path: /etc/group-\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83475-4\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_backup_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/group-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_gshadow",
        "title": "Verify Group Who Owns Backup gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83535-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/gshadow-</code>, run the command: <pre>$ sudo chgrp root /etc/gshadow-</pre>\n        ",
        "rationale": "The <code>/etc/gshadow-</code> file is a backup of <code>/etc/gshadow</code>, and as such,\nit contains group password hashes. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_backup_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow-\n  stat:\n    path: /etc/gshadow-\n  register: file_exists\n  tags:\n  - CCE-83535-5\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - configure_strategy\n  - file_groupowner_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/gshadow-\n  file:\n    path: /etc/gshadow-\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83535-5\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - configure_strategy\n  - file_groupowner_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/gshadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_passwd",
        "title": "Verify Group Who Owns Backup passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83324-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/passwd-</code>, run the command: <pre>$ sudo chgrp root /etc/passwd-</pre>\n        ",
        "rationale": "The <code>/etc/passwd-</code> file is a backup file of <code>/etc/passwd</code>, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_backup_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd-\n  stat:\n    path: /etc/passwd-\n  register: file_exists\n  tags:\n  - CCE-83324-4\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/passwd-\n  file:\n    path: /etc/passwd-\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83324-4\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/passwd-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_shadow",
        "title": "Verify User Who Owns Backup shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83415-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/shadow-</code>, run the command: <pre>$ sudo chgrp root /etc/shadow-</pre>\n        ",
        "rationale": "The <code>/etc/shadow-</code> file is a backup file of <code>/etc/shadow</code>, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_backup_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow-\n  stat:\n    path: /etc/shadow-\n  register: file_exists\n  tags:\n  - CCE-83415-0\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/shadow-\n  file:\n    path: /etc/shadow-\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83415-0\n  - PCI-DSS-Req-8.7\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/shadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_group",
        "title": "Verify Group Who Owns group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80796-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/group</code>, run the command: <pre>$ sudo chgrp root /etc/group</pre>\n        ",
        "rationale": "The <code>/etc/group</code> file contains information regarding groups that are configured\non the system. Protection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group\n  stat:\n    path: /etc/group\n  register: file_exists\n  tags:\n  - CCE-80796-6\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/group\n  file:\n    path: /etc/group\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80796-6\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/group\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow",
        "title": "Verify Group Who Owns gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80797-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/gshadow</code>, run the command: <pre>$ sudo chgrp root /etc/gshadow</pre>\n        ",
        "rationale": "The <code>/etc/gshadow</code> file contains group password hashes. Protection of this file\nis critical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow\n  stat:\n    path: /etc/gshadow\n  register: file_exists\n  tags:\n  - CCE-80797-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_groupowner_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/gshadow\n  file:\n    path: /etc/gshadow\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80797-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_groupowner_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/gshadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd",
        "title": "Verify Group Who Owns passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80798-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/passwd</code>, run the command: <pre>$ sudo chgrp root /etc/passwd</pre>\n        ",
        "rationale": "The <code>/etc/passwd</code> file contains information about the users that are configured on\nthe system. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd\n  stat:\n    path: /etc/passwd\n  register: file_exists\n  tags:\n  - CCE-80798-2\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/passwd\n  file:\n    path: /etc/passwd\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80798-2\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shadow",
        "title": "Verify Group Who Owns shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80799-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the group owner of <code>/etc/shadow</code>, run the command: <pre>$ sudo chgrp root /etc/shadow</pre>\n        ",
        "rationale": "The <code>/etc/shadow</code> file stores password hashes. Protection of this file is\ncritical for system security.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow\n  stat:\n    path: /etc/shadow\n  register: file_exists\n  tags:\n  - CCE-80799-0\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/shadow\n  file:\n    path: /etc/shadow\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80799-0\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/shadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shells": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_etc_shells",
        "title": "Verify Group Who Owns /etc/shells File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87030-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.10"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "MP-2"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/shells</code>, run the command:\n<pre>$ sudo chgrp root /etc/shells</pre>\n        ",
        "rationale": "The <code>/etc/shells</code> file contains the list of full pathnames to shells on the system.\nSince this file is used by many system programs this file should be protected.",
        "oval_definition_id": "oval:ssg-file_groupowner_etc_shells:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_etc_shells",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shells\n  stat:\n    path: /etc/shells\n  register: file_exists\n  tags:\n  - CCE-87030-3\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_groupowner_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/shells\n  file:\n    path: /etc/shells\n    group: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-87030-3\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_groupowner_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_etc_shells",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chgrp -L 0 /etc/shells\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_group",
        "title": "Verify User Who Owns Backup group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83473-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/group-</code>, run the command: <pre>$ sudo chown root /etc/group- </pre>\n        ",
        "rationale": "The <code>/etc/group-</code> file is a backup file of <code>/etc/group</code>, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_owner_backup_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_backup_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group-\n  stat:\n    path: /etc/group-\n  register: file_exists\n  tags:\n  - CCE-83473-9\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/group-\n  file:\n    path: /etc/group-\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83473-9\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_backup_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/group-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_gshadow",
        "title": "Verify User Who Owns Backup gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83533-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/gshadow-</code>, run the command: <pre>$ sudo chown root /etc/gshadow- </pre>\n        ",
        "rationale": "The <code>/etc/gshadow-</code> file is a backup of <code>/etc/gshadow</code>, and as such,\nit contains group password hashes. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_owner_backup_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow-\n  stat:\n    path: /etc/gshadow-\n  register: file_exists\n  tags:\n  - CCE-83533-0\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - configure_strategy\n  - file_owner_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/gshadow-\n  file:\n    path: /etc/gshadow-\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83533-0\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7\n  - configure_strategy\n  - file_owner_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/gshadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_passwd",
        "title": "Verify User Who Owns Backup passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83326-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/passwd-</code>, run the command: <pre>$ sudo chown root /etc/passwd- </pre>\n        ",
        "rationale": "The <code>/etc/passwd-</code> file is a backup file of <code>/etc/passwd</code>, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_owner_backup_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd-\n  stat:\n    path: /etc/passwd-\n  register: file_exists\n  tags:\n  - CCE-83326-9\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/passwd-\n  file:\n    path: /etc/passwd-\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83326-9\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/passwd-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_backup_etc_shadow",
        "title": "Verify Group Who Owns Backup shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83413-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/shadow-</code>, run the command: <pre>$ sudo chown root /etc/shadow- </pre>\n        ",
        "rationale": "The <code>/etc/shadow-</code> file is a backup file of <code>/etc/shadow</code>, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_owner_backup_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow-\n  stat:\n    path: /etc/shadow-\n  register: file_exists\n  tags:\n  - CCE-83413-5\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/shadow-\n  file:\n    path: /etc/shadow-\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83413-5\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/shadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_group",
        "title": "Verify User Who Owns group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80801-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/group</code>, run the command: <pre>$ sudo chown root /etc/group </pre>\n        ",
        "rationale": "The <code>/etc/group</code> file contains information regarding groups that are configured\non the system. Protection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_owner_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group\n  stat:\n    path: /etc/group\n  register: file_exists\n  tags:\n  - CCE-80801-4\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/group\n  file:\n    path: /etc/group\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80801-4\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/group\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow",
        "title": "Verify User Who Owns gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80802-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/gshadow</code>, run the command: <pre>$ sudo chown root /etc/gshadow </pre>\n        ",
        "rationale": "The <code>/etc/gshadow</code> file contains group password hashes. Protection of this file\nis critical for system security.",
        "oval_definition_id": "oval:ssg-file_owner_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow\n  stat:\n    path: /etc/gshadow\n  register: file_exists\n  tags:\n  - CCE-80802-2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_owner_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/gshadow\n  file:\n    path: /etc/gshadow\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80802-2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_owner_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/gshadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_passwd",
        "title": "Verify User Who Owns passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80803-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/passwd</code>, run the command: <pre>$ sudo chown root /etc/passwd </pre>\n        ",
        "rationale": "The <code>/etc/passwd</code> file contains information about the users that are configured on\nthe system. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_owner_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd\n  stat:\n    path: /etc/passwd\n  register: file_exists\n  tags:\n  - CCE-80803-0\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/passwd\n  file:\n    path: /etc/passwd\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80803-0\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_shadow",
        "title": "Verify User Who Owns shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80804-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": " To properly set the owner of <code>/etc/shadow</code>, run the command: <pre>$ sudo chown root /etc/shadow </pre>\n        ",
        "rationale": "The <code>/etc/shadow</code> file contains the list of local\nsystem accounts and stores password hashes. Protection of this file is\ncritical for system security. Failure to give ownership of this file\nto root provides the designated owner with access to sensitive information\nwhich could weaken the system security posture.",
        "oval_definition_id": "oval:ssg-file_owner_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow\n  stat:\n    path: /etc/shadow\n  register: file_exists\n  tags:\n  - CCE-80804-8\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/shadow\n  file:\n    path: /etc/shadow\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80804-8\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/shadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_etc_shells": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_etc_shells",
        "title": "Verify Who Owns /etc/shells File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87055-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.10"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "MP-2"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/shells</code>, run the command:\n<pre>$ sudo chown root /etc/shells </pre>\n        ",
        "rationale": "The <code>/etc/shells</code> file contains the list of full pathnames to shells on the system.\nSince this file is used by many system programs this file should be protected.",
        "oval_definition_id": "oval:ssg-file_owner_etc_shells:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_etc_shells",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shells\n  stat:\n    path: /etc/shells\n  register: file_exists\n  tags:\n  - CCE-87055-0\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_owner_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/shells\n  file:\n    path: /etc/shells\n    owner: '0'\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-87055-0\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_owner_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_etc_shells",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "chown -L 0 /etc/shells\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_group",
        "title": "Verify Permissions on Backup group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83483-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/group-</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/group-</pre>\n        ",
        "rationale": "The <code>/etc/group-</code> file is a backup file of <code>/etc/group</code>, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_backup_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_backup_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group-\n  stat:\n    path: /etc/group-\n  register: file_exists\n  tags:\n  - CCE-83483-8\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/group-\n  file:\n    path: /etc/group-\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83483-8\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_backup_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/group-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_gshadow",
        "title": "Verify Permissions on Backup gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83573-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/gshadow-</code>, run the command:\n<pre>$ sudo chmod 0000 /etc/gshadow-</pre>\n        ",
        "rationale": "The <code>/etc/gshadow-</code> file is a backup of <code>/etc/gshadow</code>, and as such,\nit contains group password hashes. Protection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_backup_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow-\n  stat:\n    path: /etc/gshadow-\n  register: file_exists\n  tags:\n  - CCE-83573-6\n  - NIST-800-53-AC-6 (1)\n  - configure_strategy\n  - file_permissions_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xwrs,g-xwrs,o-xwrt on /etc/gshadow-\n  file:\n    path: /etc/gshadow-\n    mode: u-xwrs,g-xwrs,o-xwrt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83573-6\n  - NIST-800-53-AC-6 (1)\n  - configure_strategy\n  - file_permissions_backup_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_backup_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xwrs,g-xwrs,o-xwrt /etc/gshadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_passwd",
        "title": "Verify Permissions on Backup passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83332-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/passwd-</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/passwd-</pre>\n        ",
        "rationale": "The <code>/etc/passwd-</code> file is a backup file of <code>/etc/passwd</code>, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_backup_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd-\n  stat:\n    path: /etc/passwd-\n  register: file_exists\n  tags:\n  - CCE-83332-7\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/passwd-\n  file:\n    path: /etc/passwd-\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83332-7\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_backup_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/passwd-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_shadow",
        "title": "Verify Permissions on Backup shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83417-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6 (1)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/shadow-</code>, run the command:\n<pre>$ sudo chmod 0000 /etc/shadow-</pre>\n        ",
        "rationale": "The <code>/etc/shadow-</code> file is a backup file of <code>/etc/shadow</code>, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_backup_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow-\n  stat:\n    path: /etc/shadow-\n  register: file_exists\n  tags:\n  - CCE-83417-6\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xwrs,g-xwrs,o-xwrt on /etc/shadow-\n  file:\n    path: /etc/shadow-\n    mode: u-xwrs,g-xwrs,o-xwrt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-83417-6\n  - NIST-800-53-AC-6 (1)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_backup_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_backup_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xwrs,g-xwrs,o-xwrt /etc/shadow-\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_group": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_group",
        "title": "Verify Permissions on group File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80810-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/group</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/group</pre>\n        ",
        "rationale": "The <code>/etc/group</code> file contains information regarding groups that are configured\non the system. Protection of this file is important for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_group:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_group",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/group\n  stat:\n    path: /etc/group\n  register: file_exists\n  tags:\n  - CCE-80810-5\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/group\n  file:\n    path: /etc/group\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80810-5\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_group\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_group",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/group\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow",
        "title": "Verify Permissions on gshadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80811-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/gshadow</code>, run the command:\n<pre>$ sudo chmod 0000 /etc/gshadow</pre>\n        ",
        "rationale": "The <code>/etc/gshadow</code> file contains group password hashes. Protection of this file\nis critical for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_gshadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_gshadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/gshadow\n  stat:\n    path: /etc/gshadow\n  register: file_exists\n  tags:\n  - CCE-80811-3\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xwrs,g-xwrs,o-xwrt on /etc/gshadow\n  file:\n    path: /etc/gshadow\n    mode: u-xwrs,g-xwrs,o-xwrt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80811-3\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_permissions_etc_gshadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_gshadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xwrs,g-xwrs,o-xwrt /etc/gshadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd",
        "title": "Verify Permissions on passwd File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80812-1"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/passwd</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/passwd</pre>\n        ",
        "rationale": "If the <code>/etc/passwd</code> file is writable by a group-owner or the\nworld the risk of its compromise is increased. The file contains the list of\naccounts on the system and associated information, and protection of this file\nis critical for system security.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_passwd:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_passwd",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/passwd\n  stat:\n    path: /etc/passwd\n  register: file_exists\n  tags:\n  - CCE-80812-1\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/passwd\n  file:\n    path: /etc/passwd\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80812-1\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_passwd\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_passwd",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/passwd\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow",
        "title": "Verify Permissions on shadow File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80813-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.2.2"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002223"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.7.c"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/shadow</code>, run the command:\n<pre>$ sudo chmod 0000 /etc/shadow</pre>\n        ",
        "rationale": "The <code>/etc/shadow</code> file contains the list of local\nsystem accounts and stores password hashes. Protection of this file is\ncritical for system security. Failure to give ownership of this file\nto root provides the designated owner with access to sensitive information\nwhich could weaken the system security posture.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_shadow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_shadow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shadow\n  stat:\n    path: /etc/shadow\n  register: file_exists\n  tags:\n  - CCE-80813-9\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xwrs,g-xwrs,o-xwrt on /etc/shadow\n  file:\n    path: /etc/shadow\n    mode: u-xwrs,g-xwrs,o-xwrt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-80813-9\n  - CJIS-5.5.2.2\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-8.7.c\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_etc_shadow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_shadow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xwrs,g-xwrs,o-xwrt /etc/shadow\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_etc_shells": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_etc_shells",
        "title": "Verify Permissions on /etc/shells File",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86634-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.1.10"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "MP-2"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/shells</code>, run the command:\n<pre>$ sudo chmod 0644 /etc/shells</pre>\n        ",
        "rationale": "The <code>/etc/shells</code> file contains the list of full pathnames to shells on the system.\nSince this file is used by many system programs this file should be protected.",
        "oval_definition_id": "oval:ssg-file_permissions_etc_shells:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_etc_shells",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/shells\n  stat:\n    path: /etc/shells\n  register: file_exists\n  tags:\n  - CCE-86634-3\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_permissions_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xws,o-xwt on /etc/shells\n  file:\n    path: /etc/shells\n    mode: u-xs,g-xws,o-xwt\n  when: file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86634-3\n  - NIST-800-53-AC-3\n  - NIST-800-53-MP-2\n  - configure_strategy\n  - file_permissions_etc_shells\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_etc_shells",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "\n\n\n\n\nchmod u-xs,g-xws,o-xwt /etc/shells\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_autofs_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_autofs_disabled",
        "title": "Disable the Automounter",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80873-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "15",
              "16",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "DSS01.04",
              "DSS05.03",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000778",
              "CCI-001958"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(3)(i)",
              "164.308(a)(3)(ii)(A)",
              "164.310(d)(1)",
              "164.310(d)(2)",
              "164.312(a)(1)",
              "164.312(a)(2)(iv)",
              "164.312(b)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.13.1.1",
              "A.13.2.1",
              "A.18.1.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.7.1.1",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-3",
              "PR.AC-6",
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000114-GPOS-00059",
              "SRG-OS-000378-GPOS-00163",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040070"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230502r627750_rule"
            ]
          }
        ],
        "description": "The <code>autofs</code> daemon mounts and unmounts filesystems, such as user\nhome directories shared via NFS, on demand. In addition, autofs can be used to handle\nremovable media, and the default configuration provides the cdrom device as <code>/misc/cd</code>.\nHowever, this method of providing access to removable media is not common, so autofs\ncan almost always be disabled if NFS is not in use. Even if NFS is required, it may be\npossible to configure filesystem mounts statically by editing <code>/etc/fstab</code>\nrather than relying on the automounter.\n<br>\n        <br>\n\nThe <code>autofs</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now autofs.service</pre>\n       ",
        "rationale": "Disabling the automounter permits the administrator to\nstatically control filesystem mounting through <code>/etc/fstab</code>.\n<br>\n        <br>\nAdditionally, automatically mounting filesystems permits easy introduction of\nunknown devices, thereby facilitating malicious activity.",
        "platforms": [
          "#machine_and_package_autofs"
        ],
        "oval_definition_id": "oval:ssg-service_autofs_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_autofs_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80873-3\n  - DISA-STIG-RHEL-08-040070\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_autofs_disabled\n\n- name: Disable the Automounter - Collect systemd Services Present in the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"autofs\" in ansible_facts.packages )\n  tags:\n  - CCE-80873-3\n  - DISA-STIG-RHEL-08-040070\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_autofs_disabled\n\n- name: Disable the Automounter - Ensure autofs.service is Masked\n  ansible.builtin.systemd:\n    name: autofs.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"autofs\" in ansible_facts.packages )\n  - service_exists.stdout_lines is search(\"autofs.service\", multiline=True)\n  tags:\n  - CCE-80873-3\n  - DISA-STIG-RHEL-08-040070\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_autofs_disabled\n\n- name: Unit Socket Exists - autofs.socket\n  ansible.builtin.command: systemctl -q list-unit-files autofs.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"autofs\" in ansible_facts.packages )\n  tags:\n  - CCE-80873-3\n  - DISA-STIG-RHEL-08-040070\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_autofs_disabled\n\n- name: Disable the Automounter - Disable Socket autofs\n  ansible.builtin.systemd:\n    name: autofs.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"autofs\" in ansible_facts.packages )\n  - socket_file_exists.stdout_lines is search(\"autofs.socket\", multiline=True)\n  tags:\n  - CCE-80873-3\n  - DISA-STIG-RHEL-08-040070\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_autofs_disabled\n"
          },
          {
            "remediation_id": "service_autofs_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: autofs.service\n        enabled: false\n        mask: true\n      - name: autofs.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_autofs_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_autofs\n\nclass disable_autofs {\n  service {'autofs':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_autofs_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"autofs\"]\n"
          },
          {
            "remediation_id": "service_autofs_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && rpm --quiet -q autofs ); then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'autofs.service'\n\"$SYSTEMCTL_EXEC\" disable 'autofs.service'\n\"$SYSTEMCTL_EXEC\" mask 'autofs.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files autofs.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'autofs.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'autofs.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'autofs.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230502",
        "stig_id": "RHEL-08-040070"
      },
      "xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled",
        "title": "Disable Mounting of cramfs",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-81031-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.4.6"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000381"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000095-GPOS-00049"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040025"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230498r942930_rule"
            ]
          }
        ],
        "description": "\nTo configure the system to prevent the <code>cramfs</code>\nkernel module from being loaded, add the following line to the file <code>/etc/modprobe.d/cramfs.conf</code>:\n<pre>install cramfs /bin/false</pre>\n\nTo configure the system to prevent the <code>cramfs</code> from being used,\nadd the following line to file <code>/etc/modprobe.d/cramfs.conf</code>:\n<pre>blacklist cramfs</pre>\n\nThis effectively prevents usage of this uncommon filesystem.\n\nThe <code>cramfs</code> filesystem type is a compressed read-only\nLinux filesystem embedded in small footprint systems. A\n<code>cramfs</code> image can be used without having to first\ndecompress the image.",
        "rationale": "Removing support for unneeded filesystem types reduces the local attack surface\nof the server.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-kernel_module_cramfs_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "kernel_module_cramfs_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: Ensure kernel module 'cramfs' is disabled\n  lineinfile:\n    create: true\n    dest: /etc/modprobe.d/cramfs.conf\n    regexp: install\\s+cramfs\n    line: install cramfs /bin/false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81031-7\n  - DISA-STIG-RHEL-08-040025\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - kernel_module_cramfs_disabled\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - reboot_required\n\n- name: Ensure kernel module 'cramfs' is blacklisted\n  lineinfile:\n    create: true\n    dest: /etc/modprobe.d/cramfs.conf\n    regexp: ^blacklist cramfs$\n    line: blacklist cramfs\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81031-7\n  - DISA-STIG-RHEL-08-040025\n  - NIST-800-171-3.4.6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - kernel_module_cramfs_disabled\n  - low_complexity\n  - low_severity\n  - medium_disruption\n  - reboot_required\n"
          },
          {
            "remediation_id": "kernel_module_cramfs_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,install%20cramfs%20/bin/false%0Ablacklist%20cramfs%0A\n        mode: 0644\n        path: /etc/modprobe.d/cramfs.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "kernel_module_cramfs_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif LC_ALL=C grep -q -m 1 \"^install cramfs\" /etc/modprobe.d/cramfs.conf ; then\n\t\n\tsed -i 's#^install cramfs.*#install cramfs /bin/false#g' /etc/modprobe.d/cramfs.conf\nelse\n\techo -e \"\\n# Disable per security requirements\" >> /etc/modprobe.d/cramfs.conf\n\techo \"install cramfs /bin/false\" >> /etc/modprobe.d/cramfs.conf\nfi\n\nif ! LC_ALL=C grep -q -m 1 \"^blacklist cramfs$\" /etc/modprobe.d/cramfs.conf ; then\n\techo \"blacklist cramfs\" >> /etc/modprobe.d/cramfs.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230498",
        "stig_id": "RHEL-08-040025"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev",
        "title": "Add nodev Option to /dev/shm",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80837-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040120"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230508r854049_rule"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent creation of device\nfiles in <code>/dev/shm</code>. Legitimate character and block devices should\nnot exist within temporary directories like <code>/dev/shm</code>.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/dev/shm</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-mount_option_dev_shm_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_dev_shm_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /dev/shm: Check information associated to mountpoint'\n  command: findmnt  '/dev/shm'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80837-8\n  - DISA-STIG-RHEL-08-040120\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /dev/shm: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-80837-8\n  - DISA-STIG-RHEL-08-040120\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /dev/shm: If /dev/shm not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /dev/shm\n    - tmpfs\n    - tmpfs\n    - defaults\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - (\"\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-80837-8\n  - DISA-STIG-RHEL-08-040120\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /dev/shm: Make sure nodev option is part of the to /dev/shm\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-80837-8\n  - DISA-STIG-RHEL-08-040120\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /dev/shm: Ensure /dev/shm is mounted with nodev option'\n  mount:\n    path: /dev/shm\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"\" |\n    length == 0)\n  tags:\n  - CCE-80837-8\n  - DISA-STIG-RHEL-08-040120\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_dev_shm_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfunction perform_remediation {\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /dev/shm)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"tmpfs\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \"tmpfs /dev/shm tmpfs defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/dev/shm\"; then\n        if mountpoint -q \"/dev/shm\"; then\n            mount -o remount --target \"/dev/shm\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230508",
        "stig_id": "RHEL-08-040120"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec",
        "title": "Add noexec Option to /dev/shm",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80838-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.2.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040122"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230510r854051_rule"
            ]
          }
        ],
        "description": "The <code>noexec</code> mount option can be used to prevent binaries\nfrom being executed out of <code>/dev/shm</code>.\nIt can be dangerous to allow the execution of binaries\nfrom world-writable temporary storage directories such as <code>/dev/shm</code>.\nAdd the <code>noexec</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/dev/shm</code>.",
        "rationale": "Allowing users to execute binaries from world-writable directories\nsuch as <code>/dev/shm</code> can expose the system to potential compromise.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-mount_option_dev_shm_noexec:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_dev_shm_noexec",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add noexec Option to /dev/shm: Check information associated to mountpoint'\n  command: findmnt  '/dev/shm'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80838-6\n  - DISA-STIG-RHEL-08-040122\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /dev/shm: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-80838-6\n  - DISA-STIG-RHEL-08-040122\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /dev/shm: If /dev/shm not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /dev/shm\n    - tmpfs\n    - tmpfs\n    - defaults\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - (\"\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-80838-6\n  - DISA-STIG-RHEL-08-040122\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /dev/shm: Make sure noexec option is part of the to\n    /dev/shm options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',noexec''\n      }) }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined and \"noexec\" not in mount_info.options\n  tags:\n  - CCE-80838-6\n  - DISA-STIG-RHEL-08-040122\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /dev/shm: Ensure /dev/shm is mounted with noexec option'\n  mount:\n    path: /dev/shm\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"\" |\n    length == 0)\n  tags:\n  - CCE-80838-6\n  - DISA-STIG-RHEL-08-040122\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_noexec\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_dev_shm_noexec",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfunction perform_remediation {\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /dev/shm)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|noexec)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"tmpfs\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \"tmpfs /dev/shm tmpfs defaults,${previous_mount_opts}noexec 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"noexec\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,noexec|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/dev/shm\"; then\n        if mountpoint -q \"/dev/shm\"; then\n            mount -o remount --target \"/dev/shm\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230510",
        "stig_id": "RHEL-08-040122"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid",
        "title": "Add nosuid Option to /dev/shm",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80839-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040121"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230509r854050_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent execution\nof setuid programs in <code>/dev/shm</code>.  The SUID and SGID permissions should not\nbe required in these world-writable directories.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/dev/shm</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-mount_option_dev_shm_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_dev_shm_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /dev/shm: Check information associated to mountpoint'\n  command: findmnt  '/dev/shm'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80839-4\n  - DISA-STIG-RHEL-08-040121\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /dev/shm: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-80839-4\n  - DISA-STIG-RHEL-08-040121\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /dev/shm: If /dev/shm not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /dev/shm\n    - tmpfs\n    - tmpfs\n    - defaults\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - (\"\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-80839-4\n  - DISA-STIG-RHEL-08-040121\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /dev/shm: Make sure nosuid option is part of the to\n    /dev/shm options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-80839-4\n  - DISA-STIG-RHEL-08-040121\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /dev/shm: Ensure /dev/shm is mounted with nosuid option'\n  mount:\n    path: /dev/shm\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"\" |\n    length == 0)\n  tags:\n  - CCE-80839-4\n  - DISA-STIG-RHEL-08-040121\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_dev_shm_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_dev_shm_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfunction perform_remediation {\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /dev/shm)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"tmpfs\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \"tmpfs /dev/shm tmpfs defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/dev/shm\"; then\n        if mountpoint -q \"/dev/shm\"; then\n            mount -o remount --target \"/dev/shm\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230509",
        "stig_id": "RHEL-08-040121"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_home_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_home_nodev",
        "title": "Add nodev Option to /home",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-81048-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.3.2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/home</code>.\nLegitimate character and block devices should exist only in\nthe <code>/dev</code> directory on the root partition or within chroot\njails built for system services.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/home</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_home"
        ],
        "oval_definition_id": "oval:ssg-mount_option_home_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_home_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /home: Check information associated to mountpoint'\n  command: findmnt --fstab '/home'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-81048-1\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - mount_option_home_nodev\n  - no_reboot_needed\n  - unknown_severity\n\n- name: 'Add nodev Option to /home: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-81048-1\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - mount_option_home_nodev\n  - no_reboot_needed\n  - unknown_severity\n\n- name: 'Add nodev Option to /home: If /home not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /home\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-81048-1\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - mount_option_home_nodev\n  - no_reboot_needed\n  - unknown_severity\n\n- name: 'Add nodev Option to /home: Make sure nodev option is part of the to /home\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-81048-1\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - mount_option_home_nodev\n  - no_reboot_needed\n  - unknown_severity\n\n- name: 'Add nodev Option to /home: Ensure /home is mounted with nodev option'\n  mount:\n    path: /home\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-81048-1\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - mount_option_home_nodev\n  - no_reboot_needed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "mount_option_home_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/home\" > /dev/null || findmnt --fstab \"/home\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /home has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/home\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/home' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /home in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /home)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /home  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/home\"; then\n        if mountpoint -q \"/home\"; then\n            mount -o remount --target \"/home\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_mount_option_home_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_home_nosuid",
        "title": "Add nosuid Option to /home",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81050-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.3.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010570"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230299r627750_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/home</code>. The SUID and SGID permissions\nshould not be required in these user data directories.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/home</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from user home directory partitions.",
        "platforms": [
          "#machine_and_mount_home"
        ],
        "oval_definition_id": "oval:ssg-mount_option_home_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_home_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /home: Check information associated to mountpoint'\n  command: findmnt --fstab '/home'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-81050-7\n  - DISA-STIG-RHEL-08-010570\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_home_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /home: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-81050-7\n  - DISA-STIG-RHEL-08-010570\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_home_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /home: If /home not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /home\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-81050-7\n  - DISA-STIG-RHEL-08-010570\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_home_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /home: Make sure nosuid option is part of the to /home\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-81050-7\n  - DISA-STIG-RHEL-08-010570\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_home_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /home: Ensure /home is mounted with nosuid option'\n  mount:\n    path: /home\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/home\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-81050-7\n  - DISA-STIG-RHEL-08-010570\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_home_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_home_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/home\" > /dev/null || findmnt --fstab \"/home\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /home has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/home\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/home' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /home in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /home)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /home  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/home\"; then\n        if mountpoint -q \"/home\"; then\n            mount -o remount --target \"/home\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230299",
        "stig_id": "RHEL-08-010570"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev",
        "title": "Add nodev Option to /tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82623-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040123"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230511r854052_rule"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/tmp</code>. Legitimate character and block devices\nshould not exist within temporary directories like <code>/tmp</code>.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/tmp</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_tmp_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_tmp_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-82623-0\n  - DISA-STIG-RHEL-08-040123\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82623-0\n  - DISA-STIG-RHEL-08-040123\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /tmp: If /tmp not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82623-0\n  - DISA-STIG-RHEL-08-040123\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /tmp: Make sure nodev option is part of the to /tmp options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-82623-0\n  - DISA-STIG-RHEL-08-040123\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /tmp: Ensure /tmp is mounted with nodev option'\n  mount:\n    path: /tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82623-0\n  - DISA-STIG-RHEL-08-040123\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_tmp_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/tmp\" > /dev/null || findmnt --fstab \"/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /tmp  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/tmp\"; then\n        if mountpoint -q \"/tmp\"; then\n            mount -o remount --target \"/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230511",
        "stig_id": "RHEL-08-040123"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec",
        "title": "Add noexec Option to /tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82139-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040125"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230513r854054_rule"
            ]
          }
        ],
        "description": "The <code>noexec</code> mount option can be used to prevent binaries\nfrom being executed out of <code>/tmp</code>.\nAdd the <code>noexec</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/tmp</code>.",
        "rationale": "Allowing users to execute binaries from world-writable directories\nsuch as <code>/tmp</code> should never be necessary in normal operation and\ncan expose the system to potential compromise.",
        "platforms": [
          "#machine_and_mount_tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_tmp_noexec:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_tmp_noexec",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add noexec Option to /tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-82139-7\n  - DISA-STIG-RHEL-08-040125\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82139-7\n  - DISA-STIG-RHEL-08-040125\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /tmp: If /tmp not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82139-7\n  - DISA-STIG-RHEL-08-040125\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /tmp: Make sure noexec option is part of the to /tmp\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',noexec''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"noexec\" not in mount_info.options\n  tags:\n  - CCE-82139-7\n  - DISA-STIG-RHEL-08-040125\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /tmp: Ensure /tmp is mounted with noexec option'\n  mount:\n    path: /tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82139-7\n  - DISA-STIG-RHEL-08-040125\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_noexec\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_tmp_noexec",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/tmp\" > /dev/null || findmnt --fstab \"/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|noexec)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /tmp  defaults,${previous_mount_opts}noexec 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"noexec\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,noexec|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/tmp\"; then\n        if mountpoint -q \"/tmp\"; then\n            mount -o remount --target \"/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230513",
        "stig_id": "RHEL-08-040125"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid",
        "title": "Add nosuid Option to /tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82140-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "13",
              "14",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS05.06",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.9",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.8.2.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.8.3.1",
              "A.8.3.3",
              "A.9.1.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040124"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230512r854053_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/tmp</code>. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/tmp</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions.",
        "platforms": [
          "#machine_and_mount_tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_tmp_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_tmp_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-82140-5\n  - DISA-STIG-RHEL-08-040124\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82140-5\n  - DISA-STIG-RHEL-08-040124\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /tmp: If /tmp not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82140-5\n  - DISA-STIG-RHEL-08-040124\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /tmp: Make sure nosuid option is part of the to /tmp\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-82140-5\n  - DISA-STIG-RHEL-08-040124\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /tmp: Ensure /tmp is mounted with nosuid option'\n  mount:\n    path: /tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82140-5\n  - DISA-STIG-RHEL-08-040124\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_tmp_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_tmp_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/tmp\" > /dev/null || findmnt --fstab \"/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /tmp  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/tmp\"; then\n        if mountpoint -q \"/tmp\"; then\n            mount -o remount --target \"/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230512",
        "stig_id": "RHEL-08-040124"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nodev",
        "title": "Add nodev Option to /var/log/audit",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82080-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.7.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040129"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230517r854058_rule"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/var/log/audit</code>.\nLegitimate character and block devices should exist only in\nthe <code>/dev</code> directory on the root partition or within chroot\njails built for system services.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log/audit</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_var-log-audit"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_audit_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_audit_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /var/log/audit: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log/audit'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") |\n    list )\n  tags:\n  - CCE-82080-3\n  - DISA-STIG-RHEL-08-040129\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log/audit: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82080-3\n  - DISA-STIG-RHEL-08-040129\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log/audit: If /var/log/audit not mounted, craft\n    mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log/audit\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82080-3\n  - DISA-STIG-RHEL-08-040129\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log/audit: Make sure nodev option is part of the\n    to /var/log/audit options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-82080-3\n  - DISA-STIG-RHEL-08-040129\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log/audit: Ensure /var/log/audit is mounted with\n    nodev option'\n  mount:\n    path: /var/log/audit\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82080-3\n  - DISA-STIG-RHEL-08-040129\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_audit_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log/audit\" > /dev/null || findmnt --fstab \"/var/log/audit\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log/audit has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log/audit\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log/audit' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log/audit in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log/audit)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log/audit  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log/audit\"; then\n        if mountpoint -q \"/var/log/audit\"; then\n            mount -o remount --target \"/var/log/audit\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230517",
        "stig_id": "RHEL-08-040129"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_noexec": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_noexec",
        "title": "Add noexec Option to /var/log/audit",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82975-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.7.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040131"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230519r854060_rule"
            ]
          }
        ],
        "description": "The <code>noexec</code> mount option can be used to prevent binaries\nfrom being executed out of <code>/var/log/audit</code>.\nAdd the <code>noexec</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log/audit</code>.",
        "rationale": "Allowing users to execute binaries from directories containing audit log files\nsuch as <code>/var/log/audit</code> should never be necessary in normal operation and\ncan expose the system to potential compromise.",
        "platforms": [
          "#machine_and_mount_var-log-audit"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_audit_noexec:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_audit_noexec",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add noexec Option to /var/log/audit: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log/audit'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") |\n    list )\n  tags:\n  - CCE-82975-4\n  - DISA-STIG-RHEL-08-040131\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log/audit: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82975-4\n  - DISA-STIG-RHEL-08-040131\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log/audit: If /var/log/audit not mounted, craft\n    mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log/audit\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82975-4\n  - DISA-STIG-RHEL-08-040131\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log/audit: Make sure noexec option is part of the\n    to /var/log/audit options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',noexec''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"noexec\" not in mount_info.options\n  tags:\n  - CCE-82975-4\n  - DISA-STIG-RHEL-08-040131\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log/audit: Ensure /var/log/audit is mounted with\n    noexec option'\n  mount:\n    path: /var/log/audit\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82975-4\n  - DISA-STIG-RHEL-08-040131\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_noexec\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_audit_noexec",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log/audit\" > /dev/null || findmnt --fstab \"/var/log/audit\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log/audit has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log/audit\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log/audit' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log/audit in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log/audit)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|noexec)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log/audit  defaults,${previous_mount_opts}noexec 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"noexec\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,noexec|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log/audit\"; then\n        if mountpoint -q \"/var/log/audit\"; then\n            mount -o remount --target \"/var/log/audit\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230519",
        "stig_id": "RHEL-08-040131"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nosuid",
        "title": "Add nosuid Option to /var/log/audit",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82921-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.7.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040130"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230518r854059_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/var/log/audit</code>. The SUID and SGID permissions\nshould not be required in directories containing audit log files.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log/audit</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from partitions\ndesignated for audit log files.",
        "platforms": [
          "#machine_and_mount_var-log-audit"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_audit_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_audit_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /var/log/audit: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log/audit'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") |\n    list )\n  tags:\n  - CCE-82921-8\n  - DISA-STIG-RHEL-08-040130\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log/audit: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82921-8\n  - DISA-STIG-RHEL-08-040130\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log/audit: If /var/log/audit not mounted, craft\n    mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log/audit\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82921-8\n  - DISA-STIG-RHEL-08-040130\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log/audit: Make sure nosuid option is part of the\n    to /var/log/audit options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-82921-8\n  - DISA-STIG-RHEL-08-040130\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log/audit: Ensure /var/log/audit is mounted with\n    nosuid option'\n  mount:\n    path: /var/log/audit\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log/audit\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82921-8\n  - DISA-STIG-RHEL-08-040130\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_audit_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_audit_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log/audit\" > /dev/null || findmnt --fstab \"/var/log/audit\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log/audit has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log/audit\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log/audit' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log/audit in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log/audit)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log/audit  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log/audit\"; then\n        if mountpoint -q \"/var/log/audit\"; then\n            mount -o remount --target \"/var/log/audit\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230518",
        "stig_id": "RHEL-08-040130"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_nodev",
        "title": "Add nodev Option to /var/log",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82077-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.6.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040126"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230514r854055_rule"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/var/log</code>.\nLegitimate character and block devices should exist only in\nthe <code>/dev</code> directory on the root partition or within chroot\njails built for system services.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_var-log"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /var/log: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82077-9\n  - DISA-STIG-RHEL-08-040126\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82077-9\n  - DISA-STIG-RHEL-08-040126\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log: If /var/log not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82077-9\n  - DISA-STIG-RHEL-08-040126\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log: Make sure nodev option is part of the to /var/log\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-82077-9\n  - DISA-STIG-RHEL-08-040126\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/log: Ensure /var/log is mounted with nodev option'\n  mount:\n    path: /var/log\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82077-9\n  - DISA-STIG-RHEL-08-040126\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log\" > /dev/null || findmnt --fstab \"/var/log\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log\"; then\n        if mountpoint -q \"/var/log\"; then\n            mount -o remount --target \"/var/log\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230514",
        "stig_id": "RHEL-08-040126"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_noexec": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_noexec",
        "title": "Add noexec Option to /var/log",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82008-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.6.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040128"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230516r854057_rule"
            ]
          }
        ],
        "description": "The <code>noexec</code> mount option can be used to prevent binaries\nfrom being executed out of <code>/var/log</code>.\nAdd the <code>noexec</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log</code>.",
        "rationale": "Allowing users to execute binaries from directories containing log files\nsuch as <code>/var/log</code> should never be necessary in normal operation and\ncan expose the system to potential compromise.",
        "platforms": [
          "#machine_and_mount_var-log"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_noexec:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_noexec",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add noexec Option to /var/log: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82008-4\n  - DISA-STIG-RHEL-08-040128\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82008-4\n  - DISA-STIG-RHEL-08-040128\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log: If /var/log not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82008-4\n  - DISA-STIG-RHEL-08-040128\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log: Make sure noexec option is part of the to\n    /var/log options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',noexec''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"noexec\" not in mount_info.options\n  tags:\n  - CCE-82008-4\n  - DISA-STIG-RHEL-08-040128\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/log: Ensure /var/log is mounted with noexec option'\n  mount:\n    path: /var/log\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82008-4\n  - DISA-STIG-RHEL-08-040128\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_noexec\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_noexec",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log\" > /dev/null || findmnt --fstab \"/var/log\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|noexec)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log  defaults,${previous_mount_opts}noexec 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"noexec\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,noexec|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log\"; then\n        if mountpoint -q \"/var/log\"; then\n            mount -o remount --target \"/var/log\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230516",
        "stig_id": "RHEL-08-040128"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_log_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_log_nosuid",
        "title": "Add nosuid Option to /var/log",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82065-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.6.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040127"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230515r854056_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/var/log</code>. The SUID and SGID permissions\nshould not be required in directories containing log files.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/log</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from partitions\ndesignated for log files.",
        "platforms": [
          "#machine_and_mount_var-log"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_log_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_log_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /var/log: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/log'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82065-4\n  - DISA-STIG-RHEL-08-040127\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82065-4\n  - DISA-STIG-RHEL-08-040127\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log: If /var/log not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/log\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82065-4\n  - DISA-STIG-RHEL-08-040127\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log: Make sure nosuid option is part of the to\n    /var/log options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-82065-4\n  - DISA-STIG-RHEL-08-040127\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/log: Ensure /var/log is mounted with nosuid option'\n  mount:\n    path: /var/log\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/log\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82065-4\n  - DISA-STIG-RHEL-08-040127\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_log_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_log_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/log\" > /dev/null || findmnt --fstab \"/var/log\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/log has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/log\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/log' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/log in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/log)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/log  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/log\"; then\n        if mountpoint -q \"/var/log\"; then\n            mount -o remount --target \"/var/log\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230515",
        "stig_id": "RHEL-08-040127"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_nodev",
        "title": "Add nodev Option to /var",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82062-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.4.2"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6",
              "AC-6(1)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "MP-7"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-2",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/var</code>.\nLegitimate character and block devices should exist only in\nthe <code>/dev</code> directory on the root partition or within chroot\njails built for system services.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_var"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /var: Check information associated to mountpoint'\n  command: findmnt --fstab '/var'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-82062-1\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82062-1\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var: If /var not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82062-1\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var: Make sure nodev option is part of the to /var options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-82062-1\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var: Ensure /var is mounted with nodev option'\n  mount:\n    path: /var\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82062-1\n  - NIST-800-53-AC-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-MP-7\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var\" > /dev/null || findmnt --fstab \"/var\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var\"; then\n        if mountpoint -q \"/var\"; then\n            mount -o remount --target \"/var\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_nosuid",
        "title": "Add nosuid Option to /var",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83383-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.4.3"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/var</code>. The SUID and SGID permissions\nshould not be required for this directory.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled.",
        "platforms": [
          "#machine_and_mount_var"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /var: Check information associated to mountpoint'\n  command: findmnt --fstab '/var'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  tags:\n  - CCE-83383-0\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-83383-0\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var: If /var not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-83383-0\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var: Make sure nosuid option is part of the to /var\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-83383-0\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var: Ensure /var is mounted with nosuid option'\n  mount:\n    path: /var\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-83383-0\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var\" > /dev/null || findmnt --fstab \"/var\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var\"; then\n        if mountpoint -q \"/var\"; then\n            mount -o remount --target \"/var\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nodev": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nodev",
        "title": "Add nodev Option to /var/tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82068-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.5.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040132"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230520r854061_rule"
            ]
          }
        ],
        "description": "The <code>nodev</code> mount option can be used to prevent device files from\nbeing created in <code>/var/tmp</code>. Legitimate character and block devices\nshould not exist within temporary directories like <code>/var/tmp</code>.\nAdd the <code>nodev</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/tmp</code>.",
        "rationale": "The only legitimate location for device files is the <code>/dev</code> directory\nlocated on the root partition. The only exception to this is chroot jails.",
        "platforms": [
          "#machine_and_mount_var-tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_tmp_nodev:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_tmp_nodev",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nodev Option to /var/tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82068-8\n  - DISA-STIG-RHEL-08-040132\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82068-8\n  - DISA-STIG-RHEL-08-040132\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/tmp: If /var/tmp not mounted, craft mount_info manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82068-8\n  - DISA-STIG-RHEL-08-040132\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/tmp: Make sure nodev option is part of the to /var/tmp\n    options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nodev''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nodev\" not in mount_info.options\n  tags:\n  - CCE-82068-8\n  - DISA-STIG-RHEL-08-040132\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nodev\n  - no_reboot_needed\n\n- name: 'Add nodev Option to /var/tmp: Ensure /var/tmp is mounted with nodev option'\n  mount:\n    path: /var/tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82068-8\n  - DISA-STIG-RHEL-08-040132\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nodev\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_tmp_nodev",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/tmp\" > /dev/null || findmnt --fstab \"/var/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nodev)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/tmp  defaults,${previous_mount_opts}nodev 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nodev\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nodev|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/tmp\"; then\n        if mountpoint -q \"/var/tmp\"; then\n            mount -o remount --target \"/var/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230520",
        "stig_id": "RHEL-08-040132"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_noexec": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_noexec",
        "title": "Add noexec Option to /var/tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82151-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.3.5.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040134"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230522r854063_rule"
            ]
          }
        ],
        "description": "The <code>noexec</code> mount option can be used to prevent binaries\nfrom being executed out of <code>/var/tmp</code>.\nAdd the <code>noexec</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/tmp</code>.",
        "rationale": "Allowing users to execute binaries from world-writable directories\nsuch as <code>/var/tmp</code> should never be necessary in normal operation and\ncan expose the system to potential compromise.",
        "platforms": [
          "#machine_and_mount_var-tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_tmp_noexec:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_tmp_noexec",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add noexec Option to /var/tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82151-2\n  - DISA-STIG-RHEL-08-040134\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82151-2\n  - DISA-STIG-RHEL-08-040134\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/tmp: If /var/tmp not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82151-2\n  - DISA-STIG-RHEL-08-040134\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/tmp: Make sure noexec option is part of the to\n    /var/tmp options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',noexec''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"noexec\" not in mount_info.options\n  tags:\n  - CCE-82151-2\n  - DISA-STIG-RHEL-08-040134\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_noexec\n  - no_reboot_needed\n\n- name: 'Add noexec Option to /var/tmp: Ensure /var/tmp is mounted with noexec option'\n  mount:\n    path: /var/tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82151-2\n  - DISA-STIG-RHEL-08-040134\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_noexec\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_tmp_noexec",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/tmp\" > /dev/null || findmnt --fstab \"/var/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|noexec)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/tmp  defaults,${previous_mount_opts}noexec 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"noexec\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,noexec|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/tmp\"; then\n        if mountpoint -q \"/var/tmp\"; then\n            mount -o remount --target \"/var/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230522",
        "stig_id": "RHEL-08-040134"
      },
      "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nosuid": {
        "rule_id": "xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nosuid",
        "title": "Add nosuid Option to /var/tmp",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82154-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R28"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.1.2.5.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001764"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000368-GPOS-00154"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040133"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230521r854062_rule"
            ]
          }
        ],
        "description": "The <code>nosuid</code> mount option can be used to prevent\nexecution of setuid programs in <code>/var/tmp</code>. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd the <code>nosuid</code> option to the fourth column of\n<code>/etc/fstab</code> for the line which controls mounting of\n<code>/var/tmp</code>.",
        "rationale": "The presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions.",
        "platforms": [
          "#machine_and_mount_var-tmp"
        ],
        "oval_definition_id": "oval:ssg-mount_option_var_tmp_nosuid:def:1",
        "remediations": [
          {
            "remediation_id": "mount_option_var_tmp_nosuid",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "high",
            "strategy": "configure",
            "fix": "- name: 'Add nosuid Option to /var/tmp: Check information associated to mountpoint'\n  command: findmnt --fstab '/var/tmp'\n  register: device_name\n  failed_when: device_name.rc > 1\n  changed_when: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list\n    )\n  tags:\n  - CCE-82154-6\n  - DISA-STIG-RHEL-08-040133\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/tmp: Create mount_info dictionary variable'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - '{{ device_name.stdout_lines[0].split() | list | lower }}'\n  - '{{ device_name.stdout_lines[1].split() | list }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length > 0)\n  tags:\n  - CCE-82154-6\n  - DISA-STIG-RHEL-08-040133\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/tmp: If /var/tmp not mounted, craft mount_info\n    manually'\n  set_fact:\n    mount_info: '{{ mount_info|default({})|combine({item.0: item.1}) }}'\n  with_together:\n  - - target\n    - source\n    - fstype\n    - options\n  - - /var/tmp\n    - ''\n    - ''\n    - defaults\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - (\"--fstab\" | length == 0)\n  - device_name.stdout is defined and device_name.stdout_lines is defined\n  - (device_name.stdout | length == 0)\n  tags:\n  - CCE-82154-6\n  - DISA-STIG-RHEL-08-040133\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/tmp: Make sure nosuid option is part of the to\n    /var/tmp options'\n  set_fact:\n    mount_info: '{{ mount_info | combine( {''options'':''''~mount_info.options~'',nosuid''\n      }) }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined and \"nosuid\" not in mount_info.options\n  tags:\n  - CCE-82154-6\n  - DISA-STIG-RHEL-08-040133\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nosuid\n  - no_reboot_needed\n\n- name: 'Add nosuid Option to /var/tmp: Ensure /var/tmp is mounted with nosuid option'\n  mount:\n    path: /var/tmp\n    src: '{{ mount_info.source }}'\n    opts: '{{ mount_info.options }}'\n    state: mounted\n    fstype: '{{ mount_info.fstype }}'\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"/var/tmp\" in ansible_mounts | map(attribute=\"mount\") | list )\n  - mount_info is defined\n  - (device_name.stdout is defined and (device_name.stdout | length > 0)) or (\"--fstab\"\n    | length == 0)\n  tags:\n  - CCE-82154-6\n  - DISA-STIG-RHEL-08-040133\n  - configure_strategy\n  - high_disruption\n  - low_complexity\n  - medium_severity\n  - mount_option_var_tmp_nosuid\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "mount_option_var_tmp_nosuid",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && findmnt --kernel \"/var/tmp\" > /dev/null || findmnt --fstab \"/var/tmp\" > /dev/null ); then\n\nfunction perform_remediation {\n    \n        # the mount point /var/tmp has to be defined in /etc/fstab\n        # before this remediation can be executed. In case it is not defined, the\n        # remediation aborts and no changes regarding the mount point are done.\n        mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" \"/var/tmp\")\"\n\n    grep \"$mount_point_match_regexp\" -q /etc/fstab \\\n        || { echo \"The mount point '/var/tmp' is not even in /etc/fstab, so we can't set up mount options\" >&2;\n                echo \"Not remediating, because there is no record of /var/tmp in /etc/fstab\" >&2; return 1; }\n    \n\n\n    mount_point_match_regexp=\"$(printf \"^[[:space:]]*[^#].*[[:space:]]%s[[:space:]]\" /var/tmp)\"\n\n    # If the mount point is not in /etc/fstab, get previous mount options from /etc/mtab\n    if ! grep -q \"$mount_point_match_regexp\" /etc/fstab; then\n        # runtime opts without some automatic kernel/userspace-added defaults\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/mtab | head -1 |  awk '{print $4}' \\\n                    | sed -E \"s/(rw|defaults|seclabel|nosuid)(,|$)//g;s/,$//\")\n        [ \"$previous_mount_opts\" ] && previous_mount_opts+=\",\"\n        # In iso9660 filesystems mtab could describe a \"blocksize\" value, this should be reflected in\n        # fstab as \"block\".  The next variable is to satisfy shellcheck SC2050.\n        fs_type=\"\"\n        if [  \"$fs_type\" == \"iso9660\" ] ; then\n            previous_mount_opts=$(sed 's/blocksize=/block=/' <<< \"$previous_mount_opts\")\n        fi\n        echo \" /var/tmp  defaults,${previous_mount_opts}nosuid 0 0\" >> /etc/fstab\n    # If the mount_opt option is not already in the mount point's /etc/fstab entry, add it\n    elif ! grep \"$mount_point_match_regexp\" /etc/fstab | grep -q \"nosuid\"; then\n        previous_mount_opts=$(grep \"$mount_point_match_regexp\" /etc/fstab | awk '{print $4}')\n        sed -i \"s|\\(${mount_point_match_regexp}.*${previous_mount_opts}\\)|\\1,nosuid|\" /etc/fstab\n    fi\n\n\n    if mkdir -p \"/var/tmp\"; then\n        if mountpoint -q \"/var/tmp\"; then\n            mount -o remount --target \"/var/tmp\"\n        fi\n    fi\n}\n\nperform_remediation\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230521",
        "stig_id": "RHEL-08-040133"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_kernel_yama_ptrace_scope": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_yama_ptrace_scope",
        "title": "Restrict usage of ptrace to descendant processes",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80953-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R11"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.4.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "SC-7(10)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000132-GPOS-00067",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040282"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230546r858824_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>kernel.yama.ptrace_scope</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.yama.ptrace_scope=1</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>kernel.yama.ptrace_scope = 1</pre>\n       ",
        "rationale": "Unrestricted usage of ptrace allows compromised binaries to run ptrace\non another processes of the user. Like this, the attacker can steal\nsensitive information from the target processes (e.g. SSH sessions, web browser, ...)\nwithout any additional assistance from the user (i.e. without resorting to phishing).\n",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_kernel_yama_ptrace_scope:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_kernel_yama_ptrace_scope",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*kernel.yama.ptrace_scope.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80953-3\n  - DISA-STIG-RHEL-08-040282\n  - NIST-800-53-SC-7(10)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_yama_ptrace_scope\n\n- name: Comment out any occurrences of kernel.yama.ptrace_scope from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*kernel.yama.ptrace_scope\n    replace: '#kernel.yama.ptrace_scope'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80953-3\n  - DISA-STIG-RHEL-08-040282\n  - NIST-800-53-SC-7(10)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_yama_ptrace_scope\n\n- name: Ensure sysctl kernel.yama.ptrace_scope is set to 1\n  sysctl:\n    name: kernel.yama.ptrace_scope\n    value: '1'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80953-3\n  - DISA-STIG-RHEL-08-040282\n  - NIST-800-53-SC-7(10)\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_yama_ptrace_scope\n"
          },
          {
            "remediation_id": "sysctl_kernel_yama_ptrace_scope",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,kernel.yama.ptrace_scope%3D1%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_kernel_yama_ptrace_scope.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_kernel_yama_ptrace_scope",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of kernel.yama.ptrace_scope from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*kernel.yama.ptrace_scope.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"kernel.yama.ptrace_scope\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\n\n#\n# Set runtime for kernel.yama.ptrace_scope\n#\n/sbin/sysctl -q -n -w kernel.yama.ptrace_scope=\"1\"\n\n#\n# If kernel.yama.ptrace_scope present in /etc/sysctl.conf, change value to \"1\"\n#\telse, add \"kernel.yama.ptrace_scope = 1\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^kernel.yama.ptrace_scope\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"1\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^kernel.yama.ptrace_scope\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^kernel.yama.ptrace_scope\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80953-3\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230546",
        "stig_id": "RHEL-08-040282"
      },
      "xccdf_org.ssgproject.content_rule_coredump_disable_backtraces": {
        "rule_id": "xccdf_org.ssgproject.content_rule_coredump_disable_backtraces",
        "title": "Disable core dump backtraces",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82251-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.4.3"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-3.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "3.3.1.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010675"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230315r627750_rule"
            ]
          }
        ],
        "description": "The <code>ProcessSizeMax</code> option in <code>[Coredump]</code> section\nof <code>/etc/systemd/coredump.conf</code>\nspecifies the maximum size in bytes of a core which will be processed.\nCore dumps exceeding this size may be stored, but the backtrace will not\nbe generated.",
        "rationale": "A core dump includes a memory image taken at the time the operating system\nterminates an application. The memory image could contain sensitive data\nand is generally useful only for developers or system operators trying to\ndebug problems.\n\nEnabling core dumps on production systems is not recommended,\nhowever there may be overriding operational requirements to enable advanced\ndebuging. Permitting temporary enablement of core dumps during such situations\nshould be reviewed through local needs and policy.",
        "warnings": [
          {
            "text": "If the <code>/etc/systemd/coredump.conf</code> file\ndoes not already contain the <code>[Coredump]</code> section,\nthe value will not be configured correctly.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_systemd"
        ],
        "oval_definition_id": "oval:ssg-coredump_disable_backtraces:def:1",
        "remediations": [
          {
            "remediation_id": "coredump_disable_backtraces",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82251-0\n  - DISA-STIG-RHEL-08-010675\n  - NIST-800-53-CM-6\n  - PCI-DSS-Req-3.2\n  - PCI-DSSv4-3.3.1.1\n  - coredump_disable_backtraces\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set 'ProcessSizeMax' to '0' in the [Coredump] section of '/etc/systemd/coredump.conf'\n  ini_file:\n    path: /etc/systemd/coredump.conf\n    section: Coredump\n    option: ProcessSizeMax\n    value: '0'\n    create: true\n    mode: 420\n  when: '\"systemd\" in ansible_facts.packages'\n  tags:\n  - CCE-82251-0\n  - DISA-STIG-RHEL-08-010675\n  - NIST-800-53-CM-6\n  - PCI-DSS-Req-3.2\n  - PCI-DSSv4-3.3.1.1\n  - coredump_disable_backtraces\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "coredump_disable_backtraces",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,%23%20%20This%20file%20is%20part%20of%20systemd.%0A%23%0A%23%20%20systemd%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and/or%20modify%20it%0A%23%20%20under%20the%20terms%20of%20the%20GNU%20Lesser%20General%20Public%20License%20as%20published%20by%0A%23%20%20the%20Free%20Software%20Foundation%3B%20either%20version%202.1%20of%20the%20License%2C%20or%0A%23%20%20%28at%20your%20option%29%20any%20later%20version.%0A%23%0A%23%20Entries%20in%20this%20file%20show%20the%20compile%20time%20defaults.%0A%23%20You%20can%20change%20settings%20by%20editing%20this%20file.%0A%23%20Defaults%20can%20be%20restored%20by%20simply%20deleting%20this%20file.%0A%23%0A%23%20See%20coredump.conf%285%29%20for%20details.%0A%0A%5BCoredump%5D%0A%23Storage%3Dexternal%0A%23Compress%3Dyes%0A%23ProcessSizeMax%3D2G%0A%23ExternalSizeMax%3D2G%0A%23JournalSizeMax%3D767M%0A%23MaxUse%3D%0A%23KeepFree%3D%0AStorage%3Dnone%0AProcessSizeMax%3D0%0A\n        mode: 0644\n        path: /etc/systemd/coredump.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "coredump_disable_backtraces",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q systemd; then\n\nfound=false\n\n# set value in all files if they contain section or key\nfor f in $(echo -n \"/etc/systemd/coredump.conf\"); do\n    if [ ! -e \"$f\" ]; then\n        continue\n    fi\n\n    # find key in section and change value\n    if grep -qzosP \"[[:space:]]*\\[Coredump\\]([^\\n\\[]*\\n+)+?[[:space:]]*ProcessSizeMax\" \"$f\"; then\n\n            sed -i \"s/ProcessSizeMax[^(\\n)]*/ProcessSizeMax=0/\" \"$f\"\n\n            found=true\n\n    # find section and add key = value to it\n    elif grep -qs \"[[:space:]]*\\[Coredump\\]\" \"$f\"; then\n\n            sed -i \"/[[:space:]]*\\[Coredump\\]/a ProcessSizeMax=0\" \"$f\"\n\n            found=true\n    fi\ndone\n\n# if section not in any file, append section with key = value to FIRST file in files parameter\nif ! $found ; then\n    file=$(echo \"/etc/systemd/coredump.conf\" | cut -f1 -d ' ')\n    mkdir -p \"$(dirname \"$file\")\"\n\n    echo -e \"[Coredump]\\nProcessSizeMax=0\" >> \"$file\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230315",
        "stig_id": "RHEL-08-010675"
      },
      "xccdf_org.ssgproject.content_rule_coredump_disable_storage": {
        "rule_id": "xccdf_org.ssgproject.content_rule_coredump_disable_storage",
        "title": "Disable storing core dump",
        "result": "fail",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82252-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.4.4"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-3.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "3.3.1.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010674"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230314r627750_rule"
            ]
          }
        ],
        "description": "The <code>Storage</code> option in <code>[Coredump]</code> sectionof <code>/etc/systemd/coredump.conf</code>\ncan be set to <code>none</code> to disable storing core dumps permanently.",
        "rationale": "A core dump includes a memory image taken at the time the operating system\nterminates an application. The memory image could contain sensitive data\nand is generally useful only for developers or system operators trying to\ndebug problems. Enabling core dumps on production systems is not recommended,\nhowever there may be overriding operational requirements to enable advanced\ndebuging. Permitting temporary enablement of core dumps during such situations\nshould be reviewed through local needs and policy.",
        "warnings": [
          {
            "text": "If the <code>/etc/systemd/coredump.conf</code> file\ndoes not already contain the <code>[Coredump]</code> section,\nthe value will not be configured correctly.",
            "category": "general"
          }
        ],
        "platforms": [
          "#package_systemd"
        ],
        "oval_definition_id": "oval:ssg-coredump_disable_storage:def:1",
        "remediations": [
          {
            "remediation_id": "coredump_disable_storage",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82252-8\n  - DISA-STIG-RHEL-08-010674\n  - NIST-800-53-CM-6\n  - PCI-DSS-Req-3.2\n  - PCI-DSSv4-3.3.1.1\n  - coredump_disable_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Set 'Storage' to 'none' in the [Coredump] section of '/etc/systemd/coredump.conf'\n  ini_file:\n    path: /etc/systemd/coredump.conf\n    section: Coredump\n    option: Storage\n    value: none\n    create: true\n    mode: 420\n  when: '\"systemd\" in ansible_facts.packages'\n  tags:\n  - CCE-82252-8\n  - DISA-STIG-RHEL-08-010674\n  - NIST-800-53-CM-6\n  - PCI-DSS-Req-3.2\n  - PCI-DSSv4-3.3.1.1\n  - coredump_disable_storage\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "coredump_disable_storage",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,%23%20%20This%20file%20is%20part%20of%20systemd.%0A%23%0A%23%20%20systemd%20is%20free%20software%3B%20you%20can%20redistribute%20it%20and/or%20modify%20it%0A%23%20%20under%20the%20terms%20of%20the%20GNU%20Lesser%20General%20Public%20License%20as%20published%20by%0A%23%20%20the%20Free%20Software%20Foundation%3B%20either%20version%202.1%20of%20the%20License%2C%20or%0A%23%20%20%28at%20your%20option%29%20any%20later%20version.%0A%23%0A%23%20Entries%20in%20this%20file%20show%20the%20compile%20time%20defaults.%0A%23%20You%20can%20change%20settings%20by%20editing%20this%20file.%0A%23%20Defaults%20can%20be%20restored%20by%20simply%20deleting%20this%20file.%0A%23%0A%23%20See%20coredump.conf%285%29%20for%20details.%0A%0A%5BCoredump%5D%0A%23Storage%3Dexternal%0A%23Compress%3Dyes%0A%23ProcessSizeMax%3D2G%0A%23ExternalSizeMax%3D2G%0A%23JournalSizeMax%3D767M%0A%23MaxUse%3D%0A%23KeepFree%3D%0AStorage%3Dnone%0AProcessSizeMax%3D0%0A\n        mode: 0644\n        path: /etc/systemd/coredump.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "coredump_disable_storage",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q systemd; then\n\nfound=false\n\n# set value in all files if they contain section or key\nfor f in $(echo -n \"/etc/systemd/coredump.conf\"); do\n    if [ ! -e \"$f\" ]; then\n        continue\n    fi\n\n    # find key in section and change value\n    if grep -qzosP \"[[:space:]]*\\[Coredump\\]([^\\n\\[]*\\n+)+?[[:space:]]*Storage\" \"$f\"; then\n\n            sed -i \"s/Storage[^(\\n)]*/Storage=none/\" \"$f\"\n\n            found=true\n\n    # find section and add key = value to it\n    elif grep -qs \"[[:space:]]*\\[Coredump\\]\" \"$f\"; then\n\n            sed -i \"/[[:space:]]*\\[Coredump\\]/a Storage=none\" \"$f\"\n\n            found=true\n    fi\ndone\n\n# if section not in any file, append section with key = value to FIRST file in files parameter\nif ! $found ; then\n    file=$(echo \"/etc/systemd/coredump.conf\" | cut -f1 -d ' ')\n    mkdir -p \"$(dirname \"$file\")\"\n\n    echo -e \"[Coredump]\\nStorage=none\" >> \"$file\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230314",
        "stig_id": "RHEL-08-010674"
      },
      "xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space",
        "title": "Enable Randomized Layout of Virtual Address Space",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80916-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R9"
            ]
          },
          {
            "name": "app-srg-ctr",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform",
            "ref_ids": [
              "SRG-APP-000450-CTR-001105"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.4.1"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.7"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-002824"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.308(a)(3)",
              "164.308(a)(4)",
              "164.310(b)",
              "164.310(c)",
              "164.312(a)",
              "164.312(e)"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-002-5 R1.1",
              "CIP-002-5 R1.2",
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 4.1",
              "CIP-004-6 4.2",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.2.4",
              "CIP-004-6 R2.3",
              "CIP-004-6 R4",
              "CIP-005-6 R1",
              "CIP-005-6 R1.1",
              "CIP-005-6 R1.2",
              "CIP-007-3 R3",
              "CIP-007-3 R3.1",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.1.3",
              "CIP-007-3 R5.2.1",
              "CIP-007-3 R5.2.3",
              "CIP-007-3 R8.4",
              "CIP-009-6 R.1.1",
              "CIP-009-6 R4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "SC-30",
              "SC-30(2)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000433-GPOS-00193",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "3.3.1.1"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010430"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230280r858767_rule"
            ]
          }
        ],
        "description": "To set the runtime status of the <code>kernel.randomize_va_space</code> kernel parameter, run the following command: <pre>$ sudo sysctl -w kernel.randomize_va_space=2</pre>\nTo make sure that the setting is persistent, add the following line to a file in the directory <code>/etc/sysctl.d</code>: <pre>kernel.randomize_va_space = 2</pre>\n        ",
        "rationale": "Address space layout randomization (ASLR) makes it more difficult for an\nattacker to predict the location of attack code they have introduced into a\nprocess&#x27;s address space during an attempt at exploitation. Additionally,\nASLR makes it more difficult for an attacker to know the location of\nexisting code in order to re-purpose it using return oriented programming\n(ROP) techniques.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-sysctl_kernel_randomize_va_space:def:1",
        "remediations": [
          {
            "remediation_id": "sysctl_kernel_randomize_va_space",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "- name: List /etc/sysctl.d/*.conf files\n  find:\n    paths:\n    - /etc/sysctl.d/\n    - /run/sysctl.d/\n    - /usr/local/lib/sysctl.d/\n    contains: ^[\\s]*kernel.randomize_va_space.*$\n    patterns: '*.conf'\n    file_type: any\n  register: find_sysctl_d\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80916-0\n  - DISA-STIG-RHEL-08-010430\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-30\n  - NIST-800-53-SC-30(2)\n  - PCI-DSS-Req-2.2.1\n  - PCI-DSSv4-3.3.1.1\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_randomize_va_space\n\n- name: Comment out any occurrences of kernel.randomize_va_space from config files\n  replace:\n    path: '{{ item.path }}'\n    regexp: ^[\\s]*kernel.randomize_va_space\n    replace: '#kernel.randomize_va_space'\n  loop: '{{ find_sysctl_d.files }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80916-0\n  - DISA-STIG-RHEL-08-010430\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-30\n  - NIST-800-53-SC-30(2)\n  - PCI-DSS-Req-2.2.1\n  - PCI-DSSv4-3.3.1.1\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_randomize_va_space\n\n- name: Ensure sysctl kernel.randomize_va_space is set to 2\n  sysctl:\n    name: kernel.randomize_va_space\n    value: '2'\n    sysctl_file: /etc/sysctl.conf\n    state: present\n    reload: true\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80916-0\n  - DISA-STIG-RHEL-08-010430\n  - NIST-800-171-3.1.7\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-30\n  - NIST-800-53-SC-30(2)\n  - PCI-DSS-Req-2.2.1\n  - PCI-DSSv4-3.3.1.1\n  - disable_strategy\n  - low_complexity\n  - medium_disruption\n  - medium_severity\n  - reboot_required\n  - sysctl_kernel_randomize_va_space\n"
          },
          {
            "remediation_id": "sysctl_kernel_randomize_va_space",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,kernel.randomize_va_space%3D2%0A\n        mode: 0644\n        path: /etc/sysctl.d/75-sysctl_kernel_randomize_va_space.conf\n        overwrite: true\n"
          },
          {
            "remediation_id": "sysctl_kernel_randomize_va_space",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Comment out any occurrences of kernel.randomize_va_space from /etc/sysctl.d/*.conf files\n\nfor f in /etc/sysctl.d/*.conf /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf; do\n\n\n  # skip systemd-sysctl symlink (/etc/sysctl.d/99-sysctl.conf -> /etc/sysctl.conf)\n  if [[ \"$(readlink -f \"$f\")\" == \"/etc/sysctl.conf\" ]]; then continue; fi\n\n  matching_list=$(grep -P '^(?!#).*[\\s]*kernel.randomize_va_space.*$' $f | uniq )\n  if ! test -z \"$matching_list\"; then\n    while IFS= read -r entry; do\n      escaped_entry=$(sed -e 's|/|\\\\/|g' <<< \"$entry\")\n      # comment out \"kernel.randomize_va_space\" matches to preserve user data\n      sed -i --follow-symlinks \"s/^${escaped_entry}$/# &/g\" $f\n    done <<< \"$matching_list\"\n  fi\ndone\n\n#\n# Set sysctl config file which to save the desired value\n#\n\nSYSCONFIG_FILE=\"/etc/sysctl.conf\"\n\n\n#\n# Set runtime for kernel.randomize_va_space\n#\n/sbin/sysctl -q -n -w kernel.randomize_va_space=\"2\"\n\n#\n# If kernel.randomize_va_space present in /etc/sysctl.conf, change value to \"2\"\n#\telse, add \"kernel.randomize_va_space = 2\" to /etc/sysctl.conf\n#\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^kernel.randomize_va_space\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"2\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^kernel.randomize_va_space\\\\>\" \"${SYSCONFIG_FILE}\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^kernel.randomize_va_space\\\\>.*/$escaped_formatted_output/gi\" \"${SYSCONFIG_FILE}\"\nelse\n    if [[ -s \"${SYSCONFIG_FILE}\" ]] && [[ -n \"$(tail -c 1 -- \"${SYSCONFIG_FILE}\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"${SYSCONFIG_FILE}\"\n    fi\n    cce=\"CCE-80916-0\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"${SYSCONFIG_FILE}\" >> \"${SYSCONFIG_FILE}\"\n    printf '%s\\n' \"$formatted_output\" >> \"${SYSCONFIG_FILE}\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230280",
        "stig_id": "RHEL-08-010430"
      },
      "xccdf_org.ssgproject.content_rule_package_libselinux_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_libselinux_installed",
        "title": "Install libselinux Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-82877-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.6"
            ]
          }
        ],
        "description": "The <code>libselinux</code> package can be installed with the following command:\n<pre>\n$ sudo yum install libselinux</pre>\n      ",
        "rationale": "Security-enhanced Linux is a feature of the Linux kernel and a number of utilities\nwith enhanced security functionality designed to add mandatory access controls to Linux.\n\nThe <code>libselinux</code> package contains the core library of the Security-enhanced Linux system.",
        "oval_definition_id": "oval:ssg-package_libselinux_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_libselinux_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure libselinux is installed\n  package:\n    name: libselinux\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82877-2\n  - PCI-DSSv4-1.2.6\n  - enable_strategy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_libselinux_installed\n"
          },
          {
            "remediation_id": "package_libselinux_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_libselinux\n\nclass install_libselinux {\n  package { 'libselinux':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_libselinux_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"libselinux\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_libselinux_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"libselinux\" ; then\n    yum install -y \"libselinux\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_mcstrans_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_mcstrans_removed",
        "title": "Uninstall mcstrans Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-82756-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.7"
            ]
          }
        ],
        "description": "The <code>mcstransd</code> daemon provides category label information\nto client processes requesting information. The label translations are defined\nin <code>/etc/selinux/targeted/setrans.conf</code>.\nThe <code>mcstrans</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase mcstrans</pre>\n      ",
        "rationale": "Since this service is not used very often, disable it to reduce the\namount of potentially vulnerable code running on the system.",
        "oval_definition_id": "oval:ssg-package_mcstrans_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_mcstrans_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure mcstrans is removed\n  package:\n    name: mcstrans\n    state: absent\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82756-8\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_mcstrans_removed\n"
          },
          {
            "remediation_id": "package_mcstrans_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_mcstrans\n\nclass remove_mcstrans {\n  package { 'mcstrans':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_mcstrans_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# CAUTION: This remediation script will remove mcstrans\n#\t   from the system, and may remove any packages\n#\t   that depend on mcstrans. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"mcstrans\" ; then\n\n    yum remove -y \"mcstrans\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_setroubleshoot_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_setroubleshoot_removed",
        "title": "Uninstall setroubleshoot Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-82755-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R49"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.8"
            ]
          }
        ],
        "description": "The SETroubleshoot service notifies desktop users of SELinux\ndenials. The service provides information around configuration errors,\nunauthorized intrusions, and other potential errors.\nThe <code>setroubleshoot</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase setroubleshoot</pre>\n      ",
        "rationale": "The SETroubleshoot service is an unnecessary daemon to\nhave running on a server, especially if\nX Windows is removed or disabled.",
        "oval_definition_id": "oval:ssg-package_setroubleshoot_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_setroubleshoot_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure setroubleshoot is removed\n  package:\n    name: setroubleshoot\n    state: absent\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82755-0\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_setroubleshoot_removed\n"
          },
          {
            "remediation_id": "package_setroubleshoot_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_setroubleshoot\n\nclass remove_setroubleshoot {\n  package { 'setroubleshoot':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_setroubleshoot_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# CAUTION: This remediation script will remove setroubleshoot\n#\t   from the system, and may remove any packages\n#\t   that depend on setroubleshoot. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"setroubleshoot\" ; then\n\n    yum remove -y \"setroubleshoot\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_grub2_enable_selinux": {
        "rule_id": "xccdf_org.ssgproject.content_rule_grub2_enable_selinux",
        "title": "Ensure SELinux Not Disabled in /etc/default/grub",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80827-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "4",
              "5",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO11.04",
              "APO13.01",
              "BAI03.05",
              "DSS01.05",
              "DSS03.01",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06",
              "MEA02.01"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.2",
              "3.7.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000022",
              "CCI-000032"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.308(a)(3)",
              "164.308(a)(4)",
              "164.310(b)",
              "164.310(c)",
              "164.312(a)",
              "164.312(e)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.2.2",
              "4.3.3.3.9",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 2.8",
              "SR 2.9",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.7.1",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "AC-3(3)(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "ID.AM-3",
              "PR.AC-4",
              "PR.AC-5",
              "PR.AC-6",
              "PR.DS-5",
              "PR.PT-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.6"
            ]
          }
        ],
        "description": "SELinux can be disabled at boot time by an argument in\n<code>/etc/default/grub</code>.\nRemove any instances of <code>selinux=0</code> from the kernel arguments in that\nfile to prevent SELinux from being disabled at boot.",
        "rationale": "Disabling a major host protection feature, such as SELinux, at boot time prevents\nit from confining system services at boot time.  Further, it increases\nthe chances that it will remain off during system operation.",
        "platforms": [
          "#grub2"
        ],
        "oval_definition_id": "oval:ssg-grub2_enable_selinux:def:1",
        "remediations": [
          {
            "remediation_id": "grub2_enable_selinux",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Find /etc/grub.d/ files\n  ansible.builtin.find:\n    paths:\n    - /etc/grub.d/\n    follow: true\n  register: result_grub_d\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Ensure SELinux Not Disabled\n    in /etc/grub.d/ files\n  ansible.builtin.replace:\n    dest: '{{ item.path }}'\n    regexp: (selinux|enforcing)=0\n  with_items:\n  - '{{ result_grub_d.files }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Check if /etc/grub2.cfg\n    exists\n  ansible.builtin.stat:\n    path: /etc/grub2.cfg\n  register: result_grub2_cfg_present\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Check if /etc/default/grub\n    exists\n  ansible.builtin.stat:\n    path: /etc/default/grub\n  register: result_default_grub_present\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Ensure SELinux Not Disabled\n    in /etc/grub2.cfg\n  ansible.builtin.replace:\n    dest: /etc/grub2.cfg\n    regexp: (selinux|enforcing)=0\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  - result_grub2_cfg_present.stat.exists\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n\n- name: Ensure SELinux Not Disabled in /etc/default/grub - Ensure SELinux Not Disabled\n    in /etc/default/grub\n  ansible.builtin.replace:\n    dest: /etc/default/grub\n    regexp: (selinux|enforcing)=0\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"grub2-common\" in ansible_facts.packages'\n  - result_default_grub_present.stat.exists\n  tags:\n  - CCE-80827-9\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - PCI-DSSv4-1.2.6\n  - grub2_enable_selinux\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "grub2_enable_selinux",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { rpm --quiet -q grub2-common; }; then\n\nsed -i --follow-symlinks \"s/selinux=0//gI\" /etc/default/grub /etc/grub2.cfg /etc/grub.d/*\nsed -i --follow-symlinks \"s/enforcing=0//gI\" /etc/default/grub /etc/grub2.cfg /etc/grub.d/*\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_selinux_confinement_of_daemons": {
        "rule_id": "xccdf_org.ssgproject.content_rule_selinux_confinement_of_daemons",
        "title": "Ensure No Daemons are Unconfined by SELinux",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80867-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "6",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO11.04",
              "BAI03.05",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.06",
              "MEA02.01"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.2",
              "3.1.5",
              "3.7.2"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.308(a)(3)",
              "164.308(a)(4)",
              "164.310(b)",
              "164.310(c)",
              "164.312(a)",
              "164.312(e)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.3.9",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 2.8",
              "SR 2.9",
              "SR 5.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.2",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.5.1",
              "A.12.6.2",
              "A.12.7.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3(3)(a)",
              "AC-6",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.6"
            ]
          }
        ],
        "description": "Daemons for which the SELinux policy does not contain rules will inherit the\ncontext of the parent process. Because daemons are launched during\nstartup and descend from the <code>init</code> process, they inherit the <code>unconfined_service_t</code> context.\n<br>\n       <br>\nTo check for unconfined daemons, run the following command:\n<pre>$ sudo ps -eZ | grep &quot;unconfined_service_t&quot;</pre>\nIt should produce no output in a well-configured system.",
        "rationale": "Daemons which run with the <code>unconfined_service_t</code> context may cause AVC denials,\nor allow privileges that the daemon does not require.",
        "warnings": [
          {
            "text": "Automatic remediation of this control is not available. Remediation\ncan be achieved by amending SELinux policy or stopping the unconfined\ndaemons as outlined above.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-selinux_confinement_of_daemons:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_selinux_not_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_selinux_not_disabled",
        "title": "Ensure SELinux is Not Disabled",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-86151-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.4"
            ]
          }
        ],
        "description": "The SELinux state should be set to <code>enforcing</code> or <code>permissive</code> at system boot\ntime. In the file <code>/etc/selinux/config</code>, add or correct the following line to configure\nthe system to boot into enforcing or permissive mode:\n<pre>SELINUX=enforcing</pre>\nOR\n<pre>SELINUX=permissive</pre>\n      ",
        "rationale": "Running SELinux in disabled mode is strongly discouraged. It prevents enforcing the SELinux\ncontrols without a system reboot. It also avoids labeling any persistent objects such as\nfiles, making it difficult to enable SELinux in the future.",
        "warnings": [
          {
            "text": "In case the SELinux is &quot;disabled&quot;, the automated remediation will adopt a more\nconservative approach and set it to &quot;permissive&quot; in order to avoid any system disruption\nand give the administrator the opportunity to assess the impact and necessary efforts\nbefore setting it to &quot;enforcing&quot;, which is strongly recommended.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-selinux_not_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "selinux_not_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Ensure SELinux is Not Disabled\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUX=\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/selinux/config\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUX=\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/selinux/config\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUX=\n      line: SELINUX=permissive\n      state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86151-8\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - reboot_required\n  - restrict_strategy\n  - selinux_not_disabled\n"
          },
          {
            "remediation_id": "selinux_not_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/selinux/config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^SELINUX=/Id\" \"/etc/selinux/config\"\nelse\n    touch \"/etc/selinux/config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/selinux/config\"\n\ncp \"/etc/selinux/config\" \"/etc/selinux/config.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"SELINUX=permissive\" >> \"/etc/selinux/config\"\n# Clean up after ourselves.\nrm \"/etc/selinux/config.bak\"\n\nfixfiles onboot\nfixfiles -f relabel\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_selinux_policytype": {
        "rule_id": "xccdf_org.ssgproject.content_rule_selinux_policytype",
        "title": "Configure SELinux Policy",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80868-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R46",
              "R64"
            ]
          },
          {
            "name": "app-srg-ctr",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform",
            "ref_ids": [
              "SRG-APP-000233-CTR-000585"
            ]
          },
          {
            "name": "bsi",
            "href": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/International/bsi_it_gs_comp_2022.pdf",
            "ref_ids": [
              "APP.4.4.A4"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "1.5.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "4",
              "5",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "APO11.04",
              "APO13.01",
              "BAI03.05",
              "DSS01.05",
              "DSS03.01",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06",
              "MEA02.01"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.2",
              "3.7.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-002165",
              "CCI-002696"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(1)(ii)(D)",
              "164.308(a)(3)",
              "164.308(a)(4)",
              "164.310(b)",
              "164.310(c)",
              "164.312(a)",
              "164.312(e)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.2.3.4",
              "4.3.3.2.2",
              "4.3.3.3.9",
              "4.3.3.4",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4",
              "4.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 2.8",
              "SR 2.9",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.1",
              "A.12.1.2",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.7.1",
              "A.13.1.1",
              "A.13.1.2",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.2",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.2",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-004-6 R3.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3",
              "CIP-007-3 R6.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "AC-3(3)(a)",
              "AU-9",
              "SC-7(21)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.AE-1",
              "ID.AM-3",
              "PR.AC-4",
              "PR.AC-5",
              "PR.AC-6",
              "PR.DS-5",
              "PR.PT-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000445-GPOS-00199"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010450"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230282r854035_rule"
            ]
          }
        ],
        "description": "The SELinux <code>targeted</code> policy is appropriate for\ngeneral-purpose desktops and servers, as well as systems in many other roles.\nTo configure the system to use this policy, add or correct the following line\nin <code>/etc/selinux/config</code>:\n<pre>SELINUXTYPE=targeted\n       </pre>\nOther policies, such as <code>mls</code>, provide additional security labeling\nand greater confinement but are not compatible with many general-purpose\nuse cases.",
        "rationale": "Setting the SELinux policy to <code>targeted</code> or a more specialized policy\nensures the system will confine processes that are likely to be\ntargeted for exploitation, such as network or system services.\n<br>\n       <br>\nNote: During the development or debugging of SELinux modules, it is common to\ntemporarily place non-production systems in <code>permissive</code> mode. In such\ntemporary cases, SELinux policies should be developed, and once work\nis completed, the system should be reconfigured to\n<code>targeted</code>.",
        "oval_definition_id": "oval:ssg-selinux_policytype:def:1",
        "remediations": [
          {
            "remediation_id": "selinux_policytype",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_selinux_policy_name # promote to variable\n  set_fact:\n    var_selinux_policy_name: !!str targeted\n  tags:\n    - always\n\n- name: Configure SELinux Policy\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUXTYPE=\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/selinux/config\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUXTYPE=\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/selinux/config\n    lineinfile:\n      path: /etc/selinux/config\n      create: true\n      regexp: ^SELINUXTYPE=\n      line: SELINUXTYPE={{ var_selinux_policy_name }}\n      state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80868-3\n  - DISA-STIG-RHEL-08-010450\n  - NIST-800-171-3.1.2\n  - NIST-800-171-3.7.2\n  - NIST-800-53-AC-3\n  - NIST-800-53-AC-3(3)(a)\n  - NIST-800-53-AU-9\n  - NIST-800-53-SC-7(21)\n  - PCI-DSSv4-1.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - reboot_required\n  - restrict_strategy\n  - selinux_policytype\n"
          },
          {
            "remediation_id": "selinux_policytype",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_selinux_policy_name='targeted'\n\n\nif [ -e \"/etc/selinux/config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^SELINUXTYPE=/Id\" \"/etc/selinux/config\"\nelse\n    touch \"/etc/selinux/config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/selinux/config\"\n\ncp \"/etc/selinux/config\" \"/etc/selinux/config.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"SELINUXTYPE=$var_selinux_policy_name\" >> \"/etc/selinux/config\"\n# Clean up after ourselves.\nrm \"/etc/selinux/config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230282",
        "stig_id": "RHEL-08-010450"
      },
      "xccdf_org.ssgproject.content_rule_service_avahi-daemon_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_avahi-daemon_disabled",
        "title": "Disable Avahi Server Software",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82188-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "\nThe <code>avahi-daemon</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now avahi-daemon.service</pre>\n       ",
        "rationale": "Because the Avahi daemon service keeps an open network\nport, it is subject to network attacks. Its functionality\nis convenient but is only appropriate if the local network\ncan be trusted.",
        "platforms": [
          "#machine_and_package_avahi"
        ],
        "oval_definition_id": "oval:ssg-service_avahi-daemon_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_avahi-daemon_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82188-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_avahi-daemon_disabled\n\n- name: Disable Avahi Server Software - Collect systemd Services Present in the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"avahi\" in ansible_facts.packages )\n  tags:\n  - CCE-82188-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_avahi-daemon_disabled\n\n- name: Disable Avahi Server Software - Ensure avahi-daemon.service is Masked\n  ansible.builtin.systemd:\n    name: avahi-daemon.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"avahi\" in ansible_facts.packages )\n  - service_exists.stdout_lines is search(\"avahi-daemon.service\", multiline=True)\n  tags:\n  - CCE-82188-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_avahi-daemon_disabled\n\n- name: Unit Socket Exists - avahi-daemon.socket\n  ansible.builtin.command: systemctl -q list-unit-files avahi-daemon.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\",\n    \"container\"] and \"avahi\" in ansible_facts.packages )\n  tags:\n  - CCE-82188-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_avahi-daemon_disabled\n\n- name: Disable Avahi Server Software - Disable Socket avahi-daemon\n  ansible.builtin.systemd:\n    name: avahi-daemon.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ( ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n    and \"avahi\" in ansible_facts.packages )\n  - socket_file_exists.stdout_lines is search(\"avahi-daemon.socket\", multiline=True)\n  tags:\n  - CCE-82188-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_avahi-daemon_disabled\n"
          },
          {
            "remediation_id": "service_avahi-daemon_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: avahi-daemon.service\n        enabled: false\n        mask: true\n      - name: avahi-daemon.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_avahi-daemon_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_avahi-daemon\n\nclass disable_avahi-daemon {\n  service {'avahi-daemon':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_avahi-daemon_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"avahi-daemon\"]\n"
          },
          {
            "remediation_id": "service_avahi-daemon_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif ( [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && rpm --quiet -q avahi ); then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'avahi-daemon.service'\n\"$SYSTEMCTL_EXEC\" disable 'avahi-daemon.service'\n\"$SYSTEMCTL_EXEC\" mask 'avahi-daemon.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files avahi-daemon.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'avahi-daemon.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'avahi-daemon.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'avahi-daemon.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_crond_enabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_crond_enabled",
        "title": "Enable cron Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80875-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          }
        ],
        "description": "The <code>crond</code> service is used to execute commands at\npreconfigured times. It is required by almost all systems to perform necessary\nmaintenance tasks, such as notifying root of system activity.\n\nThe <code>crond</code> service can be enabled with the following command:\n<pre>$ sudo systemctl enable crond.service</pre>\n      ",
        "rationale": "Due to its usage for maintenance and security-supporting tasks,\nenabling the cron daemon is essential.",
        "oval_definition_id": "oval:ssg-service_crond_enabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_crond_enabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Enable cron Service - Enable service crond\n  block:\n\n  - name: Gather the package facts\n    package_facts:\n      manager: auto\n\n  - name: Enable cron Service - Enable Service crond\n    ansible.builtin.systemd:\n      name: crond\n      enabled: true\n      state: started\n      masked: false\n    when:\n    - '\"cronie\" in ansible_facts.packages'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80875-8\n  - NIST-800-53-CM-6(a)\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - service_crond_enabled\n"
          },
          {
            "remediation_id": "service_crond_enabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include enable_crond\n\nclass enable_crond {\n  service {'crond':\n    enable => true,\n    ensure => 'running',\n  }\n}\n"
          },
          {
            "remediation_id": "service_crond_enabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nenabled = [\"crond\"]\n"
          },
          {
            "remediation_id": "service_crond_enabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" unmask 'crond.service'\n\"$SYSTEMCTL_EXEC\" start 'crond.service'\n\"$SYSTEMCTL_EXEC\" enable 'crond.service'\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_d": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_d",
        "title": "Verify Group Who Owns cron.d",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82268-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/cron.d</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.d</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_d:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_d",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure group owner on /etc/cron.d/\n  file:\n    path: /etc/cron.d/\n    state: directory\n    group: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82268-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_d\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_d",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.d/ -maxdepth 1 -L -type d -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_daily": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_daily",
        "title": "Verify Group Who Owns cron.daily",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82234-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/cron.daily</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.daily</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_daily:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_daily",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure group owner on /etc/cron.daily/\n  file:\n    path: /etc/cron.daily/\n    state: directory\n    group: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82234-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_daily\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_daily",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.daily/ -maxdepth 1 -L -type d -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_hourly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_hourly",
        "title": "Verify Group Who Owns cron.hourly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82227-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/cron.hourly</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.hourly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_hourly:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_hourly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure group owner on /etc/cron.hourly/\n  file:\n    path: /etc/cron.hourly/\n    state: directory\n    group: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82227-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_hourly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_hourly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.hourly/ -maxdepth 1 -L -type d -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_monthly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_monthly",
        "title": "Verify Group Who Owns cron.monthly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82256-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/cron.monthly</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.monthly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_monthly:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_monthly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure group owner on /etc/cron.monthly/\n  file:\n    path: /etc/cron.monthly/\n    state: directory\n    group: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82256-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_monthly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_monthly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.monthly/ -maxdepth 1 -L -type d -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_weekly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_weekly",
        "title": "Verify Group Who Owns cron.weekly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82244-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/cron.weekly</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.weekly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_weekly:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_weekly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure group owner on /etc/cron.weekly/\n  file:\n    path: /etc/cron.weekly/\n    state: directory\n    group: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82244-5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_weekly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_weekly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.weekly/ -maxdepth 1 -L -type d -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_crontab": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_crontab",
        "title": "Verify Group Who Owns Crontab",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82223-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/crontab</code>, run the command:\n<pre>$ sudo chgrp root /etc/crontab</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_crontab:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_crontab",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/crontab\n  stat:\n    path: /etc/crontab\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82223-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/crontab\n  file:\n    path: /etc/crontab\n    group: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82223-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_crontab",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchgrp -L 0 /etc/crontab\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_d": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_d",
        "title": "Verify Owner on cron.d",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82272-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/cron.d</code>, run the command:\n<pre>$ sudo chown root /etc/cron.d </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_cron_d:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_d",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure owner on directory /etc/cron.d/\n  file:\n    path: /etc/cron.d/\n    state: directory\n    owner: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82272-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_d\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_d",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.d/ -maxdepth 1 -L -type d -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_daily": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_daily",
        "title": "Verify Owner on cron.daily",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82237-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/cron.daily</code>, run the command:\n<pre>$ sudo chown root /etc/cron.daily </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_cron_daily:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_daily",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure owner on directory /etc/cron.daily/\n  file:\n    path: /etc/cron.daily/\n    state: directory\n    owner: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82237-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_daily\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_daily",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.daily/ -maxdepth 1 -L -type d -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_hourly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_hourly",
        "title": "Verify Owner on cron.hourly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82209-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/cron.hourly</code>, run the command:\n<pre>$ sudo chown root /etc/cron.hourly </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_cron_hourly:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_hourly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure owner on directory /etc/cron.hourly/\n  file:\n    path: /etc/cron.hourly/\n    state: directory\n    owner: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82209-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_hourly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_hourly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.hourly/ -maxdepth 1 -L -type d -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_monthly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_monthly",
        "title": "Verify Owner on cron.monthly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82260-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/cron.monthly</code>, run the command:\n<pre>$ sudo chown root /etc/cron.monthly </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_cron_monthly:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_monthly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure owner on directory /etc/cron.monthly/\n  file:\n    path: /etc/cron.monthly/\n    state: directory\n    owner: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82260-1\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_monthly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_monthly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.monthly/ -maxdepth 1 -L -type d -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_weekly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_weekly",
        "title": "Verify Owner on cron.weekly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82247-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/cron.weekly</code>, run the command:\n<pre>$ sudo chown root /etc/cron.weekly </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_cron_weekly:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_weekly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Ensure owner on directory /etc/cron.weekly/\n  file:\n    path: /etc/cron.weekly/\n    state: directory\n    owner: '0'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82247-8\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_weekly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_weekly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.weekly/ -maxdepth 1 -L -type d -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_crontab": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_crontab",
        "title": "Verify Owner on crontab",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82224-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/crontab</code>, run the command:\n<pre>$ sudo chown root /etc/crontab </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_crontab:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_crontab",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/crontab\n  stat:\n    path: /etc/crontab\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82224-7\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/crontab\n  file:\n    path: /etc/crontab\n    owner: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82224-7\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_crontab",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchown -L 0 /etc/crontab\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_d": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_d",
        "title": "Verify Permissions on cron.d",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82277-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/cron.d</code>, run the command:\n<pre>$ sudo chmod 0700 /etc/cron.d</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_d:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_d",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/cron.d/ file(s)\n  command: 'find -H /etc/cron.d/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt  -type d '\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82277-5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_d\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/cron.d/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-s,g-xwrs,o-xwrt\n    state: directory\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82277-5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_d\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_d",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.d/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt -type d -exec chmod u-s,g-xwrs,o-xwrt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_daily": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_daily",
        "title": "Verify Permissions on cron.daily",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82240-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/cron.daily</code>, run the command:\n<pre>$ sudo chmod 0700 /etc/cron.daily</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_daily:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_daily",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/cron.daily/ file(s)\n  command: 'find -H /etc/cron.daily/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt  -type d '\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82240-3\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_daily\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/cron.daily/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-s,g-xwrs,o-xwrt\n    state: directory\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82240-3\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_daily\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_daily",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.daily/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt -type d -exec chmod u-s,g-xwrs,o-xwrt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_hourly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_hourly",
        "title": "Verify Permissions on cron.hourly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82230-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/cron.hourly</code>, run the command:\n<pre>$ sudo chmod 0700 /etc/cron.hourly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_hourly:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_hourly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/cron.hourly/ file(s)\n  command: 'find -H /etc/cron.hourly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt  -type\n    d '\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82230-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_hourly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/cron.hourly/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-s,g-xwrs,o-xwrt\n    state: directory\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82230-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_hourly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_hourly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.hourly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt -type d -exec chmod u-s,g-xwrs,o-xwrt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_monthly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_monthly",
        "title": "Verify Permissions on cron.monthly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82263-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/cron.monthly</code>, run the command:\n<pre>$ sudo chmod 0700 /etc/cron.monthly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_monthly:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_monthly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/cron.monthly/ file(s)\n  command: 'find -H /etc/cron.monthly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt  -type\n    d '\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82263-5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_monthly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/cron.monthly/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-s,g-xwrs,o-xwrt\n    state: directory\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82263-5\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_monthly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_monthly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.monthly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt -type d -exec chmod u-s,g-xwrs,o-xwrt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_weekly": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_weekly",
        "title": "Verify Permissions on cron.weekly",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82253-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.5"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/cron.weekly</code>, run the command:\n<pre>$ sudo chmod 0700 /etc/cron.weekly</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_weekly:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_weekly",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/cron.weekly/ file(s)\n  command: 'find -H /etc/cron.weekly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt  -type\n    d '\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82253-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_weekly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/cron.weekly/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-s,g-xwrs,o-xwrt\n    state: directory\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82253-6\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_weekly\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_weekly",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/cron.weekly/ -maxdepth 1 -perm /u+s,g+xwrs,o+xwrt -type d -exec chmod u-s,g-xwrs,o-xwrt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_crontab": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_crontab",
        "title": "Verify Permissions on crontab",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82206-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/crontab</code>, run the command:\n<pre>$ sudo chmod 0600 /etc/crontab</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_crontab:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_crontab",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/crontab\n  stat:\n    path: /etc/crontab\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82206-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /etc/crontab\n  file:\n    path: /etc/crontab\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82206-4\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_crontab\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_crontab",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchmod u-xs,g-xwrs,o-xwrt /etc/crontab\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_at_deny_not_exist": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_at_deny_not_exist",
        "title": "Ensure that /etc/at.deny does not exist",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86945-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/etc/at.deny</code> should not exist.\nUse <code>/etc/at.allow</code> instead.",
        "rationale": "Access to <code>at</code> should be restricted.\nIt is easier to manage an allow list than a deny list.",
        "oval_definition_id": "oval:ssg-file_at_deny_not_exist:def:1",
        "remediations": [
          {
            "remediation_id": "file_at_deny_not_exist",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Remove /etc/at.deny\n  file:\n    path: /etc/at.deny\n    state: absent\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86945-3\n  - PCI-DSSv4-2.2.6\n  - disable_strategy\n  - file_at_deny_not_exist\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_at_deny_not_exist",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [[ -f  /etc/at.deny ]]; then\n        rm /etc/at.deny\n    fi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_cron_allow_exists": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_cron_allow_exists",
        "title": "Ensure that /etc/cron.allow exists",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86184-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.8"
            ]
          }
        ],
        "description": "The file <code>/etc/cron.allow</code> should exist and should be used instead\nof <code>/etc/cron.deny</code>.",
        "rationale": "Access to <code>crontab</code> should be restricted.\nIt is easier to manage an allow list than a deny list.\nTherefore, <code>/etc/cron.allow</code> needs to be created and used instead of <code>/etc/cron.deny</code>.\nRegardless of the existence of any of these files, the root administrative user is always allowed to setup a crontab.",
        "oval_definition_id": "oval:ssg-file_cron_allow_exists:def:1",
        "remediations": [
          {
            "remediation_id": "file_cron_allow_exists",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Add empty /etc/cron.allow\n  file:\n    path: /etc/cron.allow\n    state: touch\n    owner: '0'\n    mode: '0600'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86184-9\n  - disable_strategy\n  - file_cron_allow_exists\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_cron_allow_exists",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\ntouch /etc/cron.allow\n    chown 0 /etc/cron.allow\n    chmod 0600 /etc/cron.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_cron_deny_not_exist": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_cron_deny_not_exist",
        "title": "Ensure that /etc/cron.deny does not exist",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86849-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The file <code>/etc/cron.deny</code> should not exist.\nUse <code>/etc/cron.allow</code> instead.",
        "rationale": "Access to <code>cron</code> should be restricted.\nIt is easier to manage an allow list than a deny list.",
        "oval_definition_id": "oval:ssg-file_cron_deny_not_exist:def:1",
        "remediations": [
          {
            "remediation_id": "file_cron_deny_not_exist",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Remove /etc/cron.deny\n  file:\n    path: /etc/cron.deny\n    state: absent\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86849-7\n  - PCI-DSSv4-2.2.6\n  - disable_strategy\n  - file_cron_deny_not_exist\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_cron_deny_not_exist",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [[ -f  /etc/cron.deny ]]; then\n        rm /etc/cron.deny\n    fi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_at_allow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_at_allow",
        "title": "Verify Group Who Owns /etc/at.allow file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87102-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "If <code>/etc/at.allow</code> exists, it must be group-owned by <code>root</code>.\n\nTo properly set the group owner of <code>/etc/at.allow</code>, run the command:\n<pre>$ sudo chgrp root /etc/at.allow</pre>\n       ",
        "rationale": "If the owner of the at.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information.",
        "oval_definition_id": "oval:ssg-file_groupowner_at_allow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_at_allow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/at.allow\n  stat:\n    path: /etc/at.allow\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87102-0\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_at_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/at.allow\n  file:\n    path: /etc/at.allow\n    group: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-87102-0\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_at_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_at_allow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchgrp -L 0 /etc/at.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_cron_allow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_cron_allow",
        "title": "Verify Group Who Owns /etc/cron.allow file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86829-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "If <code>/etc/cron.allow</code> exists, it must be group-owned by <code>root</code>.\n\nTo properly set the group owner of <code>/etc/cron.allow</code>, run the command:\n<pre>$ sudo chgrp root /etc/cron.allow</pre>\n       ",
        "rationale": "If the owner of the cron.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information.",
        "oval_definition_id": "oval:ssg-file_groupowner_cron_allow:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_cron_allow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/cron.allow\n  stat:\n    path: /etc/cron.allow\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86829-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/cron.allow\n  file:\n    path: /etc/cron.allow\n    group: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86829-9\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_groupowner_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_cron_allow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchgrp -L 0 /etc/cron.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_cron_allow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_cron_allow",
        "title": "Verify User Who Owns /etc/cron.allow file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86843-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.8"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "If <code>/etc/cron.allow</code> exists, it must be owned by <code>root</code>.\n\nTo properly set the owner of <code>/etc/cron.allow</code>, run the command:\n<pre>$ sudo chown root /etc/cron.allow </pre>\n       ",
        "rationale": "If the owner of the cron.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information.",
        "oval_definition_id": "oval:ssg-file_owner_cron_allow:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_cron_allow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/cron.allow\n  stat:\n    path: /etc/cron.allow\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86843-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/cron.allow\n  file:\n    path: /etc/cron.allow\n    owner: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86843-0\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_owner_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_cron_allow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchown -L 0 /etc/cron.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_at_allow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_at_allow",
        "title": "Verify Permissions on /etc/at.allow file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86903-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.2.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "If <code>/etc/at.allow</code> exists, it must have permissions <code>0600</code>\nor more restrictive.\n\n\nTo properly set the permissions of <code>/etc/at.allow</code>, run the command:\n<pre>$ sudo chmod 0600 /etc/at.allow</pre>\n       ",
        "rationale": "If the permissions of the at.allow file are not set to 0600 or more restrictive,\nthe possibility exists for an unauthorized user to view or edit sensitive information.",
        "oval_definition_id": "oval:ssg-file_permissions_at_allow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_at_allow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/at.allow\n  stat:\n    path: /etc/at.allow\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86903-2\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_at_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /etc/at.allow\n  file:\n    path: /etc/at.allow\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86903-2\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_at_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_at_allow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchmod u-xs,g-xwrs,o-xwrt /etc/at.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_cron_allow": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_cron_allow",
        "title": "Verify Permissions on /etc/cron.allow file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86876-0"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.1.1.8"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "If <code>/etc/cron.allow</code> exists, it must have permissions <code>0600</code>\nor more restrictive.\n\n\nTo properly set the permissions of <code>/etc/cron.allow</code>, run the command:\n<pre>$ sudo chmod 0600 /etc/cron.allow</pre>\n       ",
        "rationale": "If the permissions of the cron.allow file are not set to 0600 or more restrictive,\nthe possibility exists for an unauthorized user to view or edit sensitive information.",
        "oval_definition_id": "oval:ssg-file_permissions_cron_allow:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_cron_allow",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/cron.allow\n  stat:\n    path: /etc/cron.allow\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86876-0\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /etc/cron.allow\n  file:\n    path: /etc/cron.allow\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-86876-0\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_cron_allow\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_cron_allow",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchmod u-xs,g-xwrs,o-xwrt /etc/cron.allow\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_dhcp_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_dhcp_removed",
        "title": "Uninstall DHCP Server Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83385-5"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "If the system does not need to act as a DHCP server,\nthe dhcp package can be uninstalled.\n\nThe <code>dhcp-server</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase dhcp-server</pre>\n       ",
        "rationale": "Removing the DHCP server ensures that it cannot be easily or\naccidentally reactivated and disrupt network operation.",
        "oval_definition_id": "oval:ssg-package_dhcp_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_dhcp_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure dhcp-server is removed\n  package:\n    name: dhcp-server\n    state: absent\n  tags:\n  - CCE-83385-5\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_dhcp_removed\n"
          },
          {
            "remediation_id": "package_dhcp_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_dhcp-server\n\nclass remove_dhcp-server {\n  package { 'dhcp-server':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_dhcp_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove dhcp-server\n#\t   from the system, and may remove any packages\n#\t   that depend on dhcp-server. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"dhcp-server\" ; then\n\n    yum remove -y \"dhcp-server\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_bind_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_bind_removed",
        "title": "Uninstall bind Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-82408-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          }
        ],
        "description": "The <code>named</code> service is provided by the <code>bind</code> package.\nThe <code>bind</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase bind</pre>\n       ",
        "rationale": "If there is no need to make DNS server software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_bind_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_bind_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure bind is removed\n  package:\n    name: bind\n    state: absent\n  tags:\n  - CCE-82408-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_bind_removed\n"
          },
          {
            "remediation_id": "package_bind_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_bind\n\nclass remove_bind {\n  package { 'bind':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_bind_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove bind\n#\t   from the system, and may remove any packages\n#\t   that depend on bind. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"bind\" ; then\n\n    yum remove -y \"bind\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_ftp_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_ftp_removed",
        "title": "Remove ftp Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-90745-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.3.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "FTP (File Transfer Protocol) is a traditional and widely used standard tool for\ntransferring files between a server and clients over a network, especially where no\nauthentication is necessary (permits anonymous users to connect to a server).\n<br>\nThe <code>ftp</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase ftp</pre>\n      ",
        "rationale": "FTP does not protect the confidentiality of data or authentication credentials. It\nis recommended SFTP be used if file transfer is required. Unless there is a need\nto run the system as a FTP server (for example, to allow anonymous downloads), it is\nrecommended that the package be removed to reduce the potential attack surface.",
        "oval_definition_id": "oval:ssg-package_ftp_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_ftp_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure ftp is removed\n  package:\n    name: ftp\n    state: absent\n  tags:\n  - CCE-90745-1\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_ftp_removed\n"
          },
          {
            "remediation_id": "package_ftp_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_ftp\n\nclass remove_ftp {\n  package { 'ftp':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_ftp_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove ftp\n#\t   from the system, and may remove any packages\n#\t   that depend on ftp. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"ftp\" ; then\n\n    yum remove -y \"ftp\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_vsftpd_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_vsftpd_removed",
        "title": "Uninstall vsftpd Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-82414-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000197",
              "CCI-000366",
              "CCI-000381"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7",
              "CM-7(a)",
              "CM-7(b)",
              "CM-7.1(ii)",
              "IA-5(1)(c)",
              "IA-5(1).1(v)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000074-GPOS-00042",
              "SRG-OS-000095-GPOS-00049",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040360"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230558r627750_rule"
            ]
          }
        ],
        "description": "The <code>vsftpd</code> package can be removed with the following command: <pre> $ sudo yum erase vsftpd</pre>\n       ",
        "rationale": "Removing the <code>vsftpd</code> package decreases the risk of its\naccidental activation.",
        "oval_definition_id": "oval:ssg-package_vsftpd_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_vsftpd_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure vsftpd is removed\n  package:\n    name: vsftpd\n    state: absent\n  tags:\n  - CCE-82414-4\n  - DISA-STIG-RHEL-08-040360\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-CM-7.1(ii)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-IA-5(1).1(v)\n  - disable_strategy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_vsftpd_removed\n"
          },
          {
            "remediation_id": "package_vsftpd_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_vsftpd\n\nclass remove_vsftpd {\n  package { 'vsftpd':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_vsftpd_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove vsftpd\n#\t   from the system, and may remove any packages\n#\t   that depend on vsftpd. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"vsftpd\" ; then\n\n    yum remove -y \"vsftpd\"\n\nfi\n"
          }
        ],
        "vuln_id": "SV-230558",
        "stig_id": "RHEL-08-040360"
      },
      "xccdf_org.ssgproject.content_rule_package_httpd_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_httpd_removed",
        "title": "Uninstall httpd Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-85970-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.18"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          }
        ],
        "description": "\nThe <code>httpd</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase httpd</pre>\n       ",
        "rationale": "If there is no need to make the web server software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_httpd_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_httpd_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure httpd is removed\n  package:\n    name: httpd\n    state: absent\n  tags:\n  - CCE-85970-2\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_httpd_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_httpd_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_httpd\n\nclass remove_httpd {\n  package { 'httpd':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_httpd_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove httpd\n#\t   from the system, and may remove any packages\n#\t   that depend on httpd. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"httpd\" ; then\n\n    yum remove -y \"httpd\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_nginx_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_nginx_removed",
        "title": "Uninstall nginx Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-88034-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.18"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          }
        ],
        "description": "The <code>nginx</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase nginx</pre>\n       ",
        "rationale": "If there is no need to make the web server software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_nginx_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_nginx_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure nginx is removed\n  package:\n    name: nginx\n    state: absent\n  tags:\n  - CCE-88034-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_nginx_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_nginx_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_nginx\n\nclass remove_nginx {\n  package { 'nginx':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_nginx_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove nginx\n#\t   from the system, and may remove any packages\n#\t   that depend on nginx. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"nginx\" ; then\n\n    yum remove -y \"nginx\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_cyrus-imapd_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_cyrus-imapd_removed",
        "title": "Uninstall cyrus-imapd Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-88119-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.8"
            ]
          }
        ],
        "description": "The <code>cyrus-imapd</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase cyrus-imapd</pre>\n       ",
        "rationale": "If there is no need to make the cyrus-imapd software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_cyrus-imapd_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_cyrus-imapd_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure cyrus-imapd is removed\n  package:\n    name: cyrus-imapd\n    state: absent\n  tags:\n  - CCE-88119-3\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_cyrus-imapd_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_cyrus-imapd_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_cyrus-imapd\n\nclass remove_cyrus-imapd {\n  package { 'cyrus-imapd':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_cyrus-imapd_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove cyrus-imapd\n#\t   from the system, and may remove any packages\n#\t   that depend on cyrus-imapd. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"cyrus-imapd\" ; then\n\n    yum remove -y \"cyrus-imapd\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_dovecot_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_dovecot_removed",
        "title": "Uninstall dovecot Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-85976-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.8"
            ]
          }
        ],
        "description": "\nThe <code>dovecot</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase dovecot</pre>\n       ",
        "rationale": "If there is no need to make the Dovecot software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_dovecot_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_dovecot_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure dovecot is removed\n  package:\n    name: dovecot\n    state: absent\n  tags:\n  - CCE-85976-9\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_dovecot_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_dovecot_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_dovecot\n\nclass remove_dovecot {\n  package { 'dovecot':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_dovecot_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove dovecot\n#\t   from the system, and may remove any packages\n#\t   that depend on dovecot. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"dovecot\" ; then\n\n    yum remove -y \"dovecot\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_has_nonlocal_mta": {
        "rule_id": "xccdf_org.ssgproject.content_rule_has_nonlocal_mta",
        "title": "Ensure Mail Transfer Agent is not Listening on any non-loopback Address",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-88498-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.21"
            ]
          }
        ],
        "description": "Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate\nuser or mail server. If the system is not intended to be a mail server,\nit is recommended that the MTA be configured to only process local mail.",
        "rationale": "The software for all Mail Transfer Agents is complex and most have a\nlong history of security issues. While it is important to ensure that\nthe system can process local mail messages, it is not necessary to have\nthe MTA&#x27;s daemon listening on a port unless the server is intended to\nbe a mail server that receives and processes mail from other systems.",
        "oval_definition_id": "oval:ssg-has_nonlocal_mta:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_postfix_network_listening_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_postfix_network_listening_disabled",
        "title": "Disable Postfix Network Listening",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82174-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R74"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.21"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000382"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "1.4.2"
            ]
          }
        ],
        "description": "Edit the file <code>/etc/postfix/main.cf</code> to ensure that only the following\n<code>inet_interfaces</code> line appears:\n<pre>inet_interfaces = loopback-only\n        </pre>\n       ",
        "rationale": "This ensures <code>postfix</code> accepts mail messages\n(such as cron job reports) from the local system only,\nand not from the network, which protects it from network attack.",
        "platforms": [
          "#package_postfix"
        ],
        "oval_definition_id": "oval:ssg-postfix_network_listening_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "postfix_network_listening_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_postfix_inet_interfaces # promote to variable\n  set_fact:\n    var_postfix_inet_interfaces: !!str loopback-only\n  tags:\n    - always\n\n- name: Gather list of packages\n  package_facts:\n    manager: auto\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - ''\n  tags:\n  - CCE-82174-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-1.4.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - postfix_network_listening_disabled\n  - restrict_strategy\n\n- name: Make changes to Postfix configuration file\n  lineinfile:\n    path: /etc/postfix/main.cf\n    create: false\n    regexp: ^inet_interfaces\\s*=\\s.*\n    line: inet_interfaces = {{ var_postfix_inet_interfaces }}\n    state: present\n    insertafter: ^inet_interfaces\\s*=\\s.*\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"postfix\" in ansible_facts.packages'\n  - '\"postfix\" in ansible_facts.packages'\n  tags:\n  - CCE-82174-4\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-1.4.2\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - postfix_network_listening_disabled\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "postfix_network_listening_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { rpm --quiet -q postfix; }; then\n\nvar_postfix_inet_interfaces='loopback-only'\n\n\nif [ -e \"/etc/postfix/main.cf\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*inet_interfaces\\s\\+=\\s\\+/Id\" \"/etc/postfix/main.cf\"\nelse\n    touch \"/etc/postfix/main.cf\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/postfix/main.cf\"\n\ncp \"/etc/postfix/main.cf\" \"/etc/postfix/main.cf.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"inet_interfaces=$var_postfix_inet_interfaces\" >> \"/etc/postfix/main.cf\"\n# Clean up after ourselves.\nrm \"/etc/postfix/main.cf.bak\"\n\nsystemctl restart postfix\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_rpcbind_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_rpcbind_disabled",
        "title": "Disable rpcbind Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-82858-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.12"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "The rpcbind utility maps RPC services to the ports on which they listen.\nRPC processes notify rpcbind when they start, registering the ports they\nare listening on and the RPC program numbers they expect to serve. The\nrpcbind service redirects the client to the proper port number so it can\ncommunicate with the requested service. If the system does not require RPC\n(such as for NFS servers) then this service should be disabled.\n\nThe <code>rpcbind</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now rpcbind.service</pre>\n        ",
        "rationale": "If the system does not require rpc based services, it is recommended that\nrpcbind be disabled to reduce the attack surface.",
        "oval_definition_id": "oval:ssg-service_rpcbind_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_rpcbind_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Disable rpcbind Service - Collect systemd Services Present in the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82858-2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - service_rpcbind_disabled\n\n- name: Disable rpcbind Service - Ensure rpcbind.service is Masked\n  ansible.builtin.systemd:\n    name: rpcbind.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - service_exists.stdout_lines is search(\"rpcbind.service\", multiline=True)\n  tags:\n  - CCE-82858-2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - service_rpcbind_disabled\n\n- name: Unit Socket Exists - rpcbind.socket\n  ansible.builtin.command: systemctl -q list-unit-files rpcbind.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82858-2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - service_rpcbind_disabled\n\n- name: Disable rpcbind Service - Disable Socket rpcbind\n  ansible.builtin.systemd:\n    name: rpcbind.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - socket_file_exists.stdout_lines is search(\"rpcbind.socket\", multiline=True)\n  tags:\n  - CCE-82858-2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - service_rpcbind_disabled\n"
          },
          {
            "remediation_id": "service_rpcbind_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: rpcbind.service\n        enabled: false\n        mask: true\n      - name: rpcbind.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_rpcbind_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_rpcbind\n\nclass disable_rpcbind {\n  service {'rpcbind':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_rpcbind_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"rpcbind\"]\n"
          },
          {
            "remediation_id": "service_rpcbind_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'rpcbind.service'\n\"$SYSTEMCTL_EXEC\" disable 'rpcbind.service'\n\"$SYSTEMCTL_EXEC\" mask 'rpcbind.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files rpcbind.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'rpcbind.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'rpcbind.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'rpcbind.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_nfs_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_nfs_disabled",
        "title": "Disable Network File System (nfs)",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-82762-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.9"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.PT-3"
            ]
          }
        ],
        "description": "The Network File System (NFS) service allows remote hosts to mount\nand interact with shared filesystems on the local system. If the local system\nis not designated as a NFS server then this service should be disabled.\n\nThe <code>nfs-server</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now nfs-server.service</pre>\n        ",
        "rationale": "Unnecessary services should be disabled to decrease the attack surface of the system.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-service_nfs_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_nfs_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Disable Network File System (nfs) - Collect systemd Services Present in the\n    System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82762-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_nfs_disabled\n  - unknown_severity\n\n- name: Disable Network File System (nfs) - Ensure nfs-server.service is Masked\n  ansible.builtin.systemd:\n    name: nfs-server.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - service_exists.stdout_lines is search(\"nfs-server.service\", multiline=True)\n  tags:\n  - CCE-82762-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_nfs_disabled\n  - unknown_severity\n\n- name: Unit Socket Exists - nfs-server.socket\n  ansible.builtin.command: systemctl -q list-unit-files nfs-server.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82762-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_nfs_disabled\n  - unknown_severity\n\n- name: Disable Network File System (nfs) - Disable Socket nfs-server\n  ansible.builtin.systemd:\n    name: nfs-server.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - socket_file_exists.stdout_lines is search(\"nfs-server.socket\", multiline=True)\n  tags:\n  - CCE-82762-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_nfs_disabled\n  - unknown_severity\n"
          },
          {
            "remediation_id": "service_nfs_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: nfs-server.service\n        enabled: false\n        mask: true\n      - name: nfs-server.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_nfs_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_nfs-server\n\nclass disable_nfs-server {\n  service {'nfs-server':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_nfs_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"nfs-server\"]\n"
          },
          {
            "remediation_id": "service_nfs_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'nfs-server.service'\n\"$SYSTEMCTL_EXEC\" disable 'nfs-server.service'\n\"$SYSTEMCTL_EXEC\" mask 'nfs-server.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files nfs-server.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'nfs-server.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'nfs-server.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'nfs-server.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_chrony_installed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_chrony_installed",
        "title": "The Chrony package is installed",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82874-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R71"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.1.1"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000355-GPOS-00143"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FMT_SMF_EXT.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.6.1"
            ]
          }
        ],
        "description": "System time should be synchronized between all systems in an environment. This is\ntypically done by establishing an authoritative time server or set of servers and having all\nsystems synchronize their clocks to them.\nThe <code>chrony</code> package can be installed with the following command:\n<pre>\n$ sudo yum install chrony</pre>\n      ",
        "rationale": "Time synchronization is important to support time sensitive security mechanisms like\nKerberos and also ensures log files have consistent time records across the enterprise,\nwhich aids in forensic investigations.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-package_chrony_installed:def:1",
        "remediations": [
          {
            "remediation_id": "package_chrony_installed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "- name: Ensure chrony is installed\n  package:\n    name: chrony\n    state: present\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82874-9\n  - PCI-DSS-Req-10.4\n  - PCI-DSSv4-10.6.1\n  - enable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_chrony_installed\n"
          },
          {
            "remediation_id": "package_chrony_installed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include install_chrony\n\nclass install_chrony {\n  package { 'chrony':\n    ensure => 'installed',\n  }\n}\n"
          },
          {
            "remediation_id": "package_chrony_installed",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[[packages]]\nname = \"chrony\"\nversion = \"*\"\n"
          },
          {
            "remediation_id": "package_chrony_installed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif ! rpm -q --quiet \"chrony\" ; then\n    yum install -y \"chrony\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_chronyd_specify_remote_server": {
        "rule_id": "xccdf_org.ssgproject.content_rule_chronyd_specify_remote_server",
        "title": "A remote time server for Chrony is configured",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82873-1"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R71"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.1.2"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000160",
              "CCI-001891"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0988",
              "1405"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AU-8(1)(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000355-GPOS-00143"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-10.4.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.6.2"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-030740"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230484r877038_rule"
            ]
          }
        ],
        "description": "<code>Chrony</code> is a daemon which implements the Network Time Protocol (NTP). It is designed\nto synchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on <code>chrony</code> can be found at\n\n    <a href=\"https://chrony-project.org/\">https://chrony-project.org/</a>.\n<code>Chrony</code> can be configured to be a client and/or a server.\nAdd or edit server or pool lines to <code>/etc/chrony.conf</code> as appropriate:\n<pre>server &lt;remote-server&gt;</pre>\nMultiple servers may be configured.",
        "rationale": "If <code>chrony</code> is in use on the system proper configuration is vital to ensuring time\nsynchronization is working properly.",
        "platforms": [
          "#package_chrony"
        ],
        "oval_definition_id": "oval:ssg-chronyd_specify_remote_server:def:1",
        "remediations": [
          {
            "remediation_id": "chronyd_specify_remote_server",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82873-1\n  - DISA-STIG-RHEL-08-030740\n  - NIST-800-53-AU-8(1)(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.4.3\n  - PCI-DSSv4-10.6.2\n  - chronyd_specify_remote_server\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n- name: XCCDF Value var_multiple_time_servers # promote to variable\n  set_fact:\n    var_multiple_time_servers: !!str 0.rhel.pool.ntp.org,1.rhel.pool.ntp.org,2.rhel.pool.ntp.org,3.rhel.pool.ntp.org\n  tags:\n    - always\n\n- name: Detect if chrony is already configured with pools or servers\n  find:\n    path: /etc\n    patterns: chrony.conf\n    contains: ^[\\s]*(?:server|pool)[\\s]+[\\w]+\n  register: chrony_servers\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"chrony\" in ansible_facts.packages'\n  tags:\n  - CCE-82873-1\n  - DISA-STIG-RHEL-08-030740\n  - NIST-800-53-AU-8(1)(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.4.3\n  - PCI-DSSv4-10.6.2\n  - chronyd_specify_remote_server\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Configure remote time servers\n  lineinfile:\n    path: /etc/chrony.conf\n    line: server {{ item }}\n    state: present\n    create: true\n  loop: '{{ var_multiple_time_servers.split(\",\") }}'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"chrony\" in ansible_facts.packages'\n  - chrony_servers.matched == 0\n  tags:\n  - CCE-82873-1\n  - DISA-STIG-RHEL-08-030740\n  - NIST-800-53-AU-8(1)(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-10.4.3\n  - PCI-DSSv4-10.6.2\n  - chronyd_specify_remote_server\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "chronyd_specify_remote_server",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { rpm --quiet -q chrony; }; then\n\nvar_multiple_time_servers='0.rhel.pool.ntp.org,1.rhel.pool.ntp.org,2.rhel.pool.ntp.org,3.rhel.pool.ntp.org'\n\n\nconfig_file=\"/etc/chrony.conf\"\n\nif ! grep -q '^[[:space:]]*\\(server\\|pool\\)[[:space:]]\\+[[:graph:]]\\+' \"$config_file\" ; then\n  if ! grep -q '#[[:space:]]*server' \"$config_file\" ; then\n    for server in $(echo \"$var_multiple_time_servers\" | tr ',' '\\n') ; do\n      printf '\\nserver %s' \"$server\" >> \"$config_file\"\n    done\n  else\n    sed -i 's/#[ \\t]*server/server/g' \"$config_file\"\n  fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230484",
        "stig_id": "RHEL-08-030740"
      },
      "xccdf_org.ssgproject.content_rule_chronyd_run_as_chrony_user": {
        "rule_id": "xccdf_org.ssgproject.content_rule_chronyd_run_as_chrony_user",
        "title": "Ensure that chronyd is running under chrony user account",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82879-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.1.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "10.6.3"
            ]
          }
        ],
        "description": "chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on chrony can be found at\n\n    <a href=\"https://chrony-project.org/\">https://chrony-project.org/</a>.\nChrony can be configured to be a client and/or a server.\nTo ensure that chronyd is running under chrony user account,\nremove any <code>-u ...</code> option from <code>OPTIONS</code> other than <code>-u chrony</code>,\nas chrony is run under its own user by default.\nThis recommendation only applies if chrony is in use on the system.",
        "rationale": "If chrony is in use on the system proper configuration is vital to ensuring time synchronization\nis working properly.",
        "platforms": [
          "#package_chrony"
        ],
        "oval_definition_id": "oval:ssg-chronyd_run_as_chrony_user:def:1",
        "remediations": [
          {
            "remediation_id": "chronyd_run_as_chrony_user",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-82879-8\n  - PCI-DSSv4-10.6.3\n  - chronyd_run_as_chrony_user\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Detect if file /etc/sysconfig/chronyd is not empty or missing\n  find:\n    path: /etc/sysconfig/\n    patterns: chronyd\n    contains: ^([\\s]*OPTIONS=[\"]?[^\"]*)(\"?)\n  register: chronyd_file\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"chrony\" in ansible_facts.packages'\n  tags:\n  - CCE-82879-8\n  - PCI-DSSv4-10.6.3\n  - chronyd_run_as_chrony_user\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Remove any previous configuration of user used to run chronyd process\n  replace:\n    path: /etc/sysconfig/chronyd\n    regexp: \\s*-u\\s*\\w+\\s*\n    replace: ' '\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - '\"chrony\" in ansible_facts.packages'\n  - chronyd_file is defined and chronyd_file.matched > 0\n  tags:\n  - CCE-82879-8\n  - PCI-DSSv4-10.6.3\n  - chronyd_run_as_chrony_user\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "chronyd_run_as_chrony_user",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { rpm --quiet -q chrony; }; then\n\nif grep -q 'OPTIONS=.*' /etc/sysconfig/chronyd; then\n\t# trying to solve cases where the parameter after OPTIONS\n\t#may or may not be enclosed in quotes\n\tsed -i -E -e 's/\\s*-u\\s*\\w+\\s*/ /' -e 's/^([\\s]*OPTIONS=[\"]?[^\"]*)(\"?)/\\1\\2/' /etc/sysconfig/chronyd\nfi\n\nif grep -q 'OPTIONS=.*' /etc/sysconfig/chronyd; then\n\t# trying to solve cases where the parameter after OPTIONS\n\t#may or may not be enclosed in quotes\n\tsed -i -E -e 's/\\s*-u\\s*\\w+\\s*/ /' -e 's/^([\\s]*OPTIONS=[\"]?[^\"]*)(\"?)/\\1 -u chrony\\2/' /etc/sysconfig/chronyd\nelse\n\techo 'OPTIONS=\"-u chrony\"' >> /etc/sysconfig/chronyd\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_rsync_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_rsync_removed",
        "title": "Uninstall rsync Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86335-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.13"
            ]
          }
        ],
        "description": "The rsyncd service can be used to synchronize files between systems over network links.\nThe <code>rsync-daemon</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase rsync-daemon</pre>\n      ",
        "rationale": "The rsyncd service presents a security risk as it uses unencrypted protocols for\ncommunication.",
        "oval_definition_id": "oval:ssg-package_rsync_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_rsync_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure rsync-daemon is removed\n  package:\n    name: rsync-daemon\n    state: absent\n  tags:\n  - CCE-86335-7\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - package_rsync_removed\n"
          },
          {
            "remediation_id": "package_rsync_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_rsync-daemon\n\nclass remove_rsync-daemon {\n  package { 'rsync-daemon':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_rsync_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove rsync-daemon\n#\t   from the system, and may remove any packages\n#\t   that depend on rsync-daemon. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"rsync-daemon\" ; then\n\n    yum remove -y \"rsync-daemon\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_xinetd_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_xinetd_removed",
        "title": "Uninstall xinetd Package",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-80850-1"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.19"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000305"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "The <code>xinetd</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase xinetd</pre>\n       ",
        "rationale": "Removing the <code>xinetd</code> package decreases the risk of the\nxinetd service&#x27;s accidental (or intentional) activation.",
        "oval_definition_id": "oval:ssg-package_xinetd_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_xinetd_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure xinetd is removed\n  package:\n    name: xinetd\n    state: absent\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80850-1\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_xinetd_removed\n"
          },
          {
            "remediation_id": "package_xinetd_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_xinetd\n\nclass remove_xinetd {\n  package { 'xinetd':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_xinetd_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# CAUTION: This remediation script will remove xinetd\n#\t   from the system, and may remove any packages\n#\t   that depend on xinetd. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"xinetd\" ; then\n\n    yum remove -y \"xinetd\"\n\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_ypbind_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_ypbind_removed",
        "title": "Remove NIS Client",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-82181-9"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.3.3"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "The Network Information Service (NIS), formerly known as Yellow Pages,\nis a client-server directory service protocol used to distribute system configuration\nfiles. The NIS client (<code>ypbind</code>) was used to bind a system to an NIS server\nand receive the distributed configuration files.",
        "rationale": "The NIS service is inherently an insecure system that has been vulnerable\nto DOS attacks, buffer overflows and has poor authentication for querying\nNIS maps. NIS generally has been replaced by such protocols as Lightweight\nDirectory Access Protocol (LDAP). It is recommended that the service be\nremoved.",
        "oval_definition_id": "oval:ssg-package_ypbind_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_ypbind_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure ypbind is removed\n  package:\n    name: ypbind\n    state: absent\n  tags:\n  - CCE-82181-9\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_ypbind_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_ypbind_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_ypbind\n\nclass remove_ypbind {\n  package { 'ypbind':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_ypbind_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove ypbind\n#\t   from the system, and may remove any packages\n#\t   that depend on ypbind. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"ypbind\" ; then\n\n    yum remove -y \"ypbind\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_ypserv_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_ypserv_removed",
        "title": "Uninstall ypserv Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-82432-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.10"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000381"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "IA-5(1)(c)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000095-GPOS-00049"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "The <code>ypserv</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase ypserv</pre>\n       ",
        "rationale": "The NIS service provides an unencrypted authentication service which does\nnot provide for the confidentiality and integrity of user passwords or the\nremote session.\n\nRemoving the <code>ypserv</code> package decreases the risk of the accidental\n(or intentional) activation of NIS or NIS+ services.",
        "oval_definition_id": "oval:ssg-package_ypserv_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_ypserv_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure ypserv is removed\n  package:\n    name: ypserv\n    state: absent\n  tags:\n  - CCE-82432-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-IA-5(1)(c)\n  - PCI-DSS-Req-2.2.2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_ypserv_removed\n"
          },
          {
            "remediation_id": "package_ypserv_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_ypserv\n\nclass remove_ypserv {\n  package { 'ypserv':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_ypserv_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove ypserv\n#\t   from the system, and may remove any packages\n#\t   that depend on ypserv. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"ypserv\" ; then\n\n    yum remove -y \"ypserv\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_no_rsh_trust_files": {
        "rule_id": "xccdf_org.ssgproject.content_rule_no_rsh_trust_files",
        "title": "Remove Rsh Trust Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80842-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "6.2.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-001436"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          }
        ],
        "description": "The files <code>/etc/hosts.equiv</code> and <code>~/.rhosts</code> (in\neach user&#x27;s home directory) list remote hosts and users that are trusted by the\nlocal system when using the rshd daemon.\nTo remove these files, run the following command to delete them from any\nlocation:\n<pre>$ sudo rm /etc/hosts.equiv</pre>\n        <pre>$ rm ~/.rhosts</pre>\n       ",
        "rationale": "This action is only meaningful if <code>.rhosts</code> support is permitted\nthrough PAM. Trust files are convenient, but when used in conjunction with\nthe R-services, they can allow unauthenticated access to a system.",
        "platforms": [
          "#package_rsh-server"
        ],
        "oval_definition_id": "oval:ssg-no_rsh_trust_files:def:1",
        "remediations": [
          {
            "remediation_id": "no_rsh_trust_files",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Gather the package facts\n  package_facts:\n    manager: auto\n  tags:\n  - CCE-80842-8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - no_rsh_trust_files\n  - restrict_strategy\n\n- name: Detect .rhosts files in users home directories\n  find:\n    paths:\n    - /root\n    - /home\n    recurse: true\n    patterns: .rhosts\n    hidden: true\n    file_type: file\n  check_mode: false\n  register: rhosts_locations\n  when: '\"rsh-server\" in ansible_facts.packages'\n  tags:\n  - CCE-80842-8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - no_rsh_trust_files\n  - restrict_strategy\n\n- name: Remove .rhosts files\n  file:\n    path: '{{ item }}'\n    state: absent\n  with_items: '{{ rhosts_locations.files | map(attribute=''path'') | list }}'\n  when:\n  - '\"rsh-server\" in ansible_facts.packages'\n  - rhosts_locations is success\n  tags:\n  - CCE-80842-8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - no_rsh_trust_files\n  - restrict_strategy\n\n- name: Remove /etc/hosts.equiv file\n  file:\n    path: /etc/hosts.equiv\n    state: absent\n  when: '\"rsh-server\" in ansible_facts.packages'\n  tags:\n  - CCE-80842-8\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - no_rsh_trust_files\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "no_rsh_trust_files",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif rpm --quiet -q rsh-server; then\n\nfind /root -xdev -type f -name \".rhosts\" -exec rm -f {} \\;\nfind /home -maxdepth 2 -xdev -type f -name \".rhosts\" -exec rm -f {} \\;\nrm -f /etc/hosts.equiv\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_telnet-server_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_telnet-server_removed",
        "title": "Uninstall telnet-server Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-82182-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.15"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000381"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000095-GPOS-00049"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.2"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040000"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230487r627750_rule"
            ]
          }
        ],
        "description": "The <code>telnet-server</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase telnet-server</pre>\n       ",
        "rationale": "It is detrimental for operating systems to provide, or install by default,\nfunctionality exceeding requirements or mission objectives. These\nunnecessary capabilities are often overlooked and therefore may remain\nunsecure. They increase the risk to the platform by providing additional\nattack vectors.\n<br>\nThe telnet service provides an unencrypted remote access service which does\nnot provide for the confidentiality and integrity of user passwords or the\nremote session. If a privileged user were to login using this service, the\nprivileged user password could be compromised.\n<br>\nRemoving the <code>telnet-server</code> package decreases the risk of the\ntelnet service&#x27;s accidental (or intentional) activation.",
        "oval_definition_id": "oval:ssg-package_telnet-server_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_telnet-server_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure telnet-server is removed\n  package:\n    name: telnet-server\n    state: absent\n  tags:\n  - CCE-82182-7\n  - DISA-STIG-RHEL-08-040000\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-2.2.2\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_telnet-server_removed\n"
          },
          {
            "remediation_id": "package_telnet-server_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_telnet-server\n\nclass remove_telnet-server {\n  package { 'telnet-server':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_telnet-server_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove telnet-server\n#\t   from the system, and may remove any packages\n#\t   that depend on telnet-server. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"telnet-server\" ; then\n\n    yum remove -y \"telnet-server\"\n\nfi\n"
          }
        ],
        "vuln_id": "SV-230487",
        "stig_id": "RHEL-08-040000"
      },
      "xccdf_org.ssgproject.content_rule_package_telnet_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_telnet_removed",
        "title": "Remove telnet Clients",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-80849-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.3.4"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.13"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.13.1.1",
              "A.13.2.1",
              "A.13.2.3",
              "A.14.1.2",
              "A.14.1.3",
              "A.8.2.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "The telnet client allows users to start connections to other systems via\nthe telnet protocol.",
        "rationale": "The <code>telnet</code> protocol is insecure and unencrypted. The use\nof an unencrypted transmission medium could allow an unauthorized user\nto steal credentials. The <code>ssh</code> package provides an\nencrypted session and stronger security and is included in Red Hat Enterprise Linux 8.",
        "oval_definition_id": "oval:ssg-package_telnet_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_telnet_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure telnet is removed\n  package:\n    name: telnet\n    state: absent\n  tags:\n  - CCE-80849-3\n  - NIST-800-171-3.1.13\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_telnet_removed\n"
          },
          {
            "remediation_id": "package_telnet_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_telnet\n\nclass remove_telnet {\n  package { 'telnet':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_telnet_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove telnet\n#\t   from the system, and may remove any packages\n#\t   that depend on telnet. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"telnet\" ; then\n\n    yum remove -y \"telnet\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_tftp-server_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_tftp-server_removed",
        "title": "Uninstall tftp-server Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-82436-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.16"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "3",
              "8",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000318",
              "CCI-000366",
              "CCI-000368",
              "CCI-001812",
              "CCI-001813",
              "CCI-001814"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.2.1",
              "A.6.2.2",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-3",
              "PR.IP-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-040190"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230533r627750_rule"
            ]
          }
        ],
        "description": "The <code>tftp-server</code> package can be removed with the following command: <pre> $ sudo yum erase tftp-server</pre>\n       ",
        "rationale": "Removing the <code>tftp-server</code> package decreases the risk of the accidental\n(or intentional) activation of tftp services.\n<br>\n        <br>\nIf TFTP is required for operational support (such as transmission of router\nconfigurations), its use must be documented with the Information Systems\nSecurty Manager (ISSM), restricted to only authorized personnel, and have\naccess control rules established.",
        "oval_definition_id": "oval:ssg-package_tftp-server_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_tftp-server_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure tftp-server is removed\n  package:\n    name: tftp-server\n    state: absent\n  tags:\n  - CCE-82436-7\n  - DISA-STIG-RHEL-08-040190\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_tftp-server_removed\n"
          },
          {
            "remediation_id": "package_tftp-server_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_tftp-server\n\nclass remove_tftp-server {\n  package { 'tftp-server':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_tftp-server_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove tftp-server\n#\t   from the system, and may remove any packages\n#\t   that depend on tftp-server. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"tftp-server\" ; then\n\n    yum remove -y \"tftp-server\"\n\nfi\n"
          }
        ],
        "vuln_id": "SV-230533",
        "stig_id": "RHEL-08-040190"
      },
      "xccdf_org.ssgproject.content_rule_package_tftp_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_tftp_removed",
        "title": "Remove tftp Daemon",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "low",
        "weight": 1,
        "identifiers": [
          "CCE-83590-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R62"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.3.5"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "Trivial File Transfer Protocol (TFTP) is a simple file transfer protocol,\ntypically used to automatically transfer configuration or boot files between systems.\nTFTP does not support authentication and can be easily hacked. The package\n<code>tftp</code> is a client program that allows for connections to a <code>tftp</code> server.",
        "rationale": "It is recommended that TFTP be removed, unless there is a specific need\nfor TFTP (such as a boot server). In that case, use extreme caution when configuring\nthe services.",
        "oval_definition_id": "oval:ssg-package_tftp_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_tftp_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure tftp is removed\n  package:\n    name: tftp\n    state: absent\n  tags:\n  - CCE-83590-0\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - low_severity\n  - no_reboot_needed\n  - package_tftp_removed\n"
          },
          {
            "remediation_id": "package_tftp_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_tftp\n\nclass remove_tftp {\n  package { 'tftp':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_tftp_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove tftp\n#\t   from the system, and may remove any packages\n#\t   that depend on tftp. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"tftp\" ; then\n\n    yum remove -y \"tftp\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_service_cups_disabled": {
        "rule_id": "xccdf_org.ssgproject.content_rule_service_cups_disabled",
        "title": "Disable the CUPS Service",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-82861-6"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.11"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "14",
              "3",
              "9"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.05",
              "DSS06.06"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.9.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1",
              "PR.PT-3"
            ]
          }
        ],
        "description": "\nThe <code>cups</code> service can be disabled with the following command:\n<pre>$ sudo systemctl mask --now cups.service</pre>\n      ",
        "rationale": "Turn off unneeded services to reduce attack surface.",
        "platforms": [
          "#machine"
        ],
        "oval_definition_id": "oval:ssg-service_cups_disabled:def:1",
        "remediations": [
          {
            "remediation_id": "service_cups_disabled",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Disable the CUPS Service - Collect systemd Services Present in the System\n  ansible.builtin.command: systemctl -q list-unit-files --type service\n  register: service_exists\n  changed_when: false\n  failed_when: service_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82861-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_cups_disabled\n  - unknown_severity\n\n- name: Disable the CUPS Service - Ensure cups.service is Masked\n  ansible.builtin.systemd:\n    name: cups.service\n    state: stopped\n    enabled: false\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - service_exists.stdout_lines is search(\"cups.service\", multiline=True)\n  tags:\n  - CCE-82861-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_cups_disabled\n  - unknown_severity\n\n- name: Unit Socket Exists - cups.socket\n  ansible.builtin.command: systemctl -q list-unit-files cups.socket\n  register: socket_file_exists\n  changed_when: false\n  failed_when: socket_file_exists.rc not in [0, 1]\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82861-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_cups_disabled\n  - unknown_severity\n\n- name: Disable the CUPS Service - Disable Socket cups\n  ansible.builtin.systemd:\n    name: cups.socket\n    enabled: false\n    state: stopped\n    masked: true\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - socket_file_exists.stdout_lines is search(\"cups.socket\", multiline=True)\n  tags:\n  - CCE-82861-6\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - service_cups_disabled\n  - unknown_severity\n"
          },
          {
            "remediation_id": "service_cups_disabled",
            "system": "urn:xccdf:fix:script:kubernetes",
            "complexity": "low",
            "disruption": "medium",
            "strategy": "disable",
            "fix": "apiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    systemd:\n      units:\n      - name: cups.service\n        enabled: false\n        mask: true\n      - name: cups.socket\n        enabled: false\n        mask: true\n"
          },
          {
            "remediation_id": "service_cups_disabled",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "enable",
            "fix": "include disable_cups\n\nclass disable_cups {\n  service {'cups':\n    enable => false,\n    ensure => 'stopped',\n  }\n}\n"
          },
          {
            "remediation_id": "service_cups_disabled",
            "system": "urn:redhat:osbuild:blueprint",
            "fix": "\n[customizations.services]\nmasked = [\"cups\"]\n"
          },
          {
            "remediation_id": "service_cups_disabled",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nSYSTEMCTL_EXEC='/usr/bin/systemctl'\n\"$SYSTEMCTL_EXEC\" stop 'cups.service'\n\"$SYSTEMCTL_EXEC\" disable 'cups.service'\n\"$SYSTEMCTL_EXEC\" mask 'cups.service'\n# Disable socket activation if we have a unit file for it\nif \"$SYSTEMCTL_EXEC\" -q list-unit-files cups.socket; then\n    \"$SYSTEMCTL_EXEC\" stop 'cups.socket'\n    \"$SYSTEMCTL_EXEC\" mask 'cups.socket'\nfi\n# The service may not be running because it has been started and failed,\n# so let's reset the state so OVAL checks pass.\n# Service should be 'inactive', not 'failed' after reboot though.\n\"$SYSTEMCTL_EXEC\" reset-failed 'cups.service' || true\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_squid_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_squid_removed",
        "title": "Uninstall squid Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-82189-2"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.17"
            ]
          }
        ],
        "description": "The <code>squid</code> package can be removed with the following command: <pre> $ sudo yum erase squid</pre>\n       ",
        "rationale": "If there is no need to make the proxy server software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_squid_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_squid_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure squid is removed\n  package:\n    name: squid\n    state: absent\n  tags:\n  - CCE-82189-2\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_squid_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_squid_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_squid\n\nclass remove_squid {\n  package { 'squid':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_squid_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove squid\n#\t   from the system, and may remove any packages\n#\t   that depend on squid. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"squid\" ; then\n\n    yum remove -y \"squid\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_samba_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_samba_removed",
        "title": "Uninstall Samba Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-85978-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>samba</code> package can be removed with the following command: <pre> $ sudo yum erase samba</pre>\n       ",
        "rationale": "If there is no need to make the Samba software available,\nremoving it provides a safeguard against its activation.",
        "oval_definition_id": "oval:ssg-package_samba_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_samba_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure samba is removed\n  package:\n    name: samba\n    state: absent\n  tags:\n  - CCE-85978-5\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_samba_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_samba_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_samba\n\nclass remove_samba {\n  package { 'samba':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_samba_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove samba\n#\t   from the system, and may remove any packages\n#\t   that depend on samba. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"samba\" ; then\n\n    yum remove -y \"samba\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_package_net-snmp_removed": {
        "rule_id": "xccdf_org.ssgproject.content_rule_package_net-snmp_removed",
        "title": "Uninstall net-snmp Package",
        "result": "pass",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-85980-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "2.2.14"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.4"
            ]
          }
        ],
        "description": "\nThe <code>net-snmp</code> package provides the snmpd service.\nThe <code>net-snmp</code> package can be removed with the following command:\n<pre>\n$ sudo yum erase net-snmp</pre>\n       ",
        "rationale": "If there is no need to run SNMP server software,\nremoving the package provides a safeguard against its\nactivation.",
        "oval_definition_id": "oval:ssg-package_net-snmp_removed:def:1",
        "remediations": [
          {
            "remediation_id": "package_net-snmp_removed",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "- name: Ensure net-snmp is removed\n  package:\n    name: net-snmp\n    state: absent\n  tags:\n  - CCE-85980-1\n  - PCI-DSSv4-2.2.4\n  - disable_strategy\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - package_net-snmp_removed\n  - unknown_severity\n"
          },
          {
            "remediation_id": "package_net-snmp_removed",
            "system": "urn:xccdf:fix:script:puppet",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "include remove_net-snmp\n\nclass remove_net-snmp {\n  package { 'net-snmp':\n    ensure => 'purged',\n  }\n}\n"
          },
          {
            "remediation_id": "package_net-snmp_removed",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "disable",
            "fix": "\n# CAUTION: This remediation script will remove net-snmp\n#\t   from the system, and may remove any packages\n#\t   that depend on net-snmp. Execute this\n#\t   remediation AFTER testing on a non-production\n#\t   system!\n\nif rpm -q --quiet \"net-snmp\" ; then\n\n    yum remove -y \"net-snmp\"\n\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupowner_sshd_config": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupowner_sshd_config",
        "title": "Verify Group Who Owns SSH Server config file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82901-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "\nTo properly set the group owner of <code>/etc/ssh/sshd_config</code>, run the command:\n<pre>$ sudo chgrp root /etc/ssh/sshd_config</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_groupowner_sshd_config:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupowner_sshd_config",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/ssh/sshd_config\n  stat:\n    path: /etc/ssh/sshd_config\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82901-0\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_groupowner_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner 0 on /etc/ssh/sshd_config\n  file:\n    path: /etc/ssh/sshd_config\n    group: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82901-0\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_groupowner_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupowner_sshd_config",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchgrp -L 0 /etc/ssh/sshd_config\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_private_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_private_key",
        "title": "Verify Group Ownership on SSH Server Private *_key Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86126-0"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.2"
            ]
          }
        ],
        "description": "SSH server private keys, files that match the <code>/etc/ssh/*_key</code> glob, must be\ngroup-owned by <code>ssh_keys</code> group.",
        "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
        "oval_definition_id": "oval:ssg-file_groupownership_sshd_private_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupownership_sshd_private_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/ssh/ file(s) matching ^.*_key$\n  command: find -H /etc/ssh/ -maxdepth 1 -type f ! -group ssh_keys -regextype posix-extended\n    -regex \"^.*_key$\"\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86126-0\n  - configure_strategy\n  - file_groupownership_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner on /etc/ssh/ file(s) matching ^.*_key$\n  file:\n    path: '{{ item }}'\n    group: ssh_keys\n    state: file\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86126-0\n  - configure_strategy\n  - file_groupownership_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupownership_sshd_private_key",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind /etc/ssh/ -maxdepth 1 -L -type f ! -group ssh_keys -regextype posix-extended -regex '^.*_key$' -exec chgrp -L ssh_keys {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_pub_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_groupownership_sshd_pub_key",
        "title": "Verify Group Ownership on SSH Server Public *.pub Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86133-6"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.3"
            ]
          }
        ],
        "description": "SSH server public keys, files that match the <code>/etc/ssh/*.pub</code> glob, must be\ngroup-owned by <code>root</code> group.",
        "rationale": "If a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised.",
        "oval_definition_id": "oval:ssg-file_groupownership_sshd_pub_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_groupownership_sshd_pub_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/ssh/ file(s) matching ^.*\\.pub$\n  command: find -H /etc/ssh/ -maxdepth 1 -type f ! -group 0 -regextype posix-extended\n    -regex \"^.*\\.pub$\"\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86133-6\n  - configure_strategy\n  - file_groupownership_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure group owner on /etc/ssh/ file(s) matching ^.*\\.pub$\n  file:\n    path: '{{ item }}'\n    group: '0'\n    state: file\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86133-6\n  - configure_strategy\n  - file_groupownership_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_groupownership_sshd_pub_key",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind /etc/ssh/ -maxdepth 1 -L -type f ! -group 0 -regextype posix-extended -regex '^.*\\.pub$' -exec chgrp -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_owner_sshd_config": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_owner_sshd_config",
        "title": "Verify Owner on SSH Server config file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82898-8"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          }
        ],
        "description": "\nTo properly set the owner of <code>/etc/ssh/sshd_config</code>, run the command:\n<pre>$ sudo chown root /etc/ssh/sshd_config </pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_owner_sshd_config:def:1",
        "remediations": [
          {
            "remediation_id": "file_owner_sshd_config",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/ssh/sshd_config\n  stat:\n    path: /etc/ssh/sshd_config\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82898-8\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_owner_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner 0 on /etc/ssh/sshd_config\n  file:\n    path: /etc/ssh/sshd_config\n    owner: '0'\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82898-8\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - configure_strategy\n  - file_owner_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_owner_sshd_config",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchown -L 0 /etc/ssh/sshd_config\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_ownership_sshd_private_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_ownership_sshd_private_key",
        "title": "Verify Ownership on SSH Server Private *_key Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86118-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.2"
            ]
          }
        ],
        "description": "SSH server private keys, files that match the <code>/etc/ssh/*_key</code> glob, must be owned\nby <code>root</code> user.",
        "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be impersonated.",
        "oval_definition_id": "oval:ssg-file_ownership_sshd_private_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_ownership_sshd_private_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/ssh/ file(s) matching ^.*_key$\n  command: find -H /etc/ssh/ -maxdepth 1 -type f ! -uid 0 -regextype posix-extended\n    -regex \"^.*_key$\"\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86118-7\n  - configure_strategy\n  - file_ownership_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner on /etc/ssh/ file(s) matching ^.*_key$\n  file:\n    path: '{{ item }}'\n    owner: '0'\n    state: file\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86118-7\n  - configure_strategy\n  - file_ownership_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_ownership_sshd_private_key",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind /etc/ssh/ -maxdepth 1 -L -type f ! -uid 0 -regextype posix-extended -regex '^.*_key$' -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_ownership_sshd_pub_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_ownership_sshd_pub_key",
        "title": "Verify Ownership on SSH Server Public *.pub Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86129-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.3"
            ]
          }
        ],
        "description": "SSH server public keys, files that match the <code>/etc/ssh/*.pub</code> glob, must be owned\nby <code>root</code> user.",
        "rationale": "If a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised.",
        "oval_definition_id": "oval:ssg-file_ownership_sshd_pub_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_ownership_sshd_pub_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/ssh/ file(s) matching ^.*\\.pub$\n  command: find -H /etc/ssh/ -maxdepth 1 -type f ! -uid 0 -regextype posix-extended\n    -regex \"^.*\\.pub$\"\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86129-4\n  - configure_strategy\n  - file_ownership_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure owner on /etc/ssh/ file(s) matching ^.*\\.pub$\n  file:\n    path: '{{ item }}'\n    owner: '0'\n    state: file\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86129-4\n  - configure_strategy\n  - file_ownership_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_ownership_sshd_pub_key",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind /etc/ssh/ -maxdepth 1 -L -type f ! -uid 0 -regextype posix-extended -regex '^.*\\.pub$' -exec chown -L 0 {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_sshd_config": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_config",
        "title": "Verify Permissions on SSH Server config file",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82894-7"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.1"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "\nTo properly set the permissions of <code>/etc/ssh/sshd_config</code>, run the command:\n<pre>$ sudo chmod 0600 /etc/ssh/sshd_config</pre>\n      ",
        "rationale": "Service configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes.",
        "oval_definition_id": "oval:ssg-file_permissions_sshd_config:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_sshd_config",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Test for existence /etc/ssh/sshd_config\n  stat:\n    path: /etc/ssh/sshd_config\n  register: file_exists\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82894-7\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Ensure permission u-xs,g-xwrs,o-xwrt on /etc/ssh/sshd_config\n  file:\n    path: /etc/ssh/sshd_config\n    mode: u-xs,g-xwrs,o-xwrt\n  when:\n  - ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  - file_exists.stat is defined and file_exists.stat.exists\n  tags:\n  - CCE-82894-7\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_config\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_sshd_config",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nchmod u-xs,g-xwrs,o-xwrt /etc/ssh/sshd_config\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_sshd_private_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_private_key",
        "title": "Verify Permissions on SSH Server Private *_key Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82424-3"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.2"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.13",
              "3.13.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010490"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230287r880714_rule"
            ]
          }
        ],
        "description": "SSH server private keys - files that match the <code>/etc/ssh/*_key</code> glob, have to have restricted permissions.\nIf those files are owned by the <code>root</code> user and the <code>root</code> group, they have to have the <code>0600</code> permission or stricter.\nIf they are owned by the <code>root</code> user, but by a dedicated group <code>ssh_keys</code>, they can have the <code>0640</code> permission or stricter.",
        "rationale": "If an unauthorized user obtains the private SSH host key file, the host could be\nimpersonated.",
        "oval_definition_id": "oval:ssg-file_permissions_sshd_private_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_sshd_private_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find root:root-owned keys\n  ansible.builtin.command: find -H /etc/ssh/ -maxdepth 1 -user root -regex \".*_key$\"\n    -type f -group root -perm /u+xs,g+xwrs,o+xwrt\n  register: root_owned_keys\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82424-3\n  - DISA-STIG-RHEL-08-010490\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for root:root-owned keys\n  ansible.builtin.file:\n    path: '{{ item }}'\n    mode: u-xs,g-xwrs,o-xwrt\n    state: file\n  with_items:\n  - '{{ root_owned_keys.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82424-3\n  - DISA-STIG-RHEL-08-010490\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Find root:ssh_keys-owned keys\n  ansible.builtin.command: find -H /etc/ssh/ -maxdepth 1 -user root -regex \".*_key$\"\n    -type f -group ssh_keys -perm /u+xs,g+xws,o+xwrt\n  register: dedicated_group_owned_keys\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82424-3\n  - DISA-STIG-RHEL-08-010490\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for root:ssh_keys-owned keys\n  ansible.builtin.file:\n    path: '{{ item }}'\n    mode: u-xs,g-xws,o-xwrt\n    state: file\n  with_items:\n  - '{{ dedicated_group_owned_keys.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82424-3\n  - DISA-STIG-RHEL-08-010490\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_private_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_sshd_private_key",
            "system": "urn:xccdf:fix:script:puppet",
            "fix": "include ssh_private_key_perms\n\nclass ssh_private_key_perms {\n  exec { 'sshd_priv_key':\n    command => \"chmod 0640 /etc/ssh/*_key\",\n    path    => '/bin:/usr/bin'\n  }\n}\n"
          },
          {
            "remediation_id": "file_permissions_sshd_private_key",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfor keyfile in /etc/ssh/*_key; do\n    test -f \"$keyfile\" || continue\n    if test root:root = \"$(stat -c \"%U:%G\" \"$keyfile\")\"; then\n    \n\tchmod u-xs,g-xwrs,o-xwrt \"$keyfile\"\n    \n    elif test root:ssh_keys = \"$(stat -c \"%U:%G\" \"$keyfile\")\"; then\n\tchmod u-xs,g-xws,o-xwrt \"$keyfile\"\n    else\n        echo \"Key-like file '$keyfile' is owned by an unexpected user:group combination\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230287",
        "stig_id": "RHEL-08-010490"
      },
      "xccdf_org.ssgproject.content_rule_file_permissions_sshd_pub_key": {
        "rule_id": "xccdf_org.ssgproject.content_rule_file_permissions_sshd_pub_key",
        "title": "Verify Permissions on SSH Server Public *.pub Key Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82428-4"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R50"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.3"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.04",
              "DSS05.07",
              "DSS06.02"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.13",
              "3.13.10"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.7.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 2.1",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(1)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.DS-5"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010480"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230286r627750_rule"
            ]
          }
        ],
        "description": " To properly set the permissions of <code>/etc/ssh/*.pub</code>, run the command: <pre>$ sudo chmod 0644 /etc/ssh/*.pub</pre>\n      ",
        "rationale": "If a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised.",
        "oval_definition_id": "oval:ssg-file_permissions_sshd_pub_key:def:1",
        "remediations": [
          {
            "remediation_id": "file_permissions_sshd_pub_key",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: Find /etc/ssh/ file(s)\n  command: find -H /etc/ssh/ -maxdepth 1 -perm /u+xs,g+xws,o+xwt  -type f -regextype\n    posix-extended -regex \"^.*\\.pub$\"\n  register: files_found\n  changed_when: false\n  failed_when: false\n  check_mode: false\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82428-4\n  - DISA-STIG-RHEL-08-010480\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n\n- name: Set permissions for /etc/ssh/ file(s)\n  file:\n    path: '{{ item }}'\n    mode: u-xs,g-xws,o-xwt\n    state: file\n  with_items:\n  - '{{ files_found.stdout_lines }}'\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82428-4\n  - DISA-STIG-RHEL-08-010480\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.10\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(1)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - file_permissions_sshd_pub_key\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n"
          },
          {
            "remediation_id": "file_permissions_sshd_pub_key",
            "system": "urn:xccdf:fix:script:puppet",
            "fix": "include ssh_public_key_perms\n\nclass ssh_public_key_perms {\n  exec { 'sshd_pub_key':\n    command => \"chmod 0644 /etc/ssh/*.pub\",\n    path    => '/bin:/usr/bin'\n  }\n}\n"
          },
          {
            "remediation_id": "file_permissions_sshd_pub_key",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nfind -H /etc/ssh/ -maxdepth 1 -perm /u+xs,g+xws,o+xwt  -type f -regextype posix-extended -regex '^.*\\.pub$' -exec chmod u-xs,g-xws,o-xwt {} \\;\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230286",
        "stig_id": "RHEL-08-010480"
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_keepalive": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_keepalive",
        "title": "Set SSH Client Alive Count Max",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80907-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "7",
              "8"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI03.01",
              "BAI03.02",
              "BAI03.03",
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000879",
              "CCI-001133",
              "CCI-002361"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.14.1.1",
              "A.14.2.1",
              "A.14.2.5",
              "A.18.1.4",
              "A.6.1.2",
              "A.6.1.5",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-004-6 R2.2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-12",
              "AC-17(a)",
              "AC-2(5)",
              "CM-6(a)",
              "SC-10"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.IP-2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000163-GPOS-00072",
              "SRG-OS-000279-GPOS-00109"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010200"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230244r951594_rule"
            ]
          }
        ],
        "description": "The SSH server sends at most <code>ClientAliveCountMax</code> messages\nduring a SSH session and waits for a response from the SSH client.\nThe option <code>ClientAliveInterval</code> configures timeout after\neach <code>ClientAliveCountMax</code> message. If the SSH server does not\nreceive a response from the client, then the connection is considered unresponsive\nand terminated.\nFor SSH earlier than v8.2, a <code>ClientAliveCountMax</code> value of <code>0</code>\ncauses a timeout precisely when the <code>ClientAliveInterval</code> is set.\nStarting with v8.2, a value of <code>0</code> disables the timeout functionality\ncompletely. If the option is set to a number greater than <code>0</code>, then\nthe session will be disconnected after\n<code>ClientAliveInterval * ClientAliveCountMax</code> seconds without receiving\na keep alive message.",
        "rationale": "This ensures a user login will be terminated as soon as the <code>ClientAliveInterval</code>\nis reached.",
        "oval_definition_id": "oval:ssg-sshd_set_keepalive:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_keepalive",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_sshd_set_keepalive # promote to variable\n  set_fact:\n    var_sshd_set_keepalive: !!str 1\n  tags:\n    - always\n\n- name: Set SSH Client Alive Count Max\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveCountMax\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveCountMax\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveCountMax\\s+\n      line: ClientAliveCountMax {{ var_sshd_set_keepalive }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80907-9\n  - CJIS-5.5.6\n  - DISA-STIG-RHEL-08-010200\n  - NIST-800-171-3.1.11\n  - NIST-800-53-AC-12\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-2(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-10\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_keepalive\n"
          },
          {
            "remediation_id": "sshd_set_keepalive",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_sshd_set_keepalive='1'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*ClientAliveCountMax\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"ClientAliveCountMax $var_sshd_set_keepalive\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230244",
        "stig_id": "RHEL-08-010200"
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout",
        "title": "Set SSH Client Alive Interval",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80906-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.7"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "7",
              "8"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO13.01",
              "BAI03.01",
              "BAI03.02",
              "BAI03.03",
              "DSS01.03",
              "DSS03.05",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.11"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000879",
              "CCI-001133",
              "CCI-002361"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 6.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.4.1",
              "A.12.4.3",
              "A.14.1.1",
              "A.14.2.1",
              "A.14.2.5",
              "A.18.1.4",
              "A.6.1.2",
              "A.6.1.5",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-004-6 R2.2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-12",
              "AC-17(a)",
              "AC-17(a)",
              "AC-2(5)",
              "CM-6(a)",
              "CM-6(a)",
              "SC-10"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "DE.CM-1",
              "DE.CM-3",
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.IP-2"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000126-GPOS-00066",
              "SRG-OS-000163-GPOS-00072",
              "SRG-OS-000279-GPOS-00109",
              "SRG-OS-000395-GPOS-00175"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-8.1.8"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.2.8"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010201"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-244525r951596_rule"
            ]
          }
        ],
        "description": "SSH allows administrators to set a network responsiveness timeout interval.\nAfter this interval has passed, the unresponsive client will be automatically logged out.\n<br>\n        <br>\nTo set this timeout interval, edit the following line in <code>/etc/ssh/sshd_config</code> as\nfollows:\n<pre>ClientAliveInterval <b>300</b>\n        </pre>\n        <br>\n        <br>\nThe timeout <b>interval</b> is given in seconds. For example, have a timeout\nof 10 minutes, set <b>interval</b> to 600.\n<br>\n        <br>\nIf a shorter timeout has already been set for the login shell, that value will\npreempt any SSH setting made in <code>/etc/ssh/sshd_config</code>. Keep in mind that\nsome processes may stop SSH from correctly detecting that the user is idle.",
        "rationale": "Terminating an idle ssh session within a short time period reduces the window of\nopportunity for unauthorized personnel to take control of a management session\nenabled on the console or console port that has been let unattended.",
        "warnings": [
          {
            "text": "SSH disconnecting unresponsive clients will not have desired effect without also\nconfiguring ClientAliveCountMax in the SSH service configuration.",
            "category": "dependency"
          },
          {
            "text": "Following conditions may prevent the SSH session to time out:\n<ul><li>Remote processes on the remote machine generates output. As the output has to be transferred over the network to the client, the timeout is reset every time such transfer happens.</li><li>Any <code>scp</code> or <code>sftp</code> activity by the same user to the host resets the timeout.</li></ul>\n       ",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-sshd_set_idle_timeout:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_idle_timeout",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value sshd_idle_timeout_value # promote to variable\n  set_fact:\n    sshd_idle_timeout_value: !!str 300\n  tags:\n    - always\n\n- name: Set SSH Client Alive Interval\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveInterval\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveInterval\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*ClientAliveInterval\\s+\n      line: ClientAliveInterval {{ sshd_idle_timeout_value }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80906-1\n  - CJIS-5.5.6\n  - DISA-STIG-RHEL-08-010201\n  - NIST-800-171-3.1.11\n  - NIST-800-53-AC-12\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-2(5)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-SC-10\n  - PCI-DSS-Req-8.1.8\n  - PCI-DSSv4-8.2.8\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_idle_timeout\n"
          },
          {
            "remediation_id": "sshd_set_idle_timeout",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_idle_timeout_value='300'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*ClientAliveInterval\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"ClientAliveInterval $sshd_idle_timeout_value\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-244525",
        "stig_id": "RHEL-08-010201"
      },
      "xccdf_org.ssgproject.content_rule_disable_host_auth": {
        "rule_id": "xccdf_org.ssgproject.content_rule_disable_host_auth",
        "title": "Disable Host-Based Authentication",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80786-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.9"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.12"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-3",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00229"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "8.3.1"
            ]
          }
        ],
        "description": "SSH&#x27;s cryptographic host-based authentication is\nmore secure than <code>.rhosts</code> authentication. However, it is\nnot recommended that hosts unilaterally trust one another, even\nwithin an organization.\n<br>\nThe default SSH configuration disables host-based authentication. The appropriate\nconfiguration is used if no value is set for <code>HostbasedAuthentication</code>.\n<br>\nTo explicitly disable host-based authentication, add or correct the\nfollowing line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>HostbasedAuthentication no</pre>\n       ",
        "rationale": "SSH trust relationships mean a compromise on one host\ncan allow an attacker to move trivially to other hosts.",
        "oval_definition_id": "oval:ssg-disable_host_auth:def:1",
        "remediations": [
          {
            "remediation_id": "disable_host_auth",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Disable Host-Based Authentication\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*HostbasedAuthentication\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*HostbasedAuthentication\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*HostbasedAuthentication\\s+\n      line: HostbasedAuthentication no\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80786-7\n  - CJIS-5.5.6\n  - NIST-800-171-3.1.12\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-3\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-8.3.1\n  - disable_host_auth\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n"
          },
          {
            "remediation_id": "disable_host_auth",
            "system": "urn:xccdf:fix:script:kubernetes",
            "fix": "---\napiVersion: machineconfiguration.openshift.io/v1\nkind: MachineConfig\nspec:\n  config:\n    ignition:\n      version: 3.1.0\n    storage:\n      files:\n      - contents:\n          source: data:,%23%09%24OpenBSD%3A%20sshd_config%2Cv%201.103%202018%2F04%2F09%2020%3A41%3A22%20tj%20Exp%20%24%0A%0A%23%20This%20is%20the%20sshd%20server%20system-wide%20configuration%20file.%20%20See%0A%23%20sshd_config%285%29%20for%20more%20information.%0A%0A%23%20This%20sshd%20was%20compiled%20with%20PATH%3D%2Fusr%2Flocal%2Fbin%3A%2Fusr%2Fbin%3A%2Fusr%2Flocal%2Fsbin%3A%2Fusr%2Fsbin%0A%0A%23%20The%20strategy%20used%20for%20options%20in%20the%20default%20sshd_config%20shipped%20with%0A%23%20OpenSSH%20is%20to%20specify%20options%20with%20their%20default%20value%20where%0A%23%20possible%2C%20but%20leave%20them%20commented.%20%20Uncommented%20options%20override%20the%0A%23%20default%20value.%0A%0A%23%20If%20you%20want%20to%20change%20the%20port%20on%20a%20SELinux%20system%2C%20you%20have%20to%20tell%0A%23%20SELinux%20about%20this%20change.%0A%23%20semanage%20port%20-a%20-t%20ssh_port_t%20-p%20tcp%20%23PORTNUMBER%0A%23%0A%23Port%2022%0A%23AddressFamily%20any%0A%23ListenAddress%200.0.0.0%0A%23ListenAddress%20%3A%3A%0A%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_rsa_key%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_ecdsa_key%0AHostKey%20%2Fetc%2Fssh%2Fssh_host_ed25519_key%0A%0A%23%20Ciphers%20and%20keying%0ARekeyLimit%20512M%201h%0A%0A%23%20System-wide%20Crypto%20policy%3A%0A%23%20This%20system%20is%20following%20system-wide%20crypto%20policy.%20The%20changes%20to%0A%23%20Ciphers%2C%20MACs%2C%20KexAlgoritms%20and%20GSSAPIKexAlgorithsm%20will%20not%20have%20any%0A%23%20effect%20here.%20They%20will%20be%20overridden%20by%20command-line%20options%20passed%20on%0A%23%20the%20server%20start%20up.%0A%23%20To%20opt%20out%2C%20uncomment%20a%20line%20with%20redefinition%20of%20%20CRYPTO_POLICY%3D%0A%23%20variable%20in%20%20%2Fetc%2Fsysconfig%2Fsshd%20%20to%20overwrite%20the%20policy.%0A%23%20For%20more%20information%2C%20see%20manual%20page%20for%20update-crypto-policies%288%29.%0A%0A%23%20Logging%0A%23SyslogFacility%20AUTH%0ASyslogFacility%20AUTHPRIV%0A%23LogLevel%20INFO%0A%0A%23%20Authentication%3A%0A%0A%23LoginGraceTime%202m%0APermitRootLogin%20no%0AStrictModes%20yes%0A%23MaxAuthTries%206%0A%23MaxSessions%2010%0A%0APubkeyAuthentication%20yes%0A%0A%23%20The%20default%20is%20to%20check%20both%20.ssh%2Fauthorized_keys%20and%20.ssh%2Fauthorized_keys2%0A%23%20but%20this%20is%20overridden%20so%20installations%20will%20only%20check%20.ssh%2Fauthorized_keys%0AAuthorizedKeysFile%09.ssh%2Fauthorized_keys%0A%0A%23AuthorizedPrincipalsFile%20none%0A%0A%23AuthorizedKeysCommand%20none%0A%23AuthorizedKeysCommandUser%20nobody%0A%0A%23%20For%20this%20to%20work%20you%20will%20also%20need%20host%20keys%20in%20%2Fetc%2Fssh%2Fssh_known_hosts%0AHostbasedAuthentication%20no%0A%23%20Change%20to%20yes%20if%20you%20don%27t%20trust%20~%2F.ssh%2Fknown_hosts%20for%0A%23%20HostbasedAuthentication%0AIgnoreUserKnownHosts%20yes%0A%23%20Don%27t%20read%20the%20user%27s%20~%2F.rhosts%20and%20~%2F.shosts%20files%0AIgnoreRhosts%20yes%0A%0A%23%20To%20disable%20tunneled%20clear%20text%20passwords%2C%20change%20to%20no%20here%21%0A%23PasswordAuthentication%20yes%0APermitEmptyPasswords%20no%0APasswordAuthentication%20no%0A%0A%23%20Change%20to%20no%20to%20disable%20s%2Fkey%20passwords%0A%23ChallengeResponseAuthentication%20yes%0AChallengeResponseAuthentication%20no%0A%0A%23%20Kerberos%20options%0AKerberosAuthentication%20no%0A%23KerberosOrLocalPasswd%20yes%0A%23KerberosTicketCleanup%20yes%0A%23KerberosGetAFSToken%20no%0A%23KerberosUseKuserok%20yes%0A%0A%23%20GSSAPI%20options%0AGSSAPIAuthentication%20no%0AGSSAPICleanupCredentials%20no%0A%23GSSAPIStrictAcceptorCheck%20yes%0A%23GSSAPIKeyExchange%20no%0A%23GSSAPIEnablek5users%20no%0A%0A%23%20Set%20this%20to%20%27yes%27%20to%20enable%20PAM%20authentication%2C%20account%20processing%2C%0A%23%20and%20session%20processing.%20If%20this%20is%20enabled%2C%20PAM%20authentication%20will%0A%23%20be%20allowed%20through%20the%20ChallengeResponseAuthentication%20and%0A%23%20PasswordAuthentication.%20%20Depending%20on%20your%20PAM%20configuration%2C%0A%23%20PAM%20authentication%20via%20ChallengeResponseAuthentication%20may%20bypass%0A%23%20the%20setting%20of%20%22PermitRootLogin%20without-password%22.%0A%23%20If%20you%20just%20want%20the%20PAM%20account%20and%20session%20checks%20to%20run%20without%0A%23%20PAM%20authentication%2C%20then%20enable%20this%20but%20set%20PasswordAuthentication%0A%23%20and%20ChallengeResponseAuthentication%20to%20%27no%27.%0A%23%20WARNING%3A%20%27UsePAM%20no%27%20is%20not%20supported%20in%20Fedora%20and%20may%20cause%20several%0A%23%20problems.%0AUsePAM%20yes%0A%0A%23AllowAgentForwarding%20yes%0A%23AllowTcpForwarding%20yes%0A%23GatewayPorts%20no%0AX11Forwarding%20yes%0A%23X11DisplayOffset%2010%0A%23X11UseLocalhost%20yes%0A%23PermitTTY%20yes%0A%0A%23%20It%20is%20recommended%20to%20use%20pam_motd%20in%20%2Fetc%2Fpam.d%2Fsshd%20instead%20of%20PrintMotd%2C%0A%23%20as%20it%20is%20more%20configurable%20and%20versatile%20than%20the%20built-in%20version.%0APrintMotd%20no%0A%0APrintLastLog%20yes%0A%23TCPKeepAlive%20yes%0APermitUserEnvironment%20no%0ACompression%20no%0AClientAliveInterval%20600%0AClientAliveCountMax%200%0A%23UseDNS%20no%0A%23PidFile%20%2Fvar%2Frun%2Fsshd.pid%0A%23MaxStartups%2010%3A30%3A100%0A%23PermitTunnel%20no%0A%23ChrootDirectory%20none%0A%23VersionAddendum%20none%0A%0A%23%20no%20default%20banner%20path%0ABanner%20%2Fetc%2Fissue%0A%0A%23%20Accept%20locale-related%20environment%20variables%0AAcceptEnv%20LANG%20LC_CTYPE%20LC_NUMERIC%20LC_TIME%20LC_COLLATE%20LC_MONETARY%20LC_MESSAGES%0AAcceptEnv%20LC_PAPER%20LC_NAME%20LC_ADDRESS%20LC_TELEPHONE%20LC_MEASUREMENT%0AAcceptEnv%20LC_IDENTIFICATION%20LC_ALL%20LANGUAGE%0AAcceptEnv%20XMODIFIERS%0A%0A%23%20override%20default%20of%20no%20subsystems%0ASubsystem%09sftp%09%2Fusr%2Flibexec%2Fopenssh%2Fsftp-server%0A%0A%23%20Example%20of%20overriding%20settings%20on%20a%20per-user%20basis%0A%23Match%20User%20anoncvs%0A%23%09X11Forwarding%20no%0A%23%09AllowTcpForwarding%20no%0A%23%09PermitTTY%20no%0A%23%09ForceCommand%20cvs%20server%0A%0AUsePrivilegeSeparation%20sandbox\n        mode: 0600\n        path: /etc/ssh/sshd_config\n        overwrite: true\n"
          },
          {
            "remediation_id": "disable_host_auth",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*HostbasedAuthentication\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"HostbasedAuthentication no\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords",
        "title": "Disable SSH Access via Empty Passwords",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "high",
        "weight": 1,
        "identifiers": [
          "CCE-80896-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.18"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.1",
              "3.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000766"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 5.2",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.DS-5",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000106-GPOS-00053",
              "SRG-OS-000480-GPOS-00227",
              "SRG-OS-000480-GPOS-00229"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-020330"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230380r951612_rule"
            ]
          }
        ],
        "description": "Disallow SSH login with empty passwords.\nThe default SSH configuration disables logins with empty passwords. The appropriate\nconfiguration is used if no value is set for <code>PermitEmptyPasswords</code>.\n<br>\nTo explicitly disallow SSH login from accounts with empty passwords,\nadd or correct the following line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<br>\n        <pre>PermitEmptyPasswords no</pre>\nAny accounts with empty passwords should be disabled immediately, and PAM configuration\nshould prevent users from being able to assign themselves empty passwords.",
        "rationale": "Configuring this setting for the SSH daemon provides additional assurance\nthat remote login via SSH will require a password, even in the event of\nmisconfiguration elsewhere.",
        "oval_definition_id": "oval:ssg-sshd_disable_empty_passwords:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_disable_empty_passwords",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Disable SSH Access via Empty Passwords\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitEmptyPasswords\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitEmptyPasswords\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitEmptyPasswords\\s+\n      line: PermitEmptyPasswords no\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80896-4\n  - CJIS-5.5.6\n  - DISA-STIG-RHEL-08-020330\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - high_severity\n  - low_complexity\n  - low_disruption\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_disable_empty_passwords\n"
          },
          {
            "remediation_id": "sshd_disable_empty_passwords",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*PermitEmptyPasswords\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"PermitEmptyPasswords no\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230380",
        "stig_id": "RHEL-08-020330"
      },
      "xccdf_org.ssgproject.content_rule_sshd_disable_rhosts": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_disable_rhosts",
        "title": "Disable SSH Support for .rhosts Files",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80899-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.10"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.12"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.IP-1",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FIA_UAU.1"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "SSH can emulate the behavior of the obsolete rsh\ncommand in allowing users to enable insecure access to their\naccounts via <code>.rhosts</code> files.\n<br>\nThe default SSH configuration disables support for <code>.rhosts</code>. The appropriate\nconfiguration is used if no value is set for <code>IgnoreRhosts</code>.\n<br>\nTo explicitly disable support for .rhosts files, add or correct the following line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>IgnoreRhosts yes</pre>\n       ",
        "rationale": "SSH trust relationships mean a compromise on one host\ncan allow an attacker to move trivially to other hosts.",
        "oval_definition_id": "oval:ssg-sshd_disable_rhosts:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_disable_rhosts",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Disable SSH Support for .rhosts Files\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*IgnoreRhosts\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*IgnoreRhosts\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*IgnoreRhosts\\s+\n      line: IgnoreRhosts yes\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80899-8\n  - CJIS-5.5.6\n  - NIST-800-171-3.1.12\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_disable_rhosts\n"
          },
          {
            "remediation_id": "sshd_disable_rhosts",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*IgnoreRhosts\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"IgnoreRhosts yes\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_disable_root_login": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_disable_root_login",
        "title": "Disable SSH Root Login",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80901-2"
        ],
        "references": [
          {
            "name": "anssi",
            "href": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
            "ref_ids": [
              "R33"
            ]
          },
          {
            "name": "app-srg-ctr",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform",
            "ref_ids": [
              "SRG-APP-000148-CTR-000335",
              "SRG-APP-000190-CTR-000500"
            ]
          },
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.19"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "13",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO01.06",
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.02",
              "DSS06.03",
              "DSS06.06",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.1",
              "3.1.5"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366",
              "CCI-000770"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 5.2"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.10.1.1",
              "A.11.1.4",
              "A.11.1.5",
              "A.11.2.1",
              "A.13.1.1",
              "A.13.1.3",
              "A.13.2.1",
              "A.13.2.3",
              "A.13.2.4",
              "A.14.1.2",
              "A.14.1.3",
              "A.18.1.4",
              "A.6.1.2",
              "A.7.1.1",
              "A.7.1.2",
              "A.7.3.1",
              "A.8.2.2",
              "A.8.2.3",
              "A.9.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R2.1",
              "CIP-007-3 R2.2",
              "CIP-007-3 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-6(2)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)",
              "IA-2",
              "IA-2(5)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.DS-5",
              "PR.PT-3"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000109-GPOS-00056",
              "SRG-OS-000480-GPOS-00227"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FAU_GEN.1"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010550"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230296r951608_rule"
            ]
          }
        ],
        "description": "The root user should never be allowed to login to a\nsystem directly over a network.\nTo disable root login via SSH, add or correct the following line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>PermitRootLogin no</pre>\n       ",
        "rationale": "Even though the communications channel may be encrypted, an additional layer of\nsecurity is gained by extending the policy of not logging directly on as root.\nIn addition, logging in with a user-specific account provides individual\naccountability of actions performed on the system and also helps to minimize\ndirect attack attempts on root&#x27;s password.",
        "warnings": [
          {
            "text": "This rule is disabled on Red Hat Virtualization Hosts and Managers, it will report not applicable.\nRHV hosts require root access to be managed by RHV Manager.",
            "category": "general"
          }
        ],
        "platforms": [
          "#no_ovirt"
        ],
        "oval_definition_id": "oval:ssg-sshd_disable_root_login:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_disable_root_login",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Disable SSH Root Login\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitRootLogin\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitRootLogin\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitRootLogin\\s+\n      line: PermitRootLogin no\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80901-2\n  - CJIS-5.5.6\n  - DISA-STIG-RHEL-08-010550\n  - NIST-800-171-3.1.1\n  - NIST-800-171-3.1.5\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-6(2)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - NIST-800-53-IA-2\n  - NIST-800-53-IA-2(5)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_disable_root_login\n"
          },
          {
            "remediation_id": "sshd_disable_root_login",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*PermitRootLogin\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"PermitRootLogin no\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230296",
        "stig_id": "RHEL-08-010550"
      },
      "xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env",
        "title": "Do Not Allow SSH Environment Options",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-80903-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.20"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "3",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.12"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000366"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.4.3.2",
              "4.3.4.3.3"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.12.1.2",
              "A.12.5.1",
              "A.12.6.2",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "CM-6(a)",
              "CM-7(a)",
              "CM-7(b)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.IP-1"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000480-GPOS-00229"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          },
          {
            "name": "stigid",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
            "ref_ids": [
              "RHEL-08-010830"
            ]
          },
          {
            "name": "stigref",
            "href": "https://public.cyber.mil/stigs/srg-stig-tools/",
            "ref_ids": [
              "SV-230330r951610_rule"
            ]
          }
        ],
        "description": "Ensure that users are not able to override environment variables of the SSH daemon.\n<br>\nThe default SSH configuration disables environment processing. The appropriate\nconfiguration is used if no value is set for <code>PermitUserEnvironment</code>.\n<br>\nTo explicitly disable Environment options, add or correct the following\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>PermitUserEnvironment no</pre>\n       ",
        "rationale": "SSH environment options potentially allow users to bypass\naccess restriction in some configurations.",
        "oval_definition_id": "oval:ssg-sshd_do_not_permit_user_env:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_do_not_permit_user_env",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Do Not Allow SSH Environment Options\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitUserEnvironment\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitUserEnvironment\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*PermitUserEnvironment\\s+\n      line: PermitUserEnvironment no\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-80903-8\n  - CJIS-5.5.6\n  - DISA-STIG-RHEL-08-010830\n  - NIST-800-171-3.1.12\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-CM-7(a)\n  - NIST-800-53-CM-7(b)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_do_not_permit_user_env\n"
          },
          {
            "remediation_id": "sshd_do_not_permit_user_env",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*PermitUserEnvironment\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"PermitUserEnvironment no\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": "SV-230330",
        "stig_id": "RHEL-08-010830"
      },
      "xccdf_org.ssgproject.content_rule_sshd_enable_pam": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_enable_pam",
        "title": "Enable PAM",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86721-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.21"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000877"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000125-GPOS-00065"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will\nenable PAM authentication using ChallengeResponseAuthentication and\nPasswordAuthentication in addition to PAM account and session module processing for all\nauthentication types.\n\nTo enable PAM authentication, add or correct the following line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>UsePAM yes</pre>\n       ",
        "rationale": "When UsePAM is set to yes, PAM runs through account and session types properly. This is\nimportant if you want to restrict access to services based off of IP, time or other factors of\nthe account. Additionally, you can make sure users inherit certain environment variables\non login or disallow access to the server.",
        "oval_definition_id": "oval:ssg-sshd_enable_pam:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_enable_pam",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Enable PAM\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*UsePAM\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*UsePAM\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*UsePAM\\s+\n      line: UsePAM yes\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86721-8\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_enable_pam\n"
          },
          {
            "remediation_id": "sshd_enable_pam",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*UsePAM\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"UsePAM yes\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner_net": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner_net",
        "title": "Enable SSH Warning Banner",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-87978-3"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.5"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.04",
              "DSS05.10",
              "DSS06.10"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.9"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000048",
              "CCI-000050",
              "CCI-001384",
              "CCI-001385",
              "CCI-001386",
              "CCI-001387",
              "CCI-001388"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(a)(4)(i)",
              "164.308(b)(1)",
              "164.308(b)(3)",
              "164.310(b)",
              "164.312(e)(1)",
              "164.312(e)(2)(ii)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.2",
              "SR 1.5",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.18.1.4",
              "A.9.2.1",
              "A.9.2.4",
              "A.9.3.1",
              "A.9.4.2",
              "A.9.4.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(a)",
              "AC-8(a)",
              "AC-8(c)",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-7"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000023-GPOS-00006",
              "SRG-OS-000228-GPOS-00088"
            ]
          },
          {
            "name": "ospp",
            "href": "https://www.niap-ccevs.org/Profile/PP.cfm",
            "ref_ids": [
              "FTA_TAB.1"
            ]
          }
        ],
        "description": "To enable the warning banner and ensure it is consistent\nacross the system, add or correct the following line in\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>Banner /etc/issue.net</pre>\nAnother section contains information on how to create an\nappropriate system-wide warning banner.",
        "rationale": "The warning message reinforces policy awareness during the logon process and\nfacilitates possible legal action against attackers. Alternatively, systems\nwhose ownership should not be obvious should ensure usage of a banner that does\nnot provide easy attribution.",
        "oval_definition_id": "oval:ssg-sshd_enable_warning_banner_net:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_enable_warning_banner_net",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Enable SSH Warning Banner\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Banner\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Banner\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Banner\\s+\n      line: Banner /etc/issue.net\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-87978-3\n  - CJIS-5.5.6\n  - NIST-800-171-3.1.9\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-AC-8(a)\n  - NIST-800-53-AC-8(c)\n  - NIST-800-53-CM-6(a)\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_enable_warning_banner_net\n"
          },
          {
            "remediation_id": "sshd_enable_warning_banner_net",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*Banner\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"Banner /etc/issue.net\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_limit_user_access": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_limit_user_access",
        "title": "Limit Users' SSH Access",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "unknown",
        "weight": 1,
        "identifiers": [
          "CCE-82422-7"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.4"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "DSS05.02",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS06.03",
              "DSS06.06"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.12"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.6.1.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.3",
              "A.9.4.1",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-003-8 R5.1.1",
              "CIP-003-8 R5.3",
              "CIP-004-6 R2.2.3",
              "CIP-004-6 R2.3",
              "CIP-007-3 R5.1",
              "CIP-007-3 R5.1.2",
              "CIP-007-3 R5.2",
              "CIP-007-3 R5.3.1",
              "CIP-007-3 R5.3.2",
              "CIP-007-3 R5.3.3"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-3",
              "CM-6(a)"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-4",
              "PR.AC-6",
              "PR.PT-3"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "By default, the SSH configuration allows any user with an account\nto access the system. There are several options available to limit\nwhich users and group can access the system via SSH. It is\nrecommended that at least one of the following options be leveraged:\n- AllowUsers variable gives the system administrator the option of\n  allowing specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically allowing a user&#x27;s access only from a\n  particular host, the entry can be specified in the form of user@host.\n- AllowGroups variable gives the system administrator the option of\n  allowing specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable.\n- DenyUsers variable gives the system administrator the option of\n  denying specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically denying a user&#x27;s access from a\n  particular host, the entry can be specified in the form of user@host.\n- DenyGroups variable gives the system administrator the option of\n  denying specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable.",
        "rationale": "Specifying which accounts are allowed SSH access into the system reduces the\npossibility of unauthorized access to the system.",
        "warnings": [
          {
            "text": "Automated remediation is not available for this configuration check\nbecause each system has unique user names and group names.",
            "category": "general"
          }
        ],
        "oval_definition_id": "oval:ssg-sshd_limit_user_access:def:1",
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_login_grace_time": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_login_grace_time",
        "title": "Ensure SSH LoginGraceTime is configured",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86551-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.12"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>LoginGraceTime</code> parameter to the SSH server specifies the time allowed for successful authentication to\nthe SSH server. The longer the Grace period is the more open unauthenticated connections\ncan exist. Like other session controls in this session the Grace Period should be limited to\nappropriate limits to ensure the service is available for needed access.",
        "rationale": "Setting the <code>LoginGraceTime</code> parameter to a low number will minimize the risk of successful\nbrute force attacks to the SSH server. It will also limit the number of concurrent\nunauthenticated connections.",
        "oval_definition_id": "oval:ssg-sshd_set_login_grace_time:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_login_grace_time",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_sshd_set_login_grace_time # promote to variable\n  set_fact:\n    var_sshd_set_login_grace_time: !!str 60\n  tags:\n    - always\n\n- name: Ensure SSH LoginGraceTime is configured\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LoginGraceTime\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LoginGraceTime\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LoginGraceTime\\s+\n      line: LoginGraceTime {{ var_sshd_set_login_grace_time }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86551-9\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_login_grace_time\n"
          },
          {
            "remediation_id": "sshd_set_login_grace_time",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_sshd_set_login_grace_time='60'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*LoginGraceTime\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"LoginGraceTime $var_sshd_set_login_grace_time\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_loglevel_verbose": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_loglevel_verbose",
        "title": "Set SSH Daemon LogLevel to VERBOSE",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-82420-1"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.13"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000067"
            ]
          },
          {
            "name": "nerc-cip",
            "href": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
            "ref_ids": [
              "CIP-007-3 R7.1"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(1)",
              "AC-17(a)",
              "CM-6(a)"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000032-GPOS-00013"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.2.4"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>VERBOSE</code> parameter configures the SSH daemon to record login and logout activity.\nTo specify the log level in\nSSH, add or correct the following line in\n\n\n<code>/etc/ssh/sshd_config</code>:\n\n<pre>LogLevel VERBOSE</pre>\n       ",
        "rationale": "SSH provides several logging levels with varying amounts of verbosity. <code>DEBUG</code> is specifically\nnot recommended other than strictly for debugging SSH communications since it provides\nso much data that it is difficult to identify important security information. <code>INFO</code> or\n<code>VERBOSE</code> level is the basic level that only records login activity of SSH users. In many\nsituations, such as Incident Response, it is important to determine when a particular user was active\non a system. The logout record can eliminate those users who disconnected, which helps narrow the\nfield.",
        "oval_definition_id": "oval:ssg-sshd_set_loglevel_verbose:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_loglevel_verbose",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: Set SSH Daemon LogLevel to VERBOSE\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LogLevel\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LogLevel\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*LogLevel\\s+\n      line: LogLevel VERBOSE\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-82420-1\n  - NIST-800-53-AC-17(1)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - PCI-DSS-Req-2.2.4\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_loglevel_verbose\n"
          },
          {
            "remediation_id": "sshd_set_loglevel_verbose",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*LogLevel\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"LogLevel VERBOSE\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_max_auth_tries": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_max_auth_tries",
        "title": "Set SSH authentication attempt limit",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83500-9"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.15"
            ]
          },
          {
            "name": "ism",
            "href": "https://www.cyber.gov.au/acsc/view-all-content/ism",
            "ref_ids": [
              "0421",
              "0422",
              "0431",
              "0974",
              "1173",
              "1401",
              "1504",
              "1505",
              "1546",
              "1557",
              "1558",
              "1559",
              "1560",
              "1561"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>MaxAuthTries</code> parameter specifies the maximum number of authentication attempts\npermitted per connection. Once the number of failures reaches half this value, additional failures are logged.\nto set MaxAUthTries edit <code>/etc/ssh/sshd_config</code> as follows:\n<pre>MaxAuthTries 4\n        </pre>\n       ",
        "rationale": "Setting the MaxAuthTries parameter to a low number will minimize the risk of successful\nbrute force attacks to the SSH server.",
        "oval_definition_id": "oval:ssg-sshd_set_max_auth_tries:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_max_auth_tries",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value sshd_max_auth_tries_value # promote to variable\n  set_fact:\n    sshd_max_auth_tries_value: !!str 4\n  tags:\n    - always\n\n- name: Set SSH authentication attempt limit\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxAuthTries\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxAuthTries\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxAuthTries\\s+\n      line: MaxAuthTries {{ sshd_max_auth_tries_value }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83500-9\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_max_auth_tries\n"
          },
          {
            "remediation_id": "sshd_set_max_auth_tries",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_max_auth_tries_value='4'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*MaxAuthTries\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"MaxAuthTries $sshd_max_auth_tries_value\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_max_sessions": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_max_sessions",
        "title": "Set SSH MaxSessions limit",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-83357-4"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.16"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The <code>MaxSessions</code> parameter specifies the maximum number of open sessions permitted\nfrom a given connection. To set MaxSessions edit\n<code>/etc/ssh/sshd_config</code> as follows: <pre>MaxSessions 10\n        </pre>\n       ",
        "rationale": "To protect a system from denial of service due to a large number of concurrent\nsessions, use the rate limiting function of MaxSessions to protect availability\nof sshd logins and prevent overwhelming the daemon.",
        "oval_definition_id": "oval:ssg-sshd_set_max_sessions:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_max_sessions",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "- name: XCCDF Value var_sshd_max_sessions # promote to variable\n  set_fact:\n    var_sshd_max_sessions: !!str 10\n  tags:\n    - always\n\n- name: Set SSH MaxSessions limit\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxSessions\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxSessions\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxSessions\\s+\n      line: MaxSessions {{ var_sshd_max_sessions }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-83357-4\n  - PCI-DSSv4-2.2.6\n  - configure_strategy\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - sshd_set_max_sessions\n"
          },
          {
            "remediation_id": "sshd_set_max_sessions",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "configure",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_sshd_max_sessions='10'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*MaxSessions\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"MaxSessions $var_sshd_max_sessions\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_set_maxstartups": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_set_maxstartups",
        "title": "Ensure SSH MaxStartups is configured",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-90718-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.17"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.6"
            ]
          }
        ],
        "description": "The MaxStartups parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon. Additional connections will be\ndropped until authentication succeeds or the LoginGraceTime expires for a\nconnection. To confgure MaxStartups, you should add or correct the following\nline in the\n<code>/etc/ssh/sshd_config</code> file:\n<pre>MaxStartups 10:30:60\n        </pre>\nCIS recommends a MaxStartups value of &#x27;10:30:60&#x27;, or more restrictive where\ndictated by site policy.",
        "rationale": "To protect a system from denial of service due to a large number of pending\nauthentication connection attempts, use the rate limiting function of MaxStartups\nto protect availability of sshd logins and prevent overwhelming the daemon.",
        "oval_definition_id": "oval:ssg-sshd_set_maxstartups:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_set_maxstartups",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value var_sshd_set_maxstartups # promote to variable\n  set_fact:\n    var_sshd_set_maxstartups: !!str 10:30:60\n  tags:\n    - always\n\n- name: Ensure SSH MaxStartups is configured\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxStartups\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxStartups\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MaxStartups\\s+\n      line: MaxStartups {{ var_sshd_set_maxstartups }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-90718-8\n  - PCI-DSSv4-2.2.6\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_set_maxstartups\n"
          },
          {
            "remediation_id": "sshd_set_maxstartups",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_sshd_set_maxstartups='10:30:60'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*MaxStartups\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"MaxStartups $var_sshd_set_maxstartups\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers",
        "title": "Use Only FIPS 140-2 Validated Ciphers",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-81032-5"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.6"
            ]
          },
          {
            "name": "cis-csc",
            "href": "https://www.cisecurity.org/controls/",
            "ref_ids": [
              "1",
              "11",
              "12",
              "14",
              "15",
              "16",
              "18",
              "3",
              "5",
              "6",
              "8",
              "9"
            ]
          },
          {
            "name": "cjis",
            "href": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
            "ref_ids": [
              "5.5.6"
            ]
          },
          {
            "name": "cobit5",
            "href": "https://www.isaca.org/resources/cobit",
            "ref_ids": [
              "APO11.04",
              "APO13.01",
              "BAI03.05",
              "BAI10.01",
              "BAI10.02",
              "BAI10.03",
              "BAI10.05",
              "DSS01.04",
              "DSS05.02",
              "DSS05.03",
              "DSS05.04",
              "DSS05.05",
              "DSS05.07",
              "DSS05.10",
              "DSS06.03",
              "DSS06.06",
              "DSS06.10",
              "MEA02.01"
            ]
          },
          {
            "name": "cui",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
            "ref_ids": [
              "3.1.13",
              "3.13.11",
              "3.13.8"
            ]
          },
          {
            "name": "disa",
            "href": "https://public.cyber.mil/stigs/cci/",
            "ref_ids": [
              "CCI-000068",
              "CCI-000366",
              "CCI-000803",
              "CCI-000877",
              "CCI-002890",
              "CCI-003123"
            ]
          },
          {
            "name": "hipaa",
            "href": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
            "ref_ids": [
              "164.308(b)(1)",
              "164.308(b)(2)",
              "164.312(e)(1)",
              "164.312(e)(2)(i)",
              "164.312(e)(2)(ii)",
              "164.314(b)(2)(i)"
            ]
          },
          {
            "name": "isa-62443-2009",
            "href": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
            "ref_ids": [
              "4.3.3.2.2",
              "4.3.3.3.9",
              "4.3.3.5.1",
              "4.3.3.5.2",
              "4.3.3.5.3",
              "4.3.3.5.4",
              "4.3.3.5.5",
              "4.3.3.5.6",
              "4.3.3.5.7",
              "4.3.3.5.8",
              "4.3.3.6.1",
              "4.3.3.6.2",
              "4.3.3.6.3",
              "4.3.3.6.4",
              "4.3.3.6.5",
              "4.3.3.6.6",
              "4.3.3.6.7",
              "4.3.3.6.8",
              "4.3.3.6.9",
              "4.3.3.7.1",
              "4.3.3.7.2",
              "4.3.3.7.3",
              "4.3.3.7.4",
              "4.3.4.3.2",
              "4.3.4.3.3",
              "4.3.4.4.7",
              "4.4.2.1",
              "4.4.2.2",
              "4.4.2.4"
            ]
          },
          {
            "name": "isa-62443-2013",
            "href": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
            "ref_ids": [
              "SR 1.1",
              "SR 1.10",
              "SR 1.11",
              "SR 1.12",
              "SR 1.13",
              "SR 1.2",
              "SR 1.3",
              "SR 1.4",
              "SR 1.5",
              "SR 1.6",
              "SR 1.7",
              "SR 1.8",
              "SR 1.9",
              "SR 2.1",
              "SR 2.10",
              "SR 2.11",
              "SR 2.12",
              "SR 2.2",
              "SR 2.3",
              "SR 2.4",
              "SR 2.5",
              "SR 2.6",
              "SR 2.7",
              "SR 2.8",
              "SR 2.9",
              "SR 3.1",
              "SR 3.5",
              "SR 3.8",
              "SR 4.1",
              "SR 4.3",
              "SR 5.1",
              "SR 5.2",
              "SR 5.3",
              "SR 7.1",
              "SR 7.6"
            ]
          },
          {
            "name": "iso27001-2013",
            "href": "https://www.iso.org/contents/data/standard/05/45/54534.html",
            "ref_ids": [
              "A.11.2.6",
              "A.12.1.2",
              "A.12.4.1",
              "A.12.4.2",
              "A.12.4.3",
              "A.12.4.4",
              "A.12.5.1",
              "A.12.6.2",
              "A.12.7.1",
              "A.13.1.1",
              "A.13.2.1",
              "A.14.1.3",
              "A.14.2.2",
              "A.14.2.3",
              "A.14.2.4",
              "A.18.1.4",
              "A.6.1.2",
              "A.6.2.1",
              "A.6.2.2",
              "A.7.1.1",
              "A.9.1.2",
              "A.9.2.1",
              "A.9.2.2",
              "A.9.2.3",
              "A.9.2.4",
              "A.9.2.6",
              "A.9.3.1",
              "A.9.4.1",
              "A.9.4.2",
              "A.9.4.3",
              "A.9.4.4",
              "A.9.4.5"
            ]
          },
          {
            "name": "nist",
            "href": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
            "ref_ids": [
              "AC-17(2)",
              "AC-17(a)",
              "CM-6(a)",
              "IA-5(1)(c)",
              "MA-4(6)",
              "SC-12(2)",
              "SC-12(3)",
              "SC-13"
            ]
          },
          {
            "name": "nist-csf",
            "href": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
            "ref_ids": [
              "PR.AC-1",
              "PR.AC-3",
              "PR.AC-4",
              "PR.AC-6",
              "PR.AC-7",
              "PR.IP-1",
              "PR.PT-1",
              "PR.PT-3",
              "PR.PT-4"
            ]
          },
          {
            "name": "os-srg",
            "href": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
            "ref_ids": [
              "SRG-OS-000033-GPOS-00014",
              "SRG-OS-000120-GPOS-00061",
              "SRG-OS-000125-GPOS-00065",
              "SRG-OS-000250-GPOS-00093",
              "SRG-OS-000393-GPOS-00173",
              "SRG-OS-000394-GPOS-00174"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.7"
            ]
          }
        ],
        "description": "Limit the ciphers to those algorithms which are FIPS-approved.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\nThe following line in <code>/etc/ssh/sshd_config</code>\ndemonstrates use of FIPS-approved ciphers:\n<pre>Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc</pre>\nThe man page <code>sshd_config(5)</code> contains a list of supported ciphers.\n\nThe rule is parametrized to use the following ciphers: <code>-3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,rijndael-cbc@lysator.liu.se</code>.",
        "rationale": "Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore\ncannot be relied upon to provide confidentiality or integrity, and system data may be compromised.\n<br>\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to\ncryptographic modules.\n<br>\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules\nutilize authentication that meets industry and government requirements. For government systems, this allows\nSecurity Levels 1, 2, 3, or 4 for use on Red Hat Enterprise Linux 8.",
        "warnings": [
          {
            "text": "The system needs to be rebooted for these changes to take effect.",
            "category": "general"
          },
          {
            "text": "System Crypto Modules must be provided by a vendor that undergoes\nFIPS-140 certifications.\nFIPS-140 is applicable to all Federal agencies that use\ncryptographic-based security systems to protect sensitive information\nin computer and telecommunication systems (including voice systems) as\ndefined in Section 5131 of the Information Technology Management Reform\nAct of 1996, Public Law 104-106. This standard shall be used in\ndesigning and implementing cryptographic modules that Federal\ndepartments and agencies operate or are operated for them under\ncontract. See <b><a href=\"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-2.pdf\">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.140-2.pdf</a></b>\nTo meet this, the system has to have cryptographic software provided by\na vendor that has undergone this certification. This means providing\ndocumentation, test results, design information, and independent third\nparty review by an accredited lab. While open source software is\ncapable of meeting this, it does not meet FIPS-140 unless the vendor\nsubmits to this process.",
            "category": "regulatory"
          }
        ],
        "oval_definition_id": "oval:ssg-sshd_use_approved_ciphers:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_use_approved_ciphers",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value sshd_approved_ciphers # promote to variable\n  set_fact:\n    sshd_approved_ciphers: !!str -3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,rijndael-cbc@lysator.liu.se\n  tags:\n    - always\n\n- name: Use Only FIPS 140-2 Validated Ciphers\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Ciphers\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Ciphers\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*Ciphers\\s+\n      line: Ciphers {{ sshd_approved_ciphers }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-81032-5\n  - CJIS-5.5.6\n  - NIST-800-171-3.1.13\n  - NIST-800-171-3.13.11\n  - NIST-800-171-3.13.8\n  - NIST-800-53-AC-17(2)\n  - NIST-800-53-AC-17(a)\n  - NIST-800-53-CM-6(a)\n  - NIST-800-53-IA-5(1)(c)\n  - NIST-800-53-MA-4(6)\n  - NIST-800-53-SC-12(2)\n  - NIST-800-53-SC-12(3)\n  - NIST-800-53-SC-13\n  - PCI-DSSv4-2.2.7\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_use_approved_ciphers\n"
          },
          {
            "remediation_id": "sshd_use_approved_ciphers",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_approved_ciphers='-3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc,rijndael-cbc@lysator.liu.se'\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^Ciphers\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$sshd_approved_ciphers\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^Ciphers\\\\>\" \"/etc/ssh/sshd_config\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^Ciphers\\\\>.*/$escaped_formatted_output/gi\" \"/etc/ssh/sshd_config\"\nelse\n    if [[ -s \"/etc/ssh/sshd_config\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/ssh/sshd_config\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/ssh/sshd_config\"\n    fi\n    cce=\"CCE-81032-5\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/ssh/sshd_config\" >> \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/ssh/sshd_config\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_use_strong_kex": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_use_strong_kex",
        "title": "Use Only Strong Key Exchange algorithms",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86518-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.11"
            ]
          },
          {
            "name": "pcidss",
            "href": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
            "ref_ids": [
              "Req-2.3"
            ]
          },
          {
            "name": "pcidss4",
            "href": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
            "ref_ids": [
              "2.2.7"
            ]
          }
        ],
        "description": "Limit the Key Exchange to strong algorithms.\nThe following line in <code>/etc/ssh/sshd_config</code> demonstrates use\nof those:\n<pre>KexAlgorithms -diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\n        </pre>\n       ",
        "rationale": "Key exchange is any method in cryptography by which cryptographic keys are exchanged\nbetween two parties, allowing use of a cryptographic algorithm. If the sender and receiver\nwish to exchange encrypted messages, each must be equipped to encrypt messages to be\nsent and decrypt messages received",
        "oval_definition_id": "oval:ssg-sshd_use_strong_kex:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_use_strong_kex",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value sshd_strong_kex # promote to variable\n  set_fact:\n    sshd_strong_kex: !!str -diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1\n  tags:\n    - always\n\n- name: Use Only Strong Key Exchange algorithms\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*KexAlgorithms\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*KexAlgorithms\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*KexAlgorithms\\s+\n      line: KexAlgorithms {{ sshd_strong_kex }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86518-8\n  - PCI-DSS-Req-2.3\n  - PCI-DSSv4-2.2.7\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_use_strong_kex\n"
          },
          {
            "remediation_id": "sshd_use_strong_kex",
            "system": "urn:xccdf:fix:script:sh",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_strong_kex='-diffie-hellman-group1-sha1,diffie-hellman-group14-sha1,diffie-hellman-group-exchange-sha1'\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*KexAlgorithms\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert at the beginning of the file\nprintf '%s\\n' \"KexAlgorithms $sshd_strong_kex\" > \"/etc/ssh/sshd_config\"\ncat \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      },
      "xccdf_org.ssgproject.content_rule_sshd_use_strong_macs": {
        "rule_id": "xccdf_org.ssgproject.content_rule_sshd_use_strong_macs",
        "title": "Use Only Strong MACs",
        "result": "notapplicable",
        "time": "2025-04-12T19:39:26+00:00",
        "severity": "medium",
        "weight": 1,
        "identifiers": [
          "CCE-86504-8"
        ],
        "references": [
          {
            "name": "cis",
            "href": "https://www.cisecurity.org/benchmark/red_hat_linux/",
            "ref_ids": [
              "4.2.14"
            ]
          }
        ],
        "description": "Limit the MACs to strong hash algorithms.\nThe following line in <code>/etc/ssh/sshd_config</code> demonstrates use\nof those MACs:\n<pre>MACs -hmac-md5,hmac-md5-96,hmac-ripemd160,hmac-sha1-96,umac-64@openssh.com,hmac-md5-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,umac-64-etm@openssh.com\n        </pre>\n       ",
        "rationale": "MD5 and 96-bit MAC algorithms are considered weak and have been shown to increase\nexploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of\nattention as a weak spot that can be exploited with expanded computing power. An\nattacker that breaks the algorithm could take advantage of a MiTM position to decrypt the\nSSH tunnel and capture credentials and information",
        "oval_definition_id": "oval:ssg-sshd_use_strong_macs:def:1",
        "remediations": [
          {
            "remediation_id": "sshd_use_strong_macs",
            "system": "urn:xccdf:fix:script:ansible",
            "complexity": "low",
            "disruption": "low",
            "strategy": "restrict",
            "fix": "- name: XCCDF Value sshd_strong_macs # promote to variable\n  set_fact:\n    sshd_strong_macs: !!str -hmac-md5,hmac-md5-96,hmac-ripemd160,hmac-sha1-96,umac-64@openssh.com,hmac-md5-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,umac-64-etm@openssh.com\n  tags:\n    - always\n\n- name: Use Only Strong MACs\n  block:\n\n  - name: Check for duplicate values\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MACs\\s+\n      state: absent\n    check_mode: true\n    changed_when: false\n    register: dupes\n\n  - name: Deduplicate values from /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MACs\\s+\n      state: absent\n    when: dupes.found is defined and dupes.found > 1\n\n  - name: Insert correct line to /etc/ssh/sshd_config\n    lineinfile:\n      path: /etc/ssh/sshd_config\n      create: true\n      regexp: (?i)^\\s*MACs\\s+\n      line: MACs {{ sshd_strong_macs }}\n      state: present\n      insertbefore: BOF\n      validate: /usr/sbin/sshd -t -f %s\n  when: ansible_virtualization_type not in [\"docker\", \"lxc\", \"openvz\", \"podman\", \"container\"]\n  tags:\n  - CCE-86504-8\n  - low_complexity\n  - low_disruption\n  - medium_severity\n  - no_reboot_needed\n  - restrict_strategy\n  - sshd_use_strong_macs\n"
          },
          {
            "remediation_id": "sshd_use_strong_macs",
            "system": "urn:xccdf:fix:script:sh",
            "fix": "# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_strong_macs='-hmac-md5,hmac-md5-96,hmac-ripemd160,hmac-sha1-96,umac-64@openssh.com,hmac-md5-etm@openssh.com,hmac-md5-96-etm@openssh.com,hmac-ripemd160-etm@openssh.com,hmac-sha1-96-etm@openssh.com,umac-64-etm@openssh.com'\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^MACs\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"$sshd_strong_macs\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^MACs\\\\>\" \"/etc/ssh/sshd_config\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^MACs\\\\>.*/$escaped_formatted_output/gi\" \"/etc/ssh/sshd_config\"\nelse\n    if [[ -s \"/etc/ssh/sshd_config\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/ssh/sshd_config\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/ssh/sshd_config\"\n    fi\n    cce=\"CCE-86504-8\"\n    printf '# Per %s: Set %s in %s\\n' \"${cce}\" \"${formatted_output}\" \"/etc/ssh/sshd_config\" >> \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/ssh/sshd_config\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\n"
          }
        ],
        "vuln_id": null,
        "stig_id": null
      }
    },
    "references": {
      "anssi": "https://cyber.gouv.fr/sites/default/files/document/linux_configuration-en-v2.pdf",
      "cis": "https://www.cisecurity.org/benchmark/red_hat_linux/",
      "cis-csc": "https://www.cisecurity.org/controls/",
      "cjis": "https://www.fbi.gov/file-repository/cjis-security-policy-v5_5_20160601-2-1.pdf",
      "cobit5": "https://www.isaca.org/resources/cobit",
      "disa": "https://public.cyber.mil/stigs/cci/",
      "isa-62443-2009": "https://www.isa.org/products/isa-62443-2-1-2009-security-for-industrial-automat",
      "isa-62443-2013": "https://www.isa.org/products/ansi-isa-62443-3-3-99-03-03-2013-security-for-indu",
      "ism": "https://www.cyber.gov.au/acsc/view-all-content/ism",
      "iso27001-2013": "https://www.iso.org/contents/data/standard/05/45/54534.html",
      "nist": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-53r4.pdf",
      "nist-csf": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
      "os-srg": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cgeneral-purpose-os",
      "pcidss": "https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf",
      "pcidss4": "https://docs-prv.pcisecuritystandards.org/PCI%20DSS/Standard/PCI-DSS-v4_0.pdf",
      "stigid": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=operating-systems%2Cunix-linux",
      "stigref": "https://public.cyber.mil/stigs/srg-stig-tools/",
      "hipaa": "https://www.gpo.gov/fdsys/pkg/CFR-2007-title45-vol1/pdf/CFR-2007-title45-vol1-chapA-subchapC.pdf",
      "nerc-cip": "https://www.nerc.com/pa/Stand/Standard%20Purpose%20Statement%20DL/US_Standard_One-Stop-Shop.xlsx",
      "ospp": "https://www.niap-ccevs.org/Profile/PP.cfm",
      "cui": "http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-171.pdf",
      "app-srg-ctr": "https://public.cyber.mil/stigs/downloads/?_dl_facet_stigs=container-platform",
      "bsi": "https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Grundschutz/International/bsi_it_gs_comp_2022.pdf"
    },
    "identifiers": {
      "CCE-80844-4": "https://ncp.nist.gov/cce",
      "CCE-80675-2": "https://ncp.nist.gov/cce",
      "CCE-85964-5": "https://ncp.nist.gov/cce",
      "CCE-80676-0": "https://ncp.nist.gov/cce",
      "CCE-80935-0": "https://ncp.nist.gov/cce",
      "CCE-80939-2": "https://ncp.nist.gov/cce",
      "CCE-86282-1": "https://ncp.nist.gov/cce",
      "CCE-80851-9": "https://ncp.nist.gov/cce",
      "CCE-81003-6": "https://ncp.nist.gov/cce",
      "CCE-86195-5": "https://ncp.nist.gov/cce",
      "CCE-86007-2": "https://ncp.nist.gov/cce",
      "CCE-89904-7": "https://ncp.nist.gov/cce",
      "CCE-83693-2": "https://ncp.nist.gov/cce",
      "CCE-83742-7": "https://ncp.nist.gov/cce",
      "CCE-80775-0": "https://ncp.nist.gov/cce",
      "CCE-80776-8": "https://ncp.nist.gov/cce",
      "CCE-80780-0": "https://ncp.nist.gov/cce",
      "CCE-80781-8": "https://ncp.nist.gov/cce",
      "CCE-82214-8": "https://ncp.nist.gov/cce",
      "CCE-83798-9": "https://ncp.nist.gov/cce",
      "CCE-83601-5": "https://ncp.nist.gov/cce",
      "CCE-82279-1": "https://ncp.nist.gov/cce",
      "CCE-87838-9": "https://ncp.nist.gov/cce",
      "CCE-80790-9": "https://ncp.nist.gov/cce",
      "CCE-80792-5": "https://ncp.nist.gov/cce",
      "CCE-88248-0": "https://ncp.nist.gov/cce",
      "CCE-80763-6": "https://ncp.nist.gov/cce",
      "CCE-86147-6": "https://ncp.nist.gov/cce",
      "CCE-83496-0": "https://ncp.nist.gov/cce",
      "CCE-83708-8": "https://ncp.nist.gov/cce",
      "CCE-86051-0": "https://ncp.nist.gov/cce",
      "CCE-83728-6": "https://ncp.nist.gov/cce",
      "CCE-83718-7": "https://ncp.nist.gov/cce",
      "CCE-86054-4": "https://ncp.nist.gov/cce",
      "CCE-83738-5": "https://ncp.nist.gov/cce",
      "CCE-83348-3": "https://ncp.nist.gov/cce",
      "CCE-86047-8": "https://ncp.nist.gov/cce",
      "CCE-83338-4": "https://ncp.nist.gov/cce",
      "CCE-80768-5": "https://ncp.nist.gov/cce",
      "CCE-80770-1": "https://ncp.nist.gov/cce",
      "CCE-86225-0": "https://ncp.nist.gov/cce",
      "CCE-86931-3": "https://ncp.nist.gov/cce",
      "CCE-86916-4": "https://ncp.nist.gov/cce",
      "CCE-83478-8": "https://ncp.nist.gov/cce",
      "CCE-83480-4": "https://ncp.nist.gov/cce",
      "CCE-80667-9": "https://ncp.nist.gov/cce",
      "CCE-80670-3": "https://ncp.nist.gov/cce",
      "CCE-86233-4": "https://ncp.nist.gov/cce",
      "CCE-80654-7": "https://ncp.nist.gov/cce",
      "CCE-83377-2": "https://ncp.nist.gov/cce",
      "CCE-82066-2": "https://ncp.nist.gov/cce",
      "CCE-82046-4": "https://ncp.nist.gov/cce",
      "CCE-80656-2": "https://ncp.nist.gov/cce",
      "CCE-80891-5": "https://ncp.nist.gov/cce",
      "CCE-80892-3": "https://ncp.nist.gov/cce",
      "CCE-85945-4": "https://ncp.nist.gov/cce",
      "CCE-80893-1": "https://ncp.nist.gov/cce",
      "CCE-89903-9": "https://ncp.nist.gov/cce",
      "CCE-86201-1": "https://ncp.nist.gov/cce",
      "CCE-86328-2": "https://ncp.nist.gov/cce",
      "CCE-80954-1": "https://ncp.nist.gov/cce",
      "CCE-80674-5": "https://ncp.nist.gov/cce",
      "CCE-80647-1": "https://ncp.nist.gov/cce",
      "CCE-82473-0": "https://ncp.nist.gov/cce",
      "CCE-86914-9": "https://ncp.nist.gov/cce",
      "CCE-80671-1": "https://ncp.nist.gov/cce",
      "CCE-86758-0": "https://ncp.nist.gov/cce",
      "CCE-80651-3": "https://ncp.nist.gov/cce",
      "CCE-86525-3": "https://ncp.nist.gov/cce",
      "CCE-80822-0": "https://ncp.nist.gov/cce",
      "CCE-80841-0": "https://ncp.nist.gov/cce",
      "CCE-85953-8": "https://ncp.nist.gov/cce",
      "CCE-86755-6": "https://ncp.nist.gov/cce",
      "CCE-80649-7": "https://ncp.nist.gov/cce",
      "CCE-86297-9": "https://ncp.nist.gov/cce",
      "CCE-86071-8": "https://ncp.nist.gov/cce",
      "CCE-86517-0": "https://ncp.nist.gov/cce",
      "CCE-86112-0": "https://ncp.nist.gov/cce",
      "CCE-80843-6": "https://ncp.nist.gov/cce",
      "CCE-86064-3": "https://ncp.nist.gov/cce",
      "CCE-80673-7": "https://ncp.nist.gov/cce",
      "CCE-86314-2": "https://ncp.nist.gov/cce",
      "CCE-86316-7": "https://ncp.nist.gov/cce",
      "CCE-83424-2": "https://ncp.nist.gov/cce",
      "CCE-87369-5": "https://ncp.nist.gov/cce",
      "CCE-86131-0": "https://ncp.nist.gov/cce",
      "CCE-84043-9": "https://ncp.nist.gov/cce",
      "CCE-84038-9": "https://ncp.nist.gov/cce",
      "CCE-80672-9": "https://ncp.nist.gov/cce",
      "CCE-85914-0": "https://ncp.nist.gov/cce",
      "CCE-81036-6": "https://ncp.nist.gov/cce",
      "CCE-82888-9": "https://ncp.nist.gov/cce",
      "CCE-81035-8": "https://ncp.nist.gov/cce",
      "CCE-80800-6": "https://ncp.nist.gov/cce",
      "CCE-86009-8": "https://ncp.nist.gov/cce",
      "CCE-80805-5": "https://ncp.nist.gov/cce",
      "CCE-86015-5": "https://ncp.nist.gov/cce",
      "CCE-80814-7": "https://ncp.nist.gov/cce",
      "CCE-86024-7": "https://ncp.nist.gov/cce",
      "CCE-80828-7": "https://ncp.nist.gov/cce",
      "CCE-85915-7": "https://ncp.nist.gov/cce",
      "CCE-86012-2": "https://ncp.nist.gov/cce",
      "CCE-85913-2": "https://ncp.nist.gov/cce",
      "CCE-86021-3": "https://ncp.nist.gov/cce",
      "CCE-85912-4": "https://ncp.nist.gov/cce",
      "CCE-86028-8": "https://ncp.nist.gov/cce",
      "CCE-80829-5": "https://ncp.nist.gov/cce",
      "CCE-80847-7": "https://ncp.nist.gov/cce",
      "CCE-80886-5": "https://ncp.nist.gov/cce",
      "CCE-88321-5": "https://ncp.nist.gov/cce",
      "CCE-80860-0": "https://ncp.nist.gov/cce",
      "CCE-80861-8": "https://ncp.nist.gov/cce",
      "CCE-80862-6": "https://ncp.nist.gov/cce",
      "CCE-85921-5": "https://ncp.nist.gov/cce",
      "CCE-85930-6": "https://ncp.nist.gov/cce",
      "CCE-85995-9": "https://ncp.nist.gov/cce",
      "CCE-86045-2": "https://ncp.nist.gov/cce",
      "CCE-87605-2": "https://ncp.nist.gov/cce",
      "CCE-84275-7": "https://ncp.nist.gov/cce",
      "CCE-82998-6": "https://ncp.nist.gov/cce",
      "CCE-80877-4": "https://ncp.nist.gov/cce",
      "CCE-87272-1": "https://ncp.nist.gov/cce",
      "CCE-87278-8": "https://ncp.nist.gov/cce",
      "CCE-81006-9": "https://ncp.nist.gov/cce",
      "CCE-81009-3": "https://ncp.nist.gov/cce",
      "CCE-81013-5": "https://ncp.nist.gov/cce",
      "CCE-82863-2": "https://ncp.nist.gov/cce",
      "CCE-81007-7": "https://ncp.nist.gov/cce",
      "CCE-81010-1": "https://ncp.nist.gov/cce",
      "CCE-81015-0": "https://ncp.nist.gov/cce",
      "CCE-80917-8": "https://ncp.nist.gov/cce",
      "CCE-81011-9": "https://ncp.nist.gov/cce",
      "CCE-81018-4": "https://ncp.nist.gov/cce",
      "CCE-81021-8": "https://ncp.nist.gov/cce",
      "CCE-81016-8": "https://ncp.nist.gov/cce",
      "CCE-80919-4": "https://ncp.nist.gov/cce",
      "CCE-80920-2": "https://ncp.nist.gov/cce",
      "CCE-81020-0": "https://ncp.nist.gov/cce",
      "CCE-81022-6": "https://ncp.nist.gov/cce",
      "CCE-81017-6": "https://ncp.nist.gov/cce",
      "CCE-80922-8": "https://ncp.nist.gov/cce",
      "CCE-81023-4": "https://ncp.nist.gov/cce",
      "CCE-80923-6": "https://ncp.nist.gov/cce",
      "CCE-80918-6": "https://ncp.nist.gov/cce",
      "CCE-80921-0": "https://ncp.nist.gov/cce",
      "CCE-81024-2": "https://ncp.nist.gov/cce",
      "CCE-86376-1": "https://ncp.nist.gov/cce",
      "CCE-88428-8": "https://ncp.nist.gov/cce",
      "CCE-87231-7": "https://ncp.nist.gov/cce",
      "CCE-83501-7": "https://ncp.nist.gov/cce",
      "CCE-80783-4": "https://ncp.nist.gov/cce",
      "CCE-80818-8": "https://ncp.nist.gov/cce",
      "CCE-83497-8": "https://ncp.nist.gov/cce",
      "CCE-83499-4": "https://ncp.nist.gov/cce",
      "CCE-86140-1": "https://ncp.nist.gov/cce",
      "CCE-83475-4": "https://ncp.nist.gov/cce",
      "CCE-83535-5": "https://ncp.nist.gov/cce",
      "CCE-83324-4": "https://ncp.nist.gov/cce",
      "CCE-83415-0": "https://ncp.nist.gov/cce",
      "CCE-80796-6": "https://ncp.nist.gov/cce",
      "CCE-80797-4": "https://ncp.nist.gov/cce",
      "CCE-80798-2": "https://ncp.nist.gov/cce",
      "CCE-80799-0": "https://ncp.nist.gov/cce",
      "CCE-87030-3": "https://ncp.nist.gov/cce",
      "CCE-83473-9": "https://ncp.nist.gov/cce",
      "CCE-83533-0": "https://ncp.nist.gov/cce",
      "CCE-83326-9": "https://ncp.nist.gov/cce",
      "CCE-83413-5": "https://ncp.nist.gov/cce",
      "CCE-80801-4": "https://ncp.nist.gov/cce",
      "CCE-80802-2": "https://ncp.nist.gov/cce",
      "CCE-80803-0": "https://ncp.nist.gov/cce",
      "CCE-80804-8": "https://ncp.nist.gov/cce",
      "CCE-87055-0": "https://ncp.nist.gov/cce",
      "CCE-83483-8": "https://ncp.nist.gov/cce",
      "CCE-83573-6": "https://ncp.nist.gov/cce",
      "CCE-83332-7": "https://ncp.nist.gov/cce",
      "CCE-83417-6": "https://ncp.nist.gov/cce",
      "CCE-80810-5": "https://ncp.nist.gov/cce",
      "CCE-80811-3": "https://ncp.nist.gov/cce",
      "CCE-80812-1": "https://ncp.nist.gov/cce",
      "CCE-80813-9": "https://ncp.nist.gov/cce",
      "CCE-86634-3": "https://ncp.nist.gov/cce",
      "CCE-80873-3": "https://ncp.nist.gov/cce",
      "CCE-81031-7": "https://ncp.nist.gov/cce",
      "CCE-80837-8": "https://ncp.nist.gov/cce",
      "CCE-80838-6": "https://ncp.nist.gov/cce",
      "CCE-80839-4": "https://ncp.nist.gov/cce",
      "CCE-81048-1": "https://ncp.nist.gov/cce",
      "CCE-81050-7": "https://ncp.nist.gov/cce",
      "CCE-82623-0": "https://ncp.nist.gov/cce",
      "CCE-82139-7": "https://ncp.nist.gov/cce",
      "CCE-82140-5": "https://ncp.nist.gov/cce",
      "CCE-82080-3": "https://ncp.nist.gov/cce",
      "CCE-82975-4": "https://ncp.nist.gov/cce",
      "CCE-82921-8": "https://ncp.nist.gov/cce",
      "CCE-82077-9": "https://ncp.nist.gov/cce",
      "CCE-82008-4": "https://ncp.nist.gov/cce",
      "CCE-82065-4": "https://ncp.nist.gov/cce",
      "CCE-82062-1": "https://ncp.nist.gov/cce",
      "CCE-83383-0": "https://ncp.nist.gov/cce",
      "CCE-82068-8": "https://ncp.nist.gov/cce",
      "CCE-82151-2": "https://ncp.nist.gov/cce",
      "CCE-82154-6": "https://ncp.nist.gov/cce",
      "CCE-80953-3": "https://ncp.nist.gov/cce",
      "CCE-82251-0": "https://ncp.nist.gov/cce",
      "CCE-82252-8": "https://ncp.nist.gov/cce",
      "CCE-80916-0": "https://ncp.nist.gov/cce",
      "CCE-82877-2": "https://ncp.nist.gov/cce",
      "CCE-82756-8": "https://ncp.nist.gov/cce",
      "CCE-82755-0": "https://ncp.nist.gov/cce",
      "CCE-80827-9": "https://ncp.nist.gov/cce",
      "CCE-80867-5": "https://ncp.nist.gov/cce",
      "CCE-86151-8": "https://ncp.nist.gov/cce",
      "CCE-80868-3": "https://ncp.nist.gov/cce",
      "CCE-82188-4": "https://ncp.nist.gov/cce",
      "CCE-80875-8": "https://ncp.nist.gov/cce",
      "CCE-82268-4": "https://ncp.nist.gov/cce",
      "CCE-82234-6": "https://ncp.nist.gov/cce",
      "CCE-82227-0": "https://ncp.nist.gov/cce",
      "CCE-82256-9": "https://ncp.nist.gov/cce",
      "CCE-82244-5": "https://ncp.nist.gov/cce",
      "CCE-82223-9": "https://ncp.nist.gov/cce",
      "CCE-82272-6": "https://ncp.nist.gov/cce",
      "CCE-82237-9": "https://ncp.nist.gov/cce",
      "CCE-82209-8": "https://ncp.nist.gov/cce",
      "CCE-82260-1": "https://ncp.nist.gov/cce",
      "CCE-82247-8": "https://ncp.nist.gov/cce",
      "CCE-82224-7": "https://ncp.nist.gov/cce",
      "CCE-82277-5": "https://ncp.nist.gov/cce",
      "CCE-82240-3": "https://ncp.nist.gov/cce",
      "CCE-82230-4": "https://ncp.nist.gov/cce",
      "CCE-82263-5": "https://ncp.nist.gov/cce",
      "CCE-82253-6": "https://ncp.nist.gov/cce",
      "CCE-82206-4": "https://ncp.nist.gov/cce",
      "CCE-86945-3": "https://ncp.nist.gov/cce",
      "CCE-86184-9": "https://ncp.nist.gov/cce",
      "CCE-86849-7": "https://ncp.nist.gov/cce",
      "CCE-87102-0": "https://ncp.nist.gov/cce",
      "CCE-86829-9": "https://ncp.nist.gov/cce",
      "CCE-86843-0": "https://ncp.nist.gov/cce",
      "CCE-86903-2": "https://ncp.nist.gov/cce",
      "CCE-86876-0": "https://ncp.nist.gov/cce",
      "CCE-83385-5": "https://ncp.nist.gov/cce",
      "CCE-82408-6": "https://ncp.nist.gov/cce",
      "CCE-90745-1": "https://ncp.nist.gov/cce",
      "CCE-82414-4": "https://ncp.nist.gov/cce",
      "CCE-85970-2": "https://ncp.nist.gov/cce",
      "CCE-88034-4": "https://ncp.nist.gov/cce",
      "CCE-88119-3": "https://ncp.nist.gov/cce",
      "CCE-85976-9": "https://ncp.nist.gov/cce",
      "CCE-88498-1": "https://ncp.nist.gov/cce",
      "CCE-82174-4": "https://ncp.nist.gov/cce",
      "CCE-82858-2": "https://ncp.nist.gov/cce",
      "CCE-82762-6": "https://ncp.nist.gov/cce",
      "CCE-82874-9": "https://ncp.nist.gov/cce",
      "CCE-82873-1": "https://ncp.nist.gov/cce",
      "CCE-82879-8": "https://ncp.nist.gov/cce",
      "CCE-86335-7": "https://ncp.nist.gov/cce",
      "CCE-80850-1": "https://ncp.nist.gov/cce",
      "CCE-82181-9": "https://ncp.nist.gov/cce",
      "CCE-82432-6": "https://ncp.nist.gov/cce",
      "CCE-80842-8": "https://ncp.nist.gov/cce",
      "CCE-82182-7": "https://ncp.nist.gov/cce",
      "CCE-80849-3": "https://ncp.nist.gov/cce",
      "CCE-82436-7": "https://ncp.nist.gov/cce",
      "CCE-83590-0": "https://ncp.nist.gov/cce",
      "CCE-82861-6": "https://ncp.nist.gov/cce",
      "CCE-82189-2": "https://ncp.nist.gov/cce",
      "CCE-85978-5": "https://ncp.nist.gov/cce",
      "CCE-85980-1": "https://ncp.nist.gov/cce",
      "CCE-82901-0": "https://ncp.nist.gov/cce",
      "CCE-86126-0": "https://ncp.nist.gov/cce",
      "CCE-86133-6": "https://ncp.nist.gov/cce",
      "CCE-82898-8": "https://ncp.nist.gov/cce",
      "CCE-86118-7": "https://ncp.nist.gov/cce",
      "CCE-86129-4": "https://ncp.nist.gov/cce",
      "CCE-82894-7": "https://ncp.nist.gov/cce",
      "CCE-82424-3": "https://ncp.nist.gov/cce",
      "CCE-82428-4": "https://ncp.nist.gov/cce",
      "CCE-80907-9": "https://ncp.nist.gov/cce",
      "CCE-80906-1": "https://ncp.nist.gov/cce",
      "CCE-80786-7": "https://ncp.nist.gov/cce",
      "CCE-80896-4": "https://ncp.nist.gov/cce",
      "CCE-80899-8": "https://ncp.nist.gov/cce",
      "CCE-80901-2": "https://ncp.nist.gov/cce",
      "CCE-80903-8": "https://ncp.nist.gov/cce",
      "CCE-86721-8": "https://ncp.nist.gov/cce",
      "CCE-87978-3": "https://ncp.nist.gov/cce",
      "CCE-82422-7": "https://ncp.nist.gov/cce",
      "CCE-86551-9": "https://ncp.nist.gov/cce",
      "CCE-82420-1": "https://ncp.nist.gov/cce",
      "CCE-83500-9": "https://ncp.nist.gov/cce",
      "CCE-83357-4": "https://ncp.nist.gov/cce",
      "CCE-90718-8": "https://ncp.nist.gov/cce",
      "CCE-81032-5": "https://ncp.nist.gov/cce",
      "CCE-86518-8": "https://ncp.nist.gov/cce",
      "CCE-86504-8": "https://ncp.nist.gov/cce"
    }
  }