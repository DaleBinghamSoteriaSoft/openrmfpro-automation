<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <!-- Bootstrap CSS -->
        <link href="/css/bootstrap.min.css" type="text/css" rel="stylesheet" crossorigin="anonymous">
        <link href="/css/style.css" type="text/css" rel="stylesheet" crossorigin="anonymous">
    
        <title>OpenRMF Professional System Package Checklists</title>
    </head>
    <body style="font-size: 12pt;">
        <main class="main" id="top">
            <div id="divMainContainer" class="container-fluid" data-layout="container">
              <div class="content">
                <h1 class="mb-3">OpenRMF<sup>&reg;</sup> Professional Sample Application</h1>
                <a href="javascript:goHome();" title="Go to the Homepage">HOME</a><p></p>
                <div class="card overflow-hidden mb-3">
                  <div class="card-header bg-light">
                    <div class="row justify-content-between align-items-center">
                      <div class="col-sm-auto">
                        <h5 class="mb-1 mb-md-0">Your System Package POAM Risk Cube</h5>
                      </div>
                      <div class="col-sm-auto fs--1">
                        
                      </div>
                    </div>
                  </div>
                  <div class="card-body fs--1">
                    <div id="divLoading" style="display: none;" class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                    <table id="tblPOAMData" style="width: 100%; min-height: 600px;">
                      <thead>
                        <tr>
                          <th colspan="7" class="text-center poamCubeImpact">Impact</th>
                        </tr>
                      </thead>
                      <tbody id="poamItems">
                        <tr>
                          <td rowspan="6" class="poamCubeLikelihood"><div class="rotateMinus90">Likelihood</div></td>
                          <td style="width: 15%;" class="text-center"></td>
                          <td style="width: 15%;" class="text-center">Negligible</td>
                          <td style="width: 15%;" class="text-center">Minor</td>
                          <td style="width: 15%;" class="text-center">Moderate</td>
                          <td style="width: 15%;" class="text-center">Significant</td>
                          <td style="width: 15%;" class="text-center">Severe</td>
                        </tr>
                        <tr>
                          <td class="text-center">Very Likely</td>
                          <td class="text-center badge-soft-poam-low"><span id="txtVHLikelihoodVLImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtVHLikelihoodLImpact"></span></td>
                          <td class="text-center badge-soft-poam-high"><span id="txtVHLikelihoodMImpact"></span></td>
                          <td class="text-center badge-soft-poam-veryhigh"><span id="txtVHLikelihoodHImpact"></span></td>
                          <td class="text-center badge-soft-poam-veryhigh"><span id="txtVHLikelihoodVHImpact"></span></td>
                        </tr>
                        <tr>
                          <td class="text-center">Likely</td>
                          <td class="text-center badge-soft-poam-verylow"><span id="txtHLikelihoodVLImpact"></span></td>
                          <td class="text-center badge-soft-poam-low"><span id="txtHLikelihoodLImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtHLikelihoodMImpact"></span></td>
                          <td class="text-center badge-soft-poam-high"><span id="txtHLikelihoodHImpact"></span></td>
                          <td class="text-center badge-soft-poam-veryhigh"><span id="txtHLikelihoodVHImpact"></span></td>
                        </tr>
                        <tr>
                          <td class="text-center">Possible</td>
                          <td class="text-center badge-soft-poam-verylow"><span id="txtMLikelihoodVLImpact"></span></td>
                          <td class="text-center badge-soft-poam-low"><span id="txtMLikelihoodLImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtMLikelihoodMImpact"></span></td>
                          <td class="text-center badge-soft-poam-high"><span id="txtMLikelihoodHImpact"></span></td>
                          <td class="text-center badge-soft-poam-high"><span id="txtMLikelihoodVHImpact"></span></td>
                        </tr>
                        <tr>
                          <td class="text-center">Unlikely</td>
                          <td class="text-center badge-soft-poam-verylow"><span id="txtLLikelihoodVLImpact"></span></td>
                          <td class="text-center badge-soft-poam-low"><span id="txtLLikelihoodLImpact"></span></td>
                          <td class="text-center badge-soft-poam-low"><span id="txtLLikelihoodMImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtLLikelihoodHImpact"></span></td>
                          <td class="text-center badge-soft-poam-high"><span id="txtLLikelihoodVHImpact"></span></td>
                        </tr>
                        <tr>
                          <td class="text-center">Very Unlikely</td>
                          <td class="text-center badge-soft-poam-verylow"><span id="txtVLLikelihoodVLImpact"></span></td>
                          <td class="text-center badge-soft-poam-verylow"><span id="txtVLLikelihoodLImpact"></span></td>
                          <td class="text-center badge-soft-poam-low"><span id="txtVLLikelihoodMImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtVLLikelihoodHImpact"></span></td>
                          <td class="text-center badge-soft-poam-moderate"><span id="txtVLLikelihoodVHImpact"></span></td>
                        </tr>
                      </tbody>
                    </table>
                    <div class="clearfix">&nbsp;</div>
                    <div>Total Unassigned POA&amp;M Items: <span id="txtUnassigned"></span></div>
                  </div>
                </div> <!-- end system package selection -->

            </div> <!-- end content -->
          </div> <!-- end divMainContainer -->
        </main>  

        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/common.js"></script>
        <script>
            var systemKey = "";
            
            document.addEventListener("DOMContentLoaded", function(event) { 
                systemKey = getParameterByName("systemKey");
                if (systemKey) {
                  sessionStorage.setItem("systemKey", systemKey);
                  getPOAMRiskData();
                } else {
                  goHome();
                }
            });

            async function getPOAMRiskData() {
              if (systemKey) {
                showElement("divLoading");
                let response = await fetch("/api/systempackage/"+systemKey+"/riskcube/");
                if (response.ok) {
                    var data = await response.json();
                    if (data) {
                      setFieldValue("txtVHLikelihoodVLImpact", data.countVHLikelihoodVLImpact);
                      setFieldValue("txtVHLikelihoodLImpact", data.countVHLikelihoodLImpact);
                      setFieldValue("txtVHLikelihoodMImpact", data.countVHLikelihoodMImpact);
                      setFieldValue("txtVHLikelihoodHImpact", data.countVHLikelihoodHImpact);
                      setFieldValue("txtVHLikelihoodVHImpact", data.countVHLikelihoodVHImpact);

                      setFieldValue("txtHLikelihoodVLImpact", data.countHLikelihoodVLImpact);
                      setFieldValue("txtHLikelihoodLImpact", data.countHLikelihoodLImpact);
                      setFieldValue("txtHLikelihoodMImpact", data.countHLikelihoodMImpact);
                      setFieldValue("txtHLikelihoodHImpact", data.countHLikelihoodHImpact);
                      setFieldValue("txtHLikelihoodVHImpact", data.countHLikelihoodVHImpact);

                      setFieldValue("txtMLikelihoodVLImpact", data.countMLikelihoodVLImpact);
                      setFieldValue("txtMLikelihoodLImpact", data.countMLikelihoodLImpact);
                      setFieldValue("txtMLikelihoodMImpact", data.countMLikelihoodMImpact);
                      setFieldValue("txtMLikelihoodHImpact", data.countMLikelihoodHImpact);
                      setFieldValue("txtMLikelihoodVHImpact", data.countMLikelihoodVHImpact);

                      setFieldValue("txtLLikelihoodVLImpact", data.countLLikelihoodVLImpact);
                      setFieldValue("txtLLikelihoodLImpact", data.countLLikelihoodLImpact);
                      setFieldValue("txtLLikelihoodMImpact", data.countLLikelihoodMImpact);
                      setFieldValue("txtLLikelihoodHImpact", data.countLLikelihoodHImpact);
                      setFieldValue("txtLLikelihoodVHImpact", data.countLLikelihoodVHImpact);

                      setFieldValue("txtVLLikelihoodVLImpact", data.countVLLikelihoodVLImpact);
                      setFieldValue("txtVLLikelihoodLImpact", data.countVLLikelihoodLImpact);
                      setFieldValue("txtVLLikelihoodMImpact", data.countVLLikelihoodMImpact);
                      setFieldValue("txtVLLikelihoodHImpact", data.countVLLikelihoodHImpact);
                      setFieldValue("txtVLLikelihoodVHImpact", data.countVLLikelihoodVHImpact);

                      setFieldValue("txtUnassigned", data.countUnassigned);                      
                    } else {
                        alert('System Package data did not contain valid POAM data.');
                    }
                } else {
                    alert("No valid System Package POAM data found");
                }
              } else {
                  alert('Please choose a valid System Package');
              }
              hideElement("divLoading");
            }

        </script>
    </body>
</html>